[0m06:40:10.486605 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:40:10.503548 | 3d548351-71fa-4890-ab94-24bb05ce17dc ==============================
[0m06:40:10.503548 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:40:10.504233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:40:10.580662 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m06:40:10.587455 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m06:40:10.590700 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_ryh18oj'
[0m06:40:10.592559 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m06:40:10.597740 [debug] [MainThread]: Creating symlink to local dependency.
[0m06:40:10.598832 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m06:40:10.600026 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.17440638, "process_user_time": 0.82751, "process_kernel_time": 0.081148, "process_mem_max_rss": "105672", "process_in_blocks": "176", "process_out_blocks": "8"}
[0m06:40:10.601019 [debug] [MainThread]: Command `dbt deps` succeeded at 06:40:10.600928 after 0.18 seconds
[0m06:40:10.602080 [debug] [MainThread]: Flushing usage events
[0m06:40:12.499830 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:40:12.504336 | fa6e9cd0-9cb1-45fa-bbb4-ae9e9568e9f6 ==============================
[0m06:40:12.504336 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:40:12.506651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:40:12.638021 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:40:12.679122 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m06:40:12.693345 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:40:14.063819 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:40:14.065946 [info ] [MainThread]: 
[0m06:40:14.069227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:40:14.070133 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:40:14.097050 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:40:14.100874 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:40:14.101484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:19.105995 [debug] [ThreadPool]: SQL status: SELECT 8 in 5.007 seconds
[0m06:40:19.110407 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:40:19.112572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m06:40:19.113771 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m06:40:19.122482 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m06:40:19.123336 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m06:40:19.125928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:40:19.130532 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:40:19.134548 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m06:40:19.135318 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m06:40:19.136468 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m06:40:19.137384 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m06:40:19.137755 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m06:40:19.138238 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m06:40:19.139173 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m06:40:19.139600 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m06:40:19.143470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m06:40:19.143957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:40:19.150159 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:40:19.155145 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:40:19.153350 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:40:19.156461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:40:19.157503 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:40:19.158689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:19.162025 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m06:40:19.162788 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:40:19.164218 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:40:19.163738 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:40:19.165532 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:40:19.166219 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:40:19.166973 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m06:40:19.168303 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:40:19.168790 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m06:40:19.169325 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:40:19.170118 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:40:19.171072 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:40:19.175489 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:19.176079 [debug] [MainThread]: On master: BEGIN
[0m06:40:19.176457 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:40:19.181152 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:40:19.181832 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:19.182505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:40:19.185811 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:40:19.187335 [debug] [MainThread]: On master: ROLLBACK
[0m06:40:19.187996 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:19.188460 [debug] [MainThread]: On master: BEGIN
[0m06:40:19.189261 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:40:19.189762 [debug] [MainThread]: On master: COMMIT
[0m06:40:19.190250 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:19.190647 [debug] [MainThread]: On master: COMMIT
[0m06:40:19.191256 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:40:19.191731 [debug] [MainThread]: On master: Close
[0m06:40:19.192300 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:40:19.192829 [info ] [MainThread]: 
[0m06:40:19.198804 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m06:40:19.199642 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m06:40:19.202943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now seed.dbtcomp.geography)
[0m06:40:19.203524 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m06:40:19.204099 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m06:40:19.231056 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m06:40:19.232340 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m06:40:19.233361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:19.238703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:40:19.239594 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m06:40:19.240174 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m06:40:19.243463 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m06:40:19.297798 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m06:40:19.298496 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m06:40:19.300403 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m06:40:19.306577 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m06:40:19.326205 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m06:40:19.327657 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m06:40:19.328143 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m06:40:19.329333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:40:19.330888 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m06:40:19.332310 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.13s]
[0m06:40:19.332893 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m06:40:19.333898 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:19.334262 [debug] [MainThread]: On master: BEGIN
[0m06:40:19.334513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:40:19.339038 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:40:19.344454 [debug] [MainThread]: On master: COMMIT
[0m06:40:19.346732 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:19.348074 [debug] [MainThread]: On master: COMMIT
[0m06:40:19.349654 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:40:19.350775 [debug] [MainThread]: On master: Close
[0m06:40:19.365826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:40:19.378212 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:40:19.397855 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m06:40:19.406860 [info ] [MainThread]: 
[0m06:40:19.413666 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m06:40:19.421590 [debug] [MainThread]: Command end result
[0m06:40:19.504374 [info ] [MainThread]: 
[0m06:40:19.504875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:40:19.505725 [info ] [MainThread]: 
[0m06:40:19.506088 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:40:19.510184 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.0437093, "process_user_time": 2.234173, "process_kernel_time": 0.103146, "process_mem_max_rss": "113404", "process_in_blocks": "488", "process_out_blocks": "0"}
[0m06:40:19.510737 [debug] [MainThread]: Command `dbt seed` succeeded at 06:40:19.510657 after 7.04 seconds
[0m06:40:19.512002 [debug] [MainThread]: Flushing usage events
[0m06:41:16.493737 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:16.498962 | 2e54ed52-7e6b-4637-9ad8-01ff5082e136 ==============================
[0m06:41:16.498962 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.500236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.517835 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:16.535046 | 0a019ac3-fb60-4ada-9ed2-af78d00e5e24 ==============================
[0m06:41:16.535046 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.536217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.575030 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:16.594401 | 247d8f70-3087-4965-a13e-593fa694c391 ==============================
[0m06:41:16.594401 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.601185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.606463 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:41:16.608915 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:16.613584 | 94ea0d91-1a1e-4624-9c3f-d26a875e41a8 ==============================
[0m06:41:16.613584 [info ] [MainThread]: Running with dbt=1.8.2


============================== 06:41:16.614148 | 7985dc78-13d7-4d9a-a2ff-c1e17609c048 ==============================
[0m06:41:16.614148 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.603903 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:41:16.614882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellerscsv', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.615481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 06:41:16.616764 | 8df8bb5c-01f6-4922-95d8-8dabbc55ba34 ==============================
[0m06:41:16.616764 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.619764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.616316 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:16.622844 | fc0347a4-17c0-4d3d-873c-af0ddfcb2a40 ==============================
[0m06:41:16.622844 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.624033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.631216 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:16.636046 | fdab455b-4f47-4a9a-9439-8175c0c8884c ==============================
[0m06:41:16.636046 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.636566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.666469 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.677658 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.713027 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.736552 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.769830 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.772963 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.798567 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.802695 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.820694 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.827951 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.829277 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.832095 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.834140 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.837477 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.846435 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.851360 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.854872 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.859573 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.865450 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.878550 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.912767 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.913381 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.914091 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.914524 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.929740 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.930629 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.940867 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.941607 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.949440 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.950390 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.982474 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.983599 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:18.232730 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.236105 [info ] [MainThread]: 
[0m06:41:18.240084 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.241684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.251727 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.255725 [info ] [MainThread]: 
[0m06:41:18.258399 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.260236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.281950 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.282897 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.283931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.287850 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.288823 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.289772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.290723 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m06:41:18.295308 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:18.300286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m06:41:18.301775 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m06:41:18.302158 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m06:41:18.304513 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:18.310216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m06:41:18.308359 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m06:41:18.312505 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m06:41:18.313497 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m06:41:18.318374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:18.319455 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m06:41:18.320245 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m06:41:18.321268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:18.324381 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m06:41:18.325923 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m06:41:18.327144 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m06:41:18.329945 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m06:41:18.334537 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m06:41:18.335270 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m06:41:18.337130 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m06:41:18.339683 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m06:41:18.340799 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m06:41:18.344184 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m06:41:18.347423 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m06:41:18.348188 [debug] [ThreadPool]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "pg_namespace_nspname_index"
DETAIL:  Key (nspname)=(dev) already exists.

[0m06:41:18.349211 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m06:41:18.350186 [debug] [ThreadPool]: On create_sales_dw_dev: ROLLBACK
[0m06:41:18.352900 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m06:41:18.355187 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:41:18.358207 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m06:41:18.357343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m06:41:18.362731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:18.364112 [debug] [MainThread]: Connection 'create_sales_dw_dev' was properly closed.
[0m06:41:18.365285 [info ] [MainThread]: 
[0m06:41:18.365382 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.358512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:18.366065 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m06:41:18.367453 [error] [MainThread]: Encountered an error:
Database Error
  duplicate key value violates unique constraint "pg_namespace_nspname_index"
  DETAIL:  Key (nspname)=(dev) already exists.
[0m06:41:18.367691 [info ] [MainThread]: 
[0m06:41:18.369102 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8927099, "process_user_time": 2.398472, "process_kernel_time": 0.140177, "process_mem_max_rss": "111532", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:18.370260 [debug] [MainThread]: Command `dbt run` failed at 06:41:18.370148 after 1.89 seconds
[0m06:41:18.370537 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.371152 [debug] [MainThread]: Flushing usage events
[0m06:41:18.365463 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:18.373019 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:18.372413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.375184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:18.370661 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.382540 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:18.383168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.390094 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m06:41:18.391265 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:18.392810 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:18.396317 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:41:18.398367 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.399318 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:18.396886 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m06:41:18.405686 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:18.404654 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m06:41:18.406815 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:18.410519 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:18.415064 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.416586 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:18.416845 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.423277 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.426391 [info ] [MainThread]: 
[0m06:41:18.425091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.427046 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.427627 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.428600 [debug] [MainThread]: On master: BEGIN
[0m06:41:18.429670 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.430477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:18.431251 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.435180 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m06:41:18.435266 [info ] [MainThread]: 
[0m06:41:18.437613 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:18.437846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.438801 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:41:18.441387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.443470 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.444588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:41:18.445107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:18.455086 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.456348 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.456711 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:41:18.445325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:41:18.457144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.458212 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:18.460153 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.456946 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.461118 [debug] [MainThread]: On master: BEGIN
[0m06:41:18.460467 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:18.462646 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:18.464116 [debug] [MainThread]: On master: COMMIT
[0m06:41:18.461660 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:18.465432 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.466277 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.463504 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:18.465360 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.466961 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m06:41:18.466737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.467690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.468194 [debug] [MainThread]: On master: COMMIT
[0m06:41:18.465908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:18.471233 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:18.472618 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:18.475216 [debug] [MainThread]: On master: Close
[0m06:41:18.476874 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m06:41:18.477967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:41:18.477575 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:18.479139 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:18.480188 [info ] [MainThread]: 
[0m06:41:18.478501 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:18.488212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:41:18.486990 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:18.492339 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m06:41:18.489572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:18.490282 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.496763 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m06:41:18.498440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m06:41:18.496075 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:18.495466 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:18.500378 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m06:41:18.499926 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.498130 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:18.501093 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:18.505901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.500739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:18.505366 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:18.509708 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m06:41:18.506564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:18.508651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.514187 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:41:18.515048 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m06:41:18.518461 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.519855 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m06:41:18.522956 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m06:41:18.516768 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:18.524502 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.524964 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:18.520354 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:18.526577 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.527852 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m06:41:18.525590 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:18.529320 [info ] [MainThread]: 
[0m06:41:18.531232 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:18.531727 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:18.531866 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.531578 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m06:41:18.533307 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:18.534500 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.534058 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:18.532666 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:18.534586 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:18.541309 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:18.545781 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.546465 [debug] [MainThread]: On master: BEGIN
[0m06:41:18.546908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:18.549014 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.550419 [info ] [MainThread]: 
[0m06:41:18.550816 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m06:41:18.551037 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.553075 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:41:18.553582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.554238 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.554657 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:18.555464 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:41:18.557705 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m06:41:18.558107 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:41:18.558315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:18.559389 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:18.560109 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.560535 [debug] [MainThread]: On master: BEGIN
[0m06:41:18.560560 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.561136 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.561423 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:18.561851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.562372 [debug] [MainThread]: On master: COMMIT
[0m06:41:18.563148 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.563557 [debug] [MainThread]: On master: COMMIT
[0m06:41:18.564042 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:18.564533 [debug] [MainThread]: On master: Close
[0m06:41:18.565153 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:18.565538 [info ] [MainThread]: 
[0m06:41:18.571165 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m06:41:18.571827 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m06:41:18.572435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_channels)
[0m06:41:18.573089 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m06:41:18.574920 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.575573 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.576054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.576487 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.578180 [info ] [MainThread]: 
[0m06:41:18.578473 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m06:41:18.578886 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.579563 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m06:41:18.579702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.600191 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.600858 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.601298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.602575 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m06:41:18.604117 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:41:18.604568 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m06:41:18.604990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:18.609442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:41:18.610044 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:41:18.610667 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m06:41:18.614470 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m06:41:18.619541 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:41:18.621517 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m06:41:18.622502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:18.635921 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m06:41:18.637178 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:41:18.641167 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m06:41:18.647672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:41:18.652080 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m06:41:18.659390 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:41:18.666729 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m06:41:18.672439 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:18.674348 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m06:41:18.675761 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.10s]
[0m06:41:18.679307 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m06:41:18.694468 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.695404 [debug] [MainThread]: On master: BEGIN
[0m06:41:18.699214 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:18.703289 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:18.705286 [debug] [MainThread]: On master: COMMIT
[0m06:41:18.706413 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.711207 [debug] [MainThread]: On master: COMMIT
[0m06:41:18.711870 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:18.714189 [debug] [MainThread]: On master: Close
[0m06:41:18.715672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:18.716416 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:41:18.720132 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m06:41:18.720649 [info ] [MainThread]: 
[0m06:41:18.721036 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m06:41:18.721570 [debug] [MainThread]: Command end result
[0m06:41:18.721882 [info ] [MainThread]: 
[0m06:41:18.722287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:18.724214 [info ] [MainThread]: 
[0m06:41:18.726542 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:18.731245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1715221, "process_user_time": 2.550626, "process_kernel_time": 0.148709, "process_mem_max_rss": "112584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:18.733409 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:18.733328 after 2.17 seconds
[0m06:41:18.733829 [debug] [MainThread]: Flushing usage events
[0m06:41:20.149916 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:20.157389 | 5ea2485a-f6b9-4cde-bbff-e7e8dfa555e7 ==============================
[0m06:41:20.157389 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:20.158663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:41:20.158694 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:20.165747 | 49f1ebed-e152-4556-968f-b92f42ea8b33 ==============================
[0m06:41:20.165747 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:20.166470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:41:20.298319 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:20.304535 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:20.317783 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:20.324296 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:20.535476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:20.536099 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:20.537184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:20.538566 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:20.581121 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:20.582635 [info ] [MainThread]: 
[0m06:41:20.586349 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:20.587090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:20.593384 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:20.595363 [info ] [MainThread]: 
[0m06:41:20.595792 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:20.597190 [debug] [MainThread]: Command end result
[0m06:41:20.597784 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5092478, "process_user_time": 0.976567, "process_kernel_time": 0.061603, "process_mem_max_rss": "96940", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:20.598286 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:20.598199 after 0.51 seconds
[0m06:41:20.598634 [debug] [MainThread]: Flushing usage events
[0m06:41:20.608950 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:20.610299 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:20.612305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:20.619375 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m06:41:20.621005 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:20.625358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:41:20.625899 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:20.630365 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:20.632129 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:20.632561 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:20.632885 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:20.633225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:20.633539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:20.638189 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:41:20.640886 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:20.641423 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:20.643494 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:20.646892 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:20.647455 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:23.476932 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m06:41:23.480820 [debug] [ThreadPool]: SQL status: BEGIN in 5.015 seconds
[0m06:41:23.482422 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:23.483042 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:23.483481 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:23.483900 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:23.485788 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:23.486066 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:23.487044 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:23.487875 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:23.488325 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:23.488627 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:23.493004 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.493454 [debug] [MainThread]: On master: BEGIN
[0m06:41:23.493749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:23.497502 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:23.498081 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.498530 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:23.501635 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m06:41:23.503059 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:23.503700 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.504137 [debug] [MainThread]: On master: BEGIN
[0m06:41:23.504769 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:23.505195 [debug] [MainThread]: On master: COMMIT
[0m06:41:23.505492 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.505754 [debug] [MainThread]: On master: COMMIT
[0m06:41:23.506175 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:23.506473 [debug] [MainThread]: On master: Close
[0m06:41:23.506914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:23.507239 [info ] [MainThread]: 
[0m06:41:23.513391 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellerscsv
[0m06:41:23.514376 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellerscsv ............................... [RUN]
[0m06:41:23.515191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellerscsv)
[0m06:41:23.515808 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellerscsv
[0m06:41:23.518351 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m06:41:23.523248 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:23.523845 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:23.524910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellerscsv"
[0m06:41:23.526136 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellerscsv
[0m06:41:23.526211 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:23.532120 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:23.534293 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:23.538850 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.540799 [debug] [MainThread]: On master: BEGIN
[0m06:41:23.542049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:23.551441 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellerscsv"
[0m06:41:23.553049 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellerscsv"
[0m06:41:23.553491 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: BEGIN
[0m06:41:23.553857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:23.558262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:41:23.558896 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellerscsv"
[0m06:41:23.559485 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellerscsv"} */

  create view "sales_dw"."dev"."src_resellerscsv__dbt_tmp"
    
    
  as (
    WITH raw_resellercsv AS (

    SELECT * FROM "sales_dw"."import"."resellercsv"
)

SELECT transaction_id, product_name, number_of_purchased_postcards, total_amount, sales_channel, customer_first_name, customer_last_name, customer_email, office_location, created_date, imported_file, loaded_timestamp
FROM raw_resellercsv
  );
[0m06:41:23.562016 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m06:41:23.562867 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m06:41:23.566650 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:41:23.567627 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.006 seconds
[0m06:41:23.568357 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m06:41:23.567910 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellerscsv"
[0m06:41:23.569517 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:23.570846 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellerscsv"} */
alter table "sales_dw"."dev"."src_resellerscsv__dbt_tmp" rename to "src_resellerscsv"
[0m06:41:23.571889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:23.571508 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m06:41:23.574693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:41:23.575153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:41:23.580520 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:41:23.580888 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.005 seconds
[0m06:41:23.581460 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m06:41:23.582069 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: COMMIT
[0m06:41:23.582149 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:23.580307 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:23.583179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:41:23.582795 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellerscsv"
[0m06:41:23.582385 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:23.583290 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:23.586864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:41:23.587639 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: COMMIT
[0m06:41:23.587319 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:23.587821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:23.588775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:23.589322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:41:23.587405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:41:23.593483 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m06:41:23.591917 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:23.594523 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:23.594288 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:23.595051 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:23.595006 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m06:41:23.594757 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:23.595703 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:41:23.595541 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellerscsv__dbt_backup"
[0m06:41:23.595240 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:23.596169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:23.596303 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m06:41:23.596542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:23.597201 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:23.598249 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:23.598545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:41:23.598676 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:23.600820 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellerscsv"
[0m06:41:23.601657 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellerscsv"} */
drop view if exists "sales_dw"."dev"."src_resellerscsv__dbt_backup" cascade
[0m06:41:23.603039 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:23.604430 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m06:41:23.605438 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: Close
[0m06:41:23.607392 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:41:23.608903 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellerscsv .......................... [[32mCREATE VIEW[0m in 0.09s]
[0m06:41:23.609375 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m06:41:23.609898 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellerscsv
[0m06:41:23.610438 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:23.611592 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.611831 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.010 seconds
[0m06:41:23.612440 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m06:41:23.612829 [debug] [MainThread]: On master: BEGIN
[0m06:41:23.613765 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:23.615156 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 5.12s]
[0m06:41:23.615824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:23.618961 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m06:41:23.629931 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.629916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:41:23.634019 [debug] [MainThread]: On master: BEGIN
[0m06:41:23.636382 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:23.636786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:23.636642 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m06:41:23.639120 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:23.648393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:23.639714 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:41:23.648531 [debug] [MainThread]: On master: COMMIT
[0m06:41:23.654343 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.654771 [debug] [MainThread]: On master: COMMIT
[0m06:41:23.655612 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:23.653932 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:23.656578 [debug] [MainThread]: On master: Close
[0m06:41:23.657861 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m06:41:23.661303 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:23.667386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:23.672478 [debug] [MainThread]: On master: COMMIT
[0m06:41:23.687428 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.687963 [debug] [MainThread]: On master: COMMIT
[0m06:41:23.684138 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellerscsv' was properly closed.
[0m06:41:23.673715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:23.688556 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:23.691404 [debug] [MainThread]: On master: Close
[0m06:41:23.695325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:23.695834 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m06:41:23.697227 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:23.697637 [info ] [MainThread]: 
[0m06:41:23.698375 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m06:41:23.689420 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:41:23.701505 [debug] [MainThread]: Command end result
[0m06:41:23.701601 [info ] [MainThread]: 
[0m06:41:23.701900 [info ] [MainThread]: 
[0m06:41:23.702402 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m06:41:23.702574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:23.703219 [info ] [MainThread]: 
[0m06:41:23.703361 [debug] [MainThread]: Command end result
[0m06:41:23.703761 [info ] [MainThread]: 
[0m06:41:23.703603 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:23.704227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:23.705131 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2636833, "process_user_time": 2.541899, "process_kernel_time": 0.172471, "process_mem_max_rss": "112600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:23.705558 [info ] [MainThread]: 
[0m06:41:23.706156 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:23.706075 after 7.26 seconds
[0m06:41:23.706131 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m06:41:23.707270 [debug] [MainThread]: Flushing usage events
[0m06:41:23.706653 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:23.707708 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:23.712572 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.164286, "process_user_time": 2.565055, "process_kernel_time": 0.149131, "process_mem_max_rss": "112440", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:23.713117 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:23.713679 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:23.713599 after 7.17 seconds
[0m06:41:23.716194 [debug] [MainThread]: Flushing usage events
[0m06:41:23.717573 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m06:41:23.718813 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:23.719436 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:25.177599 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:25.184581 | 49314d00-cdf4-4187-8488-be89648abc42 ==============================
[0m06:41:25.184581 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:25.185264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:41:25.193318 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:25.197492 | 261d7f99-4005-4f8b-a1a2-89ca80a7bdc7 ==============================
[0m06:41:25.197492 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:25.198108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellerscsv', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:25.205326 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:25.209410 | 30eb3fd7-12c3-4217-b3f3-46dfacecab90 ==============================
[0m06:41:25.209410 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:25.209916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'send_anonymous_usage_stats': 'True'}
[0m06:41:25.331706 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:25.336606 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:25.350287 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:25.409130 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:25.412045 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:25.415947 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:25.581339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:25.583399 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:25.583828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:25.584625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:25.594547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:25.598833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:25.636136 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:25.637356 [info ] [MainThread]: 
[0m06:41:25.639212 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:25.640452 [debug] [MainThread]: Command end result
[0m06:41:25.640146 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m06:41:25.648295 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:25.648796 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:25.646864 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49786, "process_user_time": 0.964364, "process_kernel_time": 0.067025, "process_mem_max_rss": "97080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:25.653317 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:25.655427 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:25.654822 after 0.51 seconds
[0m06:41:25.656374 [debug] [MainThread]: Flushing usage events
[0m06:41:25.656961 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:25.655544 [info ] [MainThread]: 
[0m06:41:25.666291 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:25.666446 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:25.679237 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:25.673024 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:25.692525 [debug] [MainThread]: Command end result
[0m06:41:25.693207 [info ] [MainThread]: 
[0m06:41:25.696120 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5353696, "process_user_time": 1.011419, "process_kernel_time": 0.052332, "process_mem_max_rss": "97332", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:25.697058 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:25.696916 after 0.54 seconds
[0m06:41:25.696763 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:25.697456 [debug] [MainThread]: Flushing usage events
[0m06:41:25.698189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:25.697549 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:25.701161 [debug] [MainThread]: On master: BEGIN
[0m06:41:25.702259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:25.721132 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:25.721752 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:25.722252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:28.553279 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m06:41:28.556524 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.557136 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:28.560710 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m06:41:28.561870 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:28.562384 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.562865 [debug] [MainThread]: On master: BEGIN
[0m06:41:28.563769 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:28.564398 [debug] [MainThread]: On master: COMMIT
[0m06:41:28.564997 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.565479 [debug] [MainThread]: On master: COMMIT
[0m06:41:28.566042 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:28.566567 [debug] [MainThread]: On master: Close
[0m06:41:28.567454 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:28.568032 [info ] [MainThread]: 
[0m06:41:28.574407 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m06:41:28.577348 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m06:41:28.578107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_transactions)
[0m06:41:28.578637 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m06:41:28.587544 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m06:41:28.589099 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m06:41:28.600670 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m06:41:28.603250 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:28.603197 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m06:41:28.603934 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:28.604126 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:28.604701 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:28.604992 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m06:41:28.605903 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:28.606328 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m06:41:28.606992 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m06:41:28.610760 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:28.610028 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:28.611340 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:28.611202 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:28.612168 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:28.612759 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m06:41:28.613345 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m06:41:28.614374 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:41:28.614498 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:28.614889 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m06:41:28.615093 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:28.615375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:28.616056 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.616582 [debug] [MainThread]: On master: BEGIN
[0m06:41:28.617116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:28.619695 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.620039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:41:28.620272 [debug] [MainThread]: On master: BEGIN
[0m06:41:28.620612 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:41:28.620701 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:28.621062 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m06:41:28.622409 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m06:41:28.626613 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:41:28.627059 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m06:41:28.627658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:28.636131 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m06:41:28.638663 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:41:28.639599 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m06:41:28.643964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:41:28.656549 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m06:41:28.665722 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:41:28.666205 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m06:41:28.666837 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:28.667640 [debug] [ThreadPool]: SQL status: BEGIN in 5.019 seconds
[0m06:41:28.673244 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:28.670858 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m06:41:28.673647 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:28.679347 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:28.677058 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m06:41:28.681615 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:28.688244 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:28.687213 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m06:41:28.705103 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.705547 [debug] [MainThread]: On master: BEGIN
[0m06:41:28.706127 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.706932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:28.707199 [debug] [MainThread]: On master: BEGIN
[0m06:41:28.708338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:28.719502 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m06:41:28.720271 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m06:41:28.720699 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.721044 [debug] [MainThread]: On master: COMMIT
[0m06:41:28.721511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:28.721917 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.722413 [debug] [MainThread]: On master: COMMIT
[0m06:41:28.722815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:28.723114 [debug] [MainThread]: On master: Close
[0m06:41:28.723486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:28.723757 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m06:41:28.723993 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:28.724276 [info ] [MainThread]: 
[0m06:41:28.724686 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m06:41:28.725364 [debug] [MainThread]: Command end result
[0m06:41:28.725366 [debug] [MainThread]: SQL status: SELECT 4 in 0.003 seconds
[0m06:41:28.725780 [info ] [MainThread]: 
[0m06:41:28.726799 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:28.727186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:28.727602 [info ] [MainThread]: 
[0m06:41:28.727832 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.728143 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:28.728469 [debug] [MainThread]: On master: BEGIN
[0m06:41:28.729126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.223468, "process_user_time": 2.573941, "process_kernel_time": 0.142314, "process_mem_max_rss": "114720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:28.729701 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:28.729763 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:28.729690 after 12.22 seconds
[0m06:41:28.730269 [debug] [MainThread]: On master: COMMIT
[0m06:41:28.730666 [debug] [MainThread]: Flushing usage events
[0m06:41:28.730997 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.736993 [debug] [MainThread]: On master: COMMIT
[0m06:41:28.740715 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:28.742404 [debug] [MainThread]: On master: Close
[0m06:41:28.743522 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:28.746317 [info ] [MainThread]: 
[0m06:41:28.753217 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m06:41:28.753929 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m06:41:28.754442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m06:41:28.754799 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m06:41:28.759647 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m06:41:28.760648 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m06:41:28.783292 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m06:41:28.784713 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:41:28.785169 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m06:41:28.785585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:30.104504 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:30.112095 | c683858d-9968-44ce-9bff-398f651722ab ==============================
[0m06:41:30.112095 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:30.112559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:30.241924 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:30.253799 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:30.396172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:30.398179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:30.483939 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:30.493177 [info ] [MainThread]: 
[0m06:41:30.495064 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:30.496967 [debug] [MainThread]: Command end result
[0m06:41:30.497785 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45461565, "process_user_time": 0.931585, "process_kernel_time": 0.063903, "process_mem_max_rss": "97576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:30.498619 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:30.498506 after 0.46 seconds
[0m06:41:30.500511 [debug] [MainThread]: Flushing usage events
[0m06:41:30.706606 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m06:41:30.707914 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:30.709029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:30.714327 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m06:41:30.716936 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:30.718822 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:30.720878 [debug] [MainThread]: On master: BEGIN
[0m06:41:30.721662 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:30.722952 [debug] [MainThread]: On master: COMMIT
[0m06:41:30.724633 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:30.725206 [debug] [MainThread]: On master: COMMIT
[0m06:41:30.727063 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:41:30.727817 [debug] [MainThread]: On master: Close
[0m06:41:30.728691 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:30.729109 [info ] [MainThread]: 
[0m06:41:30.729150 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.007 seconds
[0m06:41:30.733642 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:30.736217 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m06:41:30.736900 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m06:41:30.737394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m06:41:30.737854 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m06:41:30.737492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:41:30.743736 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m06:41:30.745065 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m06:41:30.737967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:30.746262 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:30.756122 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:30.751517 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:30.756571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:30.756881 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:30.757538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:30.769293 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m06:41:30.770834 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:41:30.771336 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m06:41:30.771739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:30.776505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:41:30.777190 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:41:30.777579 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m06:41:30.779129 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m06:41:30.784386 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:41:30.784953 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m06:41:30.785808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:30.794645 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m06:41:30.795436 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:41:30.795862 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m06:41:30.796605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:41:30.801169 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m06:41:30.804697 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:41:30.805262 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m06:41:30.805874 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:30.807538 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m06:41:30.808951 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 0.07s]
[0m06:41:30.809726 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m06:41:30.810899 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:30.811317 [debug] [MainThread]: On master: BEGIN
[0m06:41:30.811668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:30.817730 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:41:30.818708 [debug] [MainThread]: On master: COMMIT
[0m06:41:30.819498 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:30.820288 [debug] [MainThread]: On master: COMMIT
[0m06:41:30.821198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:30.821921 [debug] [MainThread]: On master: Close
[0m06:41:30.822940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:30.826848 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:41:30.829040 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m06:41:30.830213 [info ] [MainThread]: 
[0m06:41:30.844168 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m06:41:30.871910 [debug] [MainThread]: Command end result
[0m06:41:30.879254 [info ] [MainThread]: 
[0m06:41:30.880723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:30.882681 [info ] [MainThread]: 
[0m06:41:30.888604 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:30.889708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.785429, "process_user_time": 1.131447, "process_kernel_time": 0.079292, "process_mem_max_rss": "106020", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:30.891629 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:30.891073 after 10.79 seconds
[0m06:41:30.897262 [debug] [MainThread]: Flushing usage events
[0m06:41:32.263316 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:32.270692 | 6290197a-c09f-4d0b-b260-6e6c212c9607 ==============================
[0m06:41:32.270692 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:32.271251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:41:32.286981 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:32.291251 | a1a4042c-eab3-4d87-ae20-63e1e0882ee9 ==============================
[0m06:41:32.291251 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:32.291767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'send_anonymous_usage_stats': 'True'}
[0m06:41:32.399748 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:32.411416 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:32.411726 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:32.422822 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:32.577208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:32.588287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:32.611471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:32.611995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:32.653418 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:32.657884 [info ] [MainThread]: 
[0m06:41:32.658502 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:32.659318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:32.662825 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:32.664326 [info ] [MainThread]: 
[0m06:41:32.664879 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:32.666273 [debug] [MainThread]: Command end result
[0m06:41:32.666890 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.41222638, "process_user_time": 0.969314, "process_kernel_time": 0.078511, "process_mem_max_rss": "97336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:32.667389 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:32.667325 after 0.41 seconds
[0m06:41:32.667748 [debug] [MainThread]: Flushing usage events
[0m06:41:32.682038 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:32.685339 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:32.685918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:32.691532 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m06:41:32.692627 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:32.696312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:41:32.696860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:32.701720 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:32.703736 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:32.704288 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:32.704650 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:32.704986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:32.705315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:32.710024 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:41:32.710610 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:32.711099 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:32.713356 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m06:41:32.715669 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:32.716297 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:33.620826 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m06:41:33.621605 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.622202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:33.625116 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m06:41:33.625675 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.625959 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m06:41:33.626197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:33.627492 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:33.628068 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.628413 [debug] [MainThread]: On master: BEGIN
[0m06:41:33.628898 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:33.629444 [debug] [MainThread]: On master: COMMIT
[0m06:41:33.629647 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m06:41:33.629808 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.630275 [debug] [MainThread]: On master: COMMIT
[0m06:41:33.630752 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:33.631034 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:33.631208 [debug] [MainThread]: On master: Close
[0m06:41:33.631506 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.631825 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:33.631946 [debug] [MainThread]: On master: BEGIN
[0m06:41:33.632285 [info ] [MainThread]: 
[0m06:41:33.632689 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:33.633229 [debug] [MainThread]: On master: COMMIT
[0m06:41:33.633688 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.634116 [debug] [MainThread]: On master: COMMIT
[0m06:41:33.634628 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:33.635168 [debug] [MainThread]: On master: Close
[0m06:41:33.635855 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:33.636823 [info ] [MainThread]: 
[0m06:41:33.637756 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m06:41:33.638365 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m06:41:33.639030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m06:41:33.639576 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m06:41:33.641910 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m06:41:33.642601 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m06:41:33.643261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_date)
[0m06:41:33.643731 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m06:41:33.644941 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m06:41:33.646279 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m06:41:33.649156 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m06:41:33.650429 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m06:41:33.668675 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m06:41:33.670239 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:41:33.670774 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m06:41:33.671295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:33.675033 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m06:41:33.676402 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:41:33.676892 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m06:41:33.677355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:33.681518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:41:33.685417 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:41:33.686117 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m06:41:33.795085 [debug] [Thread-1 (]: SQL status: BEGIN in 5.009 seconds
[0m06:41:33.795726 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:41:33.796342 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m06:41:33.797930 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m06:41:33.802422 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:41:33.813373 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m06:41:33.814189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:33.833551 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m06:41:33.850667 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:41:33.851648 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m06:41:33.864249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m06:41:33.875263 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m06:41:33.882932 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:41:33.889199 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m06:41:33.890328 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:33.892255 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m06:41:33.893891 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 5.14s]
[0m06:41:33.894658 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m06:41:33.895957 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.896430 [debug] [MainThread]: On master: BEGIN
[0m06:41:33.896744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:33.911923 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.225 seconds
[0m06:41:33.916511 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:41:33.917021 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m06:41:33.917670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:33.927948 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m06:41:33.928589 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:41:33.929036 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m06:41:33.932444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:41:33.936657 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m06:41:33.939457 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:41:33.940019 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m06:41:33.940644 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:41:33.942395 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m06:41:33.943839 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.30s]
[0m06:41:33.944563 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m06:41:33.945817 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.946369 [debug] [MainThread]: On master: BEGIN
[0m06:41:33.946888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:33.951299 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:33.951797 [debug] [MainThread]: On master: COMMIT
[0m06:41:33.952315 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.952774 [debug] [MainThread]: On master: COMMIT
[0m06:41:33.953343 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:33.953871 [debug] [MainThread]: On master: Close
[0m06:41:33.954528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:33.955031 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:33.955536 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m06:41:33.955961 [info ] [MainThread]: 
[0m06:41:33.956386 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.41 seconds (15.41s).
[0m06:41:33.957015 [debug] [MainThread]: Command end result
[0m06:41:33.957356 [info ] [MainThread]: 
[0m06:41:33.957746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:33.958094 [info ] [MainThread]: 
[0m06:41:33.958457 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:33.959146 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.40268, "process_user_time": 2.606535, "process_kernel_time": 0.147423, "process_mem_max_rss": "112836", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:33.959642 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:33.959583 after 17.40 seconds
[0m06:41:33.960025 [debug] [MainThread]: Flushing usage events
[0m06:41:35.765498 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m06:41:35.766381 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:35.766937 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m06:41:35.767346 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:35.768186 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:35.769145 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:35.770551 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:35.770878 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.001 seconds
[0m06:41:35.771837 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:35.772656 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:35.773150 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:35.773497 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:35.778348 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:35.778969 [debug] [MainThread]: On master: BEGIN
[0m06:41:35.779388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:35.784316 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:41:35.784917 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:35.785666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:35.790026 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m06:41:35.791287 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:35.791746 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:35.792119 [debug] [MainThread]: On master: BEGIN
[0m06:41:35.792605 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:35.793129 [debug] [MainThread]: On master: COMMIT
[0m06:41:35.793497 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:35.793886 [debug] [MainThread]: On master: COMMIT
[0m06:41:35.794292 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:35.794611 [debug] [MainThread]: On master: Close
[0m06:41:35.795086 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:35.795733 [info ] [MainThread]: 
[0m06:41:35.800799 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m06:41:35.801686 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m06:41:35.802443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_product)
[0m06:41:35.803098 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m06:41:35.811252 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m06:41:35.812680 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m06:41:35.837632 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m06:41:35.840279 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:41:35.840790 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m06:41:35.841266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:36.218563 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:36.222811 | 86f8d2d6-9a8e-4c75-ae5c-0e7bde3dc318 ==============================
[0m06:41:36.222811 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:36.223393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:36.350935 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:36.374130 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:36.502095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:36.502649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:36.551599 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:36.552801 [info ] [MainThread]: 
[0m06:41:36.553290 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:36.554534 [debug] [MainThread]: Command end result
[0m06:41:36.555174 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.3647281, "process_user_time": 0.970889, "process_kernel_time": 0.048143, "process_mem_max_rss": "97460", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:36.555622 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:36.555561 after 0.37 seconds
[0m06:41:36.555954 [debug] [MainThread]: Flushing usage events
[0m06:41:37.710163 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m06:41:37.710822 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:37.711251 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:37.713486 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:37.714483 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:37.714923 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:37.718998 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:37.722123 [debug] [MainThread]: On master: BEGIN
[0m06:41:37.724129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:37.740256 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m06:41:37.741045 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:37.741428 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:37.745037 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m06:41:37.746945 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:37.748214 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:37.749105 [debug] [MainThread]: On master: BEGIN
[0m06:41:37.753927 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:37.760123 [debug] [MainThread]: On master: COMMIT
[0m06:41:37.764079 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:37.765267 [debug] [MainThread]: On master: COMMIT
[0m06:41:37.774765 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:37.779721 [debug] [MainThread]: On master: Close
[0m06:41:37.780954 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:37.782962 [info ] [MainThread]: 
[0m06:41:37.815866 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m06:41:37.817658 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m06:41:37.818202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_channel)
[0m06:41:37.818639 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m06:41:37.824198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m06:41:37.825419 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m06:41:37.851048 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m06:41:37.853921 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:41:37.854692 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m06:41:37.855255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:37.860957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:41:37.862377 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:41:37.863093 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m06:41:37.866600 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m06:41:37.871367 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:41:37.871999 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m06:41:37.874360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:41:37.888762 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m06:41:37.889617 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:41:37.890430 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m06:41:37.891342 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:41:37.896925 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m06:41:37.899700 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:41:37.901349 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m06:41:37.902016 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:41:37.903838 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m06:41:37.905087 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.09s]
[0m06:41:37.905602 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m06:41:37.906675 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:37.907088 [debug] [MainThread]: On master: BEGIN
[0m06:41:37.907425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:37.911651 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:37.912265 [debug] [MainThread]: On master: COMMIT
[0m06:41:37.916922 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:37.917374 [debug] [MainThread]: On master: COMMIT
[0m06:41:37.921505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:37.921912 [debug] [MainThread]: On master: Close
[0m06:41:37.922381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:37.922702 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:41:37.922932 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m06:41:37.923297 [info ] [MainThread]: 
[0m06:41:37.923611 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.26 seconds (5.26s).
[0m06:41:37.924146 [debug] [MainThread]: Command end result
[0m06:41:37.924445 [info ] [MainThread]: 
[0m06:41:37.924777 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:37.925143 [info ] [MainThread]: 
[0m06:41:37.925527 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:37.926323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6960588, "process_user_time": 1.082618, "process_kernel_time": 0.087535, "process_mem_max_rss": "106168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:37.927011 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:37.926884 after 5.70 seconds
[0m06:41:37.927576 [debug] [MainThread]: Flushing usage events
[0m06:41:38.679682 [debug] [Thread-1 (]: SQL status: BEGIN in 5.008 seconds
[0m06:41:38.682211 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:41:38.682743 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m06:41:38.684036 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m06:41:38.691214 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:41:38.693116 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m06:41:38.693752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:38.710854 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m06:41:38.711657 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:41:38.712173 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m06:41:38.714145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:41:38.718803 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m06:41:38.721784 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:41:38.722218 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m06:41:38.722698 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:38.724400 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m06:41:38.725721 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 5.09s]
[0m06:41:38.726345 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m06:41:38.727557 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:38.729838 [debug] [MainThread]: On master: BEGIN
[0m06:41:38.730220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:38.734630 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:38.735182 [debug] [MainThread]: On master: COMMIT
[0m06:41:38.735515 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:38.735830 [debug] [MainThread]: On master: COMMIT
[0m06:41:38.736222 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:38.736579 [debug] [MainThread]: On master: Close
[0m06:41:38.736993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:38.737267 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:38.737502 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m06:41:38.737806 [info ] [MainThread]: 
[0m06:41:38.738251 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.21 seconds (20.21s).
[0m06:41:38.738875 [debug] [MainThread]: Command end result
[0m06:41:38.739788 [info ] [MainThread]: 
[0m06:41:38.740280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:38.743701 [info ] [MainThread]: 
[0m06:41:38.744365 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:38.748042 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.199793, "process_user_time": 2.545127, "process_kernel_time": 0.163673, "process_mem_max_rss": "112452", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:38.752651 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:38.752536 after 22.20 seconds
[0m06:41:38.755478 [debug] [MainThread]: Flushing usage events
[0m06:41:38.908804 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m06:41:38.913820 [debug] [MainThread]: On master: COMMIT
[0m06:41:38.922236 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:38.922865 [debug] [MainThread]: On master: COMMIT
[0m06:41:38.926372 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:38.928459 [debug] [MainThread]: On master: Close
[0m06:41:38.930688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:38.932239 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m06:41:38.933843 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:41:38.934964 [info ] [MainThread]: 
[0m06:41:38.936778 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.36 seconds (20.36s).
[0m06:41:38.937442 [debug] [MainThread]: Command end result
[0m06:41:38.938351 [info ] [MainThread]: 
[0m06:41:38.939387 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:38.939712 [info ] [MainThread]: 
[0m06:41:38.940472 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:38.941682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.381746, "process_user_time": 2.576135, "process_kernel_time": 0.149582, "process_mem_max_rss": "112944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:38.942865 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:38.942782 after 22.38 seconds
[0m06:41:38.943364 [debug] [MainThread]: Flushing usage events
[0m06:41:40.205115 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:40.209845 | 80619d76-ce1d-4488-a378-ee43bef244a8 ==============================
[0m06:41:40.209845 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:40.210560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:41:40.246906 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:40.251744 | 3eac90da-1f78-4789-b8d9-9cc3be11d897 ==============================
[0m06:41:40.251744 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:40.253311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:40.345821 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:40.359915 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:40.385180 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:40.399813 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:40.521198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:40.522176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:40.539740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:40.541428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:40.594155 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:40.595528 [info ] [MainThread]: 
[0m06:41:40.595926 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:40.597253 [debug] [MainThread]: Command end result
[0m06:41:40.605136 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42892003, "process_user_time": 0.977107, "process_kernel_time": 0.055664, "process_mem_max_rss": "97212", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:40.605740 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:40.605671 after 0.43 seconds
[0m06:41:40.606155 [debug] [MainThread]: Flushing usage events
[0m06:41:40.630413 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:40.631692 [info ] [MainThread]: 
[0m06:41:40.636618 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:40.645342 [debug] [MainThread]: Command end result
[0m06:41:40.652640 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.43735433, "process_user_time": 0.963686, "process_kernel_time": 0.065113, "process_mem_max_rss": "97168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:40.656294 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:40.656172 after 0.44 seconds
[0m06:41:40.656858 [debug] [MainThread]: Flushing usage events
[0m06:41:40.845592 [debug] [Thread-1 (]: SQL status: BEGIN in 5.004 seconds
[0m06:41:40.859570 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:41:40.871354 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m06:41:40.899724 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m06:41:40.929555 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:41:40.931561 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m06:41:40.932542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:40.946247 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m06:41:40.947390 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:41:40.949101 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m06:41:40.950039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:41:40.954426 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m06:41:40.958132 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:41:40.958888 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m06:41:40.960844 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:41:40.963917 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m06:41:40.966162 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 5.16s]
[0m06:41:40.968391 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m06:41:40.971006 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:40.971478 [debug] [MainThread]: On master: BEGIN
[0m06:41:40.971789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:40.982850 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m06:41:40.984693 [debug] [MainThread]: On master: COMMIT
[0m06:41:40.986045 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:40.987212 [debug] [MainThread]: On master: COMMIT
[0m06:41:40.987772 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:40.988790 [debug] [MainThread]: On master: Close
[0m06:41:40.989335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:40.990311 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m06:41:40.990783 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:40.991223 [info ] [MainThread]: 
[0m06:41:40.993955 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.29 seconds (15.29s).
[0m06:41:40.994613 [debug] [MainThread]: Command end result
[0m06:41:40.994899 [info ] [MainThread]: 
[0m06:41:40.995277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:40.995614 [info ] [MainThread]: 
[0m06:41:40.995919 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:40.996727 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.824938, "process_user_time": 1.115306, "process_kernel_time": 0.08797, "process_mem_max_rss": "106272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:40.997520 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:40.997439 after 15.83 seconds
[0m06:41:41.000473 [debug] [MainThread]: Flushing usage events
[0m06:41:41.300666 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:41.305311 | b1547134-194d-4a80-a7e8-deef848077f5 ==============================
[0m06:41:41.305311 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:41.306713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:41.360368 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:41.376533 | 3c7ad45a-8a1d-4d9e-b410-836076e2f632 ==============================
[0m06:41:41.376533 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:41.385262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:41.470144 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:41.482848 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:41.543959 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:41.559057 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:41.648344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:41.649052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:41.699242 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:41.703623 [info ] [MainThread]: 
[0m06:41:41.705171 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:41.709165 [debug] [MainThread]: Command end result
[0m06:41:41.711581 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.43939695, "process_user_time": 1.010105, "process_kernel_time": 0.06332, "process_mem_max_rss": "97060", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:41.715763 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:41.715533 after 0.44 seconds
[0m06:41:41.717923 [debug] [MainThread]: Flushing usage events
[0m06:41:41.731272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:41.734729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:41.786941 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:41.788346 [info ] [MainThread]: 
[0m06:41:41.789171 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:41.790156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:41.812942 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:41.813571 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:41.814044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:41.819735 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m06:41:41.820859 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:41.824644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:41:41.825276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:41.829480 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:41.831209 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:41.834041 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:41.836628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:41.834663 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:41.838609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:41.842326 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m06:41:41.844184 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:41.847167 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:41.849481 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m06:41:41.851513 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:41.852210 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:42.376752 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:42.381236 | 3bcfdb09-1ad0-4a4a-a793-81e6ebcdeef8 ==============================
[0m06:41:42.381236 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:42.381843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:42.399266 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:42.404080 | 781486e7-92b5-432e-9e38-0157702ea729 ==============================
[0m06:41:42.404080 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:42.404701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:41:42.503947 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:42.541814 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:42.549453 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:42.568343 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:42.701938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:42.705251 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:42.714347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:42.714933 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:42.755260 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:42.756422 [info ] [MainThread]: 
[0m06:41:42.756925 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:42.758346 [debug] [MainThread]: Command end result
[0m06:41:42.757513 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:42.759033 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.41958967, "process_user_time": 0.95216, "process_kernel_time": 0.059258, "process_mem_max_rss": "97460", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:42.759490 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:42.759433 after 0.42 seconds
[0m06:41:42.759818 [debug] [MainThread]: Flushing usage events
[0m06:41:42.760191 [info ] [MainThread]: 
[0m06:41:42.765242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:42.766432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:42.789619 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:42.790300 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:42.790793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:42.797386 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m06:41:42.800351 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:42.804148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:41:42.804758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:41:42.808953 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:42.811777 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:42.812340 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:42.812757 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:42.813098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:42.813547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:46.860872 [debug] [ThreadPool]: SQL status: BEGIN in 5.020 seconds
[0m06:41:46.862031 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:46.862618 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:46.864702 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:46.866218 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:46.866926 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:46.871382 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:46.871937 [debug] [MainThread]: On master: BEGIN
[0m06:41:46.872404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:46.876878 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:46.881144 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:46.882368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:46.887060 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m06:41:46.889237 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:46.891297 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:46.895516 [debug] [MainThread]: On master: BEGIN
[0m06:41:46.896104 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:46.896555 [debug] [MainThread]: On master: COMMIT
[0m06:41:46.896894 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:46.897179 [debug] [MainThread]: On master: COMMIT
[0m06:41:46.897754 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:46.898171 [debug] [MainThread]: On master: Close
[0m06:41:46.898679 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:46.899047 [info ] [MainThread]: 
[0m06:41:46.905474 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m06:41:46.906208 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m06:41:46.906866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m06:41:46.907409 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m06:41:46.913271 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m06:41:46.914333 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m06:41:46.939661 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m06:41:46.948138 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:41:46.948686 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m06:41:46.949042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:46.954380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:41:46.955019 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:41:46.958217 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m06:41:46.960736 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m06:41:46.966964 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:41:46.967748 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m06:41:46.968870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:46.977410 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m06:41:46.978019 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:41:46.978448 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m06:41:46.979193 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:41:46.983520 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m06:41:46.986396 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:41:46.986948 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m06:41:46.987668 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:46.989626 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m06:41:46.991175 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m06:41:46.991906 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m06:41:46.993181 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:46.995138 [debug] [MainThread]: On master: BEGIN
[0m06:41:46.995525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:47.821669 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m06:41:47.824985 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:47.826663 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m06:41:47.827193 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:47.828515 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:47.829584 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:47.830806 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:47.832099 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:47.832382 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m06:41:47.832924 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:47.834037 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:47.835172 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:47.840000 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:47.840578 [debug] [MainThread]: On master: BEGIN
[0m06:41:47.840930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:52.000796 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m06:41:52.002738 [debug] [MainThread]: On master: COMMIT
[0m06:41:52.003321 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:52.003904 [debug] [MainThread]: On master: COMMIT
[0m06:41:52.004559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:52.004986 [debug] [MainThread]: On master: Close
[0m06:41:52.005493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:52.005801 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m06:41:52.006056 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:52.006464 [info ] [MainThread]: 
[0m06:41:52.006958 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.22 seconds (10.22s).
[0m06:41:52.007510 [debug] [MainThread]: Command end result
[0m06:41:52.007781 [info ] [MainThread]: 
[0m06:41:52.008128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:52.008482 [info ] [MainThread]: 
[0m06:41:52.008830 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:52.009581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.701405, "process_user_time": 1.131767, "process_kernel_time": 0.085739, "process_mem_max_rss": "106160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:52.010124 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:52.010061 after 10.70 seconds
[0m06:41:52.010468 [debug] [MainThread]: Flushing usage events
[0m06:41:52.845658 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m06:41:52.846715 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:52.847170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:52.851704 [debug] [MainThread]: SQL status: SELECT 10 in 0.004 seconds
[0m06:41:52.853732 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:52.854384 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:52.854792 [debug] [MainThread]: On master: BEGIN
[0m06:41:52.855293 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:52.855645 [debug] [MainThread]: On master: COMMIT
[0m06:41:52.855979 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:52.856284 [debug] [MainThread]: On master: COMMIT
[0m06:41:52.856822 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:52.857280 [debug] [MainThread]: On master: Close
[0m06:41:52.857831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:52.858302 [info ] [MainThread]: 
[0m06:41:52.863391 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m06:41:52.864031 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m06:41:52.864666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m06:41:52.866045 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m06:41:52.872396 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m06:41:52.874799 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m06:41:52.900018 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m06:41:52.901220 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:41:52.901622 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m06:41:52.901954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:54.063150 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:54.070045 | d52e388d-7a2a-44cb-ac02-285a03386b94 ==============================
[0m06:41:54.070045 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:54.067060 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:41:54.070934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 06:41:54.071878 | 51938829-8f4c-4333-a0ae-a81bba976402 ==============================
[0m06:41:54.071878 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:54.073726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'send_anonymous_usage_stats': 'True'}
[0m06:41:54.200205 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:54.210596 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:54.222711 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:54.232731 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:54.440263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:54.440884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:54.460284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:54.460897 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:54.507738 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:54.508317 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:54.509586 [info ] [MainThread]: 
[0m06:41:54.510873 [info ] [MainThread]: 
[0m06:41:54.511627 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:54.511941 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:54.513823 [debug] [MainThread]: Command end result
[0m06:41:54.512862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:54.514629 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4852063, "process_user_time": 0.99444, "process_kernel_time": 0.062594, "process_mem_max_rss": "97592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:54.515200 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:54.515128 after 0.49 seconds
[0m06:41:54.515556 [debug] [MainThread]: Flushing usage events
[0m06:41:54.538279 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:54.541179 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:54.542963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:54.551888 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m06:41:54.552999 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:54.556661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:41:54.557335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:41:54.561942 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:54.565759 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:54.566257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:54.565210 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:54.566988 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:54.567549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:54.570853 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:41:54.571463 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:54.572156 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:54.572670 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:41:54.573641 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:54.574206 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:54.574927 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:54.576095 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:54.576431 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m06:41:54.577849 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:54.576944 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:54.578405 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:54.583702 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:54.584287 [debug] [MainThread]: On master: BEGIN
[0m06:41:54.584592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:54.589269 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:41:54.590764 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:54.591258 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:54.598368 [debug] [MainThread]: SQL status: SELECT 10 in 0.007 seconds
[0m06:41:54.603396 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:54.604143 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:54.607535 [debug] [MainThread]: On master: BEGIN
[0m06:41:54.608463 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:54.608954 [debug] [MainThread]: On master: COMMIT
[0m06:41:54.609533 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:54.609985 [debug] [MainThread]: On master: COMMIT
[0m06:41:54.610521 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:54.610900 [debug] [MainThread]: On master: Close
[0m06:41:54.611384 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:54.611871 [info ] [MainThread]: 
[0m06:41:54.618257 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m06:41:54.619286 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m06:41:54.620056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m06:41:54.620802 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m06:41:54.626989 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m06:41:54.628240 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m06:41:54.653024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m06:41:54.654403 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:41:54.654797 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m06:41:54.655100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:54.659519 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:41:54.660200 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:41:54.660716 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    reseller_id AS sales_agent_key,
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m06:41:54.663739 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m06:41:54.668404 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:41:54.669013 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m06:41:54.669791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:54.679768 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m06:41:54.680215 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:41:54.680684 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m06:41:54.681769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:41:54.686065 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m06:41:54.689538 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:41:54.690042 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m06:41:54.690816 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:41:54.692736 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m06:41:54.694182 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.07s]
[0m06:41:54.694999 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m06:41:54.696266 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:54.696779 [debug] [MainThread]: On master: BEGIN
[0m06:41:54.697751 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:57.908465 [debug] [Thread-1 (]: SQL status: BEGIN in 5.006 seconds
[0m06:41:57.911014 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:41:57.911750 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select product_id as product_key, product_id as original_product_id, product_name, geography_key , product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m06:41:57.929432 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.017 seconds
[0m06:41:57.941285 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:41:57.959785 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m06:41:57.969707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:57.995423 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m06:41:57.996791 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:41:57.997135 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m06:41:58.007448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m06:41:58.011835 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m06:41:58.014902 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:41:58.015492 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m06:41:58.016257 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:41:58.018521 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m06:41:58.019997 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 5.15s]
[0m06:41:58.020651 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m06:41:58.021741 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:58.022217 [debug] [MainThread]: On master: BEGIN
[0m06:41:58.022595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:58.026770 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:58.028990 [debug] [MainThread]: On master: COMMIT
[0m06:41:58.029537 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:58.030155 [debug] [MainThread]: On master: COMMIT
[0m06:41:58.030702 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:58.031054 [debug] [MainThread]: On master: Close
[0m06:41:58.031683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:58.032054 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:58.032680 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m06:41:58.033344 [info ] [MainThread]: 
[0m06:41:58.033836 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.27 seconds (15.27s).
[0m06:41:58.034401 [debug] [MainThread]: Command end result
[0m06:41:58.034723 [info ] [MainThread]: 
[0m06:41:58.035090 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:58.035401 [info ] [MainThread]: 
[0m06:41:58.035681 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:58.036390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.666834, "process_user_time": 1.117414, "process_kernel_time": 0.065493, "process_mem_max_rss": "106156", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:58.036839 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:58.036777 after 15.67 seconds
[0m06:41:58.037170 [debug] [MainThread]: Flushing usage events
[0m06:41:59.325350 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:59.329704 | 39ba597d-5671-4cad-8ebf-e35ca8360d0c ==============================
[0m06:41:59.329704 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:59.330292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:59.455849 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:59.473838 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:59.666328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:59.666887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:59.710590 [debug] [MainThread]: SQL status: BEGIN in 5.013 seconds
[0m06:41:59.711366 [debug] [MainThread]: On master: COMMIT
[0m06:41:59.711794 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:59.712112 [debug] [MainThread]: On master: COMMIT
[0m06:41:59.712544 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:59.713168 [debug] [MainThread]: On master: Close
[0m06:41:59.713702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:59.714105 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:59.714400 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m06:41:59.714885 [info ] [MainThread]: 
[0m06:41:59.715414 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m06:41:59.716038 [debug] [MainThread]: Command end result
[0m06:41:59.716377 [info ] [MainThread]: 
[0m06:41:59.716799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:59.717243 [info ] [MainThread]: 
[0m06:41:59.717688 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:59.718448 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6856337, "process_user_time": 1.145944, "process_kernel_time": 0.075579, "process_mem_max_rss": "108356", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:59.719028 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:59.718950 after 5.69 seconds
[0m06:41:59.719701 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:59.719999 [debug] [MainThread]: Flushing usage events
[0m06:41:59.720973 [info ] [MainThread]: 
[0m06:41:59.725357 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:59.727355 [debug] [MainThread]: Command end result
[0m06:41:59.728158 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.43064854, "process_user_time": 0.927249, "process_kernel_time": 0.062016, "process_mem_max_rss": "97464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:59.729559 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:59.729479 after 0.43 seconds
[0m06:41:59.730014 [debug] [MainThread]: Flushing usage events
[0m06:42:01.503405 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:42:01.504949 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:01.509324 | 22be9c16-345c-41a3-b4d7-a03cb830371c ==============================
[0m06:42:01.509324 [info ] [MainThread]: Running with dbt=1.8.2


============================== 06:42:01.509674 | 634f23bc-343b-4254-a787-721b78b629bf ==============================
[0m06:42:01.509674 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:01.510147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:42:01.510659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:42:01.643670 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:01.652496 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:01.661583 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:01.663953 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:01.889664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:01.889670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:01.890465 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:01.890779 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:01.939288 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:01.941183 [info ] [MainThread]: 
[0m06:42:01.941973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:01.943025 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:01.942979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:01.944415 [info ] [MainThread]: 
[0m06:42:01.947468 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:01.952416 [debug] [MainThread]: Command end result
[0m06:42:01.954023 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48018008, "process_user_time": 1.015012, "process_kernel_time": 0.05774, "process_mem_max_rss": "97592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:01.954855 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:01.954725 after 0.48 seconds
[0m06:42:01.955430 [debug] [MainThread]: Flushing usage events
[0m06:42:01.971045 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:01.972338 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:01.973102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:01.978783 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m06:42:01.980215 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:01.984770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:42:01.985426 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:42:01.991891 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:01.994274 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:01.994658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:01.993793 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:01.995564 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:01.995971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:01.999408 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:42:02.000101 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:02.000664 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:42:02.003120 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:42:02.004466 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:42:02.005037 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:42:07.005239 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m06:42:07.006051 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:07.006487 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:42:07.008620 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m06:42:07.009821 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:42:07.010277 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:42:07.015036 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:07.015625 [debug] [MainThread]: On master: BEGIN
[0m06:42:07.015945 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:07.020311 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:42:07.020965 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:07.021529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:07.026159 [debug] [MainThread]: SQL status: SELECT 10 in 0.004 seconds
[0m06:42:07.028780 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:07.030424 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:07.031281 [debug] [MainThread]: On master: BEGIN
[0m06:42:07.032178 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:42:07.032770 [debug] [MainThread]: On master: COMMIT
[0m06:42:07.033840 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:07.037018 [debug] [MainThread]: On master: COMMIT
[0m06:42:07.037824 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:07.038562 [debug] [MainThread]: On master: Close
[0m06:42:07.039274 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:42:07.039768 [info ] [MainThread]: 
[0m06:42:07.045284 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m06:42:07.045927 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m06:42:07.046377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m06:42:07.046686 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m06:42:07.059801 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m06:42:07.060945 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m06:42:07.083698 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m06:42:07.085072 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:42:07.085452 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m06:42:07.085786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:07.090109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:42:07.090748 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:42:07.091316 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_csv  AS (

    SELECT  
    
    customer_first_name, 
    customer_last_name ,
    customer_email,
    split_part(split_part(imported_file, '_', 3),'.',1)::int AS reseller_id,
    transaction_id

    FROM "sales_dw"."dev"."src_resellerscsv"
)
,

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (


select reseller_id, transaction_id as customer_id , customer_first_name, customer_last_name, customer_email  from customers_csv

union 

select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m06:42:07.095248 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m06:42:07.103854 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:42:07.104379 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m06:42:07.105475 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:42:07.114507 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m06:42:07.117238 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:42:07.118448 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m06:42:07.119573 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:42:07.124015 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m06:42:07.128761 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:42:07.129420 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m06:42:07.132446 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:42:07.134309 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m06:42:07.135572 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m06:42:07.136076 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m06:42:07.137345 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:07.137864 [debug] [MainThread]: On master: BEGIN
[0m06:42:07.138275 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:07.142358 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:42:07.142974 [debug] [MainThread]: On master: COMMIT
[0m06:42:07.144418 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:07.145552 [debug] [MainThread]: On master: COMMIT
[0m06:42:07.147339 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:07.149941 [debug] [MainThread]: On master: Close
[0m06:42:07.151320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:07.153396 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:42:07.153748 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m06:42:07.154240 [info ] [MainThread]: 
[0m06:42:07.156078 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m06:42:07.159209 [debug] [MainThread]: Command end result
[0m06:42:07.160583 [info ] [MainThread]: 
[0m06:42:07.162920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:42:07.164353 [info ] [MainThread]: 
[0m06:42:07.165322 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:42:07.166570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6988263, "process_user_time": 1.11282, "process_kernel_time": 0.072089, "process_mem_max_rss": "106172", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:07.168661 [debug] [MainThread]: Command `dbt run` succeeded at 06:42:07.168546 after 5.70 seconds
[0m06:42:07.169604 [debug] [MainThread]: Flushing usage events
[0m06:42:09.462902 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:09.467220 | fadd562f-6ce8-44e8-a84d-7be6219ba6ab ==============================
[0m06:42:09.467220 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:09.469436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:42:09.498246 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:09.502269 | 550ee30e-e9f5-4895-8ebe-c47d8d142103 ==============================
[0m06:42:09.502269 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:09.502864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:42:09.597506 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:09.616479 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:09.635768 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:09.649121 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:09.850049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:09.850615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:09.878637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:09.879657 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:09.915798 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:09.917107 [info ] [MainThread]: 
[0m06:42:09.917595 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:09.920558 [debug] [MainThread]: Command end result
[0m06:42:09.921434 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4916179, "process_user_time": 0.989077, "process_kernel_time": 0.053111, "process_mem_max_rss": "97460", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:09.922105 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:09.922013 after 0.49 seconds
[0m06:42:09.922629 [debug] [MainThread]: Flushing usage events
[0m06:42:09.926753 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:09.928313 [info ] [MainThread]: 
[0m06:42:09.928822 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:09.929675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:09.953644 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:09.954285 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:09.954845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:09.960968 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m06:42:09.962060 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:09.967155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:42:09.967784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:42:09.972409 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:09.974904 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:09.975166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:09.974486 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:09.975813 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:09.976355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:09.979803 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:42:09.980302 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:09.980812 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:42:09.983616 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m06:42:09.985121 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:42:09.985981 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:42:14.987133 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m06:42:14.988421 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:14.989028 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:42:14.991687 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:42:14.993070 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:42:14.993603 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:42:14.998609 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:14.999270 [debug] [MainThread]: On master: BEGIN
[0m06:42:14.999703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:15.004517 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:42:15.005219 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:15.005617 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:15.010697 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m06:42:15.012731 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:15.013205 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:15.013531 [debug] [MainThread]: On master: BEGIN
[0m06:42:15.013993 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:42:15.014512 [debug] [MainThread]: On master: COMMIT
[0m06:42:15.015023 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:15.015386 [debug] [MainThread]: On master: COMMIT
[0m06:42:15.016286 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:15.016744 [debug] [MainThread]: On master: Close
[0m06:42:15.017443 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:42:15.018043 [info ] [MainThread]: 
[0m06:42:15.023823 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m06:42:15.024573 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m06:42:15.026531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m06:42:15.032415 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m06:42:15.039159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m06:42:15.040758 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m06:42:15.066780 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m06:42:15.068165 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:42:15.068671 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m06:42:15.069151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:20.068867 [debug] [Thread-1 (]: SQL status: BEGIN in 5.004 seconds
[0m06:42:20.073867 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:42:20.076096 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select customer_key, customer_first_name, customer_last_name, customer_email, sales_agent_key
from "sales_dw"."dev"."staging_customers"
  );
  
[0m06:42:20.830032 [debug] [Thread-1 (]: SQL status: SELECT 200000 in 0.752 seconds
[0m06:42:20.839802 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:42:20.840311 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m06:42:20.840988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:20.851330 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m06:42:20.851870 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:42:20.852228 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m06:42:20.859031 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m06:42:20.863393 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m06:42:20.866273 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:42:20.866707 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m06:42:20.867216 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:42:20.869139 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m06:42:20.870636 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 200000[0m in 5.84s]
[0m06:42:20.871418 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m06:42:20.872583 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:20.873082 [debug] [MainThread]: On master: BEGIN
[0m06:42:20.873430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:20.878464 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:42:20.879076 [debug] [MainThread]: On master: COMMIT
[0m06:42:20.881873 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:20.882966 [debug] [MainThread]: On master: COMMIT
[0m06:42:20.884834 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:20.885815 [debug] [MainThread]: On master: Close
[0m06:42:20.889183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:20.890068 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:42:20.890418 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m06:42:20.890813 [info ] [MainThread]: 
[0m06:42:20.891198 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.96 seconds (10.96s).
[0m06:42:20.891777 [debug] [MainThread]: Command end result
[0m06:42:20.892066 [info ] [MainThread]: 
[0m06:42:20.892448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:42:20.892833 [info ] [MainThread]: 
[0m06:42:20.893255 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:42:20.894073 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.440477, "process_user_time": 1.124712, "process_kernel_time": 0.077117, "process_mem_max_rss": "106304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:20.894651 [debug] [MainThread]: Command `dbt run` succeeded at 06:42:20.894568 after 11.44 seconds
[0m06:42:20.895036 [debug] [MainThread]: Flushing usage events
[0m06:42:22.722829 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:22.728285 | 9b75072e-4447-4e5d-98a0-797faddb82bf ==============================
[0m06:42:22.728285 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:22.727364 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:42:22.731072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 06:42:22.732201 | b034870f-c3bb-4371-855b-13591cbaf561 ==============================
[0m06:42:22.732201 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:22.734635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'send_anonymous_usage_stats': 'True'}
[0m06:42:22.735034 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:42:22.735137 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:22.742221 | 0cebd9b1-a351-4461-9e4f-31c90616b352 ==============================
[0m06:42:22.742221 [info ] [MainThread]: Running with dbt=1.8.2


============================== 06:42:22.742478 | ad68b189-3bfa-4960-9980-4a149777b27c ==============================
[0m06:42:22.742478 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:22.743031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}
[0m06:42:22.743957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_csv', 'send_anonymous_usage_stats': 'True'}
[0m06:42:22.864871 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:22.877167 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:22.891701 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:22.904174 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:22.906101 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:22.912591 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:22.916477 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:22.930865 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:23.027115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:23.027746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:23.042993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:23.043892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:23.063979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:23.064587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:23.107125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:23.109440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:23.127340 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:23.136566 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:23.141584 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:23.155758 [info ] [MainThread]: 
[0m06:42:23.156873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:23.156474 [info ] [MainThread]: 
[0m06:42:23.155397 [info ] [MainThread]: 
[0m06:42:23.158224 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:23.157710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:23.157625 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:23.159135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:23.164215 [debug] [MainThread]: Command end result
[0m06:42:23.165818 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5012487, "process_user_time": 1.016279, "process_kernel_time": 0.060432, "process_mem_max_rss": "97344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:23.167984 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:23.167863 after 0.50 seconds
[0m06:42:23.168449 [debug] [MainThread]: Flushing usage events
[0m06:42:23.169139 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:23.171838 [info ] [MainThread]: 
[0m06:42:23.173050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:23.176141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:23.183736 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:23.185899 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:23.186397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:23.195178 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m06:42:23.197031 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:23.200332 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:23.200919 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:23.201228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:23.202406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:42:23.202965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:42:23.207349 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:23.209968 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:23.210187 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:23.210861 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:23.211510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:23.210579 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:23.211254 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:23.212475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:23.212998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:28.209478 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.008 seconds
[0m06:42:28.210844 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:28.214659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:42:28.217599 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m06:42:28.218323 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:28.218926 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m06:42:28.220011 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.008 seconds
[0m06:42:28.219289 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:42:28.215187 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:42:28.220225 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:28.221689 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:28.222154 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:42:28.220756 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:28.222981 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m06:42:28.222917 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:28.223923 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:28.225981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:42:28.225111 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:42:28.225406 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:28.225388 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:42:28.227063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:28.226293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:28.227051 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:42:28.226558 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:42:28.231564 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:42:28.232224 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:28.228163 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:42:28.232828 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:42:28.230951 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:28.233053 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:42:28.232969 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:28.233821 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:28.234515 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:28.235209 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m06:42:28.235143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:28.235701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:28.236555 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:42:28.237289 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:42:28.237743 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:28.238338 [debug] [MainThread]: On master: BEGIN
[0m06:42:28.238796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:28.240380 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:42:28.240972 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:28.241481 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:42:28.242992 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:42:28.243396 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m06:42:28.243524 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:28.244117 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:28.244507 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:42:28.248180 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:42:28.249014 [debug] [MainThread]: SQL status: SELECT 14 in 0.004 seconds
[0m06:42:28.251029 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:28.253691 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:28.254112 [debug] [MainThread]: On master: BEGIN
[0m06:42:28.254665 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:42:28.255252 [debug] [MainThread]: On master: COMMIT
[0m06:42:28.255593 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:28.255896 [debug] [MainThread]: On master: COMMIT
[0m06:42:28.256295 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:28.256684 [debug] [MainThread]: On master: Close
[0m06:42:28.257124 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:42:28.257454 [info ] [MainThread]: 
[0m06:42:28.262419 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m06:42:28.263011 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m06:42:28.263536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_resellers_xml)
[0m06:42:28.264087 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m06:42:28.279626 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:42:28.281266 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m06:42:28.316211 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:42:28.319074 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:42:28.319466 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m06:42:28.319855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:28.327213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m06:42:28.327633 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:42:28.328112 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 

  

trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  



)


SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m06:42:28.634945 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.306 seconds
[0m06:42:28.645896 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m06:42:28.646423 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:42:28.646752 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m06:42:28.647509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:42:28.649042 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m06:42:28.650733 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 0[0m in 0.39s]
[0m06:42:28.651416 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m06:42:28.652695 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:28.653166 [debug] [MainThread]: On master: BEGIN
[0m06:42:28.653514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:33.231600 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m06:42:33.232619 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:33.233062 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:42:33.235377 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:42:33.238498 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:42:33.239015 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:42:33.239776 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m06:42:33.240396 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:33.240896 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:42:33.242761 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.001 seconds
[0m06:42:33.243890 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:42:33.243145 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.244367 [debug] [MainThread]: On master: BEGIN
[0m06:42:33.244653 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:42:33.245042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:33.249588 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:42:33.250264 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.253824 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.254129 [debug] [MainThread]: On master: BEGIN
[0m06:42:33.255074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:33.254870 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:33.259639 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:42:33.262333 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.266803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:33.265057 [debug] [MainThread]: SQL status: SELECT 14 in 0.007 seconds
[0m06:42:33.285109 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:33.288105 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.288454 [debug] [MainThread]: On master: BEGIN
[0m06:42:33.295493 [debug] [MainThread]: SQL status: SELECT 14 in 0.015 seconds
[0m06:42:33.297487 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:33.298047 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.298375 [debug] [MainThread]: On master: BEGIN
[0m06:42:33.298915 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:42:33.302854 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.303728 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.305887 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.309598 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:33.313040 [debug] [MainThread]: On master: Close
[0m06:42:33.313569 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:42:33.314425 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m06:42:33.315104 [info ] [MainThread]: 
[0m06:42:33.328916 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.342601 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.346566 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.348218 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:33.350563 [debug] [MainThread]: On master: Close
[0m06:42:33.351919 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:42:33.354211 [info ] [MainThread]: 
[0m06:42:33.358889 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_csv
[0m06:42:33.360123 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_csv ...... [RUN]
[0m06:42:33.361182 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m06:42:33.360854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_resellers_csv)
[0m06:42:33.361755 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m06:42:33.362122 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_csv
[0m06:42:33.362316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_main)
[0m06:42:33.362825 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m06:42:33.377945 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_csv"
[0m06:42:33.378237 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m06:42:33.379512 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_csv
[0m06:42:33.379595 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m06:42:33.412841 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_csv"
[0m06:42:33.414255 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_csv"
[0m06:42:33.414698 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_csv: BEGIN
[0m06:42:33.415155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:33.417630 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m06:42:33.419305 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m06:42:33.419874 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m06:42:33.420345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:42:33.420855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:33.421236 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_csv"
[0m06:42:33.422050 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_csv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_csv"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_csv"
  
  
    as
  
  (
    


WITH 





resellers_csv AS (
  SELECT
    SPLIT_PART(SPLIT_PART(imported_file, '.', '-2'), '_', '-1') :: INT AS reseller_id,
    transaction_id,
    product_name,
    total_amount,
    number_of_purchased_postcards,
    created_date,
    office_location,
    sales_channel,
    loaded_timestamp
  FROM
    "sales_dw"."import"."resellercsv"

      



),
trans_csv AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    transaction_id,
    reseller_id,
    product_name,
    total_amount,
    number_of_purchased_postcards,
    created_date,
    office_location,
    sales_channel,
    loaded_timestamp
  FROM
    resellers_csv
)


SELECT
  t.customer_key,
  transaction_id,
  product_key,
  channel_key,
  t.reseller_id,
  to_char(
    created_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  number_of_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct AS commission_pct,
  loaded_timestamp
FROM
  trans_csv t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m06:42:33.425232 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m06:42:33.437112 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_csv: COMMIT
[0m06:42:33.437626 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_csv"
[0m06:42:33.438018 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_csv: COMMIT
[0m06:42:33.439027 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:42:33.440417 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_csv: Close
[0m06:42:33.441720 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_csv . [[32mSELECT 0[0m in 0.08s]
[0m06:42:33.442397 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_csv
[0m06:42:33.443528 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.443944 [debug] [MainThread]: On master: BEGIN
[0m06:42:33.444246 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:33.448270 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:42:33.448722 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.449096 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.449617 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.450162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:33.450598 [debug] [MainThread]: On master: Close
[0m06:42:33.451038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:33.451359 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_csv' was properly closed.
[0m06:42:33.451650 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:42:33.451986 [info ] [MainThread]: 
[0m06:42:33.452339 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m06:42:33.452908 [debug] [MainThread]: Command end result
[0m06:42:33.453244 [info ] [MainThread]: 
[0m06:42:33.453568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:42:33.453846 [info ] [MainThread]: 
[0m06:42:33.454117 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:42:33.454692 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.773054, "process_user_time": 1.17522, "process_kernel_time": 0.070614, "process_mem_max_rss": "106304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:33.455119 [debug] [MainThread]: Command `dbt run` succeeded at 06:42:33.455064 after 10.77 seconds
[0m06:42:33.455411 [debug] [MainThread]: Flushing usage events
[0m06:42:33.657646 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m06:42:33.658538 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.659072 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.659515 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.660377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:33.660927 [debug] [MainThread]: On master: Close
[0m06:42:33.662091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:33.663804 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m06:42:33.664902 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:42:33.665310 [info ] [MainThread]: 
[0m06:42:33.666050 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.51 seconds (10.51s).
[0m06:42:33.666851 [debug] [MainThread]: Command end result
[0m06:42:33.667162 [info ] [MainThread]: 
[0m06:42:33.667486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:42:33.667914 [info ] [MainThread]: 
[0m06:42:33.668255 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:42:33.668997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.991073, "process_user_time": 1.118725, "process_kernel_time": 0.073159, "process_mem_max_rss": "108152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:33.669639 [debug] [MainThread]: Command `dbt run` succeeded at 06:42:33.669558 after 10.99 seconds
[0m06:42:33.670015 [debug] [MainThread]: Flushing usage events
[0m06:42:35.670978 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:35.675430 | 26363fd5-b03a-44bd-b43c-69f3be8faad3 ==============================
[0m06:42:35.675430 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:35.677688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:42:35.676066 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:35.680442 | 7b051f5a-0592-4cf9-897f-7eb6d44a9dc8 ==============================
[0m06:42:35.680442 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:35.680982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_csv', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:42:35.861357 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:35.864395 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:35.875648 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:35.878511 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:36.028945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:36.029400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:36.029837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:36.030795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:36.083847 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:36.084598 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:36.085719 [info ] [MainThread]: 
[0m06:42:36.086801 [info ] [MainThread]: 
[0m06:42:36.086967 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:36.087489 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:36.089129 [debug] [MainThread]: Command end result
[0m06:42:36.090169 [debug] [MainThread]: Command end result
[0m06:42:36.091441 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44430062, "process_user_time": 0.939982, "process_kernel_time": 0.062197, "process_mem_max_rss": "97220", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:36.096129 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45988885, "process_user_time": 0.954093, "process_kernel_time": 0.052114, "process_mem_max_rss": "97440", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:36.099372 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:36.099122 after 0.45 seconds
[0m06:42:36.118034 [debug] [MainThread]: Flushing usage events
[0m06:42:36.112244 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:36.111929 after 0.48 seconds
[0m06:42:36.125439 [debug] [MainThread]: Flushing usage events
[0m06:42:38.425719 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m06:42:38.426740 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m06:42:38.427392 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m06:42:43.483017 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 5.055 seconds
[0m06:42:43.502841 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m06:42:43.504987 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m06:42:43.505393 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m06:42:43.510706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:42:43.512244 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m06:42:43.514049 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 10.15s]
[0m06:42:43.517931 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m06:42:43.519245 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:43.520304 [debug] [MainThread]: On master: BEGIN
[0m06:42:43.520685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:43.525958 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:42:43.527748 [debug] [MainThread]: On master: COMMIT
[0m06:42:43.531256 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:43.532451 [debug] [MainThread]: On master: COMMIT
[0m06:42:43.534542 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:43.534930 [debug] [MainThread]: On master: Close
[0m06:42:43.536233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:43.537419 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m06:42:43.538165 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:42:43.539493 [info ] [MainThread]: 
[0m06:42:43.540889 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 20.38 seconds (20.38s).
[0m06:42:43.541587 [debug] [MainThread]: Command end result
[0m06:42:43.542089 [info ] [MainThread]: 
[0m06:42:43.542534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:42:43.545314 [info ] [MainThread]: 
[0m06:42:43.545710 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:42:43.546419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.860962, "process_user_time": 1.143426, "process_kernel_time": 0.070519, "process_mem_max_rss": "106688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:43.546929 [debug] [MainThread]: Command `dbt run` succeeded at 06:42:43.546862 after 20.86 seconds
[0m06:42:43.547251 [debug] [MainThread]: Flushing usage events
[0m06:42:45.823005 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:45.830530 | 59d6a090-2b86-4628-98b1-79222fc305b8 ==============================
[0m06:42:45.830530 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:45.831073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'send_anonymous_usage_stats': 'True'}
[0m06:42:45.840509 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:45.845223 | 6e8e33cb-c6ae-481c-8476-80f47a891d9b ==============================
[0m06:42:45.845223 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:45.845878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:42:46.014175 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:46.017847 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:46.029573 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:46.035789 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:46.184935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:46.185461 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:46.205704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:46.208805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:46.249360 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:46.253526 [info ] [MainThread]: 
[0m06:42:46.254109 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:46.254590 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:46.256109 [debug] [MainThread]: Command end result
[0m06:42:46.257352 [info ] [MainThread]: 
[0m06:42:46.257985 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46832046, "process_user_time": 1.02423, "process_kernel_time": 0.055941, "process_mem_max_rss": "97448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:46.258021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:46.258724 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:46.258621 after 0.47 seconds
[0m06:42:46.259648 [debug] [MainThread]: Flushing usage events
[0m06:42:46.259629 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:46.283569 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:46.284301 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:46.284725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:51.295904 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.011 seconds
[0m06:42:51.297816 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:51.302221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:42:51.302843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:42:51.307454 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:51.309198 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:51.309577 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:51.309939 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:51.310237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:51.310564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:51.316029 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m06:42:51.316653 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:51.317175 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:42:51.319519 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.002 seconds
[0m06:42:51.320740 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:42:51.321348 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:42:56.314458 [debug] [ThreadPool]: SQL status: BEGIN in 5.004 seconds
[0m06:42:56.316150 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:56.316497 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:42:56.318425 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m06:42:56.319517 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:42:56.320037 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:42:56.324099 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:56.324519 [debug] [MainThread]: On master: BEGIN
[0m06:42:56.324896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:56.328835 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:42:56.329409 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:56.329897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:56.335260 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m06:42:56.337260 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:56.337796 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:56.338299 [debug] [MainThread]: On master: BEGIN
[0m06:42:56.338851 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:42:56.339290 [debug] [MainThread]: On master: COMMIT
[0m06:42:56.339651 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:56.340109 [debug] [MainThread]: On master: COMMIT
[0m06:42:56.340597 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:56.340923 [debug] [MainThread]: On master: Close
[0m06:42:56.341385 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:42:56.341874 [info ] [MainThread]: 
[0m06:42:56.347217 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m06:42:56.347856 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m06:42:56.348368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions)
[0m06:42:56.348995 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m06:42:56.355477 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m06:42:56.356725 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m06:42:56.383569 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m06:42:56.395794 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:42:56.396228 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m06:42:56.396572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:56.401003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:42:56.401516 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:42:56.404610 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_csv"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m06:42:57.141132 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 0.732 seconds
[0m06:42:57.146212 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:42:57.147248 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m06:42:57.150937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:57.164090 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m06:42:57.164674 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:42:57.166833 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m06:42:57.196124 [debug] [Thread-1 (]: SQL status: COMMIT in 0.027 seconds
[0m06:42:57.202685 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m06:42:57.208703 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:42:57.212822 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m06:42:57.213510 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:42:57.215411 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m06:42:57.219153 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1000000[0m in 0.87s]
[0m06:42:57.222779 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m06:42:57.224251 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:57.228960 [debug] [MainThread]: On master: BEGIN
[0m06:42:57.230862 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:57.246113 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m06:42:57.252260 [debug] [MainThread]: On master: COMMIT
[0m06:42:57.252635 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:57.252962 [debug] [MainThread]: On master: COMMIT
[0m06:42:57.255710 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m06:42:57.256153 [debug] [MainThread]: On master: Close
[0m06:42:57.264573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:57.264916 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:42:57.265188 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m06:42:57.266901 [info ] [MainThread]: 
[0m06:42:57.267989 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.01 seconds (11.01s).
[0m06:42:57.275542 [debug] [MainThread]: Command end result
[0m06:42:57.281158 [info ] [MainThread]: 
[0m06:42:57.282239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:42:57.293825 [info ] [MainThread]: 
[0m06:42:57.294289 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:42:57.295027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.504413, "process_user_time": 1.151582, "process_kernel_time": 0.06869, "process_mem_max_rss": "106332", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:57.295513 [debug] [MainThread]: Command `dbt run` succeeded at 06:42:57.295451 after 11.50 seconds
[0m06:42:57.295922 [debug] [MainThread]: Flushing usage events
[0m06:42:58.637839 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:58.642231 | 8c218d54-548c-478f-b9c3-e8986fb48cf8 ==============================
[0m06:42:58.642231 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:58.642980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'send_anonymous_usage_stats': 'True'}
[0m06:42:58.643520 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:58.652209 | d7b7cc7b-dcde-4b7c-b34c-8e25d482b06c ==============================
[0m06:42:58.652209 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:58.652743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'send_anonymous_usage_stats': 'True'}
[0m06:42:58.776646 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:58.788814 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:58.800059 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:58.811168 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:58.959200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:58.959909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:58.968060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:58.970086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:59.010263 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:59.011459 [info ] [MainThread]: 
[0m06:42:59.011999 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:59.012695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:59.023474 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:59.028310 [info ] [MainThread]: 
[0m06:42:59.030222 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:59.034879 [debug] [MainThread]: Command end result
[0m06:42:59.034318 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:59.036566 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44232193, "process_user_time": 0.949552, "process_kernel_time": 0.062838, "process_mem_max_rss": "97452", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:59.037636 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:59.038130 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:59.037911 after 0.44 seconds
[0m06:42:59.039090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:59.039300 [debug] [MainThread]: Flushing usage events
[0m06:42:59.048086 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m06:42:59.050497 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:59.061019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:42:59.069918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:42:59.075608 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:59.083166 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:59.084177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:59.082732 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:59.098742 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:59.099240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:43:04.097015 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m06:43:04.106796 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m06:43:04.110094 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:43:04.112116 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:43:04.110998 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:43:04.121965 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:43:04.118456 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m06:43:04.127870 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:43:04.131138 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.004 seconds
[0m06:43:04.135514 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:43:04.133194 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:43:04.138816 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:43:04.149565 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:04.157203 [debug] [MainThread]: On master: BEGIN
[0m06:43:04.157526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:43:09.171995 [debug] [MainThread]: SQL status: BEGIN in 5.014 seconds
[0m06:43:09.175247 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:09.176140 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:43:09.181842 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m06:43:09.193236 [debug] [MainThread]: On master: ROLLBACK
[0m06:43:09.193850 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:09.210059 [debug] [MainThread]: On master: BEGIN
[0m06:43:09.218851 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:43:09.224287 [debug] [MainThread]: On master: COMMIT
[0m06:43:09.224953 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:09.225279 [debug] [MainThread]: On master: COMMIT
[0m06:43:09.225733 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:09.226051 [debug] [MainThread]: On master: Close
[0m06:43:09.226515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:43:09.229986 [info ] [MainThread]: 
[0m06:43:09.242128 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m06:43:09.246609 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m06:43:09.250542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.fact_sales)
[0m06:43:09.251530 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m06:43:09.260281 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m06:43:09.266060 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m06:43:09.296057 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m06:43:09.297757 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:43:09.298224 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m06:43:09.298604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:14.311058 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m06:43:14.315530 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:43:14.317913 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    transaction_id,
    product_key,
    channel_key,
    reseller_id,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    commissionpct,
    commissionpaid,
    product_price
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m06:43:15.157078 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 0.826 seconds
[0m06:43:15.168177 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:43:15.170832 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m06:43:15.173957 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:15.192082 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m06:43:15.197560 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:43:15.199137 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m06:43:15.287089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.087 seconds
[0m06:43:15.292480 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m06:43:15.302540 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:43:15.309277 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m06:43:15.313848 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:43:15.319481 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m06:43:15.321849 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1000000[0m in 6.07s]
[0m06:43:15.322808 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m06:43:15.325743 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:15.326301 [debug] [MainThread]: On master: BEGIN
[0m06:43:15.326915 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:43:15.334946 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:43:15.338822 [debug] [MainThread]: On master: COMMIT
[0m06:43:15.340852 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:15.341148 [debug] [MainThread]: On master: COMMIT
[0m06:43:15.341533 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:15.341822 [debug] [MainThread]: On master: Close
[0m06:43:15.342187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:15.342482 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m06:43:15.342733 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:43:15.345767 [info ] [MainThread]: 
[0m06:43:15.346143 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.33 seconds (16.33s).
[0m06:43:15.346635 [debug] [MainThread]: Command end result
[0m06:43:15.348423 [info ] [MainThread]: 
[0m06:43:15.348937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:43:15.352200 [info ] [MainThread]: 
[0m06:43:15.352756 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:43:15.354712 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.765676, "process_user_time": 1.111532, "process_kernel_time": 0.069089, "process_mem_max_rss": "106152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:43:15.355233 [debug] [MainThread]: Command `dbt run` succeeded at 06:43:15.355164 after 16.77 seconds
[0m06:43:15.355581 [debug] [MainThread]: Flushing usage events
[0m06:43:17.071868 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:43:17.082510 | e4663c40-2a23-48ba-8132-a15917e99490 ==============================
[0m06:43:17.082510 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:43:17.085183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:43:17.222708 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:43:17.234593 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:43:17.446727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:43:17.447329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:43:17.499630 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:43:17.503616 [info ] [MainThread]: 
[0m06:43:17.505343 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:43:17.510249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:43:17.510917 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:43:17.539155 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:43:17.539469 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:43:17.539908 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:43:17.540287 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:43:17.540601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:17.540994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:22.546174 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m06:43:22.546874 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m06:43:22.547862 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:43:22.548290 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:43:22.547424 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:43:22.552202 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:43:22.551902 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m06:43:22.553672 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:43:22.554234 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:43:22.554504 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.002 seconds
[0m06:43:22.556046 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:43:22.556467 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:43:22.561857 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:22.568210 [debug] [MainThread]: On master: BEGIN
[0m06:43:22.568671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:43:22.573143 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:43:22.573731 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:22.574134 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:43:22.579400 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m06:43:22.581307 [debug] [MainThread]: On master: ROLLBACK
[0m06:43:22.581876 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:22.582184 [debug] [MainThread]: On master: BEGIN
[0m06:43:22.582692 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:43:22.583197 [debug] [MainThread]: On master: COMMIT
[0m06:43:22.583526 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:22.583820 [debug] [MainThread]: On master: COMMIT
[0m06:43:22.584209 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:22.584483 [debug] [MainThread]: On master: Close
[0m06:43:22.584961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:43:22.585309 [info ] [MainThread]: 
[0m06:43:22.590514 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m06:43:22.591131 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m06:43:22.591644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m06:43:22.592040 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m06:43:22.597840 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m06:43:22.599137 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m06:43:22.609091 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m06:43:22.612880 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m06:43:22.613462 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m06:43:22.614181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:22.618723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:43:22.619365 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m06:43:22.619957 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m06:43:22.746089 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.126 seconds
[0m06:43:22.749219 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m06:43:22.749872 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m06:43:22.750467 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.16s]
[0m06:43:22.751029 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m06:43:22.752229 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:22.752707 [debug] [MainThread]: On master: BEGIN
[0m06:43:22.753098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:43:22.759945 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:43:22.764351 [debug] [MainThread]: On master: COMMIT
[0m06:43:22.767709 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:22.768481 [debug] [MainThread]: On master: COMMIT
[0m06:43:22.769058 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:22.770826 [debug] [MainThread]: On master: Close
[0m06:43:22.771416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:22.771948 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:43:22.775638 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m06:43:22.776133 [info ] [MainThread]: 
[0m06:43:22.776519 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m06:43:22.777108 [debug] [MainThread]: Command end result
[0m06:43:22.777484 [info ] [MainThread]: 
[0m06:43:22.777886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:43:22.778244 [info ] [MainThread]: 
[0m06:43:22.778732 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:43:22.779465 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.740628, "process_user_time": 1.027292, "process_kernel_time": 0.070917, "process_mem_max_rss": "110224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:43:22.780035 [debug] [MainThread]: Command `dbt test` succeeded at 06:43:22.779951 after 5.74 seconds
[0m06:43:22.780434 [debug] [MainThread]: Flushing usage events
[0m07:04:56.993673 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:04:56.998079 | 467871ce-b443-4fe5-978c-4167c1c8b1b6 ==============================
[0m07:04:56.998079 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:04:56.998545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:04:57.090368 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:04:57.093228 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:04:57.102177 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7d314z3n'
[0m07:04:57.102639 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:04:57.103475 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:04:57.104008 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:04:57.104880 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14612137, "process_user_time": 0.779651, "process_kernel_time": 0.047282, "process_mem_max_rss": "105512", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:04:57.105395 [debug] [MainThread]: Command `dbt deps` succeeded at 07:04:57.105330 after 0.15 seconds
[0m07:04:57.107005 [debug] [MainThread]: Flushing usage events
[0m07:05:04.019899 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:05:04.024085 | 1eb12641-1f1b-4ab3-9b24-f41b65d0e047 ==============================
[0m07:05:04.024085 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:05:04.024566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:05:04.152159 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:05:04.163285 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:05:04.167668 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:05:05.201231 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_transactions' (models/staging/staging_transactions.sql) depends on a node named 'staging_transactions_resellers_csv' which was not found
[0m07:05:05.202548 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.2215595, "process_user_time": 1.712001, "process_kernel_time": 0.06848, "process_mem_max_rss": "105436", "process_in_blocks": "48", "command_success": false, "process_out_blocks": "0"}
[0m07:05:05.206285 [debug] [MainThread]: Command `dbt seed` failed at 07:05:05.206178 after 1.23 seconds
[0m07:05:05.206804 [debug] [MainThread]: Flushing usage events
[0m07:06:18.632694 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:06:18.638240 | b531f5a2-94e0-4578-891a-461bd38bff89 ==============================
[0m07:06:18.638240 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:06:18.638993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'send_anonymous_usage_stats': 'True'}
[0m07:06:18.710424 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:06:18.711992 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:06:18.719011 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kg_peg40'
[0m07:06:18.722495 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:06:18.723304 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:06:18.724610 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:06:18.725506 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12797384, "process_user_time": 0.793089, "process_kernel_time": 0.047605, "process_mem_max_rss": "105500", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:06:18.727529 [debug] [MainThread]: Command `dbt deps` succeeded at 07:06:18.727434 after 0.13 seconds
[0m07:06:18.727935 [debug] [MainThread]: Flushing usage events
[0m07:06:25.324558 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:06:25.329136 | b1df4915-05ec-4b95-a5a3-d2de5cd77cc4 ==============================
[0m07:06:25.329136 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:06:25.329847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:06:25.468719 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:06:25.503119 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:06:25.506745 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:06:26.546281 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_transactions' (models/staging/staging_transactions.sql) depends on a node named 'staging_transactions_resellers_csv' which was not found
[0m07:06:26.548006 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.2555717, "process_user_time": 1.868565, "process_kernel_time": 0.07947, "process_mem_max_rss": "105428", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:06:26.548969 [debug] [MainThread]: Command `dbt seed` failed at 07:06:26.548864 after 1.26 seconds
[0m07:06:26.550118 [debug] [MainThread]: Flushing usage events
[0m07:10:11.619853 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:10:11.625147 | fbe7b6c7-e71b-4e2e-b956-aea9d374790c ==============================
[0m07:10:11.625147 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:10:11.625767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:10:11.762954 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:10:11.852447 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:10:11.861703 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:10:12.863446 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_transactions' (models/staging/staging_transactions.sql) depends on a node named 'staging_transactions_resellers_csv' which was not found
[0m07:10:12.865012 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.280898, "process_user_time": 1.756347, "process_kernel_time": 0.100477, "process_mem_max_rss": "105436", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:10:12.865782 [debug] [MainThread]: Command `dbt seed` failed at 07:10:12.865666 after 1.28 seconds
[0m07:10:12.867344 [debug] [MainThread]: Flushing usage events
[0m07:14:19.165155 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:14:19.169629 | 6430dc43-9fd6-4953-82f4-37c7a2185627 ==============================
[0m07:14:19.169629 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:14:19.170228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'send_anonymous_usage_stats': 'True'}
[0m07:14:19.236131 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:14:19.238829 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:14:19.251342 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tnwzplj9'
[0m07:14:19.252068 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:14:19.252961 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:14:19.253421 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:14:19.254175 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12258896, "process_user_time": 0.770048, "process_kernel_time": 0.048065, "process_mem_max_rss": "105776", "process_in_blocks": "8", "process_out_blocks": "8"}
[0m07:14:19.254731 [debug] [MainThread]: Command `dbt deps` succeeded at 07:14:19.254652 after 0.12 seconds
[0m07:14:19.255060 [debug] [MainThread]: Flushing usage events
[0m07:14:21.342696 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:14:21.347540 | ec9e707a-d987-4055-a295-29fb2092ef51 ==============================
[0m07:14:21.347540 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:14:21.350497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m07:14:21.482216 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:14:21.493572 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:14:21.497285 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:14:22.496131 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_transactions' (models/staging/staging_transactions.sql) depends on a node named 'staging_transactions_resellers_csv' which was not found
[0m07:14:22.498972 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.2293118, "process_user_time": 1.763419, "process_kernel_time": 0.084115, "process_mem_max_rss": "105712", "process_in_blocks": "8", "command_success": false, "process_out_blocks": "0"}
[0m07:14:22.499552 [debug] [MainThread]: Command `dbt seed` failed at 07:14:22.499466 after 1.23 seconds
[0m07:14:22.501190 [debug] [MainThread]: Flushing usage events
[0m07:15:43.876253 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:15:43.892894 | da881506-73f0-43f9-9bb8-dbb2fc8a21b7 ==============================
[0m07:15:43.892894 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:15:43.893553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:15:43.961922 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:15:43.965689 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:15:43.969392 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ynh1dy2i'
[0m07:15:43.970461 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:15:43.971508 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:15:43.975570 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:15:43.976734 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15183538, "process_user_time": 0.763294, "process_kernel_time": 0.048954, "process_mem_max_rss": "105784", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:15:43.977605 [debug] [MainThread]: Command `dbt deps` succeeded at 07:15:43.977484 after 0.15 seconds
[0m07:15:43.978466 [debug] [MainThread]: Flushing usage events
[0m07:15:46.062079 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:15:46.067898 | 663e2758-2a5e-42a7-bf11-82a676bdafaf ==============================
[0m07:15:46.067898 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:15:46.068576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:15:46.199531 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:15:46.219417 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:15:46.223711 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:15:47.305655 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_customers' (models/staging/staging_customers.sql) depends on a node named 'src_resellerscsv' which was not found
[0m07:15:47.322460 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.3347031, "process_user_time": 1.770517, "process_kernel_time": 0.050099, "process_mem_max_rss": "105804", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:15:47.323577 [debug] [MainThread]: Command `dbt seed` failed at 07:15:47.323471 after 1.34 seconds
[0m07:15:47.326718 [debug] [MainThread]: Flushing usage events
[0m07:16:00.206291 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:16:00.210517 | 82da1cd3-ba78-45b1-b5e2-797615608b25 ==============================
[0m07:16:00.210517 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:16:00.211534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:16:00.279818 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:16:00.281968 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:16:00.287613 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6nfraqlu'
[0m07:16:00.290808 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:16:00.291787 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:16:00.292318 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:16:00.293116 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13785154, "process_user_time": 0.823453, "process_kernel_time": 0.049691, "process_mem_max_rss": "105764", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:16:00.294489 [debug] [MainThread]: Command `dbt deps` succeeded at 07:16:00.293992 after 0.14 seconds
[0m07:16:00.295175 [debug] [MainThread]: Flushing usage events
[0m07:16:01.594893 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:16:01.600865 | dba1734b-a490-4780-a8d5-389428ba04f7 ==============================
[0m07:16:01.600865 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:16:01.601769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:16:01.737001 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:16:01.751683 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:16:01.752655 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:16:02.787378 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_customers' (models/staging/staging_customers.sql) depends on a node named 'src_resellerscsv' which was not found
[0m07:16:02.789476 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.2240148, "process_user_time": 1.78372, "process_kernel_time": 0.063309, "process_mem_max_rss": "105700", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:16:02.791172 [debug] [MainThread]: Command `dbt seed` failed at 07:16:02.791098 after 1.23 seconds
[0m07:16:02.792151 [debug] [MainThread]: Flushing usage events
[0m07:19:53.115700 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:19:53.120166 | f2d2a0e3-a3c1-4069-ba2f-438b2ca907fe ==============================
[0m07:19:53.120166 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:19:53.120811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'send_anonymous_usage_stats': 'True'}
[0m07:19:53.195994 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:19:53.204511 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:19:53.220744 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j6fz0j7e'
[0m07:19:53.223134 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:19:53.235301 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:19:53.246481 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:19:53.263287 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.17019142, "process_user_time": 0.765796, "process_kernel_time": 0.05751, "process_mem_max_rss": "105532", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:19:53.264170 [debug] [MainThread]: Command `dbt deps` succeeded at 07:19:53.264044 after 0.18 seconds
[0m07:19:53.275000 [debug] [MainThread]: Flushing usage events
[0m07:19:55.231957 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:19:55.235999 | e66ed934-edaf-4138-b646-9320f04bb161 ==============================
[0m07:19:55.235999 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:19:55.236610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:19:55.360121 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:19:55.375455 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:19:55.376438 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:19:56.433354 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_customers' (models/staging/staging_customers.sql) depends on a node named 'src_resellerscsv' which was not found
[0m07:19:56.437032 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.2356415, "process_user_time": 1.712167, "process_kernel_time": 0.065426, "process_mem_max_rss": "105536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:19:56.437652 [debug] [MainThread]: Command `dbt seed` failed at 07:19:56.437567 after 1.24 seconds
[0m07:19:56.438344 [debug] [MainThread]: Flushing usage events
[0m07:20:47.607082 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:20:47.611278 | ee44dfca-2d77-4148-9d9e-27ba4b259d8f ==============================
[0m07:20:47.611278 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:20:47.611792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:20:47.678141 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:20:47.679294 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:20:47.684237 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-eivpj8z5'
[0m07:20:47.685047 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:20:47.687236 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:20:47.692057 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:20:47.696829 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12208363, "process_user_time": 0.77372, "process_kernel_time": 0.037986, "process_mem_max_rss": "105520", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:20:47.697394 [debug] [MainThread]: Command `dbt deps` succeeded at 07:20:47.697331 after 0.12 seconds
[0m07:20:47.698263 [debug] [MainThread]: Flushing usage events
[0m07:20:49.725984 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:20:49.730757 | b07480f7-a247-4597-af28-3b893cdad4bf ==============================
[0m07:20:49.730757 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:20:49.731273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:20:49.859767 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:20:49.915224 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:20:49.919230 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:20:51.149339 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:20:51.154120 [info ] [MainThread]: 
[0m07:20:51.155467 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:20:51.156738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:20:51.178113 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:20:51.180410 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:20:51.180773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:56.189365 [debug] [ThreadPool]: SQL status: SELECT 8 in 5.009 seconds
[0m07:20:56.190769 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:20:56.191615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m07:20:56.194256 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m07:20:56.198527 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:20:56.198991 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m07:20:56.199311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:20:56.204053 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:20:56.204660 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:20:56.205112 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m07:20:56.205881 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:20:56.206715 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m07:20:56.207161 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:20:56.207593 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m07:20:56.208407 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m07:20:56.208869 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m07:20:56.212655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m07:20:56.213078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:20:56.217509 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:20:56.219311 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:20:56.219779 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:20:56.220189 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:20:56.220514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:20:56.220810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:21:01.225353 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:21:01.225699 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:21:01.227066 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:21:01.227559 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:21:01.226571 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:21:01.228734 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:21:01.229839 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:21:01.230928 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:21:01.231165 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:21:01.232587 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:21:01.231649 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:21:01.233075 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:21:01.237234 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:01.237707 [debug] [MainThread]: On master: BEGIN
[0m07:21:01.238129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:21:06.242508 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m07:21:06.243298 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:06.243945 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:21:06.247578 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:21:06.249963 [debug] [MainThread]: On master: ROLLBACK
[0m07:21:06.250785 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:06.251546 [debug] [MainThread]: On master: BEGIN
[0m07:21:06.252984 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:21:06.253648 [debug] [MainThread]: On master: COMMIT
[0m07:21:06.254063 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:06.254471 [debug] [MainThread]: On master: COMMIT
[0m07:21:06.254945 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:21:06.255308 [debug] [MainThread]: On master: Close
[0m07:21:06.255905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:21:06.256498 [info ] [MainThread]: 
[0m07:21:06.261454 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m07:21:06.262075 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m07:21:06.262510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m07:21:06.262803 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m07:21:06.263071 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m07:21:06.281159 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:21:06.281808 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m07:21:06.282291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:06.291669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:21:06.297358 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:21:06.297869 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m07:21:06.303419 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.004 seconds
[0m07:21:06.350896 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:21:06.351581 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m07:21:06.352979 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m07:21:06.356657 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m07:21:06.368406 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m07:21:06.368872 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:21:06.369324 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m07:21:06.370344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:21:06.371802 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m07:21:06.373100 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.11s]
[0m07:21:06.375021 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m07:21:06.376171 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:06.376672 [debug] [MainThread]: On master: BEGIN
[0m07:21:06.376954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:21:06.381064 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:21:06.381771 [debug] [MainThread]: On master: COMMIT
[0m07:21:06.382254 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:06.382704 [debug] [MainThread]: On master: COMMIT
[0m07:21:06.383234 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:21:06.383585 [debug] [MainThread]: On master: Close
[0m07:21:06.383991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:21:06.384288 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m07:21:06.384538 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:21:06.384912 [info ] [MainThread]: 
[0m07:21:06.385417 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 15.23 seconds (15.23s).
[0m07:21:06.386127 [debug] [MainThread]: Command end result
[0m07:21:06.462134 [info ] [MainThread]: 
[0m07:21:06.466083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:21:06.467447 [info ] [MainThread]: 
[0m07:21:06.468265 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:21:06.473477 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 16.775629, "process_user_time": 2.088432, "process_kernel_time": 0.096481, "process_mem_max_rss": "113848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:21:06.480585 [debug] [MainThread]: Command `dbt seed` succeeded at 07:21:06.480493 after 16.78 seconds
[0m07:21:06.482641 [debug] [MainThread]: Flushing usage events
[0m07:28:26.742320 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:28:26.746641 | 95652746-abd9-4761-86bc-e403a7278267 ==============================
[0m07:28:26.746641 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:28:26.748485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:28:26.877754 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:28:26.885614 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:28:26.900081 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vrhv3doy'
[0m07:28:26.901611 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:28:26.903510 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:28:26.904215 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:28:26.905239 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.19622183, "process_user_time": 0.837671, "process_kernel_time": 0.077167, "process_mem_max_rss": "105512", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:28:26.905968 [debug] [MainThread]: Command `dbt deps` succeeded at 07:28:26.905827 after 0.20 seconds
[0m07:28:26.907447 [debug] [MainThread]: Flushing usage events
[0m07:28:28.784779 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:28:28.790055 | 46ae42d0-394d-40a0-ab6c-6e6be5b5e385 ==============================
[0m07:28:28.790055 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:28:28.790941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:28:28.929004 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:28:28.960890 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:28:28.969974 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:28:30.366608 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:28:30.368622 [info ] [MainThread]: 
[0m07:28:30.369296 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:28:30.371535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:28:30.391908 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:28:30.392503 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:28:30.392884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:28:30.398339 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m07:28:30.399342 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:28:30.399953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m07:28:30.400538 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m07:28:30.404536 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:28:30.405026 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m07:28:30.405325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:28:35.411925 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m07:28:35.412696 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:28:35.413064 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m07:28:35.413749 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:28:35.414737 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m07:28:35.415288 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:28:35.415707 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m07:28:35.416721 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m07:28:35.417224 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m07:28:35.421231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev)
[0m07:28:35.421716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:28:35.428958 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:28:35.431151 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:28:35.431867 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:28:35.432863 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:28:35.433704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:28:35.437302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:28:35.445408 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m07:28:35.448270 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:28:35.448769 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:28:35.451446 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:28:35.452433 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:28:35.452835 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:28:40.446781 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m07:28:40.449905 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:28:40.450411 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:28:40.452703 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:28:40.453726 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:28:40.454201 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:28:40.459252 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:40.462873 [debug] [MainThread]: On master: BEGIN
[0m07:28:40.463297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:28:40.467891 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:28:40.468376 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:40.471344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:28:40.480199 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:28:40.481402 [debug] [MainThread]: On master: ROLLBACK
[0m07:28:40.481873 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:40.482176 [debug] [MainThread]: On master: BEGIN
[0m07:28:40.482668 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:28:40.483131 [debug] [MainThread]: On master: COMMIT
[0m07:28:40.483619 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:40.484054 [debug] [MainThread]: On master: COMMIT
[0m07:28:40.484511 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:28:40.484879 [debug] [MainThread]: On master: Close
[0m07:28:40.485339 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:28:40.485746 [info ] [MainThread]: 
[0m07:28:40.490563 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m07:28:40.491219 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m07:28:40.491794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m07:28:40.492195 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m07:28:40.492527 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m07:28:40.510826 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:28:40.513171 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m07:28:40.513622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:28:40.517906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:28:40.518545 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:28:40.519007 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m07:28:40.522861 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m07:28:40.577385 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:28:40.578008 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m07:28:40.579268 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m07:28:40.582919 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m07:28:40.594798 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m07:28:40.595561 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:28:40.596312 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m07:28:40.597616 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:28:40.599146 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m07:28:40.600432 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.11s]
[0m07:28:40.601127 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m07:28:40.602294 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:40.602750 [debug] [MainThread]: On master: BEGIN
[0m07:28:40.603158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:28:40.607726 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:28:40.608383 [debug] [MainThread]: On master: COMMIT
[0m07:28:40.608851 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:40.609255 [debug] [MainThread]: On master: COMMIT
[0m07:28:40.609722 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:28:40.610330 [debug] [MainThread]: On master: Close
[0m07:28:40.610909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:28:40.611373 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:28:40.611850 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m07:28:40.612596 [info ] [MainThread]: 
[0m07:28:40.613078 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m07:28:40.615226 [debug] [MainThread]: Command end result
[0m07:28:40.690626 [info ] [MainThread]: 
[0m07:28:40.691484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:28:40.691954 [info ] [MainThread]: 
[0m07:28:40.692431 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:28:40.693335 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.941379, "process_user_time": 2.171701, "process_kernel_time": 0.090402, "process_mem_max_rss": "116080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:28:40.693928 [debug] [MainThread]: Command `dbt seed` succeeded at 07:28:40.693844 after 11.94 seconds
[0m07:28:40.694259 [debug] [MainThread]: Flushing usage events
[0m07:29:33.826441 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:33.850360 | a20a2d22-5680-4a03-a5a7-0ccd703623f0 ==============================
[0m07:29:33.850360 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:33.903406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:29:33.939705 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:29:33.944573 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:33.967606 | 2f3e6e1b-1905-4457-9616-bde8b06e5baa ==============================
[0m07:29:33.967606 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:29:33.975685 | 05f1da52-6f20-4e32-9c19-ffcce6fa97cc ==============================
[0m07:29:33.975685 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:33.977007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:29:33.978439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:33.987631 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:33.996903 | a0f0f4cc-9ffc-4578-9603-aa4a3ad15031 ==============================
[0m07:29:33.996903 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:34.002890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:34.000675 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:34.006882 | cdef319e-103c-4a18-bbce-ebea6a847037 ==============================
[0m07:29:34.006882 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:34.009901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:34.008839 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:29:34.012741 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:34.026133 | 29cfe65a-b874-4d52-b148-df26a544a3b6 ==============================
[0m07:29:34.026133 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:34.032735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 07:29:34.032347 | eec32e36-f78f-4817-a19e-2beeb4957f72 ==============================
[0m07:29:34.032347 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:34.037798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:34.380222 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.383830 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.424907 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.428927 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.435511 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.444353 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.448356 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.457237 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.463310 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.467647 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.467016 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.471263 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.485443 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.497829 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.557899 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.560268 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:34.564368 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.565364 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:34.569853 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.570582 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:34.581768 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.582463 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:34.584556 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.585464 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:34.594297 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.595650 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.595276 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:34.596330 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:35.980607 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:35.994124 [info ] [MainThread]: 
[0m07:29:36.060419 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.077728 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:36.082523 [info ] [MainThread]: 
[0m07:29:36.082316 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:36.086645 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:36.087147 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.083874 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.090272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.090534 [info ] [MainThread]: 
[0m07:29:36.091347 [info ] [MainThread]: 
[0m07:29:36.095944 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.096967 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.098219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.101391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.114085 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.115249 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.117405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.118839 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.119835 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.120606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.128655 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.008 seconds
[0m07:29:36.128603 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.129950 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m07:29:36.130888 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:36.133399 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:36.131926 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.136740 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.137516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m07:29:36.137905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.137333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m07:29:36.139376 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m07:29:36.138837 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.141309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.141407 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m07:29:36.145601 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.148687 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.149133 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m07:29:36.151478 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m07:29:36.151403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.152326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.157139 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.016 seconds
[0m07:29:36.159851 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:36.160969 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:29:36.161568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m07:29:36.162258 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m07:29:36.162440 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.162578 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:36.163701 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.163498 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m07:29:36.163995 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m07:29:36.164653 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m07:29:36.165546 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:29:36.165837 [info ] [MainThread]: 
[0m07:29:36.166754 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:29:36.166852 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.167313 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.167861 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:29:36.168257 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.168932 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m07:29:36.169418 [debug] [ThreadPool]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "pg_namespace_nspname_index"
DETAIL:  Key (nspname)=(dev) already exists.

[0m07:29:36.170126 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m07:29:36.170450 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.170871 [debug] [ThreadPool]: On create_sales_dw_dev: ROLLBACK
[0m07:29:36.172441 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m07:29:36.176555 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m07:29:36.177606 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:29:36.177973 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:36.176762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.178424 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m07:29:36.177763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m07:29:36.179987 [info ] [MainThread]: 
[0m07:29:36.181161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:36.181706 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.181870 [debug] [MainThread]: Connection 'create_sales_dw_dev' was properly closed.
[0m07:29:36.182947 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.182857 [info ] [MainThread]: 
[0m07:29:36.178496 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:29:36.186096 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m07:29:36.185271 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m07:29:36.189653 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.190145 [error] [MainThread]: Encountered an error:
Database Error
  duplicate key value violates unique constraint "pg_namespace_nspname_index"
  DETAIL:  Key (nspname)=(dev) already exists.
[0m07:29:36.190775 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m07:29:36.191016 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:36.191728 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4314363, "process_user_time": 2.587519, "process_kernel_time": 0.154381, "process_mem_max_rss": "111356", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:36.191895 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.192311 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:36.192300 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:29:36.192875 [debug] [MainThread]: Command `dbt run` failed at 07:29:36.192772 after 2.43 seconds
[0m07:29:36.192990 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.193391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.194118 [debug] [MainThread]: Flushing usage events
[0m07:29:36.185156 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:36.194388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.194362 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:29:36.195277 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:36.195735 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.196065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.196404 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:29:36.197162 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m07:29:36.197674 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m07:29:36.203914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m07:29:36.204666 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:36.211309 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:36.220338 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:36.220345 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.219179 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:36.223244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.223634 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.223940 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:36.225153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.225556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.230620 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:29:36.231616 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:36.232249 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:36.232299 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m07:29:36.231109 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:29:36.233690 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:36.234215 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:36.234974 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:36.235370 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:29:36.237636 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:36.237993 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:36.238425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:29:36.238750 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:36.239137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:36.239611 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:36.244328 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:36.247688 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:36.247014 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:36.248871 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:36.249321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.248153 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:36.250013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.253225 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.253819 [debug] [MainThread]: On master: BEGIN
[0m07:29:36.254165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:36.259426 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:36.260587 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.261121 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:36.264580 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:29:36.266002 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:36.266726 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.267274 [debug] [MainThread]: On master: BEGIN
[0m07:29:36.267947 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:29:36.269016 [debug] [MainThread]: On master: COMMIT
[0m07:29:36.270152 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.271277 [debug] [MainThread]: On master: COMMIT
[0m07:29:36.272157 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:36.272906 [debug] [MainThread]: On master: Close
[0m07:29:36.273592 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:36.274622 [info ] [MainThread]: 
[0m07:29:36.282606 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m07:29:36.283293 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m07:29:36.283764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m07:29:36.284092 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m07:29:36.288992 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:36.289819 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m07:29:36.290642 [info ] [MainThread]: 
[0m07:29:36.291323 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.291778 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m07:29:36.292836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.316391 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m07:29:36.316555 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.317195 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.317808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.319725 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:29:36.320295 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m07:29:36.320947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:36.324637 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m07:29:36.325969 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:36.329934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:29:36.330888 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:36.336062 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:36.337996 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:36.338402 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:36.338846 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:36.342412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.341606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.348986 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:29:36.349717 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:36.350144 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:29:36.350979 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:36.351414 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:36.350541 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:36.353443 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:29:36.353692 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:36.354708 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:36.355627 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:36.356151 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:36.356487 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:36.361128 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.361725 [debug] [MainThread]: On master: BEGIN
[0m07:29:36.362118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:36.368146 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:29:36.368807 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.369436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:36.372615 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:29:36.375209 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:36.375882 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.376340 [debug] [MainThread]: On master: BEGIN
[0m07:29:36.377064 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:29:36.377701 [debug] [MainThread]: On master: COMMIT
[0m07:29:36.378128 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.378480 [debug] [MainThread]: On master: COMMIT
[0m07:29:36.378978 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:36.379482 [debug] [MainThread]: On master: Close
[0m07:29:36.380089 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:36.380569 [info ] [MainThread]: 
[0m07:29:36.385718 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m07:29:36.386293 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m07:29:36.386845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m07:29:36.387665 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m07:29:36.393392 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m07:29:36.399025 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m07:29:36.437110 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m07:29:36.439715 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:29:36.440726 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m07:29:36.441550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:36.452718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m07:29:36.453887 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:29:36.458539 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
      id AS geography_key,
      cityname as city_name,
      countryname as country_name,
      regionname as region_name
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m07:29:36.472744 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.009 seconds
[0m07:29:36.479754 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:29:36.480808 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m07:29:36.486400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:29:36.500437 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m07:29:36.504289 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:29:36.511294 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m07:29:36.512467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:29:36.521963 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m07:29:36.524834 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:29:36.526916 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m07:29:36.528232 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:29:36.529797 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m07:29:36.531995 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 0.14s]
[0m07:29:36.532690 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m07:29:36.534379 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.535490 [debug] [MainThread]: On master: BEGIN
[0m07:29:36.536153 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:36.545384 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:29:36.545967 [debug] [MainThread]: On master: COMMIT
[0m07:29:36.546480 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.546930 [debug] [MainThread]: On master: COMMIT
[0m07:29:36.547580 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:36.548158 [debug] [MainThread]: On master: Close
[0m07:29:36.548782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:36.549237 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:29:36.549644 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m07:29:36.549980 [info ] [MainThread]: 
[0m07:29:36.550324 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m07:29:36.550853 [debug] [MainThread]: Command end result
[0m07:29:36.551237 [info ] [MainThread]: 
[0m07:29:36.551801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:36.552281 [info ] [MainThread]: 
[0m07:29:36.552769 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:36.553598 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6290135, "process_user_time": 2.912001, "process_kernel_time": 0.181503, "process_mem_max_rss": "114904", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:36.554107 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:36.554038 after 2.63 seconds
[0m07:29:36.554428 [debug] [MainThread]: Flushing usage events
[0m07:29:38.445145 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:38.450904 | 96793083-b1f1-4eee-af8e-9161573c79d8 ==============================
[0m07:29:38.450904 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:38.452501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'send_anonymous_usage_stats': 'True'}
[0m07:29:38.581761 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:38.592428 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:38.803430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:38.803889 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:38.856991 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:38.858355 [info ] [MainThread]: 
[0m07:29:38.858835 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:38.860266 [debug] [MainThread]: Command end result
[0m07:29:38.860911 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45664746, "process_user_time": 0.942704, "process_kernel_time": 0.072592, "process_mem_max_rss": "97536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:38.861351 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:38.861294 after 0.46 seconds
[0m07:29:38.861663 [debug] [MainThread]: Flushing usage events
[0m07:29:41.144790 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.007 seconds
[0m07:29:41.149209 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:41.152816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:29:41.153471 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:41.159834 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:41.160303 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:41.160707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:41.158083 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:41.161727 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:41.162246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:41.165372 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:29:41.166171 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:41.166632 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:41.168791 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:41.169984 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:41.170599 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:41.199249 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:29:41.199983 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:41.200531 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:41.202676 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:41.202779 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.008 seconds
[0m07:29:41.205256 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:41.205243 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:41.205778 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:29:41.206236 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:41.206769 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:41.207916 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:41.210862 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:41.210281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:29:41.212144 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:41.212754 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:41.210935 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:41.217196 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.217607 [debug] [MainThread]: On master: BEGIN
[0m07:29:41.218065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:41.215810 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:41.218686 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:41.219393 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:41.219882 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:41.221701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:41.222614 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:41.223372 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.222217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:41.223923 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:41.227994 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:29:41.229389 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:41.229218 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:29:41.230111 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.230121 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:41.230535 [debug] [MainThread]: On master: BEGIN
[0m07:29:41.230883 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:41.231339 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:29:41.231915 [debug] [MainThread]: On master: COMMIT
[0m07:29:41.232492 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.232937 [debug] [MainThread]: On master: COMMIT
[0m07:29:41.233512 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:41.234004 [debug] [MainThread]: On master: Close
[0m07:29:41.233798 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:41.234548 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:41.235176 [info ] [MainThread]: 
[0m07:29:41.235612 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:41.239579 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:41.240671 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m07:29:41.241331 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m07:29:41.242131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m07:29:41.242651 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m07:29:41.248472 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m07:29:41.249769 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m07:29:41.255354 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:29:41.255748 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:29:41.258514 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:41.258977 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:41.259490 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:41.260212 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:41.262574 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:41.263691 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:41.263947 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:41.264451 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:41.265115 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:41.266244 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:41.270514 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.271146 [debug] [MainThread]: On master: BEGIN
[0m07:29:41.271624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:41.274434 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m07:29:41.276297 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:29:41.276328 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:41.276975 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m07:29:41.277422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:41.277371 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.278066 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:41.281345 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:29:41.282437 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:41.283023 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.283423 [debug] [MainThread]: On master: BEGIN
[0m07:29:41.283965 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:29:41.284499 [debug] [MainThread]: On master: COMMIT
[0m07:29:41.284986 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.285435 [debug] [MainThread]: On master: COMMIT
[0m07:29:41.285934 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:41.286403 [debug] [MainThread]: On master: Close
[0m07:29:41.287149 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:41.287742 [info ] [MainThread]: 
[0m07:29:41.293309 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m07:29:41.294336 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m07:29:41.295164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m07:29:41.298465 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m07:29:41.304001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m07:29:41.305380 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m07:29:41.328626 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m07:29:41.339772 [debug] [Thread-1 (]: SQL status: BEGIN in 5.018 seconds
[0m07:29:41.341299 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:29:41.341819 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:29:41.343240 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m07:29:41.344378 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m07:29:41.345795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:41.353513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:29:41.354785 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m07:29:41.356199 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:29:41.363832 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:29:41.364583 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m07:29:41.364894 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m07:29:41.370714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m07:29:41.372235 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m07:29:41.383436 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m07:29:41.389694 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:29:41.391574 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m07:29:41.394794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:29:41.400105 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:29:41.402674 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m07:29:41.403082 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m07:29:41.406969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:29:41.409529 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:29:41.410154 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m07:29:41.410887 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:41.412746 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m07:29:41.414297 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 5.13s]
[0m07:29:41.415040 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m07:29:41.416459 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.417092 [debug] [MainThread]: On master: BEGIN
[0m07:29:41.417113 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m07:29:41.417576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:41.417747 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:29:41.418361 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m07:29:41.419303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:29:41.422172 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:41.423493 [debug] [MainThread]: On master: COMMIT
[0m07:29:41.423911 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.424778 [debug] [MainThread]: On master: COMMIT
[0m07:29:41.424802 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m07:29:41.428187 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:29:41.425553 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:41.428626 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m07:29:41.429157 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:41.428912 [debug] [MainThread]: On master: Close
[0m07:29:41.430676 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m07:29:41.431152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:41.431991 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.14s]
[0m07:29:41.432521 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:29:41.432889 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m07:29:41.433302 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m07:29:41.433688 [info ] [MainThread]: 
[0m07:29:41.434270 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m07:29:41.434215 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.434895 [debug] [MainThread]: Command end result
[0m07:29:41.434878 [debug] [MainThread]: On master: BEGIN
[0m07:29:41.435292 [info ] [MainThread]: 
[0m07:29:41.435435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:41.435842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:41.436429 [info ] [MainThread]: 
[0m07:29:41.436964 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:41.437880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6773148, "process_user_time": 2.706075, "process_kernel_time": 0.193526, "process_mem_max_rss": "113048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:41.438520 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:41.438440 after 7.68 seconds
[0m07:29:41.438954 [debug] [MainThread]: Flushing usage events
[0m07:29:43.366404 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:43.370743 | 1b453061-20e1-448f-b18d-4be5d1f1d653 ==============================
[0m07:29:43.370743 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:43.371414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:43.375114 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:43.379319 | df13ceec-e77f-48af-bc53-0e5292d13745 ==============================
[0m07:29:43.379319 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:43.379862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:29:43.490095 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:43.501920 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:43.502009 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:43.513187 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:43.713144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:43.713805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:43.713453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:43.715214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:43.756175 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:43.757578 [info ] [MainThread]: 
[0m07:29:43.758287 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:43.759210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:43.765151 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:43.766444 [info ] [MainThread]: 
[0m07:29:43.767010 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:43.768476 [debug] [MainThread]: Command end result
[0m07:29:43.769346 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42291534, "process_user_time": 0.987886, "process_kernel_time": 0.067885, "process_mem_max_rss": "97956", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:43.770194 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:43.770107 after 0.42 seconds
[0m07:29:43.770733 [debug] [MainThread]: Flushing usage events
[0m07:29:43.781909 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:43.782576 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:43.783119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:43.789233 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m07:29:43.790495 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:43.794317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:29:43.794860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:43.799277 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:43.801170 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:43.801696 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:43.802333 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:43.802879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:43.803372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:43.807992 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:29:43.808660 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:43.809794 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:43.812176 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m07:29:43.813432 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:43.814106 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:46.172328 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:29:46.173316 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:46.173872 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:46.176438 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m07:29:46.177753 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:46.178461 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:46.183540 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.187261 [debug] [MainThread]: On master: BEGIN
[0m07:29:46.190801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:46.253906 [debug] [ThreadPool]: SQL status: BEGIN in 5.032 seconds
[0m07:29:46.271927 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:46.284732 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:46.288338 [debug] [Thread-1 (]: SQL status: BEGIN in 5.011 seconds
[0m07:29:46.289179 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:29:46.289679 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m07:29:46.290040 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m07:29:46.291329 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:46.291639 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:29:46.292212 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:46.297158 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:29:46.298033 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m07:29:46.299167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:29:46.301813 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.305817 [debug] [MainThread]: On master: BEGIN
[0m07:29:46.306496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:46.315948 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m07:29:46.316692 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m07:29:46.316688 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:29:46.317163 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.317663 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m07:29:46.318205 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:46.319713 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:29:46.322137 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m07:29:46.324362 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m07:29:46.325630 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:46.328781 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:29:46.329394 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.329819 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m07:29:46.330145 [debug] [MainThread]: On master: BEGIN
[0m07:29:46.330664 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:46.330738 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:29:46.332557 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m07:29:46.332916 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.334306 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 5.09s]
[0m07:29:46.334714 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.335217 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m07:29:46.335551 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.336015 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:46.336459 [debug] [MainThread]: On master: Close
[0m07:29:46.336960 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:46.336723 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.337375 [info ] [MainThread]: 
[0m07:29:46.337692 [debug] [MainThread]: On master: BEGIN
[0m07:29:46.341207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:46.345425 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m07:29:46.346456 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m07:29:46.346117 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:46.347150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m07:29:46.347494 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.347840 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m07:29:46.348140 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.352178 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.353351 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m07:29:46.353897 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:46.354480 [debug] [MainThread]: On master: Close
[0m07:29:46.354579 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m07:29:46.355148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:46.356273 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m07:29:46.356730 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:29:46.359284 [info ] [MainThread]: 
[0m07:29:46.359793 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m07:29:46.360413 [debug] [MainThread]: Command end result
[0m07:29:46.360733 [info ] [MainThread]: 
[0m07:29:46.361102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:46.361420 [info ] [MainThread]: 
[0m07:29:46.365240 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:46.370562 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.475563, "process_user_time": 2.682901, "process_kernel_time": 0.168576, "process_mem_max_rss": "112544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:46.372369 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:46.372266 after 12.48 seconds
[0m07:29:46.372818 [debug] [MainThread]: Flushing usage events
[0m07:29:46.382369 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m07:29:46.383491 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:29:46.383796 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m07:29:46.384075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:46.388829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:29:46.389564 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:29:46.389966 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m07:29:46.391354 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:29:46.396532 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:29:46.397249 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m07:29:46.398124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:29:46.405507 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m07:29:46.405854 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:29:46.406304 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m07:29:46.407498 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:29:46.411503 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m07:29:46.414728 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:29:46.415193 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m07:29:46.415673 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:46.417291 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m07:29:46.418628 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m07:29:46.419423 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m07:29:46.420735 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.421203 [debug] [MainThread]: On master: BEGIN
[0m07:29:46.421488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:46.427363 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:29:46.428078 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.428736 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.429179 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.429816 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:46.432899 [debug] [MainThread]: On master: Close
[0m07:29:46.433420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:46.433751 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m07:29:46.434157 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:29:46.434593 [info ] [MainThread]: 
[0m07:29:46.434943 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.27 seconds (10.27s).
[0m07:29:46.435597 [debug] [MainThread]: Command end result
[0m07:29:46.435983 [info ] [MainThread]: 
[0m07:29:46.436394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:46.436726 [info ] [MainThread]: 
[0m07:29:46.437082 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:46.437767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.736775, "process_user_time": 2.663996, "process_kernel_time": 0.165745, "process_mem_max_rss": "112580", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:46.438208 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:46.438153 after 12.74 seconds
[0m07:29:46.438576 [debug] [MainThread]: Flushing usage events
[0m07:29:46.440616 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m07:29:46.443361 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.444064 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.444624 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.446007 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:46.450245 [debug] [MainThread]: On master: Close
[0m07:29:46.450820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:46.451197 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m07:29:46.451633 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:29:46.452091 [info ] [MainThread]: 
[0m07:29:46.452464 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.27 seconds (10.27s).
[0m07:29:46.453063 [debug] [MainThread]: Command end result
[0m07:29:46.453439 [info ] [MainThread]: 
[0m07:29:46.453895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:46.454272 [info ] [MainThread]: 
[0m07:29:46.454669 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:46.455487 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.586031, "process_user_time": 2.836276, "process_kernel_time": 0.176773, "process_mem_max_rss": "114608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:46.458622 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:46.458482 after 12.59 seconds
[0m07:29:46.459178 [debug] [MainThread]: Flushing usage events
[0m07:29:48.502232 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:48.507804 | b70abfa3-d667-413b-9bb6-67b8a7cd8b73 ==============================
[0m07:29:48.507804 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:48.509502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'send_anonymous_usage_stats': 'True'}
[0m07:29:48.516842 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:48.521995 | 648d185e-0b95-469b-b76b-0777ee112a50 ==============================
[0m07:29:48.521995 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:48.522609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'send_anonymous_usage_stats': 'True'}
[0m07:29:48.528283 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:48.538554 | 673b8ac0-6fdd-49ff-a3a9-3ecd27d976c4 ==============================
[0m07:29:48.538554 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:48.535054 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:29:48.539519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 07:29:48.540793 | 64bd2480-c37a-483d-90d1-d19e45933986 ==============================
[0m07:29:48.540793 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:48.541897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:48.650051 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:48.663811 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:48.664995 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:48.667673 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:48.684243 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:48.686887 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:48.695933 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:48.715909 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:48.816129 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m07:29:48.834283 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:48.842413 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:48.845704 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:48.848035 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:48.849208 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:48.854343 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:48.855526 [debug] [MainThread]: On master: BEGIN
[0m07:29:48.858983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:48.871857 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m07:29:48.875291 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:48.879361 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:48.884987 [debug] [MainThread]: SQL status: SELECT 4 in 0.003 seconds
[0m07:29:48.888283 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:48.890387 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:48.892793 [debug] [MainThread]: On master: BEGIN
[0m07:29:48.896216 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:29:48.897923 [debug] [MainThread]: On master: COMMIT
[0m07:29:48.899482 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:48.900743 [debug] [MainThread]: On master: COMMIT
[0m07:29:48.902457 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:48.903869 [debug] [MainThread]: On master: Close
[0m07:29:48.905742 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:48.907490 [info ] [MainThread]: 
[0m07:29:48.919130 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m07:29:48.920214 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m07:29:48.921236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_resellers)
[0m07:29:48.921784 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m07:29:48.926979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:48.927748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:48.930497 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m07:29:48.931359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:48.932111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:48.932558 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m07:29:48.939262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:48.939936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:48.959776 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m07:29:48.962359 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:29:48.962632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:48.963317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:48.963306 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m07:29:48.965926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:48.975194 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:48.976640 [info ] [MainThread]: 
[0m07:29:48.977272 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:48.978168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:48.986399 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:48.987827 [info ] [MainThread]: 
[0m07:29:48.988446 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:48.989888 [debug] [MainThread]: Command end result
[0m07:29:48.990658 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5173834, "process_user_time": 0.9798, "process_kernel_time": 0.05929, "process_mem_max_rss": "97580", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:48.991202 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:48.991134 after 0.52 seconds
[0m07:29:48.991748 [debug] [MainThread]: Flushing usage events
[0m07:29:49.000704 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:49.002014 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:49.001504 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:49.003538 [info ] [MainThread]: 
[0m07:29:49.004157 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:49.004109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:49.005688 [debug] [MainThread]: Command end result
[0m07:29:49.006538 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.53415614, "process_user_time": 1.009685, "process_kernel_time": 0.060824, "process_mem_max_rss": "97584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:49.007254 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:49.007147 after 0.53 seconds
[0m07:29:49.007751 [debug] [MainThread]: Flushing usage events
[0m07:29:49.017662 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:49.018977 [info ] [MainThread]: 
[0m07:29:49.019474 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:49.021082 [debug] [MainThread]: Command end result
[0m07:29:49.021969 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.52163655, "process_user_time": 1.02789, "process_kernel_time": 0.052608, "process_mem_max_rss": "97500", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:49.022490 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:49.022421 after 0.52 seconds
[0m07:29:49.022827 [debug] [MainThread]: Flushing usage events
[0m07:29:51.197178 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m07:29:51.203988 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:51.204532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:51.208796 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m07:29:51.209855 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:51.210431 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:51.210742 [debug] [MainThread]: On master: BEGIN
[0m07:29:51.211310 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:29:51.211680 [debug] [MainThread]: On master: COMMIT
[0m07:29:51.212138 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:51.212625 [debug] [MainThread]: On master: COMMIT
[0m07:29:51.214191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:51.214613 [debug] [MainThread]: On master: Close
[0m07:29:51.215132 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:51.218891 [info ] [MainThread]: 
[0m07:29:51.224060 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m07:29:51.224987 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m07:29:51.225895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m07:29:51.226326 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m07:29:51.231914 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m07:29:51.233543 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m07:29:51.257502 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m07:29:51.259250 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:29:51.259686 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m07:29:51.259993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:51.264775 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:29:51.265245 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:29:51.265583 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m07:29:51.266963 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:29:51.271774 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:29:51.272383 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m07:29:51.273122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:29:51.282179 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m07:29:51.282826 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:29:51.283247 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m07:29:51.284063 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:29:51.288611 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m07:29:51.291987 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:29:51.292628 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m07:29:51.293491 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:51.295254 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m07:29:51.296552 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m07:29:51.297279 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m07:29:51.298417 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:51.298892 [debug] [MainThread]: On master: BEGIN
[0m07:29:51.299387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:51.304319 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:51.307619 [debug] [MainThread]: On master: COMMIT
[0m07:29:51.308288 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:51.308838 [debug] [MainThread]: On master: COMMIT
[0m07:29:51.309440 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:51.310065 [debug] [MainThread]: On master: Close
[0m07:29:51.310714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:51.311205 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m07:29:51.311615 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:29:51.312018 [info ] [MainThread]: 
[0m07:29:51.312398 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.22 seconds (15.22s).
[0m07:29:51.313019 [debug] [MainThread]: Command end result
[0m07:29:51.313407 [info ] [MainThread]: 
[0m07:29:51.313827 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:51.314206 [info ] [MainThread]: 
[0m07:29:51.314591 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:51.315333 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.473646, "process_user_time": 2.610602, "process_kernel_time": 0.188161, "process_mem_max_rss": "112564", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:51.316079 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:51.316007 after 17.47 seconds
[0m07:29:51.316505 [debug] [MainThread]: Flushing usage events
[0m07:29:53.531090 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:53.535801 | 57545678-4e60-4baa-9470-83dc93a2e375 ==============================
[0m07:29:53.535801 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:53.536989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:53.559273 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:53.567730 | 219b2cfc-edbe-47e9-bc7e-d8b20933ff4c ==============================
[0m07:29:53.567730 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:53.569136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:53.670171 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:53.685549 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:53.713488 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:53.747973 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:53.840377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:53.840802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:53.893360 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:53.895144 [info ] [MainThread]: 
[0m07:29:53.895742 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:53.897139 [debug] [MainThread]: Command end result
[0m07:29:53.897801 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.39876312, "process_user_time": 1.007807, "process_kernel_time": 0.062924, "process_mem_max_rss": "97712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:53.898249 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:53.898188 after 0.40 seconds
[0m07:29:53.898553 [debug] [MainThread]: Flushing usage events
[0m07:29:53.917061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:53.919894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:53.965693 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:53.967367 [info ] [MainThread]: 
[0m07:29:53.968112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:53.969049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:53.976505 [debug] [Thread-1 (]: SQL status: BEGIN in 5.011 seconds
[0m07:29:53.977646 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:29:53.978302 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m07:29:53.981253 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m07:29:53.988398 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:29:53.989933 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m07:29:53.992570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:29:53.996496 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:53.997220 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:53.997779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:54.002977 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m07:29:54.003662 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:29:54.003596 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m07:29:54.004186 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m07:29:54.005145 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:54.005288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:29:54.011147 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.007 seconds
[0m07:29:54.012315 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m07:29:54.016059 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:29:54.013292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:29:54.014168 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:54.016550 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m07:29:54.017593 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:54.019631 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m07:29:54.021369 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 5.10s]
[0m07:29:54.020646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:29:54.022157 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m07:29:54.013882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:54.023343 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:54.023721 [debug] [MainThread]: On master: BEGIN
[0m07:29:54.024046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:54.021340 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:54.024396 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:54.025367 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:54.026018 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:54.026573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:54.021158 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:29:54.027103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:54.029103 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:54.027097 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:54.030215 [debug] [MainThread]: On master: COMMIT
[0m07:29:54.031275 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:54.029437 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:54.031962 [debug] [MainThread]: On master: COMMIT
[0m07:29:54.032088 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:29:54.030742 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:54.033165 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:54.033201 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:54.032542 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:54.033884 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:54.034255 [debug] [MainThread]: On master: Close
[0m07:29:54.033493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:54.034587 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:29:54.035777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:54.034886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:54.036879 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:54.037365 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:29:54.037259 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m07:29:54.038643 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m07:29:54.040282 [info ] [MainThread]: 
[0m07:29:54.038208 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:54.041015 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m07:29:54.040475 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:29:54.039836 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:54.042121 [debug] [MainThread]: Command end result
[0m07:29:54.042595 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:54.043332 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:54.043298 [info ] [MainThread]: 
[0m07:29:54.043986 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:54.044793 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:54.043985 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:54.045406 [info ] [MainThread]: 
[0m07:29:54.046414 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:54.046871 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:54.046859 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:54.048042 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:54.047425 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:54.048784 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.711782, "process_user_time": 1.119041, "process_kernel_time": 0.062674, "process_mem_max_rss": "108808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:54.049364 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:54.049842 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:54.049713 after 10.71 seconds
[0m07:29:54.050599 [debug] [MainThread]: Flushing usage events
[0m07:29:54.053257 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:54.056922 [debug] [MainThread]: On master: BEGIN
[0m07:29:54.061944 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:54.067205 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:54.071442 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:54.075064 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:54.079382 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m07:29:54.080844 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:54.081442 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:54.081813 [debug] [MainThread]: On master: BEGIN
[0m07:29:54.091606 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m07:29:54.096927 [debug] [MainThread]: On master: COMMIT
[0m07:29:54.114005 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:54.130434 [debug] [MainThread]: On master: COMMIT
[0m07:29:54.152230 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:29:54.174379 [debug] [MainThread]: On master: Close
[0m07:29:54.177226 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:54.178354 [info ] [MainThread]: 
[0m07:29:54.184407 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m07:29:54.185512 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m07:29:54.186186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m07:29:54.186654 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m07:29:54.193389 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m07:29:54.195200 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m07:29:54.221875 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m07:29:54.224288 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:29:54.225189 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m07:29:54.225602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:56.572641 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:56.577138 | 4605d570-99ca-4975-8640-9284e94893de ==============================
[0m07:29:56.577138 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:56.577929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:29:56.580297 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:56.584816 | c0855b65-f2ad-4645-a5aa-ef215c51c3ec ==============================
[0m07:29:56.584816 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:56.585265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:29:56.733202 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:56.739884 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:56.795848 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:56.828130 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:56.983174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:56.986890 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:56.993879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:56.995020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:57.043553 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:57.044888 [info ] [MainThread]: 
[0m07:29:57.045412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:57.049005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:57.059726 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:57.070133 [info ] [MainThread]: 
[0m07:29:57.085469 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:57.095803 [debug] [MainThread]: Command end result
[0m07:29:57.096718 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.54790956, "process_user_time": 1.014418, "process_kernel_time": 0.066288, "process_mem_max_rss": "97588", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:57.097232 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:57.097170 after 0.55 seconds
[0m07:29:57.097584 [debug] [MainThread]: Flushing usage events
[0m07:29:57.111437 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:57.112130 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:57.113536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:59.054517 [debug] [ThreadPool]: SQL status: BEGIN in 5.020 seconds
[0m07:29:59.066526 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:59.071455 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:59.094241 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m07:29:59.107926 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:59.109787 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:59.115148 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:59.115956 [debug] [MainThread]: On master: BEGIN
[0m07:29:59.116407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:59.229667 [debug] [Thread-1 (]: SQL status: BEGIN in 5.004 seconds
[0m07:29:59.231147 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:29:59.231654 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m07:29:59.233071 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:29:59.237344 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:29:59.239351 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m07:29:59.240110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:29:59.248888 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m07:29:59.250936 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:29:59.252210 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m07:29:59.253442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:29:59.257618 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m07:29:59.260533 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:29:59.261026 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m07:29:59.261713 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:59.263982 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m07:29:59.268693 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 5.08s]
[0m07:29:59.271092 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m07:29:59.272348 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:59.272743 [debug] [MainThread]: On master: BEGIN
[0m07:29:59.273181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:02.135372 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.022 seconds
[0m07:30:02.152695 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:02.169544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:30:02.171985 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:30:02.184012 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:02.187114 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:02.187649 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:02.188088 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:02.188501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:02.188889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:02.193615 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:30:02.197094 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:02.197657 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:02.199852 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:02.200873 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:02.201271 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:04.134225 [debug] [MainThread]: SQL status: BEGIN in 5.018 seconds
[0m07:30:04.169210 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:04.183307 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:04.187944 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m07:30:04.189518 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:04.190085 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:04.190425 [debug] [MainThread]: On master: BEGIN
[0m07:30:04.190978 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:04.191786 [debug] [MainThread]: On master: COMMIT
[0m07:30:04.192336 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:04.192844 [debug] [MainThread]: On master: COMMIT
[0m07:30:04.193634 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:04.194031 [debug] [MainThread]: On master: Close
[0m07:30:04.194464 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:04.194779 [info ] [MainThread]: 
[0m07:30:04.199942 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m07:30:04.200588 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m07:30:04.201227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_product)
[0m07:30:04.201745 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m07:30:04.207681 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m07:30:04.209420 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m07:30:04.233224 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m07:30:04.234751 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:30:04.235342 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m07:30:04.235892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:04.240114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:30:04.240633 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:30:04.241253 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m07:30:04.244712 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m07:30:04.250211 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:30:04.252621 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m07:30:04.253529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:04.263007 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m07:30:04.263538 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:30:04.264011 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m07:30:04.265160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:04.269468 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m07:30:04.272449 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:30:04.272886 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m07:30:04.273409 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:30:04.275058 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m07:30:04.276647 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m07:30:04.277697 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m07:30:04.280427 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:04.280719 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m07:30:04.281280 [debug] [MainThread]: On master: BEGIN
[0m07:30:04.281691 [debug] [MainThread]: On master: COMMIT
[0m07:30:04.282026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:04.282425 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:04.283068 [debug] [MainThread]: On master: COMMIT
[0m07:30:04.283677 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:04.284180 [debug] [MainThread]: On master: Close
[0m07:30:04.284822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:04.285201 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:30:04.285658 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m07:30:04.286293 [info ] [MainThread]: 
[0m07:30:04.286813 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m07:30:04.287042 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:30:04.287793 [debug] [MainThread]: Command end result
[0m07:30:04.288208 [debug] [MainThread]: On master: COMMIT
[0m07:30:04.288687 [info ] [MainThread]: 
[0m07:30:04.289213 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:04.289885 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:04.290371 [debug] [MainThread]: On master: COMMIT
[0m07:30:04.290772 [info ] [MainThread]: 
[0m07:30:04.291518 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:04.292050 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:30:04.293608 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.77187, "process_user_time": 1.136317, "process_kernel_time": 0.071789, "process_mem_max_rss": "106688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:04.294210 [debug] [MainThread]: On master: Close
[0m07:30:04.294799 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:04.294701 after 10.77 seconds
[0m07:30:04.295512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:04.296062 [debug] [MainThread]: Flushing usage events
[0m07:30:04.296693 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:30:04.300951 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m07:30:04.301437 [info ] [MainThread]: 
[0m07:30:04.301868 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.32 seconds (15.32s).
[0m07:30:04.302568 [debug] [MainThread]: Command end result
[0m07:30:04.302972 [info ] [MainThread]: 
[0m07:30:04.303419 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:04.303738 [info ] [MainThread]: 
[0m07:30:04.304060 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:04.304670 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.882617, "process_user_time": 1.119602, "process_kernel_time": 0.077456, "process_mem_max_rss": "106428", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:04.305128 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:04.305078 after 15.88 seconds
[0m07:30:04.307496 [debug] [MainThread]: Flushing usage events
[0m07:30:06.555240 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:06.559510 | 804b3175-a98f-475d-98f8-f87a1d42c2e7 ==============================
[0m07:30:06.559510 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:06.560063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:06.602432 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:30:06.599748 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:06.623362 | a90e3f46-79f9-4eee-8405-45d1eb5946a8 ==============================
[0m07:30:06.623362 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:30:06.624430 | 92b76559-a9ac-4cd2-9959-9c8d7da9dcee ==============================
[0m07:30:06.624430 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:06.630976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:30:06.638081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:06.622222 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:06.653020 | 74ec24a7-ce0e-4073-b31b-3fa69a7d2a81 ==============================
[0m07:30:06.653020 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:06.653674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:06.783276 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:06.797227 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:06.812417 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:06.813746 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:06.818913 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:06.825081 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:06.831719 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:06.838848 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:07.002619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:07.003313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:07.003637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:07.004372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:07.016692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:07.017484 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:07.040816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:07.042365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:07.065628 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:07.066750 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:07.067983 [info ] [MainThread]: 
[0m07:30:07.068071 [info ] [MainThread]: 
[0m07:30:07.069729 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:07.069809 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:07.071387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:07.071299 [debug] [MainThread]: Command end result
[0m07:30:07.071391 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:07.072260 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5336574, "process_user_time": 1.001733, "process_kernel_time": 0.043421, "process_mem_max_rss": "97584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:07.072786 [info ] [MainThread]: 
[0m07:30:07.072891 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:07.072813 after 0.53 seconds
[0m07:30:07.073236 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:07.073390 [debug] [MainThread]: Flushing usage events
[0m07:30:07.074528 [debug] [MainThread]: Command end result
[0m07:30:07.075301 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.53641236, "process_user_time": 0.971673, "process_kernel_time": 0.064442, "process_mem_max_rss": "97800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:07.076017 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:07.075926 after 0.54 seconds
[0m07:30:07.076490 [debug] [MainThread]: Flushing usage events
[0m07:30:07.089725 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:07.091559 [info ] [MainThread]: 
[0m07:30:07.092526 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:07.093541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:07.095215 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:07.095951 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:07.097260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:07.104312 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m07:30:07.105666 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:07.110407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:30:07.111204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:30:07.115818 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:07.118103 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:07.117721 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:07.118810 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:07.118379 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:07.119486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:07.119048 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:07.119624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:07.120412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:07.193103 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:30:07.193801 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:07.194366 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:07.196664 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m07:30:07.197992 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:07.198737 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:07.203594 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:07.204150 [debug] [MainThread]: On master: BEGIN
[0m07:30:07.204705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:12.125622 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:30:12.126554 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:12.127253 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:12.129401 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:12.130784 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:12.130896 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.011 seconds
[0m07:30:12.131167 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m07:30:12.131713 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:12.132362 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:12.131951 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:12.133440 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:12.137430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:30:12.139035 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m07:30:12.140376 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:12.141023 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:12.138085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:30:12.146159 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.146767 [debug] [MainThread]: On master: BEGIN
[0m07:30:12.147222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:12.142780 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:12.147509 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:12.148133 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:12.148624 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:12.149102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:12.149613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:12.154644 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:30:12.155048 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:30:12.156097 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:12.156633 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:12.157108 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:12.157646 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:12.160039 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m07:30:12.160404 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:12.161655 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:12.162654 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:12.163245 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:12.163585 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:12.168675 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.169212 [debug] [MainThread]: On master: BEGIN
[0m07:30:12.169633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:12.174128 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:30:12.174971 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.175921 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:12.180410 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m07:30:12.182140 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:12.182723 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.183173 [debug] [MainThread]: On master: BEGIN
[0m07:30:12.183723 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:12.184299 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.184811 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.185195 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.185836 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:12.186363 [debug] [MainThread]: On master: Close
[0m07:30:12.187009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:12.187411 [info ] [MainThread]: 
[0m07:30:12.193846 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m07:30:12.194740 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m07:30:12.195491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m07:30:12.195995 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m07:30:12.201728 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m07:30:12.209663 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m07:30:12.226515 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.238378 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m07:30:12.240069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:12.253025 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m07:30:12.254714 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:12.255304 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.255674 [debug] [MainThread]: On master: BEGIN
[0m07:30:12.256192 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:12.262026 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.262487 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.262931 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.264056 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:12.264386 [debug] [MainThread]: On master: Close
[0m07:30:12.265882 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:12.266731 [info ] [MainThread]: 
[0m07:30:12.286270 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m07:30:12.287525 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m07:30:12.288975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m07:30:12.289546 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m07:30:12.295244 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m07:30:12.295943 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m07:30:12.296631 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m07:30:12.304640 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:30:12.306633 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m07:30:12.308525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:12.316279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:30:12.318531 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:30:12.320153 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m07:30:12.324208 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m07:30:12.325344 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m07:30:12.329152 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:30:12.329598 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m07:30:12.330865 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:30:12.331244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:12.331563 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m07:30:12.332499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:12.338793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:30:12.340947 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:30:12.341328 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    reseller_id AS sales_agent_key,
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m07:30:12.345657 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m07:30:12.346408 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:30:12.346830 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m07:30:12.347211 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m07:30:12.351883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:30:12.351942 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:30:12.356244 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m07:30:12.356601 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m07:30:12.359929 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:30:12.360700 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m07:30:12.361095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:30:12.362525 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:30:12.369007 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m07:30:12.371871 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m07:30:12.371976 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.18s]
[0m07:30:12.372462 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:30:12.373029 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m07:30:12.373412 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m07:30:12.374449 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:12.374519 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.378717 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m07:30:12.379181 [debug] [MainThread]: On master: BEGIN
[0m07:30:12.382333 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:30:12.382775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:12.383230 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m07:30:12.384109 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:30:12.386468 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m07:30:12.389293 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.10s]
[0m07:30:12.389881 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:30:12.390654 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m07:30:12.391133 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.391683 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.392305 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.392903 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:12.392550 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.393409 [debug] [MainThread]: On master: Close
[0m07:30:12.393801 [debug] [MainThread]: On master: BEGIN
[0m07:30:12.394248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:12.394606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:12.394912 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:30:12.395449 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m07:30:12.396055 [info ] [MainThread]: 
[0m07:30:12.396442 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m07:30:12.397034 [debug] [MainThread]: Command end result
[0m07:30:12.398689 [info ] [MainThread]: 
[0m07:30:12.399173 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:12.399699 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:30:12.400058 [info ] [MainThread]: 
[0m07:30:12.400552 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.400956 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:12.401335 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.402031 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8719764, "process_user_time": 1.176954, "process_kernel_time": 0.063755, "process_mem_max_rss": "106268", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:12.402545 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.403164 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:12.403072 after 5.87 seconds
[0m07:30:12.403819 [debug] [MainThread]: Flushing usage events
[0m07:30:12.404113 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:12.411469 [debug] [MainThread]: On master: Close
[0m07:30:12.415352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:12.415875 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m07:30:12.416162 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:30:12.416475 [info ] [MainThread]: 
[0m07:30:12.416883 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.37 seconds (15.37s).
[0m07:30:12.417617 [debug] [MainThread]: Command end result
[0m07:30:12.418135 [info ] [MainThread]: 
[0m07:30:12.418621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:12.419002 [info ] [MainThread]: 
[0m07:30:12.420893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:12.425225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.910179, "process_user_time": 1.170893, "process_kernel_time": 0.075083, "process_mem_max_rss": "106336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:12.428080 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:12.427955 after 15.91 seconds
[0m07:30:12.428637 [debug] [MainThread]: Flushing usage events
[0m07:30:14.602137 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:14.606537 | 4c9e0d3b-f27a-441a-8af3-d7a9d694035a ==============================
[0m07:30:14.606537 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:14.603408 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:30:14.607086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 07:30:14.608052 | d3db8edc-dffe-428d-8237-b53828089333 ==============================
[0m07:30:14.608052 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:14.609219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:14.638522 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:14.642872 | 34c5be74-73b2-409f-9d26-fa4841697583 ==============================
[0m07:30:14.642872 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:14.643362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:14.741577 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:14.740325 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:14.753991 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:14.758914 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:14.775377 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:14.793344 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:14.899108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:14.899731 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:14.910737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:14.911465 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:14.939067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:14.939804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:14.973344 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:14.978394 [info ] [MainThread]: 
[0m07:30:14.985319 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:14.985791 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:14.988152 [info ] [MainThread]: 
[0m07:30:14.992387 [debug] [MainThread]: Command end result
[0m07:30:14.991572 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:14.997536 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.43055493, "process_user_time": 0.968631, "process_kernel_time": 0.047176, "process_mem_max_rss": "97596", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:15.004687 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:15.005206 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:15.004845 after 0.44 seconds
[0m07:30:15.005990 [info ] [MainThread]: 
[0m07:30:15.006050 [debug] [MainThread]: Flushing usage events
[0m07:30:15.008191 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:15.006466 [debug] [MainThread]: Command end result
[0m07:30:15.010173 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44306204, "process_user_time": 0.978879, "process_kernel_time": 0.051782, "process_mem_max_rss": "97576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:15.011987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:15.013999 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:15.013885 after 0.45 seconds
[0m07:30:15.019974 [debug] [MainThread]: Flushing usage events
[0m07:30:15.041914 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:15.044239 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:15.045117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:17.150293 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m07:30:17.151864 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:17.155890 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:17.166016 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m07:30:17.167990 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:17.168619 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:17.169345 [debug] [MainThread]: On master: BEGIN
[0m07:30:17.171818 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:30:17.172280 [debug] [MainThread]: On master: COMMIT
[0m07:30:17.175933 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:17.179587 [debug] [MainThread]: On master: COMMIT
[0m07:30:17.182615 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:17.183053 [debug] [MainThread]: On master: Close
[0m07:30:17.183528 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:17.183936 [info ] [MainThread]: 
[0m07:30:17.189140 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m07:30:17.189761 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m07:30:17.190226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m07:30:17.190542 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m07:30:17.196262 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m07:30:17.197541 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m07:30:17.223666 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m07:30:17.225043 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:30:17.225452 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m07:30:17.225863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:17.230624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:30:17.232309 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:30:17.234352 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select product_id as product_key, product_id as original_product_id, product_name, geography_key , product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m07:30:17.243343 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.008 seconds
[0m07:30:17.248146 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:30:17.248622 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m07:30:17.249147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:17.261200 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m07:30:17.265352 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:30:17.265841 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m07:30:17.269817 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:17.278120 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m07:30:17.282616 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:30:17.283175 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m07:30:17.283918 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:30:17.286075 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m07:30:17.287953 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.10s]
[0m07:30:17.288826 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m07:30:17.290007 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:17.290408 [debug] [MainThread]: On master: BEGIN
[0m07:30:17.290764 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:17.298220 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:30:17.298973 [debug] [MainThread]: On master: COMMIT
[0m07:30:17.302862 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:17.303413 [debug] [MainThread]: On master: COMMIT
[0m07:30:17.304071 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:17.306803 [debug] [MainThread]: On master: Close
[0m07:30:17.307431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:17.307909 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:30:17.308396 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m07:30:17.308918 [info ] [MainThread]: 
[0m07:30:17.309276 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m07:30:17.309850 [debug] [MainThread]: Command end result
[0m07:30:17.310130 [info ] [MainThread]: 
[0m07:30:17.310499 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:17.310877 [info ] [MainThread]: 
[0m07:30:17.311210 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:17.312103 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.801371, "process_user_time": 1.107668, "process_kernel_time": 0.071952, "process_mem_max_rss": "108432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:17.312800 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:17.312634 after 10.80 seconds
[0m07:30:17.313231 [debug] [MainThread]: Flushing usage events
[0m07:30:18.794090 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:18.798678 | fd492710-f048-493e-9613-ddf85196783a ==============================
[0m07:30:18.798678 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:18.799526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:30:18.927485 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:18.941328 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:19.145831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:19.146342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:19.197050 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:19.198496 [info ] [MainThread]: 
[0m07:30:19.199059 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:19.200610 [debug] [MainThread]: Command end result
[0m07:30:19.201519 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44298387, "process_user_time": 1.008424, "process_kernel_time": 0.068109, "process_mem_max_rss": "97480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:19.203049 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:19.202947 after 0.44 seconds
[0m07:30:19.204176 [debug] [MainThread]: Flushing usage events
[0m07:30:20.045651 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.007 seconds
[0m07:30:20.048715 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:20.056491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:30:20.056989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:30:20.063938 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:20.066131 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:20.066403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:20.065691 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:20.067071 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:20.067404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:25.073024 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:30:25.074806 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:25.075607 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:25.074124 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m07:30:25.077988 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:25.078577 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:25.079130 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:25.080413 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:25.080683 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m07:30:25.082280 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:25.081172 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:25.083607 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:25.090126 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:25.091872 [debug] [MainThread]: On master: BEGIN
[0m07:30:25.096096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:25.103602 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:30:25.106746 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:25.107741 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:25.112778 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m07:30:25.114424 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:25.115081 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:25.115468 [debug] [MainThread]: On master: BEGIN
[0m07:30:25.116011 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:25.116642 [debug] [MainThread]: On master: COMMIT
[0m07:30:25.117117 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:25.117602 [debug] [MainThread]: On master: COMMIT
[0m07:30:25.118338 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:25.118861 [debug] [MainThread]: On master: Close
[0m07:30:25.119475 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:25.120309 [info ] [MainThread]: 
[0m07:30:25.130428 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m07:30:25.131140 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m07:30:25.131710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m07:30:25.132187 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m07:30:25.145797 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m07:30:25.147151 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m07:30:25.169347 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m07:30:25.174638 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:30:25.175371 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m07:30:25.177252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:25.181402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:30:25.182116 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:30:25.186107 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m07:30:25.190930 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m07:30:25.195822 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:30:25.196339 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m07:30:25.197095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:25.205631 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m07:30:25.206119 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:30:25.206846 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m07:30:25.207928 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:25.213406 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m07:30:25.216656 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:30:25.217020 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m07:30:25.217737 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:30:25.219804 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m07:30:25.221146 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m07:30:25.221809 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m07:30:25.222974 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:25.225260 [debug] [MainThread]: On master: BEGIN
[0m07:30:25.225911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:25.232383 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:30:25.233104 [debug] [MainThread]: On master: COMMIT
[0m07:30:25.233622 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:25.234030 [debug] [MainThread]: On master: COMMIT
[0m07:30:25.234846 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:25.235352 [debug] [MainThread]: On master: Close
[0m07:30:25.236807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:25.238849 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:30:25.239265 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m07:30:25.239742 [info ] [MainThread]: 
[0m07:30:25.244533 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.23 seconds (10.23s).
[0m07:30:25.245423 [debug] [MainThread]: Command end result
[0m07:30:25.248867 [info ] [MainThread]: 
[0m07:30:25.249334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:25.249711 [info ] [MainThread]: 
[0m07:30:25.251411 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:25.252656 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.650894, "process_user_time": 1.103755, "process_kernel_time": 0.074796, "process_mem_max_rss": "108468", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:25.254668 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:25.254583 after 10.65 seconds
[0m07:30:25.256846 [debug] [MainThread]: Flushing usage events
[0m07:30:26.785636 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:26.790285 | 1d97d14c-fa04-4db1-ba4c-dd70f499d2d2 ==============================
[0m07:30:26.790285 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:26.790868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'send_anonymous_usage_stats': 'True'}
[0m07:30:26.802469 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:26.808684 | 7694b5cc-96fc-4678-adac-a28b4abd1d7c ==============================
[0m07:30:26.808684 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:26.809296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:30:26.979933 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:26.991908 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:26.999477 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:27.013191 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:27.163751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:27.164352 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:27.180939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:27.182796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:27.227589 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:27.228842 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:27.230104 [info ] [MainThread]: 
[0m07:30:27.231277 [info ] [MainThread]: 
[0m07:30:27.231762 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:27.232349 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:27.233841 [debug] [MainThread]: Command end result
[0m07:30:27.234759 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:27.234990 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48526797, "process_user_time": 1.025972, "process_kernel_time": 0.066647, "process_mem_max_rss": "97104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:27.235592 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:27.235516 after 0.49 seconds
[0m07:30:27.235947 [debug] [MainThread]: Flushing usage events
[0m07:30:27.258978 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:27.259855 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:27.261063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:27.271143 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m07:30:27.274672 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:27.278553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:30:27.279368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:30:27.283973 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:27.285835 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:27.286207 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:27.286627 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:27.293938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:27.289625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:32.298778 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:30:32.299209 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:30:32.302058 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:32.302707 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:32.307862 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:32.307347 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:32.310264 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m07:30:32.311543 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:32.310538 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:32.313053 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:32.312168 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:32.313588 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:32.319240 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:32.324786 [debug] [MainThread]: On master: BEGIN
[0m07:30:32.328451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:32.344352 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m07:30:32.385487 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:32.386327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:32.394674 [debug] [MainThread]: SQL status: SELECT 12 in 0.007 seconds
[0m07:30:32.406143 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:32.407658 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:32.408219 [debug] [MainThread]: On master: BEGIN
[0m07:30:32.410893 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:30:32.411540 [debug] [MainThread]: On master: COMMIT
[0m07:30:32.413138 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:32.414419 [debug] [MainThread]: On master: COMMIT
[0m07:30:32.416698 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:32.419208 [debug] [MainThread]: On master: Close
[0m07:30:32.421253 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:32.421848 [info ] [MainThread]: 
[0m07:30:32.427049 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m07:30:32.427703 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m07:30:32.428425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m07:30:32.429029 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m07:30:32.434556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m07:30:32.436158 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m07:30:32.462739 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m07:30:32.464162 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:30:32.464575 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m07:30:32.464943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:32.469309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:30:32.469869 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:30:32.470215 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select customer_key, customer_first_name, customer_last_name, customer_email, sales_agent_key
from "sales_dw"."dev"."staging_customers"
  );
  
[0m07:30:33.337469 [debug] [Thread-1 (]: SQL status: SELECT 200000 in 0.867 seconds
[0m07:30:33.345234 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:30:33.345994 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m07:30:33.346741 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:33.358131 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m07:30:33.358827 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:30:33.359350 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m07:30:33.365298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m07:30:33.372434 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m07:30:33.376628 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:30:33.377242 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m07:30:33.379455 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:30:33.381559 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m07:30:33.383101 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 200000[0m in 0.95s]
[0m07:30:33.383775 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m07:30:33.385278 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:33.388034 [debug] [MainThread]: On master: BEGIN
[0m07:30:33.388365 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:33.392630 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:30:33.393275 [debug] [MainThread]: On master: COMMIT
[0m07:30:33.393892 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:33.394268 [debug] [MainThread]: On master: COMMIT
[0m07:30:33.394706 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:33.395191 [debug] [MainThread]: On master: Close
[0m07:30:33.395667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:33.395981 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m07:30:33.396341 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:30:33.396710 [info ] [MainThread]: 
[0m07:30:33.397137 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.16 seconds (6.16s).
[0m07:30:33.398006 [debug] [MainThread]: Command end result
[0m07:30:33.398519 [info ] [MainThread]: 
[0m07:30:33.399073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:33.400085 [info ] [MainThread]: 
[0m07:30:33.401564 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:33.402998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.638004, "process_user_time": 1.201181, "process_kernel_time": 0.071865, "process_mem_max_rss": "107784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:33.404544 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:33.404448 after 6.64 seconds
[0m07:30:33.406543 [debug] [MainThread]: Flushing usage events
[0m07:30:35.786968 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:35.792313 | 8b5896ae-82aa-4d18-add8-64692f8ddc98 ==============================
[0m07:30:35.792313 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:35.793346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:30:35.836703 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:35.842996 | 155d2b26-0270-4697-835d-dead7fff6b33 ==============================
[0m07:30:35.842996 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:35.843947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'send_anonymous_usage_stats': 'True'}
[0m07:30:35.843627 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:35.850598 | 29916685-20d8-461d-b8a9-74c3afd13270 ==============================
[0m07:30:35.850598 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:35.853003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:35.930900 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:35.947207 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:35.983884 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:36.000064 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:36.007416 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:36.027698 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:36.175687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:36.176430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:36.233217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:36.235199 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:36.241339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:36.242092 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:36.242471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:36.244123 [info ] [MainThread]: 
[0m07:30:36.248385 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:36.251205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:36.274952 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:36.275717 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:36.276283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:36.281197 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:36.282812 [info ] [MainThread]: 
[0m07:30:36.283473 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:36.284643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:36.298437 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:36.299779 [info ] [MainThread]: 
[0m07:30:36.300318 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:36.302100 [debug] [MainThread]: Command end result
[0m07:30:36.302867 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4966318, "process_user_time": 1.082372, "process_kernel_time": 0.07429, "process_mem_max_rss": "97448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:36.303480 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:36.303378 after 0.50 seconds
[0m07:30:36.303844 [debug] [MainThread]: Flushing usage events
[0m07:30:36.309373 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:36.313745 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:36.314482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:36.322167 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m07:30:36.323424 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:36.327680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:30:36.328374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:30:36.332939 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:36.335377 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:36.336099 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:36.336606 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:36.337111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:36.337515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:36.342795 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:30:36.343383 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:30:36.347149 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:36.348383 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:36.349379 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:36.350319 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:36.353741 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.001 seconds
[0m07:30:36.354061 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:36.355276 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:36.356412 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:36.357125 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:36.357580 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:36.363709 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:36.364409 [debug] [MainThread]: On master: BEGIN
[0m07:30:36.364833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:36.370220 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:30:36.371449 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:36.371974 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:36.377060 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:30:36.379412 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:36.380179 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:36.380818 [debug] [MainThread]: On master: BEGIN
[0m07:30:36.381758 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:36.382381 [debug] [MainThread]: On master: COMMIT
[0m07:30:36.382904 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:36.383347 [debug] [MainThread]: On master: COMMIT
[0m07:30:36.383975 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:36.384482 [debug] [MainThread]: On master: Close
[0m07:30:36.385298 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:36.385823 [info ] [MainThread]: 
[0m07:30:36.391582 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m07:30:36.392437 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m07:30:36.393053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_main)
[0m07:30:36.393607 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m07:30:36.409716 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m07:30:36.411616 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m07:30:36.455637 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m07:30:36.460033 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m07:30:36.461789 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m07:30:36.465875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:36.470585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:30:36.472154 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m07:30:36.474763 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m07:30:41.289746 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.013 seconds
[0m07:30:41.292699 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:41.300152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:30:41.300748 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:30:41.307427 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:41.309371 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:41.309924 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:41.310869 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:41.313129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:41.314807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:41.523623 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 5.047 seconds
[0m07:30:41.541200 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m07:30:41.545866 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m07:30:41.546271 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m07:30:41.563980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m07:30:41.565485 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m07:30:41.567294 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 5.17s]
[0m07:30:41.568260 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m07:30:41.569601 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:41.570056 [debug] [MainThread]: On master: BEGIN
[0m07:30:41.575887 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:46.332776 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m07:30:46.335382 [debug] [ThreadPool]: SQL status: BEGIN in 5.022 seconds
[0m07:30:46.346176 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:46.350002 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:46.354367 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:46.355978 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:46.359364 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.001 seconds
[0m07:30:46.362268 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m07:30:46.365251 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:46.375820 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:46.374984 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:46.381099 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:46.390099 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:46.392008 [debug] [MainThread]: On master: BEGIN
[0m07:30:46.395191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:46.401420 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:30:46.403983 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:46.405180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:46.412031 [debug] [MainThread]: SQL status: SELECT 12 in 0.006 seconds
[0m07:30:46.414539 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:46.418542 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:46.419503 [debug] [MainThread]: On master: BEGIN
[0m07:30:46.420817 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:46.424497 [debug] [MainThread]: On master: COMMIT
[0m07:30:46.425377 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:46.426106 [debug] [MainThread]: On master: COMMIT
[0m07:30:46.428049 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:46.428479 [debug] [MainThread]: On master: Close
[0m07:30:46.428991 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:46.430311 [info ] [MainThread]: 
[0m07:30:46.442463 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m07:30:46.445210 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m07:30:46.446024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_resellers_xml)
[0m07:30:46.446801 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m07:30:46.463109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:30:46.464534 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m07:30:46.503987 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:30:46.505482 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:30:46.506002 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m07:30:46.506426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:46.515073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:30:46.519288 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:30:46.520930 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 

  

trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  



)


SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m07:30:46.584619 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m07:30:46.588599 [debug] [MainThread]: On master: COMMIT
[0m07:30:46.589183 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:46.589748 [debug] [MainThread]: On master: COMMIT
[0m07:30:46.590436 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:46.592453 [debug] [MainThread]: On master: Close
[0m07:30:46.594029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:46.595042 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m07:30:46.595580 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:30:46.596039 [info ] [MainThread]: 
[0m07:30:46.596491 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.31 seconds (10.31s).
[0m07:30:46.597217 [debug] [MainThread]: Command end result
[0m07:30:46.597600 [info ] [MainThread]: 
[0m07:30:46.598062 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:46.598547 [info ] [MainThread]: 
[0m07:30:46.599087 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:46.600000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.798289, "process_user_time": 1.201238, "process_kernel_time": 0.084853, "process_mem_max_rss": "107008", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:46.600598 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:46.600518 after 10.80 seconds
[0m07:30:46.601098 [debug] [MainThread]: Flushing usage events
[0m07:30:46.853300 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.330 seconds
[0m07:30:46.879521 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m07:30:46.883465 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:30:46.884418 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m07:30:46.885483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:46.888434 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m07:30:46.890045 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 0[0m in 0.44s]
[0m07:30:46.892778 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m07:30:46.894384 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:46.900914 [debug] [MainThread]: On master: BEGIN
[0m07:30:46.901359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:49.034387 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:49.039290 | 6edd5f11-1e92-4f82-aa7e-56a9c187997f ==============================
[0m07:30:49.039290 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:49.039837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:49.196417 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:49.208858 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:49.440937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:49.445350 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:49.503193 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:49.504579 [info ] [MainThread]: 
[0m07:30:49.505120 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:49.506518 [debug] [MainThread]: Command end result
[0m07:30:49.507255 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.51441544, "process_user_time": 1.06013, "process_kernel_time": 0.07148, "process_mem_max_rss": "97576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:49.508011 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:49.507925 after 0.52 seconds
[0m07:30:49.508438 [debug] [MainThread]: Flushing usage events
[0m07:30:51.916807 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m07:30:51.921771 [debug] [MainThread]: On master: COMMIT
[0m07:30:51.923697 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:51.924122 [debug] [MainThread]: On master: COMMIT
[0m07:30:51.927909 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:51.929548 [debug] [MainThread]: On master: Close
[0m07:30:51.932206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:51.934161 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:30:51.936379 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m07:30:51.937589 [info ] [MainThread]: 
[0m07:30:51.938083 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 15.69 seconds (15.69s).
[0m07:30:51.938736 [debug] [MainThread]: Command end result
[0m07:30:51.939504 [info ] [MainThread]: 
[0m07:30:51.941048 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:51.942015 [info ] [MainThread]: 
[0m07:30:51.943683 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:51.944913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.183777, "process_user_time": 1.173777, "process_kernel_time": 0.088781, "process_mem_max_rss": "108560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:51.946320 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:51.946226 after 16.19 seconds
[0m07:30:51.947640 [debug] [MainThread]: Flushing usage events
[0m07:30:54.184954 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:54.189329 | 407d8cf6-731d-49e0-87cf-940a80e51ea8 ==============================
[0m07:30:54.189329 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:54.190134 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:30:54.193766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}


============================== 07:30:54.194742 | 878eacd3-97a0-40f7-b6b6-ceeae7dde397 ==============================
[0m07:30:54.194742 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:54.195373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:30:54.326305 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:54.338034 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:54.345033 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:54.361350 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:54.507009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:54.507747 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:54.527607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:54.528525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:54.577773 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:54.589263 [info ] [MainThread]: 
[0m07:30:54.595895 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:54.611806 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:54.622525 [debug] [MainThread]: Command end result
[0m07:30:54.622971 [info ] [MainThread]: 
[0m07:30:54.631696 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.53043836, "process_user_time": 1.079981, "process_kernel_time": 0.079171, "process_mem_max_rss": "97712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:54.644904 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:54.644748 after 0.54 seconds
[0m07:30:54.646229 [debug] [MainThread]: Flushing usage events
[0m07:30:54.636958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:54.651557 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:54.688103 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:54.688625 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:54.688897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:59.712180 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.023 seconds
[0m07:30:59.722136 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:59.744114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:30:59.747068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:30:59.763773 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:59.764222 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:59.764530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:59.761579 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:59.765434 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:59.765838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:59.770144 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:30:59.771224 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:59.771874 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:59.770848 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:30:59.772778 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:59.773338 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:59.774743 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:59.775892 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:59.776104 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.002 seconds
[0m07:30:59.776590 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:59.777631 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:59.778867 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:59.784144 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:59.784776 [debug] [MainThread]: On master: BEGIN
[0m07:30:59.785139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:59.789913 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:30:59.790679 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:59.791112 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:59.796232 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:30:59.798252 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:59.798822 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:59.799253 [debug] [MainThread]: On master: BEGIN
[0m07:30:59.799963 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:59.802889 [debug] [MainThread]: On master: COMMIT
[0m07:30:59.803406 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:59.803752 [debug] [MainThread]: On master: COMMIT
[0m07:30:59.804360 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:59.804808 [debug] [MainThread]: On master: Close
[0m07:30:59.805290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:59.805785 [info ] [MainThread]: 
[0m07:30:59.811249 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m07:30:59.812038 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m07:30:59.812682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m07:30:59.813077 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m07:30:59.818891 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m07:30:59.820325 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m07:30:59.846095 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m07:30:59.847758 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:30:59.848243 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m07:30:59.848710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:59.853305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:30:59.854072 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:30:59.854630 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m07:31:00.715847 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 0.861 seconds
[0m07:31:00.724139 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:31:00.724814 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m07:31:00.725628 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:31:00.738158 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m07:31:00.739313 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:31:00.740143 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m07:31:00.747305 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m07:31:00.756418 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m07:31:00.769740 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:31:00.772334 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m07:31:00.783333 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:31:00.787232 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m07:31:00.804421 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1000000[0m in 0.99s]
[0m07:31:00.822264 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m07:31:00.840324 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:00.841659 [debug] [MainThread]: On master: BEGIN
[0m07:31:00.842499 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:31:05.868242 [debug] [MainThread]: SQL status: BEGIN in 5.026 seconds
[0m07:31:05.873085 [debug] [MainThread]: On master: COMMIT
[0m07:31:05.873864 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:05.874428 [debug] [MainThread]: On master: COMMIT
[0m07:31:05.875243 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:05.875816 [debug] [MainThread]: On master: Close
[0m07:31:05.876486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:05.876836 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m07:31:05.877253 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:31:05.877965 [info ] [MainThread]: 
[0m07:31:05.878504 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.24 seconds (11.24s).
[0m07:31:05.879159 [debug] [MainThread]: Command end result
[0m07:31:05.879555 [info ] [MainThread]: 
[0m07:31:05.879973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:31:05.880401 [info ] [MainThread]: 
[0m07:31:05.880870 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:31:05.881742 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.75662, "process_user_time": 1.264347, "process_kernel_time": 0.09757, "process_mem_max_rss": "108204", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:31:05.882414 [debug] [MainThread]: Command `dbt run` succeeded at 07:31:05.882308 after 11.76 seconds
[0m07:31:05.882926 [debug] [MainThread]: Flushing usage events
[0m07:31:08.221150 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:31:08.225787 | 08fd3e3a-7374-4ef1-827b-14ea900e08f1 ==============================
[0m07:31:08.225787 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:31:08.226567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:31:08.227439 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:31:08.234389 | e27da26b-33a2-4f7c-959b-919ef6fd9fbe ==============================
[0m07:31:08.234389 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:31:08.235110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'send_anonymous_usage_stats': 'True'}
[0m07:31:08.389390 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:31:08.408407 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:31:08.412363 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:31:08.425501 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:31:08.569586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:31:08.570206 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:31:08.580055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:31:08.582435 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:31:08.630202 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:31:08.637749 [info ] [MainThread]: 
[0m07:31:08.639885 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:31:08.656111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:31:08.676038 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:31:08.681633 [info ] [MainThread]: 
[0m07:31:08.695055 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:31:08.696928 [debug] [MainThread]: Command end result
[0m07:31:08.698057 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.53455347, "process_user_time": 1.07603, "process_kernel_time": 0.067503, "process_mem_max_rss": "97732", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:31:08.698763 [debug] [MainThread]: Command `dbt test` succeeded at 07:31:08.698683 after 0.54 seconds
[0m07:31:08.699229 [debug] [MainThread]: Flushing usage events
[0m07:31:08.712666 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:31:08.713792 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:31:08.714661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:13.725164 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.010 seconds
[0m07:31:13.728052 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:31:13.732883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:31:13.733471 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:31:13.738396 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:31:13.740695 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:31:13.741161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:13.740146 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:31:13.742099 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:31:13.742672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:18.742281 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:31:18.743169 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:31:18.743597 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:31:18.746009 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:31:18.747390 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:31:18.748135 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:31:18.751221 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m07:31:18.752873 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:31:18.753329 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:31:18.756156 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.002 seconds
[0m07:31:18.757956 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:31:18.758619 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:31:18.763912 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:18.764455 [debug] [MainThread]: On master: BEGIN
[0m07:31:18.764858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:23.769292 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m07:31:23.773088 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:23.773816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:31:23.780015 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:31:23.782787 [debug] [MainThread]: On master: ROLLBACK
[0m07:31:23.783456 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:23.783916 [debug] [MainThread]: On master: BEGIN
[0m07:31:23.784564 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:31:23.785282 [debug] [MainThread]: On master: COMMIT
[0m07:31:23.785810 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:23.786293 [debug] [MainThread]: On master: COMMIT
[0m07:31:23.786964 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:23.787528 [debug] [MainThread]: On master: Close
[0m07:31:23.788138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:31:23.789168 [info ] [MainThread]: 
[0m07:31:23.794766 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m07:31:23.795500 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m07:31:23.796779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.fact_sales)
[0m07:31:23.797436 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m07:31:23.803681 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m07:31:23.805761 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m07:31:23.832524 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m07:31:23.834392 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:31:23.834925 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m07:31:23.835469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:23.841053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:31:23.841910 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:31:23.842263 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    transaction_id,
    product_key,
    channel_key,
    reseller_id,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    commissionpct,
    commissionpaid,
    product_price
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m07:31:24.748350 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 0.906 seconds
[0m07:31:24.757324 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:31:24.758058 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m07:31:24.758940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:31:24.777884 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m07:31:24.778698 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:31:24.779288 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m07:31:24.835795 [debug] [Thread-1 (]: SQL status: COMMIT in 0.051 seconds
[0m07:31:24.847670 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m07:31:24.855833 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:31:24.866735 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m07:31:24.868531 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:31:24.873435 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m07:31:24.876434 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1000000[0m in 1.08s]
[0m07:31:24.880770 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m07:31:24.882414 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:24.883160 [debug] [MainThread]: On master: BEGIN
[0m07:31:24.883711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:31:24.888768 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:31:24.889291 [debug] [MainThread]: On master: COMMIT
[0m07:31:24.889767 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:24.890260 [debug] [MainThread]: On master: COMMIT
[0m07:31:24.891021 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:24.891836 [debug] [MainThread]: On master: Close
[0m07:31:24.892471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:24.892917 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:31:24.893315 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m07:31:24.894306 [info ] [MainThread]: 
[0m07:31:24.895735 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.25 seconds (16.25s).
[0m07:31:24.901333 [debug] [MainThread]: Command end result
[0m07:31:24.902362 [info ] [MainThread]: 
[0m07:31:24.903021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:31:24.905073 [info ] [MainThread]: 
[0m07:31:24.905729 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:31:24.906982 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.744406, "process_user_time": 1.189776, "process_kernel_time": 0.100487, "process_mem_max_rss": "106284", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:31:24.907776 [debug] [MainThread]: Command `dbt run` succeeded at 07:31:24.907691 after 16.75 seconds
[0m07:31:24.908570 [debug] [MainThread]: Flushing usage events
[0m07:31:27.424750 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:31:27.429845 | 11916c1f-fa2e-48b8-b950-d3486c2ebede ==============================
[0m07:31:27.429845 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:31:27.430805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:31:27.576803 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:31:27.594983 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:31:27.749603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:31:27.750689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:31:27.805058 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:31:27.806325 [info ] [MainThread]: 
[0m07:31:27.809883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:31:27.812972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:31:27.813485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:31:27.840536 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:31:27.840970 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:31:27.841479 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:31:27.841941 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:31:27.842334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:27.842744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:27.847823 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:31:27.848423 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:31:27.848959 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:31:27.851256 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.002 seconds
[0m07:31:27.852892 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:31:27.853744 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:31:32.847923 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:31:32.848887 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:31:32.849418 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:31:32.851707 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:31:32.853018 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:31:32.853798 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:31:32.858294 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:32.858810 [debug] [MainThread]: On master: BEGIN
[0m07:31:32.859094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:32.863410 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:31:32.865378 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:32.865852 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:31:32.871739 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:31:32.873660 [debug] [MainThread]: On master: ROLLBACK
[0m07:31:32.874308 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:32.874803 [debug] [MainThread]: On master: BEGIN
[0m07:31:32.875491 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:31:32.876559 [debug] [MainThread]: On master: COMMIT
[0m07:31:32.877945 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:32.879937 [debug] [MainThread]: On master: COMMIT
[0m07:31:32.884136 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:32.884674 [debug] [MainThread]: On master: Close
[0m07:31:32.885789 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:31:32.886411 [info ] [MainThread]: 
[0m07:31:32.892116 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m07:31:32.892761 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m07:31:32.893245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m07:31:32.893784 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m07:31:32.899968 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m07:31:32.901660 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m07:31:32.911984 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m07:31:32.913570 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m07:31:32.914106 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m07:31:32.914728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:32.919289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:31:32.919969 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m07:31:32.920399 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m07:31:33.051122 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.130 seconds
[0m07:31:33.054433 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m07:31:33.059467 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m07:31:33.063048 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.17s]
[0m07:31:33.064188 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m07:31:33.066330 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:33.067384 [debug] [MainThread]: On master: BEGIN
[0m07:31:33.068144 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:31:33.072471 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:31:33.073198 [debug] [MainThread]: On master: COMMIT
[0m07:31:33.073792 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:33.074114 [debug] [MainThread]: On master: COMMIT
[0m07:31:33.074781 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:33.075222 [debug] [MainThread]: On master: Close
[0m07:31:33.075839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:33.076287 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m07:31:33.076735 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:31:33.077228 [info ] [MainThread]: 
[0m07:31:33.077747 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m07:31:33.078471 [debug] [MainThread]: Command end result
[0m07:31:33.078914 [info ] [MainThread]: 
[0m07:31:33.079359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:31:33.079782 [info ] [MainThread]: 
[0m07:31:33.080087 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:31:33.080852 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.737896, "process_user_time": 1.160837, "process_kernel_time": 0.090865, "process_mem_max_rss": "108584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:31:33.081554 [debug] [MainThread]: Command `dbt test` succeeded at 07:31:33.081441 after 5.74 seconds
[0m07:31:33.082094 [debug] [MainThread]: Flushing usage events
[0m07:41:47.532166 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:41:47.536697 | 8ae1332e-78ff-40fb-adac-a7f5ccb3a67a ==============================
[0m07:41:47.536697 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:41:47.537408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:41:47.622095 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:41:47.626239 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:41:47.630028 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q_75xlr9'
[0m07:41:47.630653 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:41:47.631955 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:41:47.633700 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:41:47.639434 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14443754, "process_user_time": 0.859529, "process_kernel_time": 0.071203, "process_mem_max_rss": "105644", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:41:47.640066 [debug] [MainThread]: Command `dbt deps` succeeded at 07:41:47.639989 after 0.15 seconds
[0m07:41:47.640518 [debug] [MainThread]: Flushing usage events
[0m07:41:49.590189 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:41:49.594734 | 7196b9bc-5c78-4201-9997-25ae4c64e1f6 ==============================
[0m07:41:49.594734 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:41:49.595329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:41:49.761358 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:41:49.775188 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:41:49.776274 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:41:51.100813 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:41:51.102927 [info ] [MainThread]: 
[0m07:41:51.104269 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:41:51.105854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:41:51.129649 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:41:51.135547 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:41:51.138180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:41:56.150548 [debug] [ThreadPool]: SQL status: SELECT 8 in 5.012 seconds
[0m07:41:56.151853 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:41:56.152577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m07:41:56.153058 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m07:41:56.157192 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:41:56.166754 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m07:41:56.175444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:41:56.196375 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m07:41:56.209759 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:41:56.222897 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m07:41:56.237662 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m07:41:56.246224 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m07:41:56.248919 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:41:56.249370 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m07:41:56.250642 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m07:41:56.252062 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m07:41:56.256225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m07:41:56.256907 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:41:56.263299 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:41:56.263656 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:41:56.264026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:41:56.261652 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:41:56.264714 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:41:56.265211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:41:56.268630 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:41:56.269112 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:41:56.269442 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:41:56.272789 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m07:41:56.274111 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:41:56.274943 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:42:01.271213 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:42:01.272213 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:42:01.272773 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:42:01.275076 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:42:01.276208 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:42:01.276668 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:42:01.280526 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:01.281100 [debug] [MainThread]: On master: BEGIN
[0m07:42:01.281476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:42:06.286003 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m07:42:06.289088 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:06.289731 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:42:06.293141 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:42:06.294451 [debug] [MainThread]: On master: ROLLBACK
[0m07:42:06.295060 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:06.295408 [debug] [MainThread]: On master: BEGIN
[0m07:42:06.295971 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:42:06.296379 [debug] [MainThread]: On master: COMMIT
[0m07:42:06.296765 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:06.297051 [debug] [MainThread]: On master: COMMIT
[0m07:42:06.297424 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:42:06.297699 [debug] [MainThread]: On master: Close
[0m07:42:06.298184 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:42:06.298498 [info ] [MainThread]: 
[0m07:42:06.303195 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m07:42:06.303910 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m07:42:06.304423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m07:42:06.304875 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m07:42:06.305418 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m07:42:06.324106 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:42:06.324758 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m07:42:06.325298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:11.340980 [debug] [Thread-1 (]: SQL status: BEGIN in 5.015 seconds
[0m07:42:11.345182 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:42:11.345801 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m07:42:11.349484 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m07:42:11.399733 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:42:11.401452 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m07:42:11.403280 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m07:42:11.408013 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m07:42:11.426906 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m07:42:11.427554 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:42:11.427960 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m07:42:11.428855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:42:11.430235 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m07:42:11.431572 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 5.13s]
[0m07:42:11.432400 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m07:42:11.433842 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:11.439834 [debug] [MainThread]: On master: BEGIN
[0m07:42:11.440305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:42:11.444466 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:42:11.445167 [debug] [MainThread]: On master: COMMIT
[0m07:42:11.446392 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:11.447591 [debug] [MainThread]: On master: COMMIT
[0m07:42:11.448469 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:42:11.449110 [debug] [MainThread]: On master: Close
[0m07:42:11.449830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:11.450351 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m07:42:11.450796 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:42:11.451243 [info ] [MainThread]: 
[0m07:42:11.451570 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 20.35 seconds (20.35s).
[0m07:42:11.452049 [debug] [MainThread]: Command end result
[0m07:42:11.492228 [info ] [MainThread]: 
[0m07:42:11.492769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:42:11.493137 [info ] [MainThread]: 
[0m07:42:11.493584 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:42:11.494540 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 21.941936, "process_user_time": 2.188063, "process_kernel_time": 0.09298, "process_mem_max_rss": "115844", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:42:11.495223 [debug] [MainThread]: Command `dbt seed` succeeded at 07:42:11.495092 after 21.94 seconds
[0m07:42:11.495709 [debug] [MainThread]: Flushing usage events
[0m07:42:54.443993 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:42:54.450718 | 5c597959-ca93-43be-8347-d9afed16aa34 ==============================
[0m07:42:54.450718 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:42:54.452224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.454824 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:42:54.456217 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:42:54.463226 | ce5c36ee-6e9f-4b44-b157-6d7669238d47 ==============================
[0m07:42:54.463226 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:42:54.462658 | cdb004fa-d0c9-4acd-b981-d86b75641af4 ==============================
[0m07:42:54.462658 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:42:54.465154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.465584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.503099 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:42:54.498098 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:42:54.509256 | 0403c1ef-1ac8-4759-a5a7-4dc6573a39d1 ==============================
[0m07:42:54.509256 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:42:54.510414 | baf094c0-0c3f-422c-ba15-d227e1b3cae6 ==============================
[0m07:42:54.510414 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:42:54.510848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.511528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.526928 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:42:54.540479 | ac96a499-a39f-438f-9bae-0d4ff0a0959b ==============================
[0m07:42:54.540479 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:42:54.541677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.543118 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:42:54.557852 | 93eb18b8-d3ac-4066-8e1b-73615522eafb ==============================
[0m07:42:54.557852 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:42:54.563505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.602648 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.632431 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.667137 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.680194 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.699091 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.703136 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.735065 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.736604 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:54.768586 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.786558 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.799211 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.802304 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.802304 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.802421 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.803516 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:54.804629 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:54.815462 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.825248 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.830267 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.838753 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.892975 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.894175 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:54.924248 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.925553 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:54.931896 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.933484 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:54.934966 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.936158 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:56.163936 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.167124 [info ] [MainThread]: 
[0m07:42:56.172204 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.173656 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.206069 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.209769 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.211781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.234556 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.236630 [info ] [MainThread]: 
[0m07:42:56.240039 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.242170 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.251144 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.254911 [info ] [MainThread]: 
[0m07:42:56.256485 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.257586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.268042 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.269188 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.269255 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.271141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.274731 [info ] [MainThread]: 
[0m07:42:56.277570 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.280233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.283847 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m07:42:56.286818 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:42:56.289741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m07:42:56.291645 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m07:42:56.291775 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.295657 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.296344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.296899 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.297355 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m07:42:56.298140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.302020 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m07:42:56.303549 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:42:56.304804 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:42:56.305233 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.306203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m07:42:56.308410 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.308788 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.309344 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m07:42:56.309798 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m07:42:56.310432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.310955 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.311442 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:42:56.313772 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:42:56.313490 [info ] [MainThread]: 
[0m07:42:56.316908 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.314864 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.318301 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.319005 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:42:56.319421 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.009 seconds
[0m07:42:56.321112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.319489 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m07:42:56.322885 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m07:42:56.324004 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m07:42:56.323565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.323966 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:42:56.328972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m07:42:56.328226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m07:42:56.330340 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:42:56.329915 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m07:42:56.331494 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.332015 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m07:42:56.329148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:42:56.339282 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m07:42:56.341081 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.338743 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:42:56.343219 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:42:56.342645 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:42:56.343698 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m07:42:56.343915 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:42:56.344422 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.344624 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:42:56.344827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.345544 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:42:56.345178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.345935 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.346530 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m07:42:56.345673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.347045 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.347224 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m07:42:56.347923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.351124 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:42:56.352047 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:42:56.352113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m07:42:56.352797 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:42:56.356593 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m07:42:56.358271 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:42:56.359915 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:42:56.353016 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:42:56.360329 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:42:56.362926 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:42:56.363412 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:42:56.363762 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:42:56.364152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.364505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.379755 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.381230 [info ] [MainThread]: 
[0m07:42:56.381933 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.382868 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.388649 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.390224 [info ] [MainThread]: 
[0m07:42:56.391033 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.391933 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.401606 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.402253 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.402787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.408562 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m07:42:56.409983 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:42:56.411258 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.411825 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.412304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.413729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:42:56.417558 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m07:42:56.418891 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:42:56.414190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:42:56.419337 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:42:56.421818 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:42:56.422598 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:42:56.423137 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:42:56.423320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:42:56.423585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.423933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.428601 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:42:56.423814 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:42:56.429231 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:42:56.429811 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:42:56.428615 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:42:56.430903 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:42:56.431531 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:42:56.432255 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:42:56.431997 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:42:56.432549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.433037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.433524 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:42:56.434475 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:42:56.437888 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:42:56.438717 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:42:56.439349 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:42:56.441930 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:42:56.442981 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:42:56.443498 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:01.226158 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.014 seconds
[0m07:43:01.229949 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:01.246700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:01.260228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:01.278864 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.301242 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:01.274120 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.304052 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:01.304683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:01.303615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:01.309790 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:43:01.310154 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:43:01.310666 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.311225 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.311774 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:01.312455 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:01.314659 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m07:43:01.314954 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:43:01.315942 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:01.316761 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:01.317296 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:01.317680 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:01.323027 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.323692 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.324143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:01.329014 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:01.329760 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.330198 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:01.333215 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:43:01.334369 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:01.335263 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.335826 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.336547 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:01.337081 [debug] [MainThread]: On master: COMMIT
[0m07:43:01.337558 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.338062 [debug] [MainThread]: On master: COMMIT
[0m07:43:01.338664 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:01.339304 [debug] [MainThread]: On master: Close
[0m07:43:01.340104 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:01.341101 [info ] [MainThread]: 
[0m07:43:01.346261 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m07:43:01.346974 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m07:43:01.347617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_date)
[0m07:43:01.348176 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m07:43:01.350623 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:43:01.352773 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:43:01.353283 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m07:43:01.354052 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:43:01.354358 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m07:43:01.355237 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:43:01.357204 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m07:43:01.356448 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:43:01.358571 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.358750 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:43:01.359407 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:01.359659 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m07:43:01.359917 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.012 seconds
[0m07:43:01.359914 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m07:43:01.361278 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:01.360630 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m07:43:01.362050 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:01.363584 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:01.364407 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:01.366258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m07:43:01.366206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:01.370633 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.369354 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:43:01.373291 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.367337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:43:01.373293 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.373907 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.374439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:01.376046 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.376748 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:01.375006 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:43:01.366807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:01.377195 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:01.377964 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.377830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:01.378365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:01.377340 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:01.378686 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:01.381086 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:43:01.382236 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:01.380699 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.382500 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:01.383224 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:43:01.382487 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.383928 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.383472 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:01.383141 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:01.384421 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:01.384034 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:01.384323 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:01.384542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:01.385739 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:01.385433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:01.387107 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:01.387795 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m07:43:01.390858 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:43:01.391859 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:01.392536 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.393207 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:01.394111 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.394454 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:01.395092 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.395149 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m07:43:01.395749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:01.396217 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m07:43:01.397275 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:43:01.398352 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:01.398620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:01.399080 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:01.400239 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:43:01.401573 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.402650 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:01.404031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:43:01.405791 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m07:43:01.407615 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:43:01.407849 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m07:43:01.408875 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:01.409718 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.410149 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.410750 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:01.411294 [debug] [MainThread]: On master: COMMIT
[0m07:43:01.411703 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.412062 [debug] [MainThread]: On master: COMMIT
[0m07:43:01.412505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:01.412879 [debug] [MainThread]: On master: Close
[0m07:43:01.413498 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:01.414026 [info ] [MainThread]: 
[0m07:43:01.418881 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m07:43:01.419515 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m07:43:01.420100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m07:43:01.420553 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m07:43:01.426552 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m07:43:01.427958 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m07:43:01.428709 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:43:01.434862 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.437778 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:01.440708 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:43:01.442085 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m07:43:01.442673 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:01.446311 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.446863 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:01.447256 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:01.450778 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m07:43:01.451812 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.452108 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:01.452694 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.452958 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:01.457269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:01.457747 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m07:43:01.460475 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:43:01.463106 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.463591 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m07:43:01.463973 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.464522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:01.468070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:01.639728 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.230 seconds
[0m07:43:01.644435 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m07:43:01.644996 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:43:01.645697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:01.655728 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m07:43:01.656349 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m07:43:01.656906 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m07:43:01.661105 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:43:01.666070 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m07:43:01.669401 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m07:43:01.669980 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m07:43:01.670629 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:43:01.672485 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m07:43:01.673906 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.33s]
[0m07:43:01.674628 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m07:43:01.675859 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.676350 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.676734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:01.681378 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:01.682126 [debug] [MainThread]: On master: COMMIT
[0m07:43:01.682682 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.683131 [debug] [MainThread]: On master: COMMIT
[0m07:43:01.683878 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:01.684347 [debug] [MainThread]: On master: Close
[0m07:43:01.685013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:01.685537 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m07:43:01.685990 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:43:01.686533 [info ] [MainThread]: 
[0m07:43:01.687240 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m07:43:01.688079 [debug] [MainThread]: Command end result
[0m07:43:01.688596 [info ] [MainThread]: 
[0m07:43:01.689414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:01.689999 [info ] [MainThread]: 
[0m07:43:01.690527 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:01.691540 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.295577, "process_user_time": 2.482066, "process_kernel_time": 0.128978, "process_mem_max_rss": "112516", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:01.692276 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:01.692149 after 7.30 seconds
[0m07:43:01.692794 [debug] [MainThread]: Flushing usage events
[0m07:43:04.152611 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:04.157861 | cbc5105f-ea92-462e-ad77-530758ce709d ==============================
[0m07:43:04.157861 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:04.160320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:04.289807 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:04.301536 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:04.432007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:04.432949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:04.509357 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:04.513108 [info ] [MainThread]: 
[0m07:43:04.517549 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:04.524382 [debug] [MainThread]: Command end result
[0m07:43:04.536506 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.41001612, "process_user_time": 1.016585, "process_kernel_time": 0.068989, "process_mem_max_rss": "97980", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:04.543046 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:04.542937 after 0.42 seconds
[0m07:43:04.543501 [debug] [MainThread]: Flushing usage events
[0m07:43:06.383116 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m07:43:06.383939 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:43:06.385188 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:06.385057 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.385997 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:06.386558 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:06.389370 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m07:43:06.390649 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:06.390744 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:43:06.391138 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:06.392301 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:06.393126 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.395971 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:43:06.395895 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.396755 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.396975 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:06.397086 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.397609 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:06.397568 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:06.397719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:06.398299 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.398803 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.399339 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.400254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:06.400285 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:06.400859 [debug] [MainThread]: On master: Close
[0m07:43:06.401772 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:06.401623 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:06.402640 [info ] [MainThread]: 
[0m07:43:06.402664 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:06.408297 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.408782 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m07:43:06.411034 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.411515 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m07:43:06.411843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:06.412767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m07:43:06.413530 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m07:43:06.420025 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m07:43:06.422628 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m07:43:06.447739 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m07:43:06.450128 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:43:06.450774 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m07:43:06.451414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:06.457477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:43:06.459693 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:43:06.460565 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m07:43:06.463901 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m07:43:06.464556 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m07:43:06.465204 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.465846 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:06.469285 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:43:06.469618 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:43:06.470770 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m07:43:06.471656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:06.471829 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:06.472641 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.473198 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.474611 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:43:06.478717 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.479512 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.479861 [debug] [Thread-1 (]: SQL status: BEGIN in 5.015 seconds
[0m07:43:06.480016 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.478928 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m07:43:06.480486 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:43:06.481010 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:06.480919 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.481367 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
      id AS geography_key,
      cityname as city_name,
      countryname as country_name,
      regionname as region_name
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m07:43:06.481721 [debug] [MainThread]: On master: Close
[0m07:43:06.481938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:06.482805 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:06.482887 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m07:43:06.483636 [info ] [MainThread]: 
[0m07:43:06.484673 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:43:06.485407 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m07:43:06.485544 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.003 seconds
[0m07:43:06.489639 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m07:43:06.491549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:06.494670 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:06.499761 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m07:43:06.508093 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.511439 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:43:06.514994 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:43:06.511422 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m07:43:06.541830 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m07:43:06.523156 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.530626 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m07:43:06.534084 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m07:43:06.542375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m07:43:06.543509 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m07:43:06.544343 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:43:06.543905 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:43:06.553547 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m07:43:06.548646 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.556611 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.557188 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.564540 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m07:43:06.565013 [debug] [MainThread]: On master: Close
[0m07:43:06.565725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:06.555932 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m07:43:06.572906 [info ] [MainThread]: 
[0m07:43:06.574249 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m07:43:06.575748 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m07:43:06.580542 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m07:43:06.581480 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m07:43:06.581870 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:43:06.582483 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m07:43:06.583083 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m07:43:06.583625 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.584037 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m07:43:06.584564 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.584844 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:06.585172 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:06.585147 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m07:43:06.586067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m07:43:06.586657 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m07:43:06.590607 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:06.591300 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.591878 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.592094 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m07:43:06.592542 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.593351 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m07:43:06.595423 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:43:06.596697 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:06.596891 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m07:43:06.597641 [debug] [MainThread]: On master: Close
[0m07:43:06.598201 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m07:43:06.598155 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:43:06.598725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:06.601072 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m07:43:06.601555 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:06.603366 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m07:43:06.603713 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 5.18s]
[0m07:43:06.603799 [info ] [MainThread]: 
[0m07:43:06.604792 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m07:43:06.605205 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.36 seconds (10.36s).
[0m07:43:06.606472 [debug] [MainThread]: Command end result
[0m07:43:06.607577 [info ] [MainThread]: 
[0m07:43:06.607434 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.608367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:06.608791 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.609201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m07:43:06.609887 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:06.609049 [info ] [MainThread]: 
[0m07:43:06.610765 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:06.611692 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:43:06.612045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.213801, "process_user_time": 2.544189, "process_kernel_time": 0.141624, "process_mem_max_rss": "114912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:06.612179 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m07:43:06.613022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:06.612684 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:06.612583 after 12.21 seconds
[0m07:43:06.614883 [debug] [MainThread]: Flushing usage events
[0m07:43:06.618376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:43:06.618980 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:43:06.619523 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:43:06.620077 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m07:43:06.620381 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.620991 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.621435 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.622479 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:43:06.622047 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:43:06.623079 [debug] [MainThread]: On master: Close
[0m07:43:06.623947 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m07:43:06.624732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:06.625649 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:43:06.626155 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:06.626397 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m07:43:06.626615 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m07:43:06.627013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:06.627152 [info ] [MainThread]: 
[0m07:43:06.629204 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.37 seconds (10.37s).
[0m07:43:06.630628 [debug] [MainThread]: Command end result
[0m07:43:06.631203 [info ] [MainThread]: 
[0m07:43:06.631924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:06.632803 [info ] [MainThread]: 
[0m07:43:06.633483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:43:06.633846 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:06.633884 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:43:06.634830 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:43:06.635439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.181967, "process_user_time": 2.529536, "process_kernel_time": 0.153151, "process_mem_max_rss": "112940", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:06.636043 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m07:43:06.636718 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m07:43:06.637021 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:06.636892 after 12.18 seconds
[0m07:43:06.637955 [debug] [MainThread]: Flushing usage events
[0m07:43:06.638459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:43:06.638766 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:43:06.655215 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m07:43:06.657677 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:43:06.658177 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m07:43:06.658195 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:43:06.659246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:06.663549 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m07:43:06.665006 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m07:43:06.665421 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:43:06.673942 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:43:06.676654 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m07:43:06.677421 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:43:06.683878 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m07:43:06.684050 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m07:43:06.684735 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:43:06.686492 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.14s]
[0m07:43:06.687057 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m07:43:06.687939 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m07:43:06.689348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:06.690058 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.694435 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m07:43:06.694923 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.698804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:06.703368 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:43:06.704405 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m07:43:06.704796 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:43:06.705730 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.706138 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:43:06.706612 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.708965 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m07:43:06.709601 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.711686 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m07:43:06.713580 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:43:06.714744 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m07:43:06.715621 [debug] [MainThread]: On master: Close
[0m07:43:06.716829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:06.717517 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:43:06.718038 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m07:43:06.718205 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.718553 [info ] [MainThread]: 
[0m07:43:06.719213 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.719559 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.34 seconds (10.34s).
[0m07:43:06.719908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:06.720465 [debug] [MainThread]: Command end result
[0m07:43:06.721104 [info ] [MainThread]: 
[0m07:43:06.723041 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:06.724999 [info ] [MainThread]: 
[0m07:43:06.727627 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:06.728807 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.249657, "process_user_time": 2.57156, "process_kernel_time": 0.134593, "process_mem_max_rss": "112868", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:06.729604 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:06.729333 after 12.25 seconds
[0m07:43:06.731001 [debug] [MainThread]: Flushing usage events
[0m07:43:06.731448 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m07:43:06.736695 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.740626 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.741402 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.742239 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:06.742847 [debug] [MainThread]: On master: Close
[0m07:43:06.743426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:06.743758 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:06.745186 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m07:43:06.750695 [info ] [MainThread]: 
[0m07:43:06.751501 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.36 seconds (10.36s).
[0m07:43:06.752300 [debug] [MainThread]: Command end result
[0m07:43:06.752709 [info ] [MainThread]: 
[0m07:43:06.756742 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:06.757340 [info ] [MainThread]: 
[0m07:43:06.757805 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:06.758632 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.29691, "process_user_time": 2.510037, "process_kernel_time": 0.143926, "process_mem_max_rss": "112992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:06.762987 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:06.762661 after 12.30 seconds
[0m07:43:06.764381 [debug] [MainThread]: Flushing usage events
[0m07:43:08.306129 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:43:08.310264 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:08.338272 | 2cd208a0-1aed-4e10-b190-fe8c4f9d7f98 ==============================
[0m07:43:08.338272 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:43:08.341910 | e59392b9-9b70-4786-b11d-68682f2b500a ==============================
[0m07:43:08.341910 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:08.339705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:08.344455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:08.341161 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:08.352086 | afb138d1-b114-4f2a-96b1-2d9487d4327b ==============================
[0m07:43:08.352086 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:08.354785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'send_anonymous_usage_stats': 'True'}
[0m07:43:08.391356 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:08.396138 | e92aa486-bdda-4b47-94f8-08072dc647d8 ==============================
[0m07:43:08.396138 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:08.396991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:43:08.489751 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:08.504244 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:08.507948 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:08.521083 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:08.521730 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:08.539993 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:08.542967 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:08.558959 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:08.753133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:08.753968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:08.771714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:08.772549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:08.795907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:08.796515 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:08.796642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:08.797167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:08.816093 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:08.817473 [info ] [MainThread]: 
[0m07:43:08.817862 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:08.819191 [debug] [MainThread]: Command end result
[0m07:43:08.819845 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5632611, "process_user_time": 1.071279, "process_kernel_time": 0.067854, "process_mem_max_rss": "97492", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:08.820288 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:08.820225 after 0.56 seconds
[0m07:43:08.820641 [debug] [MainThread]: Flushing usage events
[0m07:43:08.839515 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:08.840922 [info ] [MainThread]: 
[0m07:43:08.842104 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:08.842770 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:08.846696 [debug] [MainThread]: Command end result
[0m07:43:08.848007 [info ] [MainThread]: 
[0m07:43:08.848923 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.59029436, "process_user_time": 1.095207, "process_kernel_time": 0.071933, "process_mem_max_rss": "97464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:08.850361 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:08.849879 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:08.850545 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:08.850424 after 0.59 seconds
[0m07:43:08.851636 [debug] [MainThread]: Flushing usage events
[0m07:43:08.851659 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:08.851910 [info ] [MainThread]: 
[0m07:43:08.853616 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:08.858966 [debug] [MainThread]: Command end result
[0m07:43:08.860676 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5114069, "process_user_time": 1.099004, "process_kernel_time": 0.07989, "process_mem_max_rss": "97448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:08.865242 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:08.865062 after 0.52 seconds
[0m07:43:08.866659 [debug] [MainThread]: Flushing usage events
[0m07:43:08.876331 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:08.880693 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:08.881251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:08.887606 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m07:43:08.888950 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:08.893695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:08.894316 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:08.901016 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:08.901530 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:08.901831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:08.898938 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:08.902547 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:08.903197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:08.909593 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m07:43:08.910638 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:08.911270 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:08.913726 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:08.915135 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:08.915977 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:09.388144 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:09.392477 | bc44e88b-02c6-4e7b-ba20-8e2ade1d8883 ==============================
[0m07:43:09.392477 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:09.393025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:09.590985 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:09.602505 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:09.726741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:09.727281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:09.777857 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:09.779214 [info ] [MainThread]: 
[0m07:43:09.779865 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:09.781482 [debug] [MainThread]: Command end result
[0m07:43:09.782373 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42655504, "process_user_time": 1.047517, "process_kernel_time": 0.074169, "process_mem_max_rss": "97840", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:09.783102 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:09.782967 after 0.43 seconds
[0m07:43:09.783732 [debug] [MainThread]: Flushing usage events
[0m07:43:11.408565 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m07:43:11.409270 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.409955 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:11.413852 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m07:43:11.415188 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:11.415879 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.416408 [debug] [MainThread]: On master: BEGIN
[0m07:43:11.416970 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:11.417475 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.417950 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.418352 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.418892 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:11.419301 [debug] [MainThread]: On master: Close
[0m07:43:11.419791 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:11.420320 [info ] [MainThread]: 
[0m07:43:11.421924 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m07:43:11.422612 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.423098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:11.426107 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m07:43:11.426963 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m07:43:11.427172 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m07:43:11.427745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_products)
[0m07:43:11.428334 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m07:43:11.429038 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:11.432936 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.433505 [debug] [MainThread]: On master: BEGIN
[0m07:43:11.434254 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m07:43:11.434285 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:11.435036 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.435511 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.435637 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m07:43:11.436111 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.439965 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:11.440848 [debug] [MainThread]: On master: Close
[0m07:43:11.441825 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:11.442587 [info ] [MainThread]: 
[0m07:43:11.448022 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m07:43:11.448771 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m07:43:11.449400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m07:43:11.450045 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m07:43:11.455323 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m07:43:11.457036 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m07:43:11.460128 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m07:43:11.461395 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:43:11.461786 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m07:43:11.462118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:11.467024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:43:11.467770 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:43:11.468458 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m07:43:11.469990 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:43:11.474695 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:43:11.475235 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m07:43:11.476068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:11.479689 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m07:43:11.481687 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:43:11.482147 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m07:43:11.482554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:11.486723 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m07:43:11.487351 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:43:11.487766 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m07:43:11.488929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:11.493616 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m07:43:11.496877 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:43:11.497564 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m07:43:11.498259 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:43:11.500088 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m07:43:11.501619 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m07:43:11.502221 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m07:43:11.503319 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.503853 [debug] [MainThread]: On master: BEGIN
[0m07:43:11.504312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:11.509357 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:11.509984 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.510443 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.510812 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.511341 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:11.511755 [debug] [MainThread]: On master: Close
[0m07:43:11.512235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:11.513473 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m07:43:11.513851 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:11.514239 [info ] [MainThread]: 
[0m07:43:11.514794 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.24 seconds (15.24s).
[0m07:43:11.515515 [debug] [MainThread]: Command end result
[0m07:43:11.515936 [info ] [MainThread]: 
[0m07:43:11.516437 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:11.516794 [info ] [MainThread]: 
[0m07:43:11.517230 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:11.518113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.121145, "process_user_time": 2.592564, "process_kernel_time": 0.132014, "process_mem_max_rss": "114472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:11.518759 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:11.518680 after 17.12 seconds
[0m07:43:11.519225 [debug] [MainThread]: Flushing usage events
[0m07:43:13.207054 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:43:13.207055 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:13.211478 | e35c2293-cdb4-497a-b96e-52027dd1b238 ==============================
[0m07:43:13.211478 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:43:13.211539 | 532c6c75-882e-4e49-aeee-666c941193f5 ==============================
[0m07:43:13.211539 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:13.212123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'send_anonymous_usage_stats': 'True'}
[0m07:43:13.212243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:13.351119 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:13.351453 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:13.363578 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:13.363578 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:13.499012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:13.499635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:13.500761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:13.501295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:13.550608 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:13.555799 [info ] [MainThread]: 
[0m07:43:13.559715 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:13.559490 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:13.563053 [info ] [MainThread]: 
[0m07:43:13.567654 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:13.569013 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:13.574200 [debug] [MainThread]: Command end result
[0m07:43:13.575576 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.39877766, "process_user_time": 1.02668, "process_kernel_time": 0.06093, "process_mem_max_rss": "97968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:13.576130 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:13.576069 after 0.40 seconds
[0m07:43:13.579614 [debug] [MainThread]: Flushing usage events
[0m07:43:13.610242 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:13.610939 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:13.611682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:13.909977 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m07:43:13.910991 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:13.911570 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:13.913881 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m07:43:13.915102 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:13.915601 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:13.919999 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:13.920818 [debug] [MainThread]: On master: BEGIN
[0m07:43:13.921241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:16.494773 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m07:43:16.501922 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:43:16.502711 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m07:43:16.504343 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:43:16.509382 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:43:16.510044 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m07:43:16.510797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:16.519840 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m07:43:16.520550 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:43:16.524423 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m07:43:16.525698 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:16.530638 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m07:43:16.533722 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:43:16.534281 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m07:43:16.535089 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:43:16.537761 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m07:43:16.542685 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 5.09s]
[0m07:43:16.543549 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m07:43:16.545103 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:16.546062 [debug] [MainThread]: On master: BEGIN
[0m07:43:16.546622 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:16.552198 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:43:16.552882 [debug] [MainThread]: On master: COMMIT
[0m07:43:16.553455 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:16.553976 [debug] [MainThread]: On master: COMMIT
[0m07:43:16.554659 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:16.555212 [debug] [MainThread]: On master: Close
[0m07:43:16.556319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:16.557053 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m07:43:16.557610 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:43:16.558237 [info ] [MainThread]: 
[0m07:43:16.558817 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.24 seconds (20.24s).
[0m07:43:16.559586 [debug] [MainThread]: Command end result
[0m07:43:16.559896 [info ] [MainThread]: 
[0m07:43:16.560239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:16.560710 [info ] [MainThread]: 
[0m07:43:16.561139 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:16.561862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.088888, "process_user_time": 2.471779, "process_kernel_time": 0.144862, "process_mem_max_rss": "112500", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:16.562303 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:16.562243 after 22.09 seconds
[0m07:43:16.562631 [debug] [MainThread]: Flushing usage events
[0m07:43:18.299983 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:18.304207 | 9d00274f-8816-40fb-be32-7fec8627b0cf ==============================
[0m07:43:18.304207 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:18.304807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'send_anonymous_usage_stats': 'True'}
[0m07:43:18.330875 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:18.337884 | 84b8326f-ab56-431c-be26-a2ae00429659 ==============================
[0m07:43:18.337884 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:18.339786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:18.451280 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:18.473228 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:18.538234 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:18.550152 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:18.624721 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.013 seconds
[0m07:43:18.628397 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:18.633793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:18.634358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:18.641931 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:18.643914 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:18.645283 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:18.645879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:18.644612 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:18.646968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:18.654997 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:43:18.655843 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:18.656596 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:18.658719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:18.659452 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:18.660910 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:18.659839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:18.661653 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:18.708476 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:18.710307 [info ] [MainThread]: 
[0m07:43:18.711146 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:18.711351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:18.711910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:18.712059 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:18.735454 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:18.735985 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:18.736349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:18.778115 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:18.793297 [info ] [MainThread]: 
[0m07:43:18.800662 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:18.811478 [debug] [MainThread]: Command end result
[0m07:43:18.820527 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.52646166, "process_user_time": 1.099811, "process_kernel_time": 0.07878, "process_mem_max_rss": "97720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:18.822415 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:18.822281 after 0.53 seconds
[0m07:43:18.822955 [debug] [MainThread]: Flushing usage events
[0m07:43:18.929622 [debug] [MainThread]: SQL status: BEGIN in 5.008 seconds
[0m07:43:18.930435 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:18.931144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:18.935437 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m07:43:18.937116 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:18.937837 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:18.938291 [debug] [MainThread]: On master: BEGIN
[0m07:43:18.939120 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:18.940114 [debug] [MainThread]: On master: COMMIT
[0m07:43:18.941706 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:18.942489 [debug] [MainThread]: On master: COMMIT
[0m07:43:18.943217 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:18.943811 [debug] [MainThread]: On master: Close
[0m07:43:18.944431 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:18.946353 [info ] [MainThread]: 
[0m07:43:18.952110 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m07:43:18.952858 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m07:43:18.953696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m07:43:18.954287 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m07:43:18.960680 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m07:43:18.962161 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m07:43:18.986235 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m07:43:18.988146 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:43:18.988756 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m07:43:18.989353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:18.995158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:43:18.995937 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:43:18.996661 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m07:43:18.999253 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m07:43:19.004151 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:43:19.004823 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m07:43:19.005997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:19.015677 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m07:43:19.019132 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:43:19.020084 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m07:43:19.024890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:19.029836 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m07:43:19.033410 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:43:19.034095 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m07:43:19.034866 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:43:19.037283 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m07:43:19.039318 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m07:43:19.040530 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m07:43:19.042259 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:19.042699 [debug] [MainThread]: On master: BEGIN
[0m07:43:19.042986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:19.047779 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:19.048623 [debug] [MainThread]: On master: COMMIT
[0m07:43:19.049147 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:19.049637 [debug] [MainThread]: On master: COMMIT
[0m07:43:19.050141 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:19.051289 [debug] [MainThread]: On master: Close
[0m07:43:19.052154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:19.052851 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m07:43:19.053423 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:43:19.054018 [info ] [MainThread]: 
[0m07:43:19.054501 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.20 seconds (10.20s).
[0m07:43:19.055370 [debug] [MainThread]: Command end result
[0m07:43:19.055937 [info ] [MainThread]: 
[0m07:43:19.056791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:19.057386 [info ] [MainThread]: 
[0m07:43:19.057966 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:19.059163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.826896, "process_user_time": 1.216736, "process_kernel_time": 0.083983, "process_mem_max_rss": "108212", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:19.059899 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:19.059801 after 10.83 seconds
[0m07:43:19.060397 [debug] [MainThread]: Flushing usage events
[0m07:43:21.229630 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:21.234084 | c71831f3-a53c-4c7d-b5f3-9e0a3333be0c ==============================
[0m07:43:21.234084 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:21.234905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'send_anonymous_usage_stats': 'True'}
[0m07:43:21.267229 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:21.272830 | ddfad5a2-e768-4b3b-afac-1f411b5f85db ==============================
[0m07:43:21.272830 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:21.273633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:21.370342 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:21.385903 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:21.404261 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:21.415582 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:21.611282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:21.611854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:21.613923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:21.614413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:21.661010 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:21.662401 [info ] [MainThread]: 
[0m07:43:21.663227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:21.663161 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:21.664301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:21.664815 [info ] [MainThread]: 
[0m07:43:21.665396 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:21.666895 [debug] [MainThread]: Command end result
[0m07:43:21.668114 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46876478, "process_user_time": 1.028863, "process_kernel_time": 0.089201, "process_mem_max_rss": "97852", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:21.668853 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:21.668731 after 0.47 seconds
[0m07:43:21.669294 [debug] [MainThread]: Flushing usage events
[0m07:43:21.689660 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:21.690664 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:21.691356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:21.710695 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.019 seconds
[0m07:43:21.712025 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:21.716526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:43:21.717278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:43:21.721709 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:21.723955 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:21.724691 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:21.726288 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:21.727390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:21.728013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:21.734748 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:43:21.735850 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:21.736457 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:21.738816 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:21.740338 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:21.741006 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:23.659928 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m07:43:23.660826 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:23.661308 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:23.663711 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m07:43:23.665010 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:23.665648 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:23.670269 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:23.670841 [debug] [MainThread]: On master: BEGIN
[0m07:43:23.671377 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:23.676471 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:23.677385 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:23.678507 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:23.684341 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m07:43:23.685824 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:23.686394 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:23.686789 [debug] [MainThread]: On master: BEGIN
[0m07:43:23.687411 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:23.688419 [debug] [MainThread]: On master: COMMIT
[0m07:43:23.691709 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:23.693114 [debug] [MainThread]: On master: COMMIT
[0m07:43:23.695915 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:23.696797 [debug] [MainThread]: On master: Close
[0m07:43:23.697443 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:23.698260 [info ] [MainThread]: 
[0m07:43:23.725806 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m07:43:23.731481 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m07:43:23.737916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_product)
[0m07:43:23.738325 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m07:43:23.761829 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.025 seconds
[0m07:43:23.777214 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m07:43:23.779902 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:23.792125 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m07:43:23.796100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:43:23.796844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:43:23.806854 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:23.809084 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:23.810877 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:23.814729 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:23.816900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:23.818722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:23.828103 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m07:43:23.830861 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:43:23.831306 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m07:43:23.831738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:26.738125 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:43:26.740852 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:26.741286 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:26.743730 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m07:43:26.744958 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:26.745611 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:26.750590 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:26.751194 [debug] [MainThread]: On master: BEGIN
[0m07:43:26.754552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:26.759798 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:26.760877 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:26.761808 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:26.765785 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m07:43:26.767262 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:26.768071 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:26.768548 [debug] [MainThread]: On master: BEGIN
[0m07:43:26.769078 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:26.769670 [debug] [MainThread]: On master: COMMIT
[0m07:43:26.770134 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:26.770509 [debug] [MainThread]: On master: COMMIT
[0m07:43:26.770922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:26.771388 [debug] [MainThread]: On master: Close
[0m07:43:26.771980 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:26.772491 [info ] [MainThread]: 
[0m07:43:26.779366 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m07:43:26.782841 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m07:43:26.783488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m07:43:26.783989 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m07:43:26.789915 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m07:43:26.791332 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m07:43:26.817209 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m07:43:26.821327 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:43:26.821957 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m07:43:26.822454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:26.826962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:43:26.828342 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:43:26.829880 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    reseller_id AS sales_agent_key,
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m07:43:26.833033 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m07:43:26.839109 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:43:26.839900 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m07:43:26.840929 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:26.856975 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m07:43:26.857757 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:43:26.858177 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m07:43:26.859177 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:26.863927 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m07:43:26.867194 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:43:26.867843 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m07:43:26.868577 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:43:26.870309 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m07:43:26.871692 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.09s]
[0m07:43:26.876086 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m07:43:26.877616 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:26.878523 [debug] [MainThread]: On master: BEGIN
[0m07:43:26.883688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:26.889214 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:26.892018 [debug] [MainThread]: On master: COMMIT
[0m07:43:26.892501 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:26.892958 [debug] [MainThread]: On master: COMMIT
[0m07:43:26.893516 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:26.894056 [debug] [MainThread]: On master: Close
[0m07:43:26.894776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:26.895333 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:43:26.895804 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m07:43:26.896626 [info ] [MainThread]: 
[0m07:43:26.897261 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m07:43:26.898090 [debug] [MainThread]: Command end result
[0m07:43:26.898685 [info ] [MainThread]: 
[0m07:43:26.899295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:26.899755 [info ] [MainThread]: 
[0m07:43:26.900319 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:26.901345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.663426, "process_user_time": 1.187193, "process_kernel_time": 0.094934, "process_mem_max_rss": "108604", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:26.901976 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:26.901901 after 5.66 seconds
[0m07:43:26.902423 [debug] [MainThread]: Flushing usage events
[0m07:43:28.406539 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:28.428332 | a32bddac-7e98-4d6b-bfee-7a9bde5214f1 ==============================
[0m07:43:28.428332 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:28.435696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'send_anonymous_usage_stats': 'True'}
[0m07:43:28.433389 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:28.453185 | 534922bb-929e-4825-8a10-06511152ddf0 ==============================
[0m07:43:28.453185 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:28.456795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:28.604252 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:28.612840 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:28.626289 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:28.629451 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:28.796940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:28.797760 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:28.804350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:28.806065 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:28.830474 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m07:43:28.832115 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:28.833620 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:28.838405 [debug] [Thread-1 (]: SQL status: BEGIN in 5.006 seconds
[0m07:43:28.834715 [debug] [ThreadPool]: SQL status: BEGIN in 5.018 seconds
[0m07:43:28.843924 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:43:28.845545 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:28.846465 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m07:43:28.846732 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m07:43:28.847090 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:28.850129 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:28.851523 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:28.851896 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m07:43:28.853504 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m07:43:28.858037 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:28.859626 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:43:28.859768 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:28.860436 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m07:43:28.863253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:43:28.865917 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:28.866520 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:28.868217 [debug] [MainThread]: On master: BEGIN
[0m07:43:28.870339 [info ] [MainThread]: 
[0m07:43:28.869352 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:28.871344 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:28.874321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:28.876546 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m07:43:28.877604 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:43:28.878898 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m07:43:28.878724 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m07:43:28.883191 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:28.885068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:28.886847 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:43:28.897891 [debug] [MainThread]: SQL status: SELECT 8 in 0.009 seconds
[0m07:43:28.903357 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m07:43:28.921663 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:28.917431 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:28.909236 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:28.941893 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:43:28.949741 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m07:43:28.946064 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:28.949016 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:28.954890 [debug] [MainThread]: On master: BEGIN
[0m07:43:28.955817 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m07:43:28.957905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:28.965395 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:43:28.971136 [debug] [MainThread]: On master: COMMIT
[0m07:43:28.972209 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:28.969008 [info ] [MainThread]: 
[0m07:43:28.972685 [debug] [MainThread]: On master: COMMIT
[0m07:43:28.976704 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:28.976413 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m07:43:28.978953 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:28.981444 [debug] [MainThread]: On master: Close
[0m07:43:28.983021 [debug] [MainThread]: Command end result
[0m07:43:28.983305 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:28.984044 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.026 seconds
[0m07:43:28.987034 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:28.984602 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 5.25s]
[0m07:43:28.985820 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6332844, "process_user_time": 1.090404, "process_kernel_time": 0.059106, "process_mem_max_rss": "97572", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:28.985381 [info ] [MainThread]: 
[0m07:43:28.990876 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m07:43:28.991527 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:28.991397 after 0.64 seconds
[0m07:43:28.994300 [debug] [MainThread]: Flushing usage events
[0m07:43:28.997068 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:28.994861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:28.998136 [debug] [MainThread]: On master: BEGIN
[0m07:43:29.000642 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m07:43:29.006102 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:29.007917 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m07:43:28.997607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:29.009656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m07:43:29.008648 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:29.012292 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m07:43:29.012020 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:29.014181 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m07:43:29.012999 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:29.019799 [debug] [MainThread]: On master: COMMIT
[0m07:43:29.019104 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:29.020455 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m07:43:29.021552 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:29.020865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:29.023308 [debug] [MainThread]: On master: COMMIT
[0m07:43:29.022019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:29.025041 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:29.025851 [debug] [MainThread]: On master: Close
[0m07:43:29.026346 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m07:43:29.027626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:29.032738 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m07:43:29.033443 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m07:43:29.034176 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:29.036711 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:43:29.038537 [info ] [MainThread]: 
[0m07:43:29.037440 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:29.039767 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.48 seconds (15.48s).
[0m07:43:29.040898 [debug] [MainThread]: Command end result
[0m07:43:29.041695 [info ] [MainThread]: 
[0m07:43:29.042294 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:29.042850 [info ] [MainThread]: 
[0m07:43:29.042460 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m07:43:29.043452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:29.044734 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:29.045920 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.867247, "process_user_time": 1.187586, "process_kernel_time": 0.085619, "process_mem_max_rss": "106532", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:29.047288 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:29.047176 after 15.87 seconds
[0m07:43:29.047819 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:29.048452 [debug] [MainThread]: Flushing usage events
[0m07:43:29.059700 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m07:43:29.068244 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:43:29.071109 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m07:43:29.072949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:30.761586 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:30.765908 | 2df29df3-4942-4872-ad8c-13475de5a69d ==============================
[0m07:43:30.765908 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:30.766590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:43:30.785894 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:30.790862 | f22fce2f-44b9-4a25-b17b-c2230d4e30a1 ==============================
[0m07:43:30.790862 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:30.791467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'send_anonymous_usage_stats': 'True'}
[0m07:43:30.915900 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:30.930344 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:30.942292 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:30.961813 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:31.107187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:31.107862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:31.115379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:31.116862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:31.161422 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:31.168901 [info ] [MainThread]: 
[0m07:43:31.175932 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:31.191094 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:31.202274 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:31.202290 [info ] [MainThread]: 
[0m07:43:31.210557 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:31.226254 [debug] [MainThread]: Command end result
[0m07:43:31.236360 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.53341943, "process_user_time": 1.025451, "process_kernel_time": 0.077639, "process_mem_max_rss": "97456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:31.237047 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:31.236985 after 0.53 seconds
[0m07:43:31.237423 [debug] [MainThread]: Flushing usage events
[0m07:43:31.264642 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:31.265341 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:31.265938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:31.271625 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m07:43:31.272993 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:31.276913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:31.277626 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:31.281860 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:31.283701 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:31.284219 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:31.284673 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:31.285067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:31.285446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:34.031809 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:43:34.032946 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:34.033695 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:34.037049 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:34.039089 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:34.039847 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:34.045102 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.045732 [debug] [MainThread]: On master: BEGIN
[0m07:43:34.048631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:34.052867 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:43:34.053370 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.053932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:34.058112 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m07:43:34.062875 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:34.063496 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.063837 [debug] [MainThread]: On master: BEGIN
[0m07:43:34.064438 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:34.064930 [debug] [MainThread]: On master: COMMIT
[0m07:43:34.065254 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.065515 [debug] [MainThread]: On master: COMMIT
[0m07:43:34.065955 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:34.066274 [debug] [MainThread]: On master: Close
[0m07:43:34.066713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:34.067071 [info ] [MainThread]: 
[0m07:43:34.072168 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m07:43:34.072890 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m07:43:34.074540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_customers)
[0m07:43:34.075523 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m07:43:34.084247 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m07:43:34.088748 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m07:43:34.089211 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:43:34.090152 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m07:43:34.091414 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m07:43:34.092137 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:43:34.100415 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:43:34.101131 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m07:43:34.102212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:34.112704 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m07:43:34.113426 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:43:34.114005 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m07:43:34.115633 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m07:43:34.117591 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m07:43:34.122647 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m07:43:34.126204 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:43:34.126692 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:43:34.127430 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m07:43:34.127295 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m07:43:34.128000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:34.129451 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:43:34.131556 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m07:43:34.132979 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 5.12s]
[0m07:43:34.134303 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m07:43:34.134798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:43:34.136140 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:43:34.136885 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.136785 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m07:43:34.137264 [debug] [MainThread]: On master: BEGIN
[0m07:43:34.137736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:34.140964 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m07:43:34.151970 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:43:34.158341 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m07:43:34.166239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:43:34.183869 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m07:43:34.201894 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:43:34.216764 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m07:43:34.241145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m07:43:34.248938 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m07:43:34.251992 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:43:34.252476 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m07:43:34.253223 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:43:34.254981 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m07:43:34.256705 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.18s]
[0m07:43:34.257704 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m07:43:34.258947 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.262074 [debug] [MainThread]: On master: BEGIN
[0m07:43:34.262819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:34.271400 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m07:43:34.272330 [debug] [MainThread]: On master: COMMIT
[0m07:43:34.272863 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.276845 [debug] [MainThread]: On master: COMMIT
[0m07:43:34.277453 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:34.277802 [debug] [MainThread]: On master: Close
[0m07:43:34.278466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:34.279285 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:34.279714 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m07:43:34.281573 [info ] [MainThread]: 
[0m07:43:34.281933 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.41 seconds (5.41s).
[0m07:43:34.282682 [debug] [MainThread]: Command end result
[0m07:43:34.282992 [info ] [MainThread]: 
[0m07:43:34.283327 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:34.283894 [info ] [MainThread]: 
[0m07:43:34.284621 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:34.285445 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9070973, "process_user_time": 1.242337, "process_kernel_time": 0.086203, "process_mem_max_rss": "106804", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:34.287370 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:34.287282 after 5.91 seconds
[0m07:43:34.293760 [debug] [MainThread]: Flushing usage events
[0m07:43:36.209101 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:43:36.209067 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:36.214546 | 64559345-979d-4972-8202-887186db33b0 ==============================
[0m07:43:36.214546 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:43:36.214359 | c2ed7db9-ce4c-4088-be73-1309f2c59e56 ==============================
[0m07:43:36.214359 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:36.215275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'send_anonymous_usage_stats': 'True'}
[0m07:43:36.216066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:36.290888 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:43:36.291619 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:36.292172 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:36.292550 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m07:43:36.293441 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:36.293906 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:36.294828 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:36.296013 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:36.296305 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m07:43:36.296924 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:36.298013 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:36.299420 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:36.304964 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:36.305689 [debug] [MainThread]: On master: BEGIN
[0m07:43:36.306129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:36.410866 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:36.416097 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:36.428711 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:36.433880 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:36.596993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:36.597737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:36.602763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:36.603411 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:36.659062 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:36.659836 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:36.660544 [info ] [MainThread]: 
[0m07:43:36.661818 [info ] [MainThread]: 
[0m07:43:36.662475 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:36.662831 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:36.663963 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:36.665029 [debug] [MainThread]: Command end result
[0m07:43:36.669202 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49327853, "process_user_time": 1.120243, "process_kernel_time": 0.066864, "process_mem_max_rss": "97584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:36.669981 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:36.669904 after 0.49 seconds
[0m07:43:36.671379 [debug] [MainThread]: Flushing usage events
[0m07:43:36.690680 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:36.691918 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:36.692444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:36.701591 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m07:43:36.702694 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:36.706406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:36.707076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:36.711748 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:36.713842 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:36.714294 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:36.714676 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:36.715050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:36.715535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:39.142106 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m07:43:39.144758 [debug] [MainThread]: On master: COMMIT
[0m07:43:39.145307 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:39.146144 [debug] [MainThread]: On master: COMMIT
[0m07:43:39.146842 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:39.147292 [debug] [MainThread]: On master: Close
[0m07:43:39.147815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:39.148164 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m07:43:39.148516 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:39.148942 [info ] [MainThread]: 
[0m07:43:39.149357 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.44 seconds (20.44s).
[0m07:43:39.149989 [debug] [MainThread]: Command end result
[0m07:43:39.150277 [info ] [MainThread]: 
[0m07:43:39.150667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:39.151047 [info ] [MainThread]: 
[0m07:43:39.151427 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:39.152470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.885977, "process_user_time": 1.201503, "process_kernel_time": 0.096323, "process_mem_max_rss": "106572", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:39.153358 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:39.153256 after 20.89 seconds
[0m07:43:39.153894 [debug] [MainThread]: Flushing usage events
[0m07:43:41.313088 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m07:43:41.317454 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.321898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:41.327695 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:43:41.331138 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:41.331988 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.332518 [debug] [MainThread]: On master: BEGIN
[0m07:43:41.335194 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:41.337058 [debug] [MainThread]: On master: COMMIT
[0m07:43:41.338108 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.339206 [debug] [MainThread]: On master: COMMIT
[0m07:43:41.340009 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:41.340787 [debug] [MainThread]: On master: Close
[0m07:43:41.341556 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:41.342226 [info ] [MainThread]: 
[0m07:43:41.385318 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m07:43:41.389403 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m07:43:41.399149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_product)
[0m07:43:41.418927 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m07:43:41.440900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m07:43:41.442219 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m07:43:41.471623 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m07:43:41.470162 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:43:41.475528 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:43:41.477136 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN


============================== 07:43:41.477360 | f1e21e31-e7cc-4bc3-ade8-9bdba2401844 ==============================
[0m07:43:41.477360 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:41.479251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:41.479665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:41.487307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:43:41.487999 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:43:41.488675 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select product_id as product_key, product_id as original_product_id, product_name, geography_key , product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m07:43:41.497217 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.008 seconds
[0m07:43:41.502381 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:43:41.502976 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m07:43:41.500114 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:43:41.503818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds


============================== 07:43:41.506246 | f20a60c9-2123-497f-93d5-c369d41b6f07 ==============================
[0m07:43:41.506246 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:41.509144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:41.517046 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m07:43:41.518300 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:43:41.519334 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m07:43:41.521235 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:41.527227 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m07:43:41.532299 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:43:41.533687 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m07:43:41.537043 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:43:41.539128 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m07:43:41.540917 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.14s]
[0m07:43:41.541936 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m07:43:41.543346 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.543915 [debug] [MainThread]: On master: BEGIN
[0m07:43:41.544715 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:41.550935 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:43:41.551603 [debug] [MainThread]: On master: COMMIT
[0m07:43:41.552235 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.552759 [debug] [MainThread]: On master: COMMIT
[0m07:43:41.556303 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:41.557373 [debug] [MainThread]: On master: Close
[0m07:43:41.558185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:41.559120 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:41.562073 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m07:43:41.563239 [info ] [MainThread]: 
[0m07:43:41.564791 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.39 seconds (10.39s).
[0m07:43:41.569093 [debug] [MainThread]: Command end result
[0m07:43:41.569766 [info ] [MainThread]: 
[0m07:43:41.573139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:41.573983 [info ] [MainThread]: 
[0m07:43:41.577018 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:41.580330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.905666, "process_user_time": 1.203821, "process_kernel_time": 0.077534, "process_mem_max_rss": "106792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:41.582297 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:41.582172 after 10.91 seconds
[0m07:43:41.583387 [debug] [MainThread]: Flushing usage events
[0m07:43:41.638777 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:41.653145 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:41.673466 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:41.686492 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:41.720942 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:43:41.722229 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:41.724945 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:41.727175 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m07:43:41.729017 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:41.729804 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:41.728718 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:41.735679 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:41.736827 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m07:43:41.738348 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:41.737255 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:41.739246 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:41.746104 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.746827 [debug] [MainThread]: On master: BEGIN
[0m07:43:41.747281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:41.753650 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:43:41.754386 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.754937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:41.760059 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m07:43:41.762201 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:41.763038 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.768001 [debug] [MainThread]: On master: BEGIN
[0m07:43:41.769485 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:41.770961 [debug] [MainThread]: On master: COMMIT
[0m07:43:41.772257 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.773545 [debug] [MainThread]: On master: COMMIT
[0m07:43:41.774591 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:41.775156 [debug] [MainThread]: On master: Close
[0m07:43:41.776020 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:41.777170 [info ] [MainThread]: 
[0m07:43:41.784810 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m07:43:41.785647 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m07:43:41.789910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m07:43:41.791122 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m07:43:41.797491 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m07:43:41.799691 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m07:43:41.844484 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m07:43:41.908803 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:43:41.914215 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m07:43:41.915692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:41.916833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:41.917655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:41.937120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:41.940722 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:41.981168 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:41.983927 [info ] [MainThread]: 
[0m07:43:41.985187 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:41.986216 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:42.001722 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:42.003160 [info ] [MainThread]: 
[0m07:43:42.003712 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:42.005398 [debug] [MainThread]: Command end result
[0m07:43:42.006187 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5412945, "process_user_time": 1.122387, "process_kernel_time": 0.07496, "process_mem_max_rss": "97604", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:42.007014 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:42.006926 after 0.54 seconds
[0m07:43:42.007453 [debug] [MainThread]: Flushing usage events
[0m07:43:42.010539 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:42.011278 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:42.011854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:43.574998 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:43.579497 | f0af2f71-aafa-4994-8789-b2df949d1d25 ==============================
[0m07:43:43.579497 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:43.580139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:43.702807 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:43.719690 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:43.905683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:43.906425 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:43.960377 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:43.961773 [info ] [MainThread]: 
[0m07:43:43.962326 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:43.963925 [debug] [MainThread]: Command end result
[0m07:43:43.964827 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4201588, "process_user_time": 1.034661, "process_kernel_time": 0.055509, "process_mem_max_rss": "98088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:43.965448 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:43.965364 after 0.42 seconds
[0m07:43:43.965868 [debug] [MainThread]: Flushing usage events
[0m07:43:46.939527 [debug] [Thread-1 (]: SQL status: BEGIN in 5.024 seconds
[0m07:43:46.947204 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:43:46.949148 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select customer_key, customer_first_name, customer_last_name, customer_email, sales_agent_key
from "sales_dw"."dev"."staging_customers"
  );
  
[0m07:43:47.017465 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.005 seconds
[0m07:43:47.019395 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:47.025082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:43:47.025836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:43:47.032150 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:47.034695 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:47.035386 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:47.036047 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:47.036761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:47.037452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:47.044553 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:43:47.045376 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:43:47.046578 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:47.048041 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:47.048688 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:47.049546 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:47.052963 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m07:43:47.053385 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m07:43:47.055316 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:47.056816 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:47.057649 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:47.058152 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:47.067295 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:47.068035 [debug] [MainThread]: On master: BEGIN
[0m07:43:47.068729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:47.075817 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:43:47.076723 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:47.077464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:47.083412 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:43:47.086217 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:47.086899 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:47.087386 [debug] [MainThread]: On master: BEGIN
[0m07:43:47.088157 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:47.089253 [debug] [MainThread]: On master: COMMIT
[0m07:43:47.089969 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:47.090995 [debug] [MainThread]: On master: COMMIT
[0m07:43:47.091722 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:47.092252 [debug] [MainThread]: On master: Close
[0m07:43:47.093069 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:47.093788 [info ] [MainThread]: 
[0m07:43:47.100717 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m07:43:47.101641 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m07:43:47.102443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_channel)
[0m07:43:47.103165 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m07:43:47.110791 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m07:43:47.112604 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m07:43:47.144439 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m07:43:47.145847 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:43:47.146253 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m07:43:47.146792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:48.242145 [debug] [Thread-1 (]: SQL status: SELECT 259023 in 1.291 seconds
[0m07:43:48.252501 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:43:48.253177 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m07:43:48.253967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:48.266006 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m07:43:48.266679 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:43:48.267073 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m07:43:48.272802 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m07:43:48.277163 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m07:43:48.280171 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:43:48.280631 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m07:43:48.281312 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:43:48.283576 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m07:43:48.285249 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 259023[0m in 6.49s]
[0m07:43:48.286277 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m07:43:48.288158 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:48.288802 [debug] [MainThread]: On master: BEGIN
[0m07:43:48.289190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:48.293967 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:48.294797 [debug] [MainThread]: On master: COMMIT
[0m07:43:48.295351 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:48.295870 [debug] [MainThread]: On master: COMMIT
[0m07:43:48.296881 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:48.297445 [debug] [MainThread]: On master: Close
[0m07:43:48.298149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:48.298665 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:48.299269 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m07:43:48.299838 [info ] [MainThread]: 
[0m07:43:48.300366 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.64 seconds (11.64s).
[0m07:43:48.301067 [debug] [MainThread]: Command end result
[0m07:43:48.301383 [info ] [MainThread]: 
[0m07:43:48.301833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:48.302315 [info ] [MainThread]: 
[0m07:43:48.302862 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:48.303821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.126955, "process_user_time": 1.280448, "process_kernel_time": 0.083373, "process_mem_max_rss": "108592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:48.304484 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:48.304340 after 12.13 seconds
[0m07:43:48.304912 [debug] [MainThread]: Flushing usage events
[0m07:43:50.643645 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:50.650415 | e66ea3bc-7dc5-498e-a702-530cd98e51d1 ==============================
[0m07:43:50.650415 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:50.651044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:50.798302 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:50.812917 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:51.020940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:51.021568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:51.077341 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:51.079538 [info ] [MainThread]: 
[0m07:43:51.080239 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:51.082554 [debug] [MainThread]: Command end result
[0m07:43:51.083439 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48083976, "process_user_time": 1.054085, "process_kernel_time": 0.066765, "process_mem_max_rss": "97460", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:51.084101 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:51.083986 after 0.48 seconds
[0m07:43:51.084500 [debug] [MainThread]: Flushing usage events
[0m07:43:52.159155 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m07:43:52.160270 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:43:52.161008 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m07:43:52.164737 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m07:43:52.169567 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:43:52.170045 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m07:43:52.170763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:52.185027 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m07:43:52.185898 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:43:52.189698 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m07:43:52.191089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:52.195539 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m07:43:52.198793 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:43:52.199280 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m07:43:52.199914 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:43:52.203030 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m07:43:52.204778 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 5.10s]
[0m07:43:52.205467 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m07:43:52.206974 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:52.207414 [debug] [MainThread]: On master: BEGIN
[0m07:43:52.207741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:52.212347 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:52.212991 [debug] [MainThread]: On master: COMMIT
[0m07:43:52.213365 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:52.213799 [debug] [MainThread]: On master: COMMIT
[0m07:43:52.214323 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:52.214798 [debug] [MainThread]: On master: Close
[0m07:43:52.215282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:52.215620 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m07:43:52.215902 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:52.216266 [info ] [MainThread]: 
[0m07:43:52.217050 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.23 seconds (10.23s).
[0m07:43:52.217947 [debug] [MainThread]: Command end result
[0m07:43:52.218329 [info ] [MainThread]: 
[0m07:43:52.218775 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:52.219105 [info ] [MainThread]: 
[0m07:43:52.219411 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:52.220206 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.784707, "process_user_time": 1.249406, "process_kernel_time": 0.093832, "process_mem_max_rss": "106420", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:52.220750 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:52.220674 after 10.79 seconds
[0m07:43:52.221116 [debug] [MainThread]: Flushing usage events
[0m07:43:54.723495 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:54.729747 | 71b9d206-843c-4ec5-92e1-1f4dfd762e09 ==============================
[0m07:43:54.729747 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:54.731498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:54.733361 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:54.739417 | 286d024a-44ea-47f5-b5b1-b546a7a66ae5 ==============================
[0m07:43:54.739417 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:54.740268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:54.749684 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:54.760674 | a6d102fb-e54e-43ea-856d-6934ad55a092 ==============================
[0m07:43:54.760674 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:54.762314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:55.051889 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:55.058965 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:55.072283 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:55.078914 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:55.087936 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:55.111635 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:55.233854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:55.236279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:55.256093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:55.256892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:55.271462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:55.272522 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:55.312803 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:55.315732 [info ] [MainThread]: 
[0m07:43:55.316765 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:55.318109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:55.318762 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:55.324282 [info ] [MainThread]: 
[0m07:43:55.325563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:55.327290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:55.328072 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:55.330160 [info ] [MainThread]: 
[0m07:43:55.330973 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:55.332742 [debug] [MainThread]: Command end result
[0m07:43:55.333680 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.62375444, "process_user_time": 1.202804, "process_kernel_time": 0.059435, "process_mem_max_rss": "97432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:55.334366 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:55.334266 after 0.62 seconds
[0m07:43:55.334791 [debug] [MainThread]: Flushing usage events
[0m07:43:55.348755 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:55.352892 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:55.353331 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:55.353897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:55.354192 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:55.354811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:55.364190 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m07:43:55.365383 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:55.369470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:43:55.369987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:43:55.374553 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:55.376555 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:55.377128 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:55.377628 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:55.378035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:55.378379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:55.383749 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:43:55.386423 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:55.388433 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:55.393530 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m07:43:55.395745 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:55.396765 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:44:00.362044 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.007 seconds
[0m07:44:00.363465 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:44:00.367581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:44:00.368229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:44:00.376753 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:00.378614 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:00.379088 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:44:00.379544 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:44:00.379879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:00.380394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:00.382701 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:44:00.383470 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:00.384080 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:44:00.385714 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:44:00.386347 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:44:00.387614 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:44:00.386884 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:00.388113 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:44:00.388120 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:44:00.391378 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:44:00.392899 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:44:00.393364 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:00.393636 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:44:00.394086 [debug] [MainThread]: On master: BEGIN
[0m07:44:00.394903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:44:00.399608 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:44:00.400319 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:00.400746 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:44:00.406082 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:44:00.408586 [debug] [MainThread]: On master: ROLLBACK
[0m07:44:00.409433 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:00.409934 [debug] [MainThread]: On master: BEGIN
[0m07:44:00.410606 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:44:00.411206 [debug] [MainThread]: On master: COMMIT
[0m07:44:00.411570 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:00.411931 [debug] [MainThread]: On master: COMMIT
[0m07:44:00.412350 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:00.412852 [debug] [MainThread]: On master: Close
[0m07:44:00.413456 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:44:00.413970 [info ] [MainThread]: 
[0m07:44:00.419551 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m07:44:00.420357 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m07:44:00.421116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_main)
[0m07:44:00.424364 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m07:44:00.442800 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m07:44:00.452413 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m07:44:00.487686 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m07:44:00.489359 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m07:44:00.490071 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m07:44:00.490541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:00.496672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:44:00.497338 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m07:44:00.497865 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m07:44:05.384780 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:44:05.387963 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:05.388718 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:44:05.393077 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.003 seconds
[0m07:44:05.394457 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:44:05.394965 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:44:05.400092 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.400645 [debug] [MainThread]: On master: BEGIN
[0m07:44:05.400990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:44:05.406982 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:44:05.408814 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.409690 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:44:05.417847 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m07:44:05.419940 [debug] [MainThread]: On master: ROLLBACK
[0m07:44:05.420618 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.421125 [debug] [MainThread]: On master: BEGIN
[0m07:44:05.421827 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:44:05.422618 [debug] [MainThread]: On master: COMMIT
[0m07:44:05.423231 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.424238 [debug] [MainThread]: On master: COMMIT
[0m07:44:05.425411 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:05.425925 [debug] [MainThread]: On master: Close
[0m07:44:05.426645 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:44:05.427105 [info ] [MainThread]: 
[0m07:44:05.434706 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m07:44:05.435353 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m07:44:05.436799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_resellers_xml)
[0m07:44:05.439074 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m07:44:05.454867 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:44:05.456285 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m07:44:05.495006 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:44:05.497101 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:44:05.497556 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m07:44:05.497854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:05.502262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:44:05.506726 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:44:05.509064 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 

  

trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  



)


SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m07:44:05.677931 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 5.180 seconds
[0m07:44:05.702475 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m07:44:05.703085 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m07:44:05.703618 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m07:44:05.706048 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:44:05.707803 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m07:44:05.709402 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 5.29s]
[0m07:44:05.710187 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m07:44:05.711935 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.712374 [debug] [MainThread]: On master: BEGIN
[0m07:44:05.712681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:44:05.717193 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:44:05.717856 [debug] [MainThread]: On master: COMMIT
[0m07:44:05.718390 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.718827 [debug] [MainThread]: On master: COMMIT
[0m07:44:05.719583 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:05.720154 [debug] [MainThread]: On master: Close
[0m07:44:05.720814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:05.721262 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m07:44:05.721699 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:44:05.722111 [info ] [MainThread]: 
[0m07:44:05.722472 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.41 seconds (10.41s).
[0m07:44:05.723169 [debug] [MainThread]: Command end result
[0m07:44:05.723681 [info ] [MainThread]: 
[0m07:44:05.724273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:44:05.724720 [info ] [MainThread]: 
[0m07:44:05.725098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:44:05.725799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.030321, "process_user_time": 1.397085, "process_kernel_time": 0.089372, "process_mem_max_rss": "107052", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:05.726209 [debug] [MainThread]: Command `dbt run` succeeded at 07:44:05.726154 after 11.03 seconds
[0m07:44:05.726546 [debug] [MainThread]: Flushing usage events
[0m07:44:05.931112 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.421 seconds
[0m07:44:05.942870 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m07:44:05.943456 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:44:05.943792 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m07:44:05.944717 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:44:05.946751 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m07:44:05.948554 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 0[0m in 0.51s]
[0m07:44:05.950120 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m07:44:05.951726 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.956491 [debug] [MainThread]: On master: BEGIN
[0m07:44:05.959134 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:44:07.706673 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:44:07.710974 | 353a48dd-2a57-4434-9eba-61d771e7df57 ==============================
[0m07:44:07.710974 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:44:07.712727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:44:07.845758 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:07.856259 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:44:08.025691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:08.026269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:08.083336 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:44:08.084791 [info ] [MainThread]: 
[0m07:44:08.085419 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:44:08.086796 [debug] [MainThread]: Command end result
[0m07:44:08.087353 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.41148338, "process_user_time": 1.065715, "process_kernel_time": 0.056907, "process_mem_max_rss": "97720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:08.087770 [debug] [MainThread]: Command `dbt test` succeeded at 07:44:08.087714 after 0.41 seconds
[0m07:44:08.088051 [debug] [MainThread]: Flushing usage events
[0m07:44:10.966876 [debug] [MainThread]: SQL status: BEGIN in 5.008 seconds
[0m07:44:10.967952 [debug] [MainThread]: On master: COMMIT
[0m07:44:10.969647 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:10.970149 [debug] [MainThread]: On master: COMMIT
[0m07:44:10.970693 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:10.971290 [debug] [MainThread]: On master: Close
[0m07:44:10.972038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:10.973743 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m07:44:10.974694 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:44:10.975666 [info ] [MainThread]: 
[0m07:44:10.976557 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 15.65 seconds (15.65s).
[0m07:44:10.978027 [debug] [MainThread]: Command end result
[0m07:44:10.978685 [info ] [MainThread]: 
[0m07:44:10.979862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:44:10.982590 [info ] [MainThread]: 
[0m07:44:10.983185 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:44:10.984171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.298986, "process_user_time": 1.383166, "process_kernel_time": 0.095995, "process_mem_max_rss": "108972", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:10.984776 [debug] [MainThread]: Command `dbt run` succeeded at 07:44:10.984715 after 16.30 seconds
[0m07:44:10.985259 [debug] [MainThread]: Flushing usage events
[0m07:44:12.885707 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:44:12.907366 | 64cd8491-b891-4608-ba63-21b23e9ac22d ==============================
[0m07:44:12.907366 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:44:12.897934 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:44:12.920164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}


============================== 07:44:12.929423 | de389399-e7a2-4bcd-81ca-f397941cf11f ==============================
[0m07:44:12.929423 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:44:12.931775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:44:13.098022 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:13.104445 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:13.109742 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:44:13.124144 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:44:13.257850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:13.258425 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:13.277141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:13.277764 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:13.313594 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:44:13.315416 [info ] [MainThread]: 
[0m07:44:13.316141 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:44:13.318205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:44:13.331606 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:44:13.333412 [info ] [MainThread]: 
[0m07:44:13.336848 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:44:13.338553 [debug] [MainThread]: Command end result
[0m07:44:13.339405 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.51890063, "process_user_time": 1.065538, "process_kernel_time": 0.064586, "process_mem_max_rss": "97468", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:13.343251 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:44:13.351650 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:44:13.351034 [debug] [MainThread]: Command `dbt test` succeeded at 07:44:13.350869 after 0.53 seconds
[0m07:44:13.352297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:13.352592 [debug] [MainThread]: Flushing usage events
[0m07:44:18.363658 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.015 seconds
[0m07:44:18.367376 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:44:18.373496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:44:18.374031 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:44:18.378600 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:18.380340 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:18.380776 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:44:18.381237 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:44:18.381602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:18.382002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:18.387150 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:44:18.388096 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:18.388667 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:44:18.391122 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:44:18.392380 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:44:18.393109 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:44:23.393810 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m07:44:23.396807 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:23.399085 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:44:23.401441 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.002 seconds
[0m07:44:23.403579 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:44:23.405151 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:44:23.410524 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:23.411096 [debug] [MainThread]: On master: BEGIN
[0m07:44:23.411478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:44:28.422719 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m07:44:28.427103 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:28.431269 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:44:28.436468 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:44:28.438208 [debug] [MainThread]: On master: ROLLBACK
[0m07:44:28.438882 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:28.439282 [debug] [MainThread]: On master: BEGIN
[0m07:44:28.439805 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:44:28.440133 [debug] [MainThread]: On master: COMMIT
[0m07:44:28.445078 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:28.445600 [debug] [MainThread]: On master: COMMIT
[0m07:44:28.446176 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:28.446546 [debug] [MainThread]: On master: Close
[0m07:44:28.446986 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:44:28.447318 [info ] [MainThread]: 
[0m07:44:28.452415 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m07:44:28.453127 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m07:44:28.453896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m07:44:28.454747 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m07:44:28.460698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m07:44:28.461990 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m07:44:28.490919 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m07:44:28.492458 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:44:28.492848 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m07:44:28.493197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:33.505810 [debug] [Thread-1 (]: SQL status: BEGIN in 5.013 seconds
[0m07:44:33.511259 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:44:33.511890 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m07:44:34.198437 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 0.686 seconds
[0m07:44:34.206051 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:44:34.209702 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m07:44:34.211868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:44:34.226018 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m07:44:34.226738 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:44:34.227135 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m07:44:34.234209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m07:44:34.239010 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m07:44:34.241917 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:44:34.242324 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m07:44:34.242826 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:44:34.244532 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m07:44:34.245762 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1000000[0m in 5.79s]
[0m07:44:34.246484 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m07:44:34.248343 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:34.249048 [debug] [MainThread]: On master: BEGIN
[0m07:44:34.251598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:44:34.257998 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:44:34.259257 [debug] [MainThread]: On master: COMMIT
[0m07:44:34.260094 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:34.261738 [debug] [MainThread]: On master: COMMIT
[0m07:44:34.262488 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:34.263468 [debug] [MainThread]: On master: Close
[0m07:44:34.264161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:34.264654 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:44:34.267837 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m07:44:34.268618 [info ] [MainThread]: 
[0m07:44:34.269197 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.95 seconds (20.95s).
[0m07:44:34.269825 [debug] [MainThread]: Command end result
[0m07:44:34.270255 [info ] [MainThread]: 
[0m07:44:34.270875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:44:34.271522 [info ] [MainThread]: 
[0m07:44:34.272109 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:44:34.275182 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.457815, "process_user_time": 1.172803, "process_kernel_time": 0.094386, "process_mem_max_rss": "108548", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:34.275812 [debug] [MainThread]: Command `dbt run` succeeded at 07:44:34.275726 after 21.46 seconds
[0m07:44:34.278079 [debug] [MainThread]: Flushing usage events
[0m07:44:36.356724 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:44:36.361456 | df0efe30-2c52-4d73-9831-d3d15fc31a71 ==============================
[0m07:44:36.361456 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:44:36.362154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:44:36.384094 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:44:36.390947 | 0ab2ae64-bcea-4bc1-9a2e-98368949942f ==============================
[0m07:44:36.390947 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:44:36.391462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:44:36.502352 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:36.525406 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:44:36.529712 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:36.545917 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:44:36.687658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:36.688519 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:36.707335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:36.710019 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:36.739672 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:44:36.740975 [info ] [MainThread]: 
[0m07:44:36.741563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:44:36.742430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:44:36.801215 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:44:36.805531 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:44:36.811400 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:44:36.830056 [info ] [MainThread]: 
[0m07:44:36.830323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:36.831164 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:44:36.833436 [debug] [MainThread]: Command end result
[0m07:44:36.834390 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49132922, "process_user_time": 1.041072, "process_kernel_time": 0.076891, "process_mem_max_rss": "97712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:36.834915 [debug] [MainThread]: Command `dbt test` succeeded at 07:44:36.834847 after 0.49 seconds
[0m07:44:36.835268 [debug] [MainThread]: Flushing usage events
[0m07:44:36.838040 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m07:44:36.842026 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:44:36.847132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:44:36.848303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:44:36.853784 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:36.856085 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:36.860089 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:44:36.860744 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:44:36.861224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:36.861780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:36.870307 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:44:36.872035 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:36.872591 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:44:36.876032 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.003 seconds
[0m07:44:36.877277 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:44:36.881210 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:44:41.874147 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m07:44:41.876936 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:41.879323 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:44:41.884334 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:44:41.885747 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:44:41.887015 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:44:41.891649 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:41.892113 [debug] [MainThread]: On master: BEGIN
[0m07:44:41.892418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:44:46.897697 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m07:44:46.898887 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:46.899453 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:44:46.908077 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m07:44:46.911943 [debug] [MainThread]: On master: ROLLBACK
[0m07:44:46.912857 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:46.913232 [debug] [MainThread]: On master: BEGIN
[0m07:44:46.915071 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:44:46.915546 [debug] [MainThread]: On master: COMMIT
[0m07:44:46.916061 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:46.916394 [debug] [MainThread]: On master: COMMIT
[0m07:44:46.917027 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:46.917836 [debug] [MainThread]: On master: Close
[0m07:44:46.918645 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:44:46.920316 [info ] [MainThread]: 
[0m07:44:46.935495 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m07:44:46.938353 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m07:44:46.939497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.fact_sales)
[0m07:44:46.941333 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m07:44:46.947519 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m07:44:46.948698 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m07:44:46.977792 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m07:44:46.987040 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:44:46.989139 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m07:44:46.989596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:51.998382 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m07:44:52.004160 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:44:52.004656 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    transaction_id,
    product_key,
    channel_key,
    reseller_id,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    commissionpct,
    commissionpaid,
    product_price
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m07:44:52.902661 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 0.897 seconds
[0m07:44:52.910206 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:44:52.912914 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m07:44:52.913608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:44:52.924079 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m07:44:52.924630 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:44:52.925045 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m07:44:52.936138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m07:44:52.951827 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m07:44:52.957425 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:44:52.959050 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m07:44:52.959788 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:44:52.962226 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m07:44:52.963856 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1000000[0m in 6.02s]
[0m07:44:52.964750 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m07:44:52.969082 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:52.969688 [debug] [MainThread]: On master: BEGIN
[0m07:44:52.970123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:44:52.974637 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:44:52.975268 [debug] [MainThread]: On master: COMMIT
[0m07:44:52.975614 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:52.975870 [debug] [MainThread]: On master: COMMIT
[0m07:44:52.976236 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:52.976775 [debug] [MainThread]: On master: Close
[0m07:44:52.978135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:52.978510 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:44:52.978914 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m07:44:52.983229 [info ] [MainThread]: 
[0m07:44:52.983590 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.24 seconds (16.24s).
[0m07:44:52.984090 [debug] [MainThread]: Command end result
[0m07:44:52.984340 [info ] [MainThread]: 
[0m07:44:52.984639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:44:52.984893 [info ] [MainThread]: 
[0m07:44:52.985161 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:44:52.985706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.664019, "process_user_time": 1.185941, "process_kernel_time": 0.078459, "process_mem_max_rss": "108384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:52.986095 [debug] [MainThread]: Command `dbt run` succeeded at 07:44:52.986044 after 16.66 seconds
[0m07:44:52.986383 [debug] [MainThread]: Flushing usage events
[0m07:44:55.308103 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:44:55.313160 | 91ae94d0-a007-4b34-8893-03f67f025e57 ==============================
[0m07:44:55.313160 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:44:55.313786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'send_anonymous_usage_stats': 'True'}
[0m07:44:55.449546 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:55.465063 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:44:55.696250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:55.696768 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:55.751601 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:44:55.753100 [info ] [MainThread]: 
[0m07:44:55.753809 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:44:55.757376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:44:55.757941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:44:55.785806 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:55.786167 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:55.786566 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:44:55.786930 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:44:55.787321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:55.787687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:55.793058 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:44:55.796775 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:55.797375 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:44:55.799557 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.002 seconds
[0m07:44:55.800883 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:44:55.801462 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:45:00.798290 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m07:45:00.801243 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:45:00.803105 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:45:00.806431 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:45:00.808333 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:45:00.809235 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:45:00.814406 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:00.815095 [debug] [MainThread]: On master: BEGIN
[0m07:45:00.815544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:45:05.827112 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m07:45:05.836163 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:05.837005 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:45:05.845639 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:45:05.849411 [debug] [MainThread]: On master: ROLLBACK
[0m07:45:05.854364 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:05.854885 [debug] [MainThread]: On master: BEGIN
[0m07:45:05.855916 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:45:05.858147 [debug] [MainThread]: On master: COMMIT
[0m07:45:05.859963 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:05.864132 [debug] [MainThread]: On master: COMMIT
[0m07:45:05.864838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:45:05.865302 [debug] [MainThread]: On master: Close
[0m07:45:05.870477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:45:05.871805 [info ] [MainThread]: 
[0m07:45:05.879595 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m07:45:05.880203 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m07:45:05.880672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m07:45:05.881038 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m07:45:05.886994 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m07:45:05.888330 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m07:45:05.899273 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m07:45:05.901049 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m07:45:05.901682 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m07:45:05.902267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:45:05.906899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:45:05.907563 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m07:45:05.907898 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m07:45:06.038581 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.130 seconds
[0m07:45:06.041760 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m07:45:06.042555 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m07:45:06.043335 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.16s]
[0m07:45:06.044110 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m07:45:06.045793 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:06.053205 [debug] [MainThread]: On master: BEGIN
[0m07:45:06.056133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:45:06.064672 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m07:45:06.065344 [debug] [MainThread]: On master: COMMIT
[0m07:45:06.066212 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:06.068239 [debug] [MainThread]: On master: COMMIT
[0m07:45:06.073448 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:45:06.076501 [debug] [MainThread]: On master: Close
[0m07:45:06.077179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:45:06.077528 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m07:45:06.077851 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:45:06.078458 [info ] [MainThread]: 
[0m07:45:06.079060 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m07:45:06.082385 [debug] [MainThread]: Command end result
[0m07:45:06.082940 [info ] [MainThread]: 
[0m07:45:06.083356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:45:06.083634 [info ] [MainThread]: 
[0m07:45:06.083928 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:45:06.084572 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.808046, "process_user_time": 1.109126, "process_kernel_time": 0.090664, "process_mem_max_rss": "108536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:45:06.088278 [debug] [MainThread]: Command `dbt test` succeeded at 07:45:06.088196 after 10.81 seconds
[0m07:45:06.088650 [debug] [MainThread]: Flushing usage events
[0m08:44:01.894300 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:44:01.899202 | 3b60a20c-60d4-45d3-85ce-823e17e531b4 ==============================
[0m08:44:01.899202 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:44:01.899997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:44:01.978461 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m08:44:01.980589 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m08:44:01.989568 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tcwrieop'
[0m08:44:01.990438 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m08:44:01.991420 [debug] [MainThread]: Creating symlink to local dependency.
[0m08:44:01.992119 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m08:44:01.993196 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13621387, "process_user_time": 0.813473, "process_kernel_time": 0.068039, "process_mem_max_rss": "105500", "process_in_blocks": "8", "process_out_blocks": "8"}
[0m08:44:01.993929 [debug] [MainThread]: Command `dbt deps` succeeded at 08:44:01.993830 after 0.14 seconds
[0m08:44:01.994354 [debug] [MainThread]: Flushing usage events
[0m08:44:03.993524 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:44:04.000100 | e37326f8-98d1-4312-9b5a-b6d55aea6715 ==============================
[0m08:44:04.000100 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:44:04.000592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m08:44:04.132135 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:44:04.150068 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:44:04.151118 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:44:05.459928 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:44:05.466770 [info ] [MainThread]: 
[0m08:44:05.467344 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:44:05.469479 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:44:05.530027 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:44:05.530666 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:44:05.531395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:05.537666 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m08:44:05.538893 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:44:05.540855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m08:44:05.546538 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m08:44:05.551762 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m08:44:05.552204 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m08:44:05.552617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:44:05.558088 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:44:05.564455 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m08:44:05.568363 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m08:44:05.569224 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:44:05.569989 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m08:44:05.570427 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m08:44:05.570851 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m08:44:05.571616 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m08:44:05.571935 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m08:44:05.575872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m08:44:05.576363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:44:05.580989 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:44:05.583509 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:44:05.584021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:44:05.583052 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:44:05.585006 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:44:05.585487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:05.588743 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:44:05.589457 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:44:05.589961 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:44:05.592022 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:44:05.593028 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:44:05.593417 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:44:10.598096 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m08:44:10.598787 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:44:10.599150 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:44:10.601217 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:44:10.602286 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:44:10.602810 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:44:10.606523 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:10.606960 [debug] [MainThread]: On master: BEGIN
[0m08:44:10.607292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:44:10.611196 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:44:10.611924 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:10.612518 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:44:10.615687 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m08:44:10.616994 [debug] [MainThread]: On master: ROLLBACK
[0m08:44:10.617661 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:10.618029 [debug] [MainThread]: On master: BEGIN
[0m08:44:10.620704 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:44:10.621163 [debug] [MainThread]: On master: COMMIT
[0m08:44:10.621714 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:10.622072 [debug] [MainThread]: On master: COMMIT
[0m08:44:10.622541 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:44:10.622859 [debug] [MainThread]: On master: Close
[0m08:44:10.623354 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:44:10.623771 [info ] [MainThread]: 
[0m08:44:10.628624 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m08:44:10.629341 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m08:44:10.630105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now seed.dbtcomp.geography)
[0m08:44:10.630678 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m08:44:10.631279 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m08:44:10.649332 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:44:10.649853 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m08:44:10.650125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:44:15.654565 [debug] [Thread-1 (]: SQL status: BEGIN in 5.004 seconds
[0m08:44:15.659287 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:44:15.660235 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m08:44:15.662845 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m08:44:15.719552 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:44:15.727391 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m08:44:15.755818 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.002 seconds
[0m08:44:15.788162 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m08:44:15.804877 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m08:44:15.806484 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:44:15.806809 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m08:44:15.807904 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:44:15.809766 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m08:44:15.810956 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 5.18s]
[0m08:44:15.811635 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m08:44:15.818047 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:15.820763 [debug] [MainThread]: On master: BEGIN
[0m08:44:15.822249 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:44:20.844019 [debug] [MainThread]: SQL status: BEGIN in 5.022 seconds
[0m08:44:20.861673 [debug] [MainThread]: On master: COMMIT
[0m08:44:20.864659 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:20.870851 [debug] [MainThread]: On master: COMMIT
[0m08:44:20.871692 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:44:20.872005 [debug] [MainThread]: On master: Close
[0m08:44:20.872401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:20.873948 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:44:20.874300 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m08:44:20.874691 [info ] [MainThread]: 
[0m08:44:20.875005 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 15.41 seconds (15.41s).
[0m08:44:20.875509 [debug] [MainThread]: Command end result
[0m08:44:20.929167 [info ] [MainThread]: 
[0m08:44:20.929664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:44:20.929957 [info ] [MainThread]: 
[0m08:44:20.930265 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:44:20.930990 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 16.975616, "process_user_time": 2.138979, "process_kernel_time": 0.090436, "process_mem_max_rss": "113976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:44:20.931547 [debug] [MainThread]: Command `dbt seed` succeeded at 08:44:20.931449 after 16.98 seconds
[0m08:44:20.931896 [debug] [MainThread]: Flushing usage events
[0m08:45:07.665672 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:07.671613 | b337152c-07f5-47d2-9fd9-a1b41714f4e8 ==============================
[0m08:45:07.671613 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.667089 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:07.672646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 08:45:07.673595 | 3d3a7197-dfef-4be9-adfe-6ba10ab47fec ==============================
[0m08:45:07.673595 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.674633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:07.671845 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:07.682461 | a29ecc18-c19e-4eac-afdf-82c84801c419 ==============================
[0m08:45:07.682461 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.683281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:07.703053 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:07.707970 | 6b3fd7d7-afea-4c62-a096-63b720af5d94 ==============================
[0m08:45:07.707970 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.708904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:45:07.724072 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:07.725699 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:07.729998 | d605b212-3ad8-4835-bf1a-8005a4bda428 ==============================
[0m08:45:07.729998 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.732784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 08:45:07.733190 | 59b4fdcb-394c-4a7b-bb1e-32e95b0f649c ==============================
[0m08:45:07.733190 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.724998 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:07.734426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 08:45:07.735421 | 8a0e33c2-638e-457e-8511-f279dd918bc2 ==============================
[0m08:45:07.735421 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.741699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:07.815426 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.832592 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.834258 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:07.854963 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.861186 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:07.870208 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.879232 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:07.889602 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.894488 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.902111 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.901782 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:07.953817 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:07.955979 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:07.962484 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:07.977279 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:07.971501 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:07.987877 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:07.998049 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:08.003093 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:08.003849 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:08.036983 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:08.037774 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:08.064387 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:08.065372 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:08.079518 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:08.080378 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:08.106160 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:08.106976 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:09.151973 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.158003 [info ] [MainThread]: 
[0m08:45:09.161411 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.166129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.168056 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.173169 [info ] [MainThread]: 
[0m08:45:09.174117 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.174993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.192841 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.193812 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.194955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.201370 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.202633 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.202643 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.008 seconds
[0m08:45:09.203393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.204521 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:09.206693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m08:45:09.211745 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m08:45:09.213812 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.010 seconds
[0m08:45:09.215025 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:09.219842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m08:45:09.220735 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m08:45:09.220864 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:45:09.223982 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m08:45:09.224893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.225777 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:45:09.226415 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m08:45:09.228254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.233393 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:45:09.236136 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:45:09.237043 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:45:09.237489 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:45:09.238229 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m08:45:09.239693 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m08:45:09.241142 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m08:45:09.242331 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m08:45:09.242910 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:45:09.243233 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m08:45:09.244309 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m08:45:09.244750 [debug] [ThreadPool]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "pg_namespace_nspname_index"
DETAIL:  Key (nspname)=(dev) already exists.

[0m08:45:09.246467 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m08:45:09.246664 [debug] [ThreadPool]: On create_sales_dw_dev: ROLLBACK
[0m08:45:09.248276 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m08:45:09.249817 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m08:45:09.251780 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m08:45:09.252744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m08:45:09.256869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:09.253328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:45:09.263209 [debug] [MainThread]: Connection 'create_sales_dw_dev' was properly closed.
[0m08:45:09.267944 [info ] [MainThread]: 
[0m08:45:09.261857 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.269451 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m08:45:09.270178 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:09.273494 [error] [MainThread]: Encountered an error:
Database Error
  duplicate key value violates unique constraint "pg_namespace_nspname_index"
  DETAIL:  Key (nspname)=(dev) already exists.
[0m08:45:09.267669 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:09.276189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6480398, "process_user_time": 2.042435, "process_kernel_time": 0.109076, "process_mem_max_rss": "111768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:09.278473 [debug] [MainThread]: Command `dbt run` failed at 08:45:09.278275 after 1.65 seconds
[0m08:45:09.277626 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.274488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.279382 [debug] [MainThread]: Flushing usage events
[0m08:45:09.277063 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:09.282305 [info ] [MainThread]: 
[0m08:45:09.288061 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m08:45:09.283972 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.289200 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.288684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.291266 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.293999 [info ] [MainThread]: 
[0m08:45:09.294224 [info ] [MainThread]: 
[0m08:45:09.290755 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.296078 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.297301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.296284 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.297357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.298021 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:09.301896 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.301522 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m08:45:09.301379 [info ] [MainThread]: 
[0m08:45:09.304121 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.304218 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:09.305314 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.306678 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:09.305757 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m08:45:09.307811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.308416 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.309599 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:09.311497 [info ] [MainThread]: 
[0m08:45:09.309942 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:45:09.313878 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.312355 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:09.314886 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:09.316167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.318655 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:09.322868 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.323433 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.324049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.326245 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.326608 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:09.327069 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.327590 [debug] [MainThread]: On master: BEGIN
[0m08:45:09.327713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.328107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:09.328650 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.329231 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.329752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.335979 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.336581 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m08:45:09.337701 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.338267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.338432 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:09.342567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:45:09.344675 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.345128 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m08:45:09.345614 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.346592 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:09.347014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.343181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:45:09.348202 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:09.351078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:45:09.351805 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:09.352343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.351231 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.353143 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:09.353610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.353921 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m08:45:09.355374 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:09.351775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:45:09.358915 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:45:09.359619 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.360210 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:09.356773 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:09.360426 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.361173 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:09.361397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:45:09.361710 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:09.362470 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:09.362236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.363911 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:09.363114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.364997 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:09.362081 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:45:09.369270 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:45:09.370058 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:09.370500 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:09.368419 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.370841 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:45:09.371136 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:09.371849 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.371658 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:09.372328 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:09.372081 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:09.372414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.373027 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:45:09.372998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.374214 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:09.374616 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:09.375085 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:09.376036 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:09.377163 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:09.381428 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:09.382005 [debug] [MainThread]: On master: BEGIN
[0m08:45:09.382368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:14.335246 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m08:45:14.343160 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.015 seconds
[0m08:45:14.339112 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.015 seconds
[0m08:45:14.352806 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.361402 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m08:45:14.359397 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:14.367703 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:14.366988 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:14.380081 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m08:45:14.378771 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:14.389849 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m08:45:14.391123 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:14.384857 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m08:45:14.392548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:45:14.392462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:45:14.391626 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.393483 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:45:14.390945 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:14.395420 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:14.393801 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:45:14.394878 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:14.397283 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:14.393639 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:14.396119 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:14.393094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:45:14.395913 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:14.393182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:45:14.398139 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:14.401417 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.400804 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:45:14.398886 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:14.402197 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.401621 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:14.403252 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:14.403302 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:14.403434 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.402781 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:14.402879 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:14.399029 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:14.404991 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.404468 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:45:14.404210 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:14.405025 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.405517 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:14.405606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:14.405938 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.403666 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:45:14.407129 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.405104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:14.407674 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.406450 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.404385 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:14.406324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:14.405921 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:14.408399 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:14.409062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:14.408185 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:14.409144 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:14.410320 [debug] [MainThread]: On master: Close
[0m08:45:14.410330 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:14.411502 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.406847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:14.412185 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:14.410987 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:14.411990 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:45:14.412874 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.414460 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.414039 [info ] [MainThread]: 
[0m08:45:14.415444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:14.414792 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.416170 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:45:14.417974 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:14.418340 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:14.418836 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:14.418814 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.419292 [debug] [MainThread]: On master: Close
[0m08:45:14.420235 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:45:14.420266 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:14.419910 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.421069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:14.420887 [info ] [MainThread]: 
[0m08:45:14.421405 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:14.421454 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:14.422618 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m08:45:14.426227 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.426651 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:14.426722 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:45:14.426768 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m08:45:14.427137 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.428064 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:14.428677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_geography)
[0m08:45:14.428196 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.428354 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m08:45:14.429076 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:14.431017 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m08:45:14.431774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:14.432169 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.432042 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m08:45:14.433169 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.434017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m08:45:14.433990 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.434799 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m08:45:14.435099 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:14.435705 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:45:14.435659 [debug] [MainThread]: On master: Close
[0m08:45:14.436980 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:14.436756 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:14.437807 [info ] [MainThread]: 
[0m08:45:14.437842 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.438468 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m08:45:14.438728 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.440256 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:14.441209 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m08:45:14.441441 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.442066 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m08:45:14.442209 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.443938 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m08:45:14.447410 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m08:45:14.448004 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m08:45:14.447471 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.449041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m08:45:14.449622 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:14.450060 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m08:45:14.450655 [debug] [MainThread]: On master: Close
[0m08:45:14.454924 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:14.456363 [info ] [MainThread]: 
[0m08:45:14.459033 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m08:45:14.461627 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m08:45:14.464438 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m08:45:14.467091 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m08:45:14.467839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_resellers)
[0m08:45:14.469364 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m08:45:14.469702 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m08:45:14.470430 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m08:45:14.471048 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:45:14.471677 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m08:45:14.472088 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:45:14.472218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:14.472657 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m08:45:14.473087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:14.477614 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m08:45:14.477948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:45:14.478549 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:45:14.478973 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m08:45:14.479351 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m08:45:14.485012 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:45:14.490294 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m08:45:14.492131 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:45:14.492889 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m08:45:14.493488 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:45:14.493991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:14.494310 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m08:45:14.503041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:14.502640 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m08:45:14.503809 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m08:45:14.504182 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:45:14.504820 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m08:45:14.505439 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:45:14.505951 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m08:45:14.505944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:14.506379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:14.510174 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m08:45:14.512666 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:45:14.513036 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m08:45:14.513750 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:14.513867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:45:14.515796 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m08:45:14.516336 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:45:14.517463 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:45:14.518399 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m08:45:14.518087 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m08:45:14.519738 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.520029 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:45:14.525718 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.528852 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:14.530347 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:45:14.531237 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m08:45:14.533206 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:14.538047 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:45:14.538777 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.539644 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.541346 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.542345 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:14.544461 [debug] [MainThread]: On master: Close
[0m08:45:14.545941 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m08:45:14.546510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:14.546951 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:45:14.547361 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:45:14.547878 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m08:45:14.548282 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m08:45:14.548899 [info ] [MainThread]: 
[0m08:45:14.549310 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:14.549436 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m08:45:14.554116 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m08:45:14.554769 [debug] [MainThread]: Command end result
[0m08:45:14.557786 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:45:14.558185 [info ] [MainThread]: 
[0m08:45:14.558724 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m08:45:14.559159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:14.560084 [info ] [MainThread]: 
[0m08:45:14.559814 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:14.560556 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:14.562431 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m08:45:14.563202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8749895, "process_user_time": 2.205819, "process_kernel_time": 0.1125, "process_mem_max_rss": "113768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:14.564773 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m08:45:14.565376 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:14.565281 after 6.88 seconds
[0m08:45:14.566100 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m08:45:14.566521 [debug] [MainThread]: Flushing usage events
[0m08:45:14.567856 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.574686 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.575251 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:16.526133 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:16.530482 | 11929ba8-225f-473e-917a-ba866f43ce49 ==============================
[0m08:45:16.530482 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:16.531256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:45:16.663283 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:16.675749 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:16.832462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:16.832984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:16.930859 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:16.933848 [info ] [MainThread]: 
[0m08:45:16.934703 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:16.936144 [debug] [MainThread]: Command end result
[0m08:45:16.936847 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46505287, "process_user_time": 0.977407, "process_kernel_time": 0.057792, "process_mem_max_rss": "97708", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:16.937304 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:16.937239 after 0.47 seconds
[0m08:45:16.937675 [debug] [MainThread]: Flushing usage events
[0m08:45:19.412932 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m08:45:19.413886 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:19.414637 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:19.417503 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m08:45:19.417830 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m08:45:19.418139 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m08:45:19.418486 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:19.419238 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:19.419676 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:19.419962 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:19.420435 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:19.420742 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:19.422309 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m08:45:19.423529 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:19.423825 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:19.424608 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:19.424972 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:19.425626 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:19.429392 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.429959 [debug] [MainThread]: On master: BEGIN
[0m08:45:19.430421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:19.430764 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.431425 [debug] [MainThread]: On master: BEGIN
[0m08:45:19.431914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:19.445203 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m08:45:19.446592 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.448385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:19.452847 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m08:45:19.454272 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:19.454853 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.455258 [debug] [MainThread]: On master: BEGIN
[0m08:45:19.455723 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:19.456291 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.456653 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.456954 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.457405 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:19.457909 [debug] [MainThread]: On master: Close
[0m08:45:19.458476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:19.458896 [info ] [MainThread]: 
[0m08:45:19.464175 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m08:45:19.464993 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m08:45:19.466200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m08:45:19.467012 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m08:45:19.472936 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m08:45:19.474464 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m08:45:19.480984 [debug] [Thread-1 (]: SQL status: BEGIN in 5.008 seconds
[0m08:45:19.485982 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:45:19.487612 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
      id AS geography_key,
      cityname as city_name,
      countryname as country_name,
      regionname as region_name
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m08:45:19.494105 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.005 seconds
[0m08:45:19.500536 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:45:19.501271 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m08:45:19.501717 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m08:45:19.502886 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:19.504721 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:45:19.507307 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m08:45:19.508082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:19.509491 [debug] [Thread-1 (]: SQL status: BEGIN in 5.006 seconds
[0m08:45:19.510224 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:45:19.510791 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m08:45:19.512136 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:45:19.515907 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:45:19.516974 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:45:19.517539 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m08:45:19.517601 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:45:19.518214 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m08:45:19.519049 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:45:19.519049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:19.519557 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m08:45:19.523854 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:45:19.525235 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:45:19.525738 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m08:45:19.526087 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m08:45:19.527068 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:45:19.527343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:45:19.532370 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m08:45:19.532728 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m08:45:19.535674 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:45:19.536287 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m08:45:19.536165 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:45:19.536894 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m08:45:19.536997 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:45:19.539716 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m08:45:19.538090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:19.541657 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 5.11s]
[0m08:45:19.541424 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m08:45:19.542552 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m08:45:19.543092 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:45:19.543678 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m08:45:19.544760 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:45:19.544421 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.546518 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m08:45:19.549879 [debug] [MainThread]: On master: BEGIN
[0m08:45:19.549958 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m08:45:19.550606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:19.553349 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:45:19.553896 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:45:19.554459 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m08:45:19.554814 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m08:45:19.556086 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:19.555989 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:19.558516 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m08:45:19.561532 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m08:45:19.561662 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m08:45:19.561920 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m08:45:19.562823 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m08:45:19.563238 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.563360 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 5.11s]
[0m08:45:19.563830 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.564521 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.564546 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m08:45:19.564732 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.565166 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:19.565668 [debug] [MainThread]: On master: BEGIN
[0m08:45:19.566120 [debug] [MainThread]: On master: Close
[0m08:45:19.566477 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.567324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:19.566682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:19.567806 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:19.567747 [debug] [MainThread]: On master: BEGIN
[0m08:45:19.568722 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m08:45:19.569460 [info ] [MainThread]: 
[0m08:45:19.569171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:19.569913 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.41 seconds (10.41s).
[0m08:45:19.572032 [debug] [MainThread]: Command end result
[0m08:45:19.572634 [info ] [MainThread]: 
[0m08:45:19.573051 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:45:19.573578 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:19.573971 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.574394 [info ] [MainThread]: 
[0m08:45:19.574860 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.575311 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:19.575899 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.576739 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.94065, "process_user_time": 2.172738, "process_kernel_time": 0.114831, "process_mem_max_rss": "113476", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:19.577294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:19.577724 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:19.577641 after 11.94 seconds
[0m08:45:19.578111 [debug] [MainThread]: On master: Close
[0m08:45:19.578538 [debug] [MainThread]: Flushing usage events
[0m08:45:19.579138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:19.582761 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m08:45:19.583525 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m08:45:19.584003 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.585795 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:19.586391 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.586785 [info ] [MainThread]: 
[0m08:45:19.587182 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.588609 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m08:45:19.589222 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:19.589830 [debug] [MainThread]: Command end result
[0m08:45:19.590348 [debug] [MainThread]: On master: Close
[0m08:45:19.590965 [info ] [MainThread]: 
[0m08:45:19.592439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:19.591825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:19.594775 [info ] [MainThread]: 
[0m08:45:19.595493 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:19.596143 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:19.597811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.930618, "process_user_time": 2.206321, "process_kernel_time": 0.121061, "process_mem_max_rss": "114868", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:19.596958 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m08:45:19.598649 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:19.598548 after 11.93 seconds
[0m08:45:19.599247 [info ] [MainThread]: 
[0m08:45:19.599832 [debug] [MainThread]: Flushing usage events
[0m08:45:19.600234 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m08:45:19.605693 [debug] [MainThread]: Command end result
[0m08:45:19.607756 [info ] [MainThread]: 
[0m08:45:19.610353 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:19.612013 [info ] [MainThread]: 
[0m08:45:19.612462 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:19.614304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.923954, "process_user_time": 2.199038, "process_kernel_time": 0.120605, "process_mem_max_rss": "114604", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:19.615210 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:19.615052 after 11.92 seconds
[0m08:45:19.620397 [debug] [MainThread]: Flushing usage events
[0m08:45:21.616322 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:21.630700 | 2095bcdb-aab2-4cfd-9f59-e76c0bae1317 ==============================
[0m08:45:21.630700 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:21.633927 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:21.647745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 08:45:21.665483 | 981d1098-8900-4d80-a96e-3d18e7dbe8ca ==============================
[0m08:45:21.665483 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:21.676759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:21.677424 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:21.667674 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:21.683612 | e7ad6824-8b26-4d2e-8ec0-dad816bfa8b0 ==============================
[0m08:45:21.683612 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:45:21.684590 | 7654ebac-b5a9-48bb-85c2-88f8cb5b5c02 ==============================
[0m08:45:21.684590 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:21.685956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:45:21.686697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:45:21.683334 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:21.689919 | 5bdafeab-0b72-4934-8b3b-b683646e8187 ==============================
[0m08:45:21.689919 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:21.693695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:21.881351 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:21.889321 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:21.895891 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:21.898052 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:21.899248 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:21.900265 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:21.903462 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:21.918969 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:21.921148 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:21.924017 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:22.140189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:22.140878 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:22.142615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:22.143660 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:22.146585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:22.146819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:22.147389 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:22.147580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:22.156164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:22.156980 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:22.190506 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:22.190962 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:22.191964 [info ] [MainThread]: 
[0m08:45:22.192513 [info ] [MainThread]: 
[0m08:45:22.192858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:22.193365 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:22.193740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:22.194312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:22.202591 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:22.204027 [info ] [MainThread]: 
[0m08:45:22.204508 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:22.204975 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:22.206425 [info ] [MainThread]: 
[0m08:45:22.207864 [debug] [MainThread]: Command end result
[0m08:45:22.208749 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:22.208271 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:22.209971 [info ] [MainThread]: 
[0m08:45:22.209035 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6345057, "process_user_time": 1.021847, "process_kernel_time": 0.065827, "process_mem_max_rss": "97648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:22.210552 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:22.210767 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:22.210680 after 0.64 seconds
[0m08:45:22.211316 [debug] [MainThread]: Flushing usage events
[0m08:45:22.211693 [debug] [MainThread]: Command end result
[0m08:45:22.212056 [debug] [MainThread]: Command end result
[0m08:45:22.216841 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6345827, "process_user_time": 0.986313, "process_kernel_time": 0.062719, "process_mem_max_rss": "97452", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:22.217283 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6396271, "process_user_time": 1.008569, "process_kernel_time": 0.073773, "process_mem_max_rss": "97588", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:22.217508 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:22.217588 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:22.218795 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:22.218679 after 0.64 seconds
[0m08:45:22.218499 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:22.217687 after 0.64 seconds
[0m08:45:22.219285 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:22.220634 [debug] [MainThread]: Flushing usage events
[0m08:45:22.219969 [debug] [MainThread]: Flushing usage events
[0m08:45:22.219721 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:22.222291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:22.223046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:22.229581 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m08:45:22.231005 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:22.233411 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m08:45:22.235422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:45:22.236489 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:22.241821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:45:22.236180 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:45:22.241691 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:22.242337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:45:22.248991 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:22.250203 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:22.250526 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:22.251999 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:22.252236 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:22.255287 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:22.255603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:22.255987 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:22.257262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:22.257437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:22.260378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:22.265389 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m08:45:22.266255 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:22.267377 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:22.266809 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m08:45:22.268949 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:22.269534 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:22.269858 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:22.271286 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:22.271954 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:22.272214 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m08:45:22.274082 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:22.274585 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:22.278932 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:22.279578 [debug] [MainThread]: On master: BEGIN
[0m08:45:22.279862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:22.284817 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:45:22.285536 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:22.286074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:22.290258 [debug] [MainThread]: SQL status: SELECT 4 in 0.003 seconds
[0m08:45:22.291816 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:22.292738 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:22.293442 [debug] [MainThread]: On master: BEGIN
[0m08:45:22.294092 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:22.294906 [debug] [MainThread]: On master: COMMIT
[0m08:45:22.295348 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:22.295770 [debug] [MainThread]: On master: COMMIT
[0m08:45:22.296310 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:22.296850 [debug] [MainThread]: On master: Close
[0m08:45:22.297713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:22.298975 [info ] [MainThread]: 
[0m08:45:22.305773 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m08:45:22.306764 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m08:45:22.307698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m08:45:22.308249 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m08:45:22.313940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m08:45:22.315616 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m08:45:22.339325 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m08:45:22.340919 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:45:22.341428 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m08:45:22.341895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:22.349460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:45:22.352604 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:45:22.353166 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m08:45:22.355393 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:45:22.362088 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:45:22.363214 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m08:45:22.364053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:22.373386 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m08:45:22.374085 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:45:22.374626 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m08:45:22.375867 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:45:22.380463 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m08:45:22.384058 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:45:22.384554 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m08:45:22.388572 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:22.390377 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m08:45:22.391910 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:45:22.392969 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m08:45:22.394291 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:22.397024 [debug] [MainThread]: On master: BEGIN
[0m08:45:22.397558 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:24.436355 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m08:45:24.437242 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:24.437662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:24.441373 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m08:45:24.447598 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:24.448308 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:24.448857 [debug] [MainThread]: On master: BEGIN
[0m08:45:24.449731 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:24.450709 [debug] [MainThread]: On master: COMMIT
[0m08:45:24.451202 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:24.451544 [debug] [MainThread]: On master: COMMIT
[0m08:45:24.451979 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:24.452326 [debug] [MainThread]: On master: Close
[0m08:45:24.452808 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:24.453224 [info ] [MainThread]: 
[0m08:45:24.458328 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m08:45:24.459115 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m08:45:24.459688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_date)
[0m08:45:24.460077 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m08:45:24.465568 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m08:45:24.467327 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m08:45:24.494789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m08:45:24.496111 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:45:24.496590 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m08:45:24.500379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:24.506193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:45:24.506721 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:45:24.507309 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m08:45:24.580553 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m08:45:24.581317 [debug] [MainThread]: On master: COMMIT
[0m08:45:24.581956 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:24.582643 [debug] [MainThread]: On master: COMMIT
[0m08:45:24.585043 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:24.585497 [debug] [MainThread]: On master: Close
[0m08:45:24.586081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:24.586725 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m08:45:24.587318 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:24.587953 [info ] [MainThread]: 
[0m08:45:24.588393 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.29 seconds (15.29s).
[0m08:45:24.589073 [debug] [MainThread]: Command end result
[0m08:45:24.589525 [info ] [MainThread]: 
[0m08:45:24.589950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:24.590379 [info ] [MainThread]: 
[0m08:45:24.592733 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:24.594185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.959631, "process_user_time": 2.212354, "process_kernel_time": 0.1076, "process_mem_max_rss": "112564", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:24.597364 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:24.597237 after 16.96 seconds
[0m08:45:24.598022 [debug] [MainThread]: Flushing usage events
[0m08:45:24.715212 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.207 seconds
[0m08:45:24.719848 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:45:24.720344 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m08:45:24.720924 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:24.732084 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m08:45:24.733031 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:45:24.733640 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m08:45:24.735306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:24.739703 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m08:45:24.742577 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:45:24.743011 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m08:45:24.743866 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:45:24.746031 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m08:45:24.747559 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.29s]
[0m08:45:24.748254 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m08:45:24.749390 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:24.749974 [debug] [MainThread]: On master: BEGIN
[0m08:45:24.752790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:24.757639 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:45:24.758684 [debug] [MainThread]: On master: COMMIT
[0m08:45:24.759272 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:24.759845 [debug] [MainThread]: On master: COMMIT
[0m08:45:24.760640 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:24.761243 [debug] [MainThread]: On master: Close
[0m08:45:24.762064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:24.762598 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:45:24.763066 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m08:45:24.764036 [info ] [MainThread]: 
[0m08:45:24.766359 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.47 seconds (15.47s).
[0m08:45:24.768701 [debug] [MainThread]: Command end result
[0m08:45:24.769102 [info ] [MainThread]: 
[0m08:45:24.769590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:24.770022 [info ] [MainThread]: 
[0m08:45:24.770840 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:24.772997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.08785, "process_user_time": 2.190526, "process_kernel_time": 0.111002, "process_mem_max_rss": "114312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:24.774578 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:24.774482 after 17.09 seconds
[0m08:45:24.776392 [debug] [MainThread]: Flushing usage events
[0m08:45:26.597254 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:26.602439 | adc01582-ef65-4d77-b02c-4f5589a51cea ==============================
[0m08:45:26.602439 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:26.602956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'send_anonymous_usage_stats': 'True'}
[0m08:45:26.622345 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:26.622423 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:26.626839 | 854f63b5-f447-41cc-80e2-0770d25c293b ==============================
[0m08:45:26.626839 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:45:26.626594 | f238eab5-ae11-468d-bdfe-7e0f3fac58f6 ==============================
[0m08:45:26.626594 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:26.627352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:26.627745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:26.723877 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:26.737709 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:26.749644 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:26.759192 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:26.761362 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:26.773585 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:26.947877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:26.948433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:26.956634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:26.957283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:26.963440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:26.964536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:27.001751 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:27.003062 [info ] [MainThread]: 
[0m08:45:27.003633 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:27.005128 [debug] [MainThread]: Command end result
[0m08:45:27.004265 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:27.005808 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.41988182, "process_user_time": 0.97913, "process_kernel_time": 0.063038, "process_mem_max_rss": "97852", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:27.006923 [info ] [MainThread]: 
[0m08:45:27.007480 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:27.007402 after 0.42 seconds
[0m08:45:27.008006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:27.008420 [debug] [MainThread]: Flushing usage events
[0m08:45:27.009141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:27.015800 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:27.017069 [info ] [MainThread]: 
[0m08:45:27.017495 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:27.018796 [debug] [MainThread]: Command end result
[0m08:45:27.019429 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4336909, "process_user_time": 0.961536, "process_kernel_time": 0.054255, "process_mem_max_rss": "97576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:27.019951 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:27.019888 after 0.43 seconds
[0m08:45:27.020304 [debug] [MainThread]: Flushing usage events
[0m08:45:27.032232 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:27.034316 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:27.036315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:27.046940 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m08:45:27.048200 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:27.054463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:45:27.055246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:45:27.059923 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:27.061876 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:27.065197 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:27.065872 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:27.066456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:27.066986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:27.072509 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:45:27.073267 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:27.073763 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:27.076071 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m08:45:27.081663 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:27.083142 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:27.270469 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m08:45:27.273395 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m08:45:27.280833 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:27.293555 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:27.280184 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:27.296389 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:27.297679 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m08:45:27.305004 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:27.320314 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:27.298283 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m08:45:27.321673 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:27.322181 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:27.333459 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.340170 [debug] [MainThread]: On master: BEGIN
[0m08:45:27.340628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:27.344819 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:45:27.345455 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.345920 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:27.349999 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m08:45:27.351311 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:27.351770 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.352039 [debug] [MainThread]: On master: BEGIN
[0m08:45:27.352569 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:27.353134 [debug] [MainThread]: On master: COMMIT
[0m08:45:27.353470 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.353727 [debug] [MainThread]: On master: COMMIT
[0m08:45:27.354073 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:27.354424 [debug] [MainThread]: On master: Close
[0m08:45:27.354857 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:27.355253 [info ] [MainThread]: 
[0m08:45:27.360343 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m08:45:27.361011 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m08:45:27.361522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_product)
[0m08:45:27.361870 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m08:45:27.367768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m08:45:27.369173 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m08:45:27.391013 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m08:45:27.396764 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:45:27.397219 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m08:45:27.397566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:27.402444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:45:27.402247 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m08:45:27.403026 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:45:27.403355 [debug] [MainThread]: On master: COMMIT
[0m08:45:27.403731 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m08:45:27.404122 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.404648 [debug] [MainThread]: On master: COMMIT
[0m08:45:27.404989 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:27.405291 [debug] [MainThread]: On master: Close
[0m08:45:27.405815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:27.406368 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:45:27.406631 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:27.410402 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m08:45:27.411401 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:45:27.411901 [info ] [MainThread]: 
[0m08:45:27.412498 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m08:45:27.412964 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m08:45:27.413820 [debug] [MainThread]: Command end result
[0m08:45:27.414096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:45:27.414467 [info ] [MainThread]: 
[0m08:45:27.422320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:27.422991 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m08:45:27.423384 [info ] [MainThread]: 
[0m08:45:27.423922 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:45:27.424418 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:27.424891 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m08:45:27.425625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.843418, "process_user_time": 1.118195, "process_kernel_time": 0.075553, "process_mem_max_rss": "106588", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:27.426446 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:27.426322 after 5.84 seconds
[0m08:45:27.426772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:27.427227 [debug] [MainThread]: Flushing usage events
[0m08:45:27.431456 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m08:45:27.434714 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:45:27.435288 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m08:45:27.435858 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:27.437549 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m08:45:27.438934 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:45:27.439498 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m08:45:27.440575 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.441010 [debug] [MainThread]: On master: BEGIN
[0m08:45:27.441347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:27.445739 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:45:27.446449 [debug] [MainThread]: On master: COMMIT
[0m08:45:27.446891 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.447250 [debug] [MainThread]: On master: COMMIT
[0m08:45:27.447637 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:27.447917 [debug] [MainThread]: On master: Close
[0m08:45:27.448348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:27.448784 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:45:27.449073 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m08:45:27.449510 [info ] [MainThread]: 
[0m08:45:27.450073 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.26 seconds (5.26s).
[0m08:45:27.450861 [debug] [MainThread]: Command end result
[0m08:45:27.451299 [info ] [MainThread]: 
[0m08:45:27.451783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:27.452141 [info ] [MainThread]: 
[0m08:45:27.452510 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:27.453142 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.870431, "process_user_time": 1.109145, "process_kernel_time": 0.087963, "process_mem_max_rss": "108624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:27.453615 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:27.453550 after 5.87 seconds
[0m08:45:27.454045 [debug] [MainThread]: Flushing usage events
[0m08:45:29.429478 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:29.434453 | 8e90d895-edfd-44a8-ad98-2502dac7f558 ==============================
[0m08:45:29.434453 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:29.431944 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:29.432357 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:29.438411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:29.435303 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:29.439481 | 4641a42d-3914-4e28-ad9d-b2dc4a83b760 ==============================
[0m08:45:29.439481 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:45:29.439367 | c3059f8d-e345-49ca-a856-1ecb6d0869d3 ==============================
[0m08:45:29.439367 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:45:29.439709 | c5ea504b-1fc5-4a90-9b52-b39935817591 ==============================
[0m08:45:29.439709 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:29.440309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:29.440724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:29.440905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:45:29.618036 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:29.650795 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:29.655532 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:29.653383 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:29.658228 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:29.670715 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:29.672916 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:29.675878 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:29.811123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:29.812385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:29.821748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:29.822580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:29.824746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:29.825222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:29.833899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:29.834407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:29.868292 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:29.870498 [info ] [MainThread]: 
[0m08:45:29.871281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:29.872226 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:29.876817 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:29.878205 [info ] [MainThread]: 
[0m08:45:29.878427 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:29.878612 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:29.878781 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:29.880424 [info ] [MainThread]: 
[0m08:45:29.881025 [info ] [MainThread]: 
[0m08:45:29.882385 [debug] [MainThread]: Command end result
[0m08:45:29.882741 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:29.883391 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:29.883587 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48855743, "process_user_time": 1.012436, "process_kernel_time": 0.053445, "process_mem_max_rss": "97444", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:29.884115 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:29.884047 after 0.49 seconds
[0m08:45:29.884350 [debug] [MainThread]: Command end result
[0m08:45:29.884673 [debug] [MainThread]: Flushing usage events
[0m08:45:29.884999 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48017237, "process_user_time": 1.011215, "process_kernel_time": 0.060191, "process_mem_max_rss": "97500", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:29.885005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:29.885615 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:29.885527 after 0.48 seconds
[0m08:45:29.886018 [debug] [MainThread]: Flushing usage events
[0m08:45:29.900523 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:29.901229 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:29.901676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:29.907758 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:29.908486 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:29.909011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:32.075380 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m08:45:32.094012 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:32.099878 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:32.105883 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:32.118581 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:32.126345 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:32.134704 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:32.135251 [debug] [MainThread]: On master: BEGIN
[0m08:45:32.135520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:34.911794 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.010 seconds
[0m08:45:34.914841 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:34.915148 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.006 seconds
[0m08:45:34.916466 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:34.918981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:45:34.920108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:45:34.919667 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:45:34.924134 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:34.926053 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:34.926626 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:34.927084 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:34.920624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:45:34.927522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:34.927868 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:34.927945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:34.929621 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:34.930526 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:34.931224 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:34.932316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:34.934046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:34.935220 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:45:34.935808 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:34.937931 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:34.938621 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:45:34.939230 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:34.939658 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:34.940487 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:34.941751 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:34.941656 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:34.942275 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:34.942922 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:34.943772 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:37.153481 [debug] [MainThread]: SQL status: BEGIN in 5.018 seconds
[0m08:45:37.170763 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:37.175360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:37.192461 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m08:45:37.194140 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:37.194711 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:37.195023 [debug] [MainThread]: On master: BEGIN
[0m08:45:37.195559 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:37.196125 [debug] [MainThread]: On master: COMMIT
[0m08:45:37.196549 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:37.196950 [debug] [MainThread]: On master: COMMIT
[0m08:45:37.197558 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:37.197972 [debug] [MainThread]: On master: Close
[0m08:45:37.198541 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:37.199023 [info ] [MainThread]: 
[0m08:45:37.204082 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m08:45:37.204765 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m08:45:37.205269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m08:45:37.205680 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m08:45:37.211110 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m08:45:37.212382 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m08:45:37.234141 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m08:45:37.235695 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:45:37.236198 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m08:45:37.236580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:39.939560 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m08:45:39.939688 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m08:45:39.940481 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:39.941109 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:39.940953 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:39.941851 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:39.943442 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m08:45:39.944690 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:39.943836 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.001 seconds
[0m08:45:39.945191 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:39.945878 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:39.946489 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:39.949524 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:39.950032 [debug] [MainThread]: On master: BEGIN
[0m08:45:39.950382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:39.950876 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:39.951321 [debug] [MainThread]: On master: BEGIN
[0m08:45:39.951663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:42.248369 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m08:45:42.249871 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:45:42.251532 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m08:45:42.253292 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:45:42.258991 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:45:42.262383 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m08:45:42.263560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:42.273037 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m08:45:42.276817 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:45:42.277599 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m08:45:42.279020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:42.284134 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m08:45:42.287595 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:45:42.288106 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m08:45:42.289062 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:42.291460 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m08:45:42.293019 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 5.09s]
[0m08:45:42.293954 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m08:45:42.295621 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:42.296376 [debug] [MainThread]: On master: BEGIN
[0m08:45:42.297007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:42.303382 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:45:42.304601 [debug] [MainThread]: On master: COMMIT
[0m08:45:42.305442 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:42.308442 [debug] [MainThread]: On master: COMMIT
[0m08:45:42.309608 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:42.310416 [debug] [MainThread]: On master: Close
[0m08:45:42.311094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:42.311589 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m08:45:42.312666 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:45:42.313686 [info ] [MainThread]: 
[0m08:45:42.314673 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.31 seconds (15.31s).
[0m08:45:42.317583 [debug] [MainThread]: Command end result
[0m08:45:42.319431 [info ] [MainThread]: 
[0m08:45:42.320247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:42.320603 [info ] [MainThread]: 
[0m08:45:42.320937 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:42.323011 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.760237, "process_user_time": 1.07008, "process_kernel_time": 0.070466, "process_mem_max_rss": "108156", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:42.323751 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:42.323685 after 15.76 seconds
[0m08:45:42.324076 [debug] [MainThread]: Flushing usage events
[0m08:45:43.769640 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:43.782354 | 82b5ff9f-e12f-4c8d-9e82-d72d342a682a ==============================
[0m08:45:43.782354 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:43.784507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:45:43.786252 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:43.804789 | 605d8265-03a7-40ab-8845-04b5711d53b6 ==============================
[0m08:45:43.804789 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:43.811817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:45:43.937509 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:43.948004 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:43.951236 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:43.964334 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:44.104065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:44.104991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:44.113705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:44.114311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:44.158110 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:44.159499 [info ] [MainThread]: 
[0m08:45:44.160353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:44.160903 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:44.161780 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:44.162278 [info ] [MainThread]: 
[0m08:45:44.162704 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:44.164010 [debug] [MainThread]: Command end result
[0m08:45:44.165567 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42781204, "process_user_time": 0.964383, "process_kernel_time": 0.042279, "process_mem_max_rss": "97704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:44.166509 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:44.166435 after 0.43 seconds
[0m08:45:44.166941 [debug] [MainThread]: Flushing usage events
[0m08:45:44.184715 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:44.190698 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:44.191770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:44.206341 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.014 seconds
[0m08:45:44.212587 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:44.242970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:45:44.251477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:45:44.261421 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:44.267789 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:44.267042 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:44.269289 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:44.269793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:44.268477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:44.275482 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:45:44.276194 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:44.276985 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:44.279437 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:44.281553 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:44.282120 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:44.956193 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m08:45:44.956505 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m08:45:44.956966 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:44.957526 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:44.957422 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:44.958273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:44.961895 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m08:45:44.962453 [debug] [MainThread]: SQL status: SELECT 8 in 0.003 seconds
[0m08:45:44.963747 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:44.964438 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:44.964844 [debug] [MainThread]: On master: BEGIN
[0m08:45:44.965734 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:44.965672 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:44.966309 [debug] [MainThread]: On master: COMMIT
[0m08:45:44.966795 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:44.966848 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:44.967218 [debug] [MainThread]: On master: COMMIT
[0m08:45:44.967523 [debug] [MainThread]: On master: BEGIN
[0m08:45:44.967762 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:44.968327 [debug] [MainThread]: On master: Close
[0m08:45:44.968405 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:44.968964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:44.969505 [info ] [MainThread]: 
[0m08:45:44.969413 [debug] [MainThread]: On master: COMMIT
[0m08:45:44.973400 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:44.973823 [debug] [MainThread]: On master: COMMIT
[0m08:45:44.974571 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:44.975141 [debug] [MainThread]: On master: Close
[0m08:45:44.975106 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m08:45:44.975753 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:44.975898 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m08:45:44.976282 [info ] [MainThread]: 
[0m08:45:44.976596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m08:45:44.977167 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m08:45:44.981440 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m08:45:44.982086 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m08:45:44.982723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m08:45:44.983245 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m08:45:44.983413 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m08:45:44.984811 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m08:45:44.989035 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m08:45:44.990118 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m08:45:45.009445 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m08:45:45.019571 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:45:45.015066 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m08:45:45.021767 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:45:45.020037 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m08:45:45.025854 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m08:45:45.028009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:45.028147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:45.039074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m08:45:45.050323 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:45:45.061047 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    reseller_id AS sales_agent_key,
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m08:45:45.076371 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.011 seconds
[0m08:45:45.086369 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:45:45.087243 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m08:45:45.087955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:45.098899 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m08:45:45.099405 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:45:45.099702 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m08:45:45.100519 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:45.104376 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m08:45:45.107080 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:45:45.107513 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m08:45:45.108126 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:45:45.109834 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m08:45:45.111272 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.13s]
[0m08:45:45.111892 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m08:45:45.112962 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:45.113423 [debug] [MainThread]: On master: BEGIN
[0m08:45:45.113873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:45.118031 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:45:45.118589 [debug] [MainThread]: On master: COMMIT
[0m08:45:45.119086 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:45.119689 [debug] [MainThread]: On master: COMMIT
[0m08:45:45.120347 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:45.120831 [debug] [MainThread]: On master: Close
[0m08:45:45.121488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:45.122650 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:45.123036 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m08:45:45.123410 [info ] [MainThread]: 
[0m08:45:45.123767 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.24 seconds (15.24s).
[0m08:45:45.124341 [debug] [MainThread]: Command end result
[0m08:45:45.124606 [info ] [MainThread]: 
[0m08:45:45.124907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:45.125183 [info ] [MainThread]: 
[0m08:45:45.125464 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:45.126049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.726643, "process_user_time": 1.159169, "process_kernel_time": 0.057705, "process_mem_max_rss": "108244", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:45.126509 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:45.126449 after 15.73 seconds
[0m08:45:45.126855 [debug] [MainThread]: Flushing usage events
[0m08:45:46.779358 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:46.783744 | 1f18775b-c8b7-4972-be84-e4e39f15e0fb ==============================
[0m08:45:46.783744 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:46.784309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:46.907266 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:46.918384 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:47.040872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:47.041485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:47.132616 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:47.137393 [info ] [MainThread]: 
[0m08:45:47.140406 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:47.142192 [debug] [MainThread]: Command end result
[0m08:45:47.143286 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.39295503, "process_user_time": 1.020569, "process_kernel_time": 0.048062, "process_mem_max_rss": "97964", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:47.144024 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:47.143945 after 0.39 seconds
[0m08:45:47.144596 [debug] [MainThread]: Flushing usage events
[0m08:45:49.277693 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m08:45:49.278422 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:49.278996 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:49.281220 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m08:45:49.282485 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:49.283091 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:49.287661 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:49.290051 [debug] [MainThread]: On master: BEGIN
[0m08:45:49.290403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:49.294370 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:45:49.294945 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:49.295409 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:49.299600 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m08:45:49.301166 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:49.301750 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:49.302169 [debug] [MainThread]: On master: BEGIN
[0m08:45:49.302716 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:49.303161 [debug] [MainThread]: On master: COMMIT
[0m08:45:49.303495 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:49.303901 [debug] [MainThread]: On master: COMMIT
[0m08:45:49.304417 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:49.304777 [debug] [MainThread]: On master: Close
[0m08:45:49.305288 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:49.305625 [info ] [MainThread]: 
[0m08:45:49.310466 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m08:45:49.311115 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m08:45:49.311588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m08:45:49.311914 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m08:45:49.317298 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m08:45:49.318614 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m08:45:49.344695 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m08:45:49.354779 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:45:49.358729 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m08:45:49.359446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:50.042474 [debug] [Thread-1 (]: SQL status: BEGIN in 5.015 seconds
[0m08:45:50.053496 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:45:50.056829 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select product_id as product_key, product_id as original_product_id, product_name, geography_key , product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m08:45:50.069247 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.012 seconds
[0m08:45:50.073693 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:45:50.074249 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m08:45:50.074899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:50.086107 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m08:45:50.086728 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:45:50.087057 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m08:45:50.088024 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:50.092229 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m08:45:50.095298 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:45:50.095756 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m08:45:50.096282 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:45:50.097844 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m08:45:50.099079 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 5.12s]
[0m08:45:50.099789 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m08:45:50.100807 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:50.101206 [debug] [MainThread]: On master: BEGIN
[0m08:45:50.101481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:50.105741 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:45:50.106424 [debug] [MainThread]: On master: COMMIT
[0m08:45:50.106811 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:50.107095 [debug] [MainThread]: On master: COMMIT
[0m08:45:50.107499 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:50.108183 [debug] [MainThread]: On master: Close
[0m08:45:50.108893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:50.109367 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m08:45:50.109840 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:50.110298 [info ] [MainThread]: 
[0m08:45:50.110752 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.24 seconds (20.24s).
[0m08:45:50.111346 [debug] [MainThread]: Command end result
[0m08:45:50.111739 [info ] [MainThread]: 
[0m08:45:50.112197 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:50.112552 [info ] [MainThread]: 
[0m08:45:50.112972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:50.113823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.715036, "process_user_time": 1.151216, "process_kernel_time": 0.061546, "process_mem_max_rss": "106408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:50.114438 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:50.114362 after 20.72 seconds
[0m08:45:50.114895 [debug] [MainThread]: Flushing usage events
[0m08:45:51.765976 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:51.776197 | a13bc293-0422-4cd9-ba7f-1162ad1cc5a2 ==============================
[0m08:45:51.776197 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:51.777680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:51.928332 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:51.946102 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:52.102393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:52.103019 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:52.154202 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:52.155989 [info ] [MainThread]: 
[0m08:45:52.159655 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:52.161048 [debug] [MainThread]: Command end result
[0m08:45:52.165733 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4416743, "process_user_time": 0.947574, "process_kernel_time": 0.056033, "process_mem_max_rss": "97464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:52.167089 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:52.166987 after 0.44 seconds
[0m08:45:52.169484 [debug] [MainThread]: Flushing usage events
[0m08:45:54.368741 [debug] [Thread-1 (]: SQL status: BEGIN in 5.009 seconds
[0m08:45:54.376462 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:45:54.376894 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m08:45:54.380405 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m08:45:54.385398 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:45:54.392465 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m08:45:54.393361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:54.405713 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m08:45:54.406238 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:45:54.406728 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m08:45:54.407971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:54.412084 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m08:45:54.415415 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:45:54.416010 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m08:45:54.416662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:45:54.418459 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m08:45:54.420169 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 5.11s]
[0m08:45:54.420864 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m08:45:54.422042 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:54.425574 [debug] [MainThread]: On master: BEGIN
[0m08:45:54.427367 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:54.435668 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:45:54.436194 [debug] [MainThread]: On master: COMMIT
[0m08:45:54.436548 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:54.436851 [debug] [MainThread]: On master: COMMIT
[0m08:45:54.437288 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:54.437617 [debug] [MainThread]: On master: Close
[0m08:45:54.438032 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:54.438429 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:54.438850 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m08:45:54.439380 [info ] [MainThread]: 
[0m08:45:54.439941 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m08:45:54.440689 [debug] [MainThread]: Command end result
[0m08:45:54.441037 [info ] [MainThread]: 
[0m08:45:54.441382 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:54.441663 [info ] [MainThread]: 
[0m08:45:54.442066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:54.442813 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.705673, "process_user_time": 1.11085, "process_kernel_time": 0.069491, "process_mem_max_rss": "108456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:54.443288 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:54.443229 after 10.71 seconds
[0m08:45:54.443616 [debug] [MainThread]: Flushing usage events
[0m08:45:55.831699 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:55.835997 | 5c426349-4a8e-4739-8e0b-fe9c1f25cde8 ==============================
[0m08:45:55.835997 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:55.836708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:55.974421 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:55.996981 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:56.216956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:56.217433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:56.269409 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:56.271467 [info ] [MainThread]: 
[0m08:45:56.271888 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:56.273164 [debug] [MainThread]: Command end result
[0m08:45:56.274795 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4737666, "process_user_time": 0.969209, "process_kernel_time": 0.072357, "process_mem_max_rss": "97580", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:56.275345 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:56.275277 after 0.47 seconds
[0m08:45:56.276437 [debug] [MainThread]: Flushing usage events
[0m08:50:55.532739 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:50:55.537282 | 91732b1d-af7e-4453-8212-ba57ff90d9e9 ==============================
[0m08:50:55.537282 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:50:55.537842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:50:55.607662 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m08:50:55.609042 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m08:50:55.612470 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-skb5yair'
[0m08:50:55.612978 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m08:50:55.614030 [debug] [MainThread]: Creating symlink to local dependency.
[0m08:50:55.615370 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m08:50:55.616216 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11728054, "process_user_time": 0.798966, "process_kernel_time": 0.076092, "process_mem_max_rss": "105528", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m08:50:55.616776 [debug] [MainThread]: Command `dbt deps` succeeded at 08:50:55.616711 after 0.12 seconds
[0m08:50:55.620263 [debug] [MainThread]: Flushing usage events
[0m08:50:57.624215 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:50:57.628431 | 50e44598-f511-4d88-a8c8-672d0bf881ca ==============================
[0m08:50:57.628431 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:50:57.629054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:50:57.770964 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:50:57.784494 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:50:57.787779 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:50:59.145056 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:50:59.146794 [info ] [MainThread]: 
[0m08:50:59.147361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:50:59.148119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:50:59.171187 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:50:59.171918 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:50:59.172319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:04.198291 [debug] [ThreadPool]: SQL status: SELECT 8 in 5.026 seconds
[0m08:51:04.199589 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:51:04.202935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m08:51:04.203377 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m08:51:04.214331 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m08:51:04.215264 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m08:51:04.215623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:51:04.232496 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m08:51:04.237019 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m08:51:04.246888 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m08:51:04.251479 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m08:51:04.254499 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m08:51:04.258802 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m08:51:04.260103 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m08:51:04.261468 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m08:51:04.261840 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m08:51:04.265338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m08:51:04.265839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:51:04.270882 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:51:04.272684 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:51:04.273154 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:51:04.275571 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:51:04.276557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:51:04.278833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:09.287733 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m08:51:09.288406 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m08:51:09.293012 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:51:09.288739 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:51:09.296951 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:51:09.300647 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:51:09.306675 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m08:51:09.306976 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:51:09.323863 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:51:09.309719 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:51:09.331679 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:51:09.337469 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:51:09.344911 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:09.351518 [debug] [MainThread]: On master: BEGIN
[0m08:51:09.355715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:51:14.360527 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m08:51:14.361274 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:14.361885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:51:14.368077 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:51:14.369325 [debug] [MainThread]: On master: ROLLBACK
[0m08:51:14.369908 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:14.370255 [debug] [MainThread]: On master: BEGIN
[0m08:51:14.370787 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:51:14.371209 [debug] [MainThread]: On master: COMMIT
[0m08:51:14.371600 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:14.371961 [debug] [MainThread]: On master: COMMIT
[0m08:51:14.372432 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:51:14.372810 [debug] [MainThread]: On master: Close
[0m08:51:14.373339 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:51:14.373725 [info ] [MainThread]: 
[0m08:51:14.382513 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m08:51:14.384072 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m08:51:14.384593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m08:51:14.384933 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m08:51:14.385311 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m08:51:14.403063 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:51:14.403701 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m08:51:14.404135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:51:14.408464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:51:14.409008 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:51:14.409358 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m08:51:14.411768 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m08:51:14.462504 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:51:14.463235 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m08:51:14.464846 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m08:51:14.468795 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m08:51:14.481436 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m08:51:14.482469 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:51:14.486187 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m08:51:14.492240 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:51:14.494241 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m08:51:14.495672 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.11s]
[0m08:51:14.496374 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m08:51:14.497784 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:14.498279 [debug] [MainThread]: On master: BEGIN
[0m08:51:14.498645 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:51:14.502667 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:51:14.503240 [debug] [MainThread]: On master: COMMIT
[0m08:51:14.503673 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:14.504066 [debug] [MainThread]: On master: COMMIT
[0m08:51:14.504648 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:51:14.505095 [debug] [MainThread]: On master: Close
[0m08:51:14.505664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:51:14.506035 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m08:51:14.506401 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:51:14.506848 [info ] [MainThread]: 
[0m08:51:14.507229 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 15.36 seconds (15.36s).
[0m08:51:14.507862 [debug] [MainThread]: Command end result
[0m08:51:14.555805 [info ] [MainThread]: 
[0m08:51:14.556327 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:51:14.557580 [info ] [MainThread]: 
[0m08:51:14.559597 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:51:14.561121 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 17.002092, "process_user_time": 2.162056, "process_kernel_time": 0.091937, "process_mem_max_rss": "114976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:51:14.561714 [debug] [MainThread]: Command `dbt seed` succeeded at 08:51:14.561640 after 17.00 seconds
[0m08:51:14.562668 [debug] [MainThread]: Flushing usage events
[0m08:52:01.439860 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:01.445004 | dae8daf1-004d-4cef-a15b-37589930ffed ==============================
[0m08:52:01.445004 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.447005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'send_anonymous_usage_stats': 'True'}
[0m08:52:01.443451 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:01.448960 | 707990cf-1b15-4dd7-aaee-3bed9192b8d4 ==============================
[0m08:52:01.448960 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.453129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:52:01.491891 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:01.498794 | 5b06b25d-3d27-4326-ada7-ae963c3f3c9a ==============================
[0m08:52:01.498794 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.499696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m08:52:01.499578 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:01.508786 | 9d71d3e8-f47c-4ae1-848f-b03e879f215e ==============================
[0m08:52:01.508786 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.504413 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:01.510988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 08:52:01.511981 | 567ae55d-8f83-4e34-911b-89b6a5f34c2b ==============================
[0m08:52:01.511981 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.513461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:01.515882 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:01.521120 | bc694e70-e507-4f75-958d-598093d8ce61 ==============================
[0m08:52:01.521120 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.524143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:01.525178 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:01.533687 | 78dd5b0b-4239-4cfd-8aed-e30285c53b97 ==============================
[0m08:52:01.533687 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.536424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:01.620888 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.622017 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.639432 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.641868 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.697719 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.700067 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.701090 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.717966 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.723303 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.728808 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.729221 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.726711 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.726433 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.731420 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:01.751509 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.755069 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.752888 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:01.787860 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.843918 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.845291 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:01.853423 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.854690 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:01.887485 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.888466 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:01.906839 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.907461 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.908214 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:01.908126 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:03.100472 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.109114 [info ] [MainThread]: 
[0m08:52:03.117002 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.120533 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.188132 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.193401 [info ] [MainThread]: 
[0m08:52:03.196098 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.198913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.199339 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.201475 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.203304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.219189 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.219508 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.221256 [info ] [MainThread]: 
[0m08:52:03.221373 [info ] [MainThread]: 
[0m08:52:03.222141 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.222401 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.223243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.223375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.226142 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.226737 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.227274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.235874 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.009 seconds
[0m08:52:03.238743 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:03.239674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m08:52:03.240787 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m08:52:03.246166 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:52:03.246159 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.246686 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m08:52:03.247698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:03.247915 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.248617 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.248337 [info ] [MainThread]: 
[0m08:52:03.248596 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.249121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.249502 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.249479 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.249900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.250562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.252923 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:52:03.253856 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:52:03.254698 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m08:52:03.255885 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:52:03.257227 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m08:52:03.256303 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m08:52:03.257769 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:52:03.258173 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m08:52:03.258765 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:03.259381 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m08:52:03.259736 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m08:52:03.261056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m08:52:03.263682 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m08:52:03.263777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m08:52:03.268659 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:52:03.264700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:03.269620 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m08:52:03.270472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:03.268893 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.271942 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:03.272433 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:03.272904 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:03.273252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:03.273789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.274849 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:52:03.275492 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:52:03.275868 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m08:52:03.276099 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.276435 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:52:03.276751 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.280794 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m08:52:03.280947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.282363 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:52:03.284299 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m08:52:03.285993 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m08:52:03.287328 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m08:52:03.291367 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m08:52:03.293416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m08:52:03.294927 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:03.294303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:03.302715 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.306260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:03.310525 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:03.306407 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:03.312017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:03.313462 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:03.315544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.307056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:03.317415 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:03.321188 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m08:52:03.319749 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.322861 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.322435 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:03.323659 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:03.323430 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:03.324491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:03.325977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.327969 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:52:03.331978 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:03.333385 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:52:03.336666 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:03.336719 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.338005 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:03.340661 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:52:03.342225 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:03.343044 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:03.374472 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.376132 [info ] [MainThread]: 
[0m08:52:03.377013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.378125 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.389901 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.391876 [info ] [MainThread]: 
[0m08:52:03.392689 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.393719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.400691 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.401397 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.401918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.407147 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m08:52:03.408291 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:03.414177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:52:03.416574 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.418032 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.421610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.415831 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:03.422905 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.433565 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:03.429315 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:03.438007 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:03.447334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.435019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:03.461421 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m08:52:03.461878 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:03.462242 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:03.465450 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:03.468433 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:03.467489 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m08:52:03.472327 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:03.472612 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.474156 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:03.479224 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m08:52:03.480479 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:03.484398 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:03.494256 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:03.494872 [debug] [MainThread]: On master: BEGIN
[0m08:52:03.495192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:03.499724 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:52:03.500341 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:03.500939 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:03.504106 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:52:03.505345 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:03.505926 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:03.506301 [debug] [MainThread]: On master: BEGIN
[0m08:52:03.506792 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:03.507286 [debug] [MainThread]: On master: COMMIT
[0m08:52:03.507680 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:03.508039 [debug] [MainThread]: On master: COMMIT
[0m08:52:03.508761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:03.509212 [debug] [MainThread]: On master: Close
[0m08:52:03.512455 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:03.514227 [info ] [MainThread]: 
[0m08:52:03.519616 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m08:52:03.520298 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m08:52:03.521041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_resellers)
[0m08:52:03.521675 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m08:52:03.526961 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m08:52:03.529407 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m08:52:03.551054 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m08:52:03.553541 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:52:03.554005 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m08:52:03.554387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:03.559114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:52:03.562868 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:52:03.564027 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m08:52:03.565920 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:03.570921 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:52:03.571603 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m08:52:03.572394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:03.581761 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m08:52:03.582516 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:52:03.582992 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m08:52:03.584110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:52:03.588654 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m08:52:03.592039 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:52:03.592618 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m08:52:03.593266 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:03.595285 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m08:52:03.597051 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m08:52:03.598083 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m08:52:03.599447 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:03.599953 [debug] [MainThread]: On master: BEGIN
[0m08:52:03.600361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:03.605348 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:03.606057 [debug] [MainThread]: On master: COMMIT
[0m08:52:03.606483 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:03.606860 [debug] [MainThread]: On master: COMMIT
[0m08:52:03.607423 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:03.607811 [debug] [MainThread]: On master: Close
[0m08:52:03.608287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:03.608641 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m08:52:03.608975 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:03.609380 [info ] [MainThread]: 
[0m08:52:03.613368 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m08:52:03.614488 [debug] [MainThread]: Command end result
[0m08:52:03.615178 [info ] [MainThread]: 
[0m08:52:03.615721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:03.616163 [info ] [MainThread]: 
[0m08:52:03.616575 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:03.617435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1340606, "process_user_time": 2.448304, "process_kernel_time": 0.140393, "process_mem_max_rss": "112832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:03.617920 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:03.617862 after 2.13 seconds
[0m08:52:03.618315 [debug] [MainThread]: Flushing usage events
[0m08:52:05.147324 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:05.151732 | 7dcdfa8e-f47d-41df-961f-ef2c6de09ba6 ==============================
[0m08:52:05.151732 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:05.152306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:05.157506 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:05.161980 | f9e0a131-04fd-43c8-bd56-a8be9e9a7949 ==============================
[0m08:52:05.161980 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:05.162621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:05.277947 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:05.288559 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:05.288694 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:05.299588 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:05.519652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:05.520230 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:05.524964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:05.525530 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:05.566355 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:05.567829 [info ] [MainThread]: 
[0m08:52:05.569982 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:05.571366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:05.576369 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:05.577657 [info ] [MainThread]: 
[0m08:52:05.578239 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:05.579952 [debug] [MainThread]: Command end result
[0m08:52:05.580802 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46300045, "process_user_time": 0.968029, "process_kernel_time": 0.065339, "process_mem_max_rss": "97704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:05.581490 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:05.581414 after 0.46 seconds
[0m08:52:05.581955 [debug] [MainThread]: Flushing usage events
[0m08:52:05.597291 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:05.598024 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:05.598634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:05.604319 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m08:52:05.605751 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:05.609955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:05.610522 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:05.615464 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:05.617913 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:05.618624 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:05.619273 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:05.619951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:05.623681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:05.629325 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:52:05.630033 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:05.630627 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:05.633055 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:05.634655 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:05.635285 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:08.218591 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.015 seconds
[0m08:52:08.225264 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:08.257518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:52:08.264063 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.014 seconds
[0m08:52:08.269014 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:08.259696 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:08.271757 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:08.273867 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.275104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:08.274542 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:08.278257 [debug] [ThreadPool]: SQL status: BEGIN in 5.004 seconds
[0m08:52:08.275525 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:08.279092 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m08:52:08.279500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:08.275760 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:08.280133 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.280642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:08.282219 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.281429 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:08.284414 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:08.286642 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:08.286044 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:08.287667 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:52:08.284913 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:08.287359 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:08.288734 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:08.288324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:08.289620 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:08.289861 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:08.289262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:08.291405 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:08.291786 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m08:52:08.291724 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m08:52:08.293184 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:08.294289 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:52:08.294520 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:08.294959 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.293306 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:08.295656 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:08.294140 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:08.296680 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:08.298097 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:08.299228 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:08.299678 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:08.301118 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.301797 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.302292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:08.307626 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:08.308332 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.308839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:08.311696 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:08.312779 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:08.313184 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.313541 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.314073 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:08.314548 [debug] [MainThread]: On master: COMMIT
[0m08:52:08.314993 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.315282 [debug] [MainThread]: On master: COMMIT
[0m08:52:08.315669 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:08.316020 [debug] [MainThread]: On master: Close
[0m08:52:08.316594 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:08.316982 [info ] [MainThread]: 
[0m08:52:08.322768 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m08:52:08.323557 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m08:52:08.324130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_date)
[0m08:52:08.324619 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m08:52:08.324843 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m08:52:08.328696 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.329442 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:08.331061 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m08:52:08.331806 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m08:52:08.332006 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:08.332644 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.333005 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m08:52:08.333531 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:08.333595 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:08.336015 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:08.337176 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:08.338520 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:08.339713 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:08.341511 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.342374 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.344431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:08.346054 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.346812 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.348544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:08.360968 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m08:52:08.361822 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.362637 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:08.366331 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m08:52:08.367601 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:08.368450 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.368448 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m08:52:08.368865 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.370031 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:08.371583 [debug] [MainThread]: On master: COMMIT
[0m08:52:08.372654 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.372518 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:52:08.373574 [debug] [MainThread]: On master: COMMIT
[0m08:52:08.374387 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:08.374037 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m08:52:08.375122 [debug] [MainThread]: On master: Close
[0m08:52:08.375671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:08.376556 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:08.377380 [info ] [MainThread]: 
[0m08:52:08.381987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:52:08.383021 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:52:08.383644 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m08:52:08.383762 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m08:52:08.384473 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m08:52:08.385238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_channels)
[0m08:52:08.386032 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m08:52:08.392121 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m08:52:08.394134 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m08:52:08.422025 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m08:52:08.423358 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:52:08.424217 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m08:52:08.425048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:08.430941 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.009 seconds
[0m08:52:08.432665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:52:08.432716 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:08.433668 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:52:08.434416 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m08:52:08.437242 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:08.438383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:08.442551 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:52:08.443136 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m08:52:08.444756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:08.439301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:08.446755 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.451358 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:08.455120 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:08.456132 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m08:52:08.455769 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:08.456869 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:52:08.457424 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m08:52:08.456337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:08.457275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:08.458869 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:52:08.465294 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m08:52:08.469062 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:52:08.469704 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m08:52:08.470498 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:08.472571 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m08:52:08.473894 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m08:52:08.474654 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m08:52:08.475936 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.476386 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.476686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:08.481566 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:08.482264 [debug] [MainThread]: On master: COMMIT
[0m08:52:08.482687 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.483088 [debug] [MainThread]: On master: COMMIT
[0m08:52:08.483551 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:08.483867 [debug] [MainThread]: On master: Close
[0m08:52:08.484279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:08.484550 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m08:52:08.484942 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:08.485517 [info ] [MainThread]: 
[0m08:52:08.486003 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m08:52:08.486922 [debug] [MainThread]: Command end result
[0m08:52:08.487424 [info ] [MainThread]: 
[0m08:52:08.487957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:08.488579 [info ] [MainThread]: 
[0m08:52:08.489525 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:08.493440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0279374, "process_user_time": 2.430308, "process_kernel_time": 0.141004, "process_mem_max_rss": "114732", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:08.494058 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:08.493987 after 7.03 seconds
[0m08:52:08.494901 [debug] [MainThread]: Flushing usage events
[0m08:52:08.602756 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.218 seconds
[0m08:52:08.608612 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:52:08.611082 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m08:52:08.614759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:08.624764 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m08:52:08.625408 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:52:08.629759 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m08:52:08.635178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m08:52:08.641196 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m08:52:08.645766 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:52:08.646331 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m08:52:08.651163 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m08:52:08.653139 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m08:52:08.654806 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.33s]
[0m08:52:08.656025 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m08:52:08.657716 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.658552 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.659096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:10.334493 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:10.334496 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:10.339501 | 0f121535-3716-4cbd-9b43-bd7ec4fc3791 ==============================
[0m08:52:10.339501 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:52:10.339691 | 8b5c9c29-6692-417d-8f65-c5c4a7470fee ==============================
[0m08:52:10.339691 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:10.340389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'send_anonymous_usage_stats': 'True'}
[0m08:52:10.340844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:10.482898 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:10.492758 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:10.494582 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:10.506403 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:10.631535 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m08:52:10.640253 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:10.663527 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:10.679350 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:10.681003 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:10.682335 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:10.686787 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:10.687407 [debug] [MainThread]: On master: BEGIN
[0m08:52:10.688819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:10.695978 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m08:52:10.698831 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:10.699861 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:10.703741 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m08:52:10.706746 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:10.707996 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:10.708999 [debug] [MainThread]: On master: BEGIN
[0m08:52:10.710404 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:10.711818 [debug] [MainThread]: On master: COMMIT
[0m08:52:10.712483 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:10.713504 [debug] [MainThread]: On master: COMMIT
[0m08:52:10.714917 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:10.716132 [debug] [MainThread]: On master: Close
[0m08:52:10.717345 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:10.718422 [info ] [MainThread]: 
[0m08:52:10.729628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:10.729553 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m08:52:10.729950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:10.730121 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:10.730651 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m08:52:10.731160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:10.739311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_resellers)
[0m08:52:10.742403 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m08:52:10.748039 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m08:52:10.749418 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m08:52:10.771481 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m08:52:10.775293 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:52:10.775884 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m08:52:10.776293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:10.776830 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:10.778570 [info ] [MainThread]: 
[0m08:52:10.780761 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:10.781505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:52:10.782368 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:52:10.782407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:10.782945 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m08:52:10.785136 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:10.789798 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:52:10.790531 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m08:52:10.790432 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:10.791286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:10.791851 [info ] [MainThread]: 
[0m08:52:10.795483 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:10.796971 [debug] [MainThread]: Command end result
[0m08:52:10.797988 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.50043535, "process_user_time": 1.011002, "process_kernel_time": 0.081286, "process_mem_max_rss": "97336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:10.798627 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:10.798556 after 0.50 seconds
[0m08:52:10.799001 [debug] [MainThread]: Flushing usage events
[0m08:52:10.800577 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m08:52:10.801068 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:52:10.801619 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m08:52:10.802663 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:52:10.805609 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:10.806676 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:10.807146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:10.807549 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m08:52:10.811378 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:52:10.812127 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m08:52:10.813010 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:10.813430 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m08:52:10.815965 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m08:52:10.818162 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:52:10.817632 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:10.818930 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m08:52:10.821562 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:10.823582 [debug] [MainThread]: On master: BEGIN
[0m08:52:10.823665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:10.824075 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:10.824369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:10.829334 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:10.832296 [debug] [MainThread]: On master: COMMIT
[0m08:52:10.829409 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:10.832910 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:10.831853 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:10.833794 [debug] [MainThread]: On master: COMMIT
[0m08:52:10.833367 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:10.834765 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:10.834769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:10.835235 [debug] [MainThread]: On master: Close
[0m08:52:10.835935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:10.834168 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:10.836660 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m08:52:10.837152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:10.837680 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:10.838527 [info ] [MainThread]: 
[0m08:52:10.838919 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m08:52:10.839437 [debug] [MainThread]: Command end result
[0m08:52:10.839720 [info ] [MainThread]: 
[0m08:52:10.840093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:10.840564 [info ] [MainThread]: 
[0m08:52:10.841141 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:10.840988 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:52:10.842009 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.713923, "process_user_time": 1.110071, "process_kernel_time": 0.082227, "process_mem_max_rss": "106620", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:10.842532 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:10.842468 after 5.71 seconds
[0m08:52:10.842358 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:10.843008 [debug] [MainThread]: Flushing usage events
[0m08:52:10.843532 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:10.850834 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:10.855159 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:10.856181 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:12.438846 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:12.443432 | 428d811b-13de-474a-bdb5-ee2da4b085a1 ==============================
[0m08:52:12.443432 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:12.444076 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:12.447997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'send_anonymous_usage_stats': 'True'}


============================== 08:52:12.448768 | 57d17c59-06ff-4d5c-bb1f-bc99c8517ce2 ==============================
[0m08:52:12.448768 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:12.452642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:12.579181 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:12.589093 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:12.590278 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:12.606423 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:12.800503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:12.801044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:12.811464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:12.812212 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:12.855731 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:12.856957 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:12.857637 [info ] [MainThread]: 
[0m08:52:12.858191 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:12.858409 [info ] [MainThread]: 
[0m08:52:12.859625 [debug] [MainThread]: Command end result
[0m08:52:12.860212 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:12.860461 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45197383, "process_user_time": 1.022577, "process_kernel_time": 0.062035, "process_mem_max_rss": "97224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:12.861230 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:12.861078 after 0.45 seconds
[0m08:52:12.861328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:12.861682 [debug] [MainThread]: Flushing usage events
[0m08:52:12.885319 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:12.886088 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:12.887479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:13.296336 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m08:52:13.296040 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m08:52:13.297087 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:13.297511 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:13.297607 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:13.298064 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:13.299889 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m08:52:13.300226 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:13.301048 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:13.301858 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:13.302277 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:13.302973 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:13.306537 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.307030 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.307291 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.307417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:13.307777 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.308169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:13.312224 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:13.314938 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.315905 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:13.322056 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m08:52:13.323471 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:13.324003 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.324366 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.324887 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:13.325395 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.325754 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.326083 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.326559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.326943 [debug] [MainThread]: On master: Close
[0m08:52:13.327533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:13.327961 [info ] [MainThread]: 
[0m08:52:13.333430 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m08:52:13.334109 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m08:52:13.334620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_transactions)
[0m08:52:13.335011 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m08:52:13.340557 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m08:52:13.342353 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m08:52:13.355094 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m08:52:13.355762 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.356107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:13.359326 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m08:52:13.360941 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:13.361409 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.361779 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.362315 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:13.362938 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.363359 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.363827 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.364311 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.364652 [debug] [MainThread]: On master: Close
[0m08:52:13.364625 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m08:52:13.365211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:13.365817 [info ] [MainThread]: 
[0m08:52:13.367039 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:52:13.367567 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m08:52:13.368030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:13.371171 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m08:52:13.371852 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m08:52:13.372628 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:52:13.372698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_products)
[0m08:52:13.374737 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:52:13.374880 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m08:52:13.375700 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m08:52:13.379939 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:13.381148 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m08:52:13.385258 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m08:52:13.388918 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:52:13.392173 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m08:52:13.393077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:13.402046 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m08:52:13.402721 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:52:13.403233 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m08:52:13.404080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.408099 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m08:52:13.408606 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m08:52:13.409606 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:52:13.410078 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m08:52:13.410538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:13.411846 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:52:13.412420 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m08:52:13.413129 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:13.414988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:52:13.415144 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m08:52:13.415668 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:52:13.416283 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m08:52:13.416694 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:52:13.417357 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m08:52:13.417744 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:13.418483 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.418952 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.419301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:13.422498 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:52:13.423117 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m08:52:13.423896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:13.423949 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:13.424595 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.424976 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.425357 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.426001 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.426389 [debug] [MainThread]: On master: Close
[0m08:52:13.426891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:13.427347 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:13.427844 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m08:52:13.428352 [info ] [MainThread]: 
[0m08:52:13.428806 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.21 seconds (10.21s).
[0m08:52:13.429666 [debug] [MainThread]: Command end result
[0m08:52:13.430127 [info ] [MainThread]: 
[0m08:52:13.430764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:13.431288 [info ] [MainThread]: 
[0m08:52:13.431796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:13.432671 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.980136, "process_user_time": 2.380946, "process_kernel_time": 0.148934, "process_mem_max_rss": "112852", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:13.433030 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m08:52:13.433343 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:13.433261 after 11.98 seconds
[0m08:52:13.433614 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:52:13.433764 [debug] [MainThread]: Flushing usage events
[0m08:52:13.434111 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m08:52:13.435141 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.440007 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m08:52:13.443494 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:52:13.444259 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m08:52:13.444952 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:13.448164 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m08:52:13.449690 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.08s]
[0m08:52:13.450364 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m08:52:13.451713 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.452119 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.452596 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:13.457459 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:13.458127 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.458706 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.459476 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.460178 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.460692 [debug] [MainThread]: On master: Close
[0m08:52:13.461185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:13.461585 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:13.461925 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m08:52:13.462550 [info ] [MainThread]: 
[0m08:52:13.462667 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m08:52:13.463501 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m08:52:13.463522 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m08:52:13.464402 [debug] [MainThread]: Command end result
[0m08:52:13.463970 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:13.464792 [info ] [MainThread]: 
[0m08:52:13.464508 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:13.465328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:13.465036 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:13.465795 [info ] [MainThread]: 
[0m08:52:13.465585 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:13.466271 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:13.467056 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.006065, "process_user_time": 2.38702, "process_kernel_time": 0.138377, "process_mem_max_rss": "113048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:13.467744 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:13.467631 after 12.01 seconds
[0m08:52:13.467800 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m08:52:13.468176 [debug] [MainThread]: Flushing usage events
[0m08:52:13.468089 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:13.468991 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:13.470040 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:13.471168 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:13.471887 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:13.478063 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.478679 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.479024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:13.484134 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:13.484795 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.485148 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:13.489084 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m08:52:13.490799 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:13.491385 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.491728 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.492233 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:13.492700 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.493023 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.493334 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.493776 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.494068 [debug] [MainThread]: On master: Close
[0m08:52:13.494639 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:13.494991 [info ] [MainThread]: 
[0m08:52:13.500580 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m08:52:13.501190 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m08:52:13.501645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_customers)
[0m08:52:13.501996 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m08:52:13.507744 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m08:52:13.508928 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m08:52:13.532307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m08:52:13.533628 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m08:52:13.534075 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m08:52:13.534583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:13.666441 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m08:52:13.667356 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.667860 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.668310 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.669270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.669868 [debug] [MainThread]: On master: Close
[0m08:52:13.670510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:13.670937 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:13.671398 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m08:52:13.671891 [info ] [MainThread]: 
[0m08:52:13.672292 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.48 seconds (10.48s).
[0m08:52:13.673117 [debug] [MainThread]: Command end result
[0m08:52:13.673546 [info ] [MainThread]: 
[0m08:52:13.673995 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:13.674377 [info ] [MainThread]: 
[0m08:52:13.674711 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:13.675342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.268839, "process_user_time": 2.372603, "process_kernel_time": 0.133937, "process_mem_max_rss": "115000", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:13.675799 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:13.675724 after 12.27 seconds
[0m08:52:13.676136 [debug] [MainThread]: Flushing usage events
[0m08:52:15.321077 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:15.339696 | 6909844e-580e-4c38-8128-208cf9c5a8a6 ==============================
[0m08:52:15.339696 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:15.354708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m08:52:15.367567 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:15.352337 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:15.381377 | abfa8cfd-3ea3-4c47-b2c8-2887f4af8ba7 ==============================
[0m08:52:15.381377 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:15.382479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 08:52:15.383651 | b367dd38-3f3a-4da9-a2b2-3811a319d4d4 ==============================
[0m08:52:15.383651 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:15.384401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'send_anonymous_usage_stats': 'True'}
[0m08:52:15.385703 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:15.391384 | 154f80e4-549d-465b-b15b-bc04afd1a236 ==============================
[0m08:52:15.391384 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:15.392515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'send_anonymous_usage_stats': 'True'}
[0m08:52:15.510552 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:15.524580 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:15.526156 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:15.528823 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:15.534060 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:15.544394 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:15.545147 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:15.548687 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:15.725996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:15.726859 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:15.739451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:15.740016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:15.740179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:15.741977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:15.742177 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:15.742721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:15.792472 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:15.793114 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:15.793956 [info ] [MainThread]: 
[0m08:52:15.795261 [info ] [MainThread]: 
[0m08:52:15.795666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:15.795827 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:15.796080 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:15.796877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:15.797769 [debug] [MainThread]: Command end result
[0m08:52:15.798885 [info ] [MainThread]: 
[0m08:52:15.798591 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:15.798912 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.495521, "process_user_time": 1.00886, "process_kernel_time": 0.059701, "process_mem_max_rss": "97588", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:15.799913 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:15.799794 after 0.50 seconds
[0m08:52:15.799489 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:15.800492 [info ] [MainThread]: 
[0m08:52:15.800664 [debug] [MainThread]: Flushing usage events
[0m08:52:15.801257 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:15.801872 [debug] [MainThread]: Command end result
[0m08:52:15.803416 [debug] [MainThread]: Command end result
[0m08:52:15.806741 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.52122235, "process_user_time": 0.999842, "process_kernel_time": 0.058517, "process_mem_max_rss": "97340", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:15.807391 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.51763344, "process_user_time": 1.004929, "process_kernel_time": 0.058111, "process_mem_max_rss": "97460", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:15.807499 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:15.807406 after 0.52 seconds
[0m08:52:15.808697 [debug] [MainThread]: Flushing usage events
[0m08:52:15.808730 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:15.808620 after 0.52 seconds
[0m08:52:15.809794 [debug] [MainThread]: Flushing usage events
[0m08:52:15.825812 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:15.827544 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:15.829535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:15.843389 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m08:52:15.844269 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:15.844970 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:15.847742 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m08:52:15.849868 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:15.850805 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:15.855484 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:15.856459 [debug] [MainThread]: On master: BEGIN
[0m08:52:15.857571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:17.899119 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.012 seconds
[0m08:52:17.904073 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:17.908853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:52:17.909237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:17.953570 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:17.942414 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:17.961899 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:17.962424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:17.956443 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:17.967806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:18.313081 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m08:52:18.314095 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:18.314685 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:18.318658 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m08:52:18.320228 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:18.320916 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:18.321400 [debug] [MainThread]: On master: BEGIN
[0m08:52:18.321957 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:18.324053 [debug] [MainThread]: On master: COMMIT
[0m08:52:18.324846 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:18.328467 [debug] [MainThread]: On master: COMMIT
[0m08:52:18.329323 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:18.329996 [debug] [MainThread]: On master: Close
[0m08:52:18.330886 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:18.331411 [info ] [MainThread]: 
[0m08:52:18.337708 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m08:52:18.338509 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m08:52:18.339442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m08:52:18.339882 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m08:52:18.345714 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m08:52:18.348464 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m08:52:18.374133 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m08:52:18.392016 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:52:18.400603 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m08:52:18.402657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:18.424645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m08:52:18.431882 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:52:18.439926 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
      id AS geography_key,
      cityname as city_name,
      countryname as country_name,
      regionname as region_name
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m08:52:18.443120 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.002 seconds
[0m08:52:18.447684 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:52:18.448347 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m08:52:18.449110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:18.460286 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m08:52:18.460894 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:52:18.461308 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m08:52:18.462038 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:52:18.466561 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m08:52:18.469944 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:52:18.470633 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m08:52:18.471312 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:52:18.473094 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m08:52:18.475187 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 0.14s]
[0m08:52:18.475844 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m08:52:18.477831 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:18.478965 [debug] [MainThread]: On master: BEGIN
[0m08:52:18.479440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:18.484076 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:18.487380 [debug] [MainThread]: On master: COMMIT
[0m08:52:18.487906 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:18.488633 [debug] [MainThread]: On master: COMMIT
[0m08:52:18.492814 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:18.493394 [debug] [MainThread]: On master: Close
[0m08:52:18.494010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:18.494433 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:18.495087 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m08:52:18.495560 [info ] [MainThread]: 
[0m08:52:18.497555 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.38 seconds (15.38s).
[0m08:52:18.498198 [debug] [MainThread]: Command end result
[0m08:52:18.498743 [info ] [MainThread]: 
[0m08:52:18.499594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:18.500090 [info ] [MainThread]: 
[0m08:52:18.500594 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:18.501399 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.095757, "process_user_time": 2.336571, "process_kernel_time": 0.129809, "process_mem_max_rss": "115064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:18.502025 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:18.501960 after 17.10 seconds
[0m08:52:18.502602 [debug] [MainThread]: Flushing usage events
[0m08:52:18.539230 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m08:52:18.540468 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m08:52:18.541053 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m08:52:18.546232 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:18.551417 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m08:52:18.552170 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m08:52:18.553258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:18.562510 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m08:52:18.563435 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m08:52:18.564029 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m08:52:18.565176 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:52:18.570499 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m08:52:18.574014 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m08:52:18.574719 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m08:52:18.575475 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:18.577386 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m08:52:18.579140 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 5.08s]
[0m08:52:18.580032 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m08:52:18.581383 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:18.581827 [debug] [MainThread]: On master: BEGIN
[0m08:52:18.582192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:20.435040 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:20.446021 | 1f84825c-bbb2-4aa4-929d-0c3ad36f18ec ==============================
[0m08:52:20.446021 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:20.450841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:52:20.601393 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:20.612228 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:20.738779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:20.739349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:20.790194 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:20.791408 [info ] [MainThread]: 
[0m08:52:20.791831 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:20.793099 [debug] [MainThread]: Command end result
[0m08:52:20.793761 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.3920621, "process_user_time": 0.989137, "process_kernel_time": 0.061318, "process_mem_max_rss": "97968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:20.794271 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:20.794193 after 0.39 seconds
[0m08:52:20.794660 [debug] [MainThread]: Flushing usage events
[0m08:52:20.840041 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.011 seconds
[0m08:52:20.841415 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:20.845292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:52:20.845846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:20.850504 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:20.856293 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:20.860777 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:20.861432 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:20.862022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:20.862656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:20.864027 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m08:52:20.864804 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:20.865253 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:20.869870 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m08:52:20.871408 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:20.871928 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:20.872411 [debug] [MainThread]: On master: BEGIN
[0m08:52:20.872975 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:20.873559 [debug] [MainThread]: On master: COMMIT
[0m08:52:20.873986 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:20.874257 [debug] [MainThread]: On master: COMMIT
[0m08:52:20.874701 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:20.875170 [debug] [MainThread]: On master: Close
[0m08:52:20.875802 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:20.876221 [info ] [MainThread]: 
[0m08:52:20.881437 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m08:52:20.882008 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m08:52:20.882478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_channels)
[0m08:52:20.882845 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m08:52:20.888222 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m08:52:20.902840 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m08:52:20.961790 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m08:52:20.971864 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:52:20.974689 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m08:52:20.975127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:22.975654 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m08:52:22.982084 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:22.982585 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:22.984529 [debug] [ThreadPool]: SQL status: BEGIN in 5.022 seconds
[0m08:52:22.986081 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m08:52:22.987285 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:22.989383 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:22.988802 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:22.990189 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:22.991623 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m08:52:22.992653 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:22.993170 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:22.997849 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:22.999603 [debug] [MainThread]: On master: BEGIN
[0m08:52:23.000528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:23.591224 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m08:52:23.592425 [debug] [MainThread]: On master: COMMIT
[0m08:52:23.592975 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:23.593352 [debug] [MainThread]: On master: COMMIT
[0m08:52:23.594008 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:23.594490 [debug] [MainThread]: On master: Close
[0m08:52:23.595057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:23.595513 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m08:52:23.595911 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:23.596306 [info ] [MainThread]: 
[0m08:52:23.596703 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.20 seconds (20.20s).
[0m08:52:23.597410 [debug] [MainThread]: Command end result
[0m08:52:23.597752 [info ] [MainThread]: 
[0m08:52:23.598186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:23.598620 [info ] [MainThread]: 
[0m08:52:23.599098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:23.599901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.1232, "process_user_time": 2.418255, "process_kernel_time": 0.14296, "process_mem_max_rss": "114992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:23.600426 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:23.600356 after 22.12 seconds
[0m08:52:23.600828 [debug] [MainThread]: Flushing usage events
[0m08:52:25.413998 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:25.418566 | 5da9845e-3c18-482b-8223-cbb2807a50a3 ==============================
[0m08:52:25.418566 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:25.419093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:25.559172 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:25.574054 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:25.726756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:25.727320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:25.808038 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:25.818848 [info ] [MainThread]: 
[0m08:52:25.819578 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:25.821341 [debug] [MainThread]: Command end result
[0m08:52:25.822155 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44253334, "process_user_time": 0.968626, "process_kernel_time": 0.067321, "process_mem_max_rss": "97364", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:25.822823 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:25.822750 after 0.44 seconds
[0m08:52:25.826089 [debug] [MainThread]: Flushing usage events
[0m08:52:25.867787 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m08:52:25.868560 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:25.869156 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m08:52:25.876743 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:25.879743 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:25.880577 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:25.882443 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m08:52:25.883761 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:25.882745 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:25.884999 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:25.884241 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:25.885652 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:25.890965 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:25.891463 [debug] [MainThread]: On master: BEGIN
[0m08:52:25.891776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:25.979915 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m08:52:25.981617 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:52:25.982632 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m08:52:25.984504 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:25.989298 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:52:25.990004 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m08:52:25.993972 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:26.003008 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m08:52:26.003737 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:52:26.004247 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m08:52:26.005561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:52:26.013221 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m08:52:26.020975 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:52:26.021642 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m08:52:26.022285 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:26.024127 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m08:52:26.025717 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 5.14s]
[0m08:52:26.026467 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m08:52:26.027821 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:26.028475 [debug] [MainThread]: On master: BEGIN
[0m08:52:26.028986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:26.034146 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:26.034793 [debug] [MainThread]: On master: COMMIT
[0m08:52:26.035363 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:26.035794 [debug] [MainThread]: On master: COMMIT
[0m08:52:26.036301 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:26.037024 [debug] [MainThread]: On master: Close
[0m08:52:26.037824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:26.038263 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:26.038589 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m08:52:26.038885 [info ] [MainThread]: 
[0m08:52:26.039271 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.26 seconds (15.26s).
[0m08:52:26.039964 [debug] [MainThread]: Command end result
[0m08:52:26.040393 [info ] [MainThread]: 
[0m08:52:26.041002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:26.041424 [info ] [MainThread]: 
[0m08:52:26.041768 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:26.042521 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.738683, "process_user_time": 1.165577, "process_kernel_time": 0.085927, "process_mem_max_rss": "108584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:26.043173 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:26.043063 after 15.74 seconds
[0m08:52:26.043682 [debug] [MainThread]: Flushing usage events
[0m08:52:28.004657 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m08:52:28.006325 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:28.007061 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:28.011690 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m08:52:28.013320 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:28.014587 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:28.017890 [debug] [MainThread]: On master: BEGIN
[0m08:52:28.018657 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:28.019868 [debug] [MainThread]: On master: COMMIT
[0m08:52:28.023650 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:28.024060 [debug] [MainThread]: On master: COMMIT
[0m08:52:28.024618 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:28.024998 [debug] [MainThread]: On master: Close
[0m08:52:28.025511 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:28.025944 [info ] [MainThread]: 
[0m08:52:28.033846 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m08:52:28.037619 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m08:52:28.038474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m08:52:28.038933 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m08:52:28.044490 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m08:52:28.057497 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m08:52:28.130961 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m08:52:28.134440 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:52:28.135998 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m08:52:28.136558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:28.549795 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:28.554252 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:28.567617 | 4bd07d48-11ec-49c8-8c28-b979deac1fe9 ==============================
[0m08:52:28.567617 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:52:28.567007 | aeaaee82-e17d-4ed1-be67-687d1abe4616 ==============================
[0m08:52:28.567007 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:28.568889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:28.571002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:52:28.736519 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:28.738422 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:28.752196 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:28.756247 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:28.945351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:28.945935 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:28.952055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:28.953015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:28.996601 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:28.997998 [info ] [MainThread]: 
[0m08:52:28.998629 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:29.000380 [debug] [MainThread]: Command end result
[0m08:52:29.000897 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:29.001649 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49612743, "process_user_time": 1.003881, "process_kernel_time": 0.052411, "process_mem_max_rss": "97856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:29.002853 [info ] [MainThread]: 
[0m08:52:29.003569 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:29.003465 after 0.50 seconds
[0m08:52:29.004055 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:29.004435 [debug] [MainThread]: Flushing usage events
[0m08:52:29.005179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:29.029256 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:29.030042 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:29.031130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:29.037883 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m08:52:29.039400 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:29.045088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:52:29.045852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:29.050712 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:29.052515 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:29.053469 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:29.061596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:29.059521 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:29.062344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:29.068466 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:52:29.069170 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:29.070796 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:29.073116 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m08:52:29.074239 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:29.074823 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:30.902594 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m08:52:30.914007 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:30.934039 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:30.960936 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m08:52:30.963855 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:30.964505 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:30.964961 [debug] [MainThread]: On master: BEGIN
[0m08:52:30.965712 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:30.966305 [debug] [MainThread]: On master: COMMIT
[0m08:52:30.966833 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:30.967199 [debug] [MainThread]: On master: COMMIT
[0m08:52:30.967747 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:30.968261 [debug] [MainThread]: On master: Close
[0m08:52:30.968818 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:30.970515 [info ] [MainThread]: 
[0m08:52:30.975540 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m08:52:30.976119 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m08:52:30.976600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_product)
[0m08:52:30.976929 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m08:52:30.982345 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m08:52:30.983634 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m08:52:31.006468 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m08:52:31.007654 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:52:31.008001 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m08:52:31.008392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:31.012572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:52:31.013153 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:52:31.013556 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m08:52:31.015453 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:31.020347 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:52:31.020899 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m08:52:31.021660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:31.030469 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m08:52:31.030952 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:52:31.031284 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m08:52:31.032002 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:52:31.036410 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m08:52:31.039424 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:52:31.039840 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m08:52:31.040429 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:31.042184 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m08:52:31.043510 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m08:52:31.044206 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m08:52:31.045504 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:31.045999 [debug] [MainThread]: On master: BEGIN
[0m08:52:31.046448 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:31.051132 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:31.051821 [debug] [MainThread]: On master: COMMIT
[0m08:52:31.052442 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:31.052955 [debug] [MainThread]: On master: COMMIT
[0m08:52:31.053564 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:31.054001 [debug] [MainThread]: On master: Close
[0m08:52:31.054509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:31.055741 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:31.056114 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m08:52:31.056538 [info ] [MainThread]: 
[0m08:52:31.056929 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.26 seconds (15.26s).
[0m08:52:31.057542 [debug] [MainThread]: Command end result
[0m08:52:31.057898 [info ] [MainThread]: 
[0m08:52:31.058407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:31.058796 [info ] [MainThread]: 
[0m08:52:31.059176 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:31.059933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.740901, "process_user_time": 1.136009, "process_kernel_time": 0.0908, "process_mem_max_rss": "106192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:31.060507 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:31.060441 after 15.74 seconds
[0m08:52:31.060891 [debug] [MainThread]: Flushing usage events
[0m08:52:32.511455 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:32.511460 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:32.515925 | ed0de2d2-4b37-45ed-8361-468cf9b441ae ==============================
[0m08:52:32.515925 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:52:32.515889 | 83f98b3c-1153-4d0f-bf86-891b266c23ae ==============================
[0m08:52:32.515889 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:32.516584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:32.516745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:32.642752 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:32.644439 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:32.653854 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:32.655587 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:32.840195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:32.840873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:32.854210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:32.854873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:32.886848 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:32.888201 [info ] [MainThread]: 
[0m08:52:32.888831 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:32.889576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:32.902490 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:32.903705 [info ] [MainThread]: 
[0m08:52:32.904140 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:32.905658 [debug] [MainThread]: Command end result
[0m08:52:32.906468 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4251155, "process_user_time": 0.966464, "process_kernel_time": 0.060028, "process_mem_max_rss": "97732", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:32.907026 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:32.906952 after 0.43 seconds
[0m08:52:32.907415 [debug] [MainThread]: Flushing usage events
[0m08:52:32.911557 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:32.912077 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:32.912633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:33.151714 [debug] [Thread-1 (]: SQL status: BEGIN in 5.015 seconds
[0m08:52:33.161154 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:52:33.172097 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    reseller_id AS sales_agent_key,
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m08:52:33.206663 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.024 seconds
[0m08:52:33.211801 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:52:33.212459 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m08:52:33.213185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:33.224595 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m08:52:33.225439 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:52:33.226081 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m08:52:33.227133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:52:33.231545 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m08:52:33.234415 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:52:33.234906 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m08:52:33.235590 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:52:33.237595 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m08:52:33.239250 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 5.20s]
[0m08:52:33.239937 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m08:52:33.241054 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:33.241524 [debug] [MainThread]: On master: BEGIN
[0m08:52:33.241919 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:33.245746 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:52:33.246281 [debug] [MainThread]: On master: COMMIT
[0m08:52:33.246642 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:33.246949 [debug] [MainThread]: On master: COMMIT
[0m08:52:33.247327 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:33.247694 [debug] [MainThread]: On master: Close
[0m08:52:33.248139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:33.248526 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m08:52:33.248944 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:33.249362 [info ] [MainThread]: 
[0m08:52:33.249704 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.39 seconds (20.39s).
[0m08:52:33.250204 [debug] [MainThread]: Command end result
[0m08:52:33.250514 [info ] [MainThread]: 
[0m08:52:33.250844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:33.251111 [info ] [MainThread]: 
[0m08:52:33.251392 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:33.252216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.844524, "process_user_time": 1.185545, "process_kernel_time": 0.074727, "process_mem_max_rss": "108356", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:33.252741 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:33.252678 after 20.85 seconds
[0m08:52:33.253126 [debug] [MainThread]: Flushing usage events
[0m08:52:34.071542 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m08:52:34.072267 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:34.072802 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:34.074894 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:34.076306 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:34.076960 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:34.080811 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:34.081347 [debug] [MainThread]: On master: BEGIN
[0m08:52:34.081784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:35.547305 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:35.552084 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:35.556395 | 7d641c8a-865a-4866-ad78-480d6b2ee92a ==============================
[0m08:52:35.556395 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:52:35.556773 | 4cf13838-e885-4841-a687-676430403612 ==============================
[0m08:52:35.556773 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:35.557319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:35.557854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'send_anonymous_usage_stats': 'True'}
[0m08:52:35.709236 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:35.718132 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:35.723157 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:35.734152 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:35.923620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:35.924249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:35.942369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:35.943041 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:35.970897 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:35.972135 [info ] [MainThread]: 
[0m08:52:35.972840 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:35.974351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:35.998186 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:35.999353 [info ] [MainThread]: 
[0m08:52:35.999663 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:35.999935 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:36.000864 [debug] [MainThread]: Command end result
[0m08:52:36.001294 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:36.002007 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5500316, "process_user_time": 0.949932, "process_kernel_time": 0.066924, "process_mem_max_rss": "97452", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:36.002385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:36.002882 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:36.002791 after 0.55 seconds
[0m08:52:36.003756 [debug] [MainThread]: Flushing usage events
[0m08:52:37.922506 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.010 seconds
[0m08:52:37.926200 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:37.930104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:37.930569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:37.939287 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:37.941630 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:37.942182 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:37.942568 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:37.943155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:37.943834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:39.086492 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m08:52:39.088033 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:39.089713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:39.095196 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m08:52:39.096969 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:39.097617 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:39.098412 [debug] [MainThread]: On master: BEGIN
[0m08:52:39.099981 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:39.100596 [debug] [MainThread]: On master: COMMIT
[0m08:52:39.102468 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:39.104448 [debug] [MainThread]: On master: COMMIT
[0m08:52:39.105143 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:39.105607 [debug] [MainThread]: On master: Close
[0m08:52:39.106244 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:39.106692 [info ] [MainThread]: 
[0m08:52:39.111475 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m08:52:39.112148 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m08:52:39.112784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m08:52:39.113209 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m08:52:39.118988 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m08:52:39.120313 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m08:52:39.164276 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m08:52:39.166475 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:52:39.167776 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m08:52:39.169264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:39.188757 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m08:52:39.206005 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:52:39.218422 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m08:52:39.223884 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m08:52:39.234670 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:52:39.235217 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m08:52:39.236452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:52:39.246520 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m08:52:39.247491 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:52:39.248936 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m08:52:39.251366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:52:39.260126 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m08:52:39.266571 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:52:39.270492 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m08:52:39.271091 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:52:39.273711 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m08:52:39.275049 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.16s]
[0m08:52:39.275654 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m08:52:39.276853 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:39.278931 [debug] [MainThread]: On master: BEGIN
[0m08:52:39.279793 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:39.286979 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m08:52:39.287653 [debug] [MainThread]: On master: COMMIT
[0m08:52:39.291084 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:39.291601 [debug] [MainThread]: On master: COMMIT
[0m08:52:39.292084 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:39.292400 [debug] [MainThread]: On master: Close
[0m08:52:39.292948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:39.293379 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m08:52:39.293731 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:39.294174 [info ] [MainThread]: 
[0m08:52:39.297151 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m08:52:39.298095 [debug] [MainThread]: Command end result
[0m08:52:39.298630 [info ] [MainThread]: 
[0m08:52:39.299050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:39.299442 [info ] [MainThread]: 
[0m08:52:39.299758 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:39.300439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.782278, "process_user_time": 1.127121, "process_kernel_time": 0.075413, "process_mem_max_rss": "108344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:39.300872 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:39.300815 after 10.78 seconds
[0m08:52:39.301202 [debug] [MainThread]: Flushing usage events
[0m08:52:41.007947 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.006 seconds
[0m08:52:41.009638 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:41.016594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:41.017174 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:41.021135 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:41.023240 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:41.026988 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:41.028847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:41.027503 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:41.029917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:41.034323 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:52:41.037288 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:52:41.045169 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:41.038678 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:41.060725 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:41.048239 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:41.065670 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:41.066888 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:41.067136 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m08:52:41.068260 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:41.067529 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:41.072733 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:41.083062 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:41.089566 [debug] [MainThread]: On master: BEGIN
[0m08:52:41.090264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:41.099627 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:52:41.100122 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:41.107897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:41.122823 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m08:52:41.125707 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:41.128558 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:41.130856 [debug] [MainThread]: On master: BEGIN
[0m08:52:41.131459 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:41.132000 [debug] [MainThread]: On master: COMMIT
[0m08:52:41.132398 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:41.132814 [debug] [MainThread]: On master: COMMIT
[0m08:52:41.133398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:41.133851 [debug] [MainThread]: On master: Close
[0m08:52:41.134371 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:41.134719 [info ] [MainThread]: 
[0m08:52:41.140195 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m08:52:41.140864 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m08:52:41.141384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m08:52:41.144038 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m08:52:41.157850 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m08:52:41.159180 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m08:52:41.181528 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m08:52:41.184497 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m08:52:41.187508 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m08:52:41.187836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:41.600865 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:41.608541 | 9450df36-883e-4d18-9b7a-3f9178e54333 ==============================
[0m08:52:41.608541 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:41.609833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m08:52:41.748824 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:41.766635 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:41.925469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:41.926160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:42.020731 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:42.022069 [info ] [MainThread]: 
[0m08:52:42.023637 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:42.027538 [debug] [MainThread]: Command end result
[0m08:52:42.030652 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48244596, "process_user_time": 0.989695, "process_kernel_time": 0.066517, "process_mem_max_rss": "97716", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:42.031561 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:42.031477 after 0.48 seconds
[0m08:52:42.032365 [debug] [MainThread]: Flushing usage events
[0m08:52:42.959606 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m08:52:42.977996 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:42.978510 [debug] [ThreadPool]: SQL status: BEGIN in 5.035 seconds
[0m08:52:42.978859 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:42.982366 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:42.983201 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:42.984584 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:42.985757 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:42.986103 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m08:52:42.987933 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:42.986782 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:42.988576 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:42.993352 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:42.993905 [debug] [MainThread]: On master: BEGIN
[0m08:52:42.994406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:46.194452 [debug] [Thread-1 (]: SQL status: BEGIN in 5.007 seconds
[0m08:52:46.197731 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m08:52:46.198344 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m08:52:46.200617 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:52:46.205256 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m08:52:46.205676 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m08:52:46.206339 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:46.215165 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m08:52:46.215709 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m08:52:46.216014 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m08:52:46.216861 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:52:46.223629 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m08:52:46.226766 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m08:52:46.227253 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m08:52:46.227908 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:46.229677 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m08:52:46.231291 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 5.09s]
[0m08:52:46.231959 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m08:52:46.233054 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:46.233537 [debug] [MainThread]: On master: BEGIN
[0m08:52:46.233893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:46.244309 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m08:52:46.246102 [debug] [MainThread]: On master: COMMIT
[0m08:52:46.247825 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:46.248170 [debug] [MainThread]: On master: COMMIT
[0m08:52:46.248559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:46.249430 [debug] [MainThread]: On master: Close
[0m08:52:46.249863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:46.251485 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:46.256746 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m08:52:46.257291 [info ] [MainThread]: 
[0m08:52:46.257713 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m08:52:46.269167 [debug] [MainThread]: Command end result
[0m08:52:46.283575 [info ] [MainThread]: 
[0m08:52:46.292763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:46.296965 [info ] [MainThread]: 
[0m08:52:46.301420 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:46.302252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.82806, "process_user_time": 1.121846, "process_kernel_time": 0.060859, "process_mem_max_rss": "108232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:46.302788 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:46.302727 after 10.83 seconds
[0m08:52:46.303141 [debug] [MainThread]: Flushing usage events
[0m08:52:48.001608 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m08:52:48.004029 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:48.007740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:48.014431 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m08:52:48.016722 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:48.022994 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:48.023418 [debug] [MainThread]: On master: BEGIN
[0m08:52:48.026498 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:48.028227 [debug] [MainThread]: On master: COMMIT
[0m08:52:48.030599 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:48.032065 [debug] [MainThread]: On master: COMMIT
[0m08:52:48.033992 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:48.035058 [debug] [MainThread]: On master: Close
[0m08:52:48.036882 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:48.038414 [info ] [MainThread]: 
[0m08:52:48.045931 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m08:52:48.048857 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m08:52:48.049696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m08:52:48.050284 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m08:52:48.056330 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m08:52:48.057809 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m08:52:48.084341 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m08:52:48.085776 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:52:48.086259 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m08:52:48.086598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:48.091016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:52:48.091552 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:52:48.095140 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select product_id as product_key, product_id as original_product_id, product_name, geography_key , product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m08:52:48.103289 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.008 seconds
[0m08:52:48.111612 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:52:48.113536 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m08:52:48.114471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:48.126706 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m08:52:48.127429 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:52:48.127929 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m08:52:48.131446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:52:48.136289 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m08:52:48.139062 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:52:48.139496 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m08:52:48.140708 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:52:48.142478 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m08:52:48.146183 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.10s]
[0m08:52:48.148222 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m08:52:48.149486 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:48.150228 [debug] [MainThread]: On master: BEGIN
[0m08:52:48.152168 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:48.157244 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:48.163778 [debug] [MainThread]: On master: COMMIT
[0m08:52:48.164188 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:48.164502 [debug] [MainThread]: On master: COMMIT
[0m08:52:48.165039 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:48.165460 [debug] [MainThread]: On master: Close
[0m08:52:48.165922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:48.166250 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:48.166540 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m08:52:48.167254 [info ] [MainThread]: 
[0m08:52:48.167761 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.28 seconds (15.28s).
[0m08:52:48.168586 [debug] [MainThread]: Command end result
[0m08:52:48.168997 [info ] [MainThread]: 
[0m08:52:48.169425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:48.169782 [info ] [MainThread]: 
[0m08:52:48.170287 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:48.171099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.691328, "process_user_time": 1.107276, "process_kernel_time": 0.060839, "process_mem_max_rss": "108680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:48.171630 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:48.171552 after 15.69 seconds
[0m08:52:48.172024 [debug] [MainThread]: Flushing usage events
[0m08:52:48.731684 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:48.736658 | 87cb58d6-b180-41e6-a3f6-2f81624af051 ==============================
[0m08:52:48.736658 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:48.737651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:48.756483 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:48.762206 | 5d50dec7-314c-469c-a41c-2fa3efb4ffd3 ==============================
[0m08:52:48.762206 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:48.765109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:52:48.924950 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:48.932692 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:48.939818 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:48.951534 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:49.109878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:49.114129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:49.120243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:49.122853 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:49.163651 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:49.165845 [info ] [MainThread]: 
[0m08:52:49.166701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:49.170389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:49.186782 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:49.188110 [info ] [MainThread]: 
[0m08:52:49.188525 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:49.189912 [debug] [MainThread]: Command end result
[0m08:52:49.190659 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.50067466, "process_user_time": 1.008505, "process_kernel_time": 0.071106, "process_mem_max_rss": "97328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:49.191221 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:49.191150 after 0.50 seconds
[0m08:52:49.191714 [debug] [MainThread]: Flushing usage events
[0m08:52:49.195072 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:49.196960 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:49.197487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:49.205935 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m08:52:49.207254 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:49.211261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:49.211772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:49.216005 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:49.218256 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:49.218877 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:49.219304 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:49.219666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:49.220221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:49.225679 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:52:49.226926 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:49.227401 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:49.229948 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m08:52:49.231147 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:49.231785 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:50.657713 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:50.663043 | 46a62866-4a89-4b2b-8a6c-2eb7a0398529 ==============================
[0m08:52:50.663043 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:50.663660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:50.787062 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:50.832725 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:50.953847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:50.954342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:51.008974 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:51.011249 [info ] [MainThread]: 
[0m08:52:51.012074 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:51.014124 [debug] [MainThread]: Command end result
[0m08:52:51.014835 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.38641712, "process_user_time": 0.993445, "process_kernel_time": 0.052128, "process_mem_max_rss": "97096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:51.015425 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:51.015343 after 0.39 seconds
[0m08:52:51.015851 [debug] [MainThread]: Flushing usage events
[0m08:52:54.225269 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m08:52:54.227627 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:54.228154 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:54.230971 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:54.232430 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:54.233043 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:54.236985 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.237602 [debug] [MainThread]: On master: BEGIN
[0m08:52:54.238245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:54.242265 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:52:54.242751 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.243270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:54.248479 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m08:52:54.250933 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:54.251727 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.252375 [debug] [MainThread]: On master: BEGIN
[0m08:52:54.253030 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:54.253726 [debug] [MainThread]: On master: COMMIT
[0m08:52:54.254093 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.254387 [debug] [MainThread]: On master: COMMIT
[0m08:52:54.254812 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:54.255315 [debug] [MainThread]: On master: Close
[0m08:52:54.255862 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:54.256250 [info ] [MainThread]: 
[0m08:52:54.265561 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m08:52:54.269242 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m08:52:54.269997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m08:52:54.270546 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m08:52:54.276376 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m08:52:54.277673 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m08:52:54.304118 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m08:52:54.305491 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m08:52:54.306024 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m08:52:54.306450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:54.310694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:52:54.311303 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m08:52:54.311890 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select customer_key, customer_first_name, customer_last_name, customer_email, sales_agent_key
from "sales_dw"."dev"."staging_customers"
  );
  
[0m08:52:55.424488 [debug] [Thread-1 (]: SQL status: SELECT 259565 in 1.112 seconds
[0m08:52:55.431008 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m08:52:55.432450 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m08:52:55.433800 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:55.445790 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m08:52:55.446467 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m08:52:55.446833 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m08:52:55.453862 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m08:52:55.458370 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m08:52:55.463891 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m08:52:55.465039 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m08:52:55.468180 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:52:55.471233 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m08:52:55.473210 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 259565[0m in 1.20s]
[0m08:52:55.474464 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m08:52:55.476870 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:55.477625 [debug] [MainThread]: On master: BEGIN
[0m08:52:55.483022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:55.500394 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m08:52:55.500987 [debug] [MainThread]: On master: COMMIT
[0m08:52:55.501312 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:55.501639 [debug] [MainThread]: On master: COMMIT
[0m08:52:55.505568 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:55.513869 [debug] [MainThread]: On master: Close
[0m08:52:55.522266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:55.535020 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m08:52:55.535498 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:55.535842 [info ] [MainThread]: 
[0m08:52:55.536193 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.37 seconds (6.37s).
[0m08:52:55.536698 [debug] [MainThread]: Command end result
[0m08:52:55.549176 [info ] [MainThread]: 
[0m08:52:55.556279 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:55.566346 [info ] [MainThread]: 
[0m08:52:55.568123 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:55.568791 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8559675, "process_user_time": 1.161541, "process_kernel_time": 0.078249, "process_mem_max_rss": "108532", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:55.569313 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:55.569242 after 6.86 seconds
[0m08:52:55.569644 [debug] [MainThread]: Flushing usage events
[0m08:52:57.719633 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:57.725988 | a6272302-24a8-4d18-a1ed-1e303f687577 ==============================
[0m08:52:57.725988 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:57.727731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:57.729325 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:57.729758 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:57.735725 | 7ad2674c-6814-46d5-887c-826962bb9bf3 ==============================
[0m08:52:57.735725 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:52:57.735876 | b238c5ba-5870-4850-9fff-5ee59f6bd1ce ==============================
[0m08:52:57.735876 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:57.737394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:57.737744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'send_anonymous_usage_stats': 'True'}
[0m08:52:57.890022 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:57.905919 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:57.917128 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:57.930287 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:57.933084 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:57.947008 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:58.070585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:58.071244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:58.089230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:58.089995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:58.101865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:58.102387 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:58.135609 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:58.138292 [info ] [MainThread]: 
[0m08:52:58.139818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:58.140665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:58.145017 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:58.148342 [info ] [MainThread]: 
[0m08:52:58.152627 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:58.152256 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:58.153715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:58.153991 [info ] [MainThread]: 
[0m08:52:58.154457 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:58.155862 [debug] [MainThread]: Command end result
[0m08:52:58.156673 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4584398, "process_user_time": 0.989345, "process_kernel_time": 0.060959, "process_mem_max_rss": "97316", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:58.157392 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:58.157274 after 0.46 seconds
[0m08:52:58.157845 [debug] [MainThread]: Flushing usage events
[0m08:52:58.167801 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:58.168469 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:58.169023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:58.174868 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m08:52:58.176421 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:58.177565 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:58.178127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:58.178061 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:58.183301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:58.183909 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:58.191609 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:58.193513 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:58.196342 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:58.197493 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:58.198443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:58.199376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:58.209827 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m08:52:58.211249 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:58.210799 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m08:52:58.229233 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:58.230841 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:58.215326 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:58.238973 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:58.245607 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m08:52:58.248836 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:58.265021 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:58.252844 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:58.269167 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:58.282181 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:58.282728 [debug] [MainThread]: On master: BEGIN
[0m08:52:58.283085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:03.190316 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.012 seconds
[0m08:53:03.196516 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:53:03.203288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:53:03.203866 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:53:03.208328 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:03.210109 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:03.210595 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:53:03.210988 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:53:03.211352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:53:03.211683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:03.216198 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:53:03.216742 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:53:03.217007 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:03.217665 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:03.218126 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:53:03.218695 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:53:03.221008 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:53:03.221294 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m08:53:03.222220 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:53:03.223222 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:53:03.223713 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:53:03.224135 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:53:03.229791 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:03.230356 [debug] [MainThread]: On master: BEGIN
[0m08:53:03.230668 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:03.291855 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m08:53:03.292541 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:03.293040 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:53:03.297666 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m08:53:03.299586 [debug] [MainThread]: On master: ROLLBACK
[0m08:53:03.300151 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:03.300658 [debug] [MainThread]: On master: BEGIN
[0m08:53:03.301410 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:53:03.302050 [debug] [MainThread]: On master: COMMIT
[0m08:53:03.302553 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:03.302864 [debug] [MainThread]: On master: COMMIT
[0m08:53:03.303277 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:03.303591 [debug] [MainThread]: On master: Close
[0m08:53:03.304029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:03.304436 [info ] [MainThread]: 
[0m08:53:03.309237 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m08:53:03.309821 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m08:53:03.310323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_resellers_xml)
[0m08:53:03.310832 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m08:53:03.326558 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m08:53:03.327964 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m08:53:03.363723 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m08:53:03.373186 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m08:53:03.374747 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m08:53:03.375087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:08.244226 [debug] [MainThread]: SQL status: BEGIN in 5.013 seconds
[0m08:53:08.249469 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:08.252552 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:53:08.273076 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m08:53:08.278377 [debug] [MainThread]: On master: ROLLBACK
[0m08:53:08.279067 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:08.279429 [debug] [MainThread]: On master: BEGIN
[0m08:53:08.280004 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:53:08.280413 [debug] [MainThread]: On master: COMMIT
[0m08:53:08.280987 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:08.284035 [debug] [MainThread]: On master: COMMIT
[0m08:53:08.285038 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:08.285967 [debug] [MainThread]: On master: Close
[0m08:53:08.289465 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:08.290014 [info ] [MainThread]: 
[0m08:53:08.295088 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m08:53:08.295761 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m08:53:08.296336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_main)
[0m08:53:08.296905 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m08:53:08.312979 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m08:53:08.314548 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m08:53:08.348272 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m08:53:08.352266 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m08:53:08.352777 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m08:53:08.353198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:08.384311 [debug] [Thread-1 (]: SQL status: BEGIN in 5.009 seconds
[0m08:53:08.384966 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m08:53:08.385423 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 



trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  

)
SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m08:53:09.652358 [debug] [Thread-1 (]: SQL status: SELECT 159565 in 1.266 seconds
[0m08:53:09.664144 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m08:53:09.664722 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m08:53:09.665059 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m08:53:09.683038 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m08:53:09.684562 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m08:53:09.685919 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 159565[0m in 6.37s]
[0m08:53:09.686564 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m08:53:09.687767 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:09.688191 [debug] [MainThread]: On master: BEGIN
[0m08:53:09.688470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:53:09.693073 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:53:09.693707 [debug] [MainThread]: On master: COMMIT
[0m08:53:09.694121 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:09.694589 [debug] [MainThread]: On master: COMMIT
[0m08:53:09.695164 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:09.695743 [debug] [MainThread]: On master: Close
[0m08:53:09.696322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:09.696691 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:53:09.697146 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m08:53:09.697571 [info ] [MainThread]: 
[0m08:53:09.697989 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.56 seconds (11.56s).
[0m08:53:09.698683 [debug] [MainThread]: Command end result
[0m08:53:09.699091 [info ] [MainThread]: 
[0m08:53:09.699562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:09.700022 [info ] [MainThread]: 
[0m08:53:09.700452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:53:09.701228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.016149, "process_user_time": 1.151426, "process_kernel_time": 0.060495, "process_mem_max_rss": "106932", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:09.701890 [debug] [MainThread]: Command `dbt run` succeeded at 08:53:09.701768 after 12.02 seconds
[0m08:53:09.702330 [debug] [MainThread]: Flushing usage events
[0m08:53:11.897347 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:53:11.902078 | 77a16e79-fcf9-4f86-80ca-a374149f1417 ==============================
[0m08:53:11.902078 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:53:11.904160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}
[0m08:53:12.044384 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:53:12.092378 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:53:12.269074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:12.269686 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:12.328097 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:53:12.329747 [info ] [MainThread]: 
[0m08:53:12.330275 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:53:12.331853 [debug] [MainThread]: Command end result
[0m08:53:12.332591 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46872792, "process_user_time": 1.060409, "process_kernel_time": 0.064609, "process_mem_max_rss": "97472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:12.333294 [debug] [MainThread]: Command `dbt test` succeeded at 08:53:12.333177 after 0.47 seconds
[0m08:53:12.335186 [debug] [MainThread]: Flushing usage events
[0m08:53:13.357232 [debug] [Thread-1 (]: SQL status: BEGIN in 5.004 seconds
[0m08:53:13.359989 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m08:53:13.360776 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m08:53:18.301740 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 4.939 seconds
[0m08:53:18.312770 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m08:53:18.313529 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m08:53:18.316603 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m08:53:18.323801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m08:53:18.329735 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m08:53:18.331269 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 10.03s]
[0m08:53:18.331905 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m08:53:18.334609 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:18.335172 [debug] [MainThread]: On master: BEGIN
[0m08:53:18.335533 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:53:18.341311 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:53:18.346762 [debug] [MainThread]: On master: COMMIT
[0m08:53:18.347119 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:18.347416 [debug] [MainThread]: On master: COMMIT
[0m08:53:18.348001 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:18.348427 [debug] [MainThread]: On master: Close
[0m08:53:18.348812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:18.349073 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m08:53:18.350112 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:53:18.352068 [info ] [MainThread]: 
[0m08:53:18.352518 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 20.20 seconds (20.20s).
[0m08:53:18.355993 [debug] [MainThread]: Command end result
[0m08:53:18.356373 [info ] [MainThread]: 
[0m08:53:18.356777 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:18.359012 [info ] [MainThread]: 
[0m08:53:18.359371 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:53:18.360124 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.660213, "process_user_time": 1.108354, "process_kernel_time": 0.077024, "process_mem_max_rss": "106948", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:18.360743 [debug] [MainThread]: Command `dbt run` succeeded at 08:53:18.360642 after 20.66 seconds
[0m08:53:18.361168 [debug] [MainThread]: Flushing usage events
[0m08:53:19.863148 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:53:19.867460 | 683a7d1e-c411-4c4c-8c19-bb44dd3f6337 ==============================
[0m08:53:19.867460 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:53:19.867976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:53:19.888100 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:53:19.894659 | f57f0280-71ce-42c5-b038-982ec158e7fc ==============================
[0m08:53:19.894659 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:53:19.895996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'send_anonymous_usage_stats': 'True'}
[0m08:53:20.000095 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:53:20.014336 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:53:20.031324 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:53:20.045882 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:53:20.170177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:20.170810 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:20.189889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:20.190462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:20.228350 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:53:20.231520 [info ] [MainThread]: 
[0m08:53:20.238162 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:53:20.242899 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:53:20.256121 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:53:20.257313 [info ] [MainThread]: 
[0m08:53:20.265267 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:53:20.281531 [debug] [MainThread]: Command end result
[0m08:53:20.281345 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:53:20.282390 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44837013, "process_user_time": 0.999615, "process_kernel_time": 0.055534, "process_mem_max_rss": "97904", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:20.282936 [debug] [MainThread]: Command `dbt test` succeeded at 08:53:20.282874 after 0.45 seconds
[0m08:53:20.282527 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:53:20.286341 [debug] [MainThread]: Flushing usage events
[0m08:53:20.287058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:20.303307 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.016 seconds
[0m08:53:20.307426 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:53:20.316556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:53:20.317315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:53:20.322021 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:20.324216 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:20.325407 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:53:20.326015 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:53:20.326503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:53:20.326989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:25.332950 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m08:53:25.336988 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m08:53:25.341118 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:25.340494 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:25.342081 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:53:25.342607 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:53:25.346629 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m08:53:25.346952 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.002 seconds
[0m08:53:25.348114 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:53:25.349460 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:53:25.350094 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:53:25.350430 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:53:25.356834 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:25.357311 [debug] [MainThread]: On master: BEGIN
[0m08:53:25.357705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:30.362481 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m08:53:30.364862 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:30.365472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:53:30.371924 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m08:53:30.376974 [debug] [MainThread]: On master: ROLLBACK
[0m08:53:30.377496 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:30.377863 [debug] [MainThread]: On master: BEGIN
[0m08:53:30.378444 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:53:30.381757 [debug] [MainThread]: On master: COMMIT
[0m08:53:30.382346 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:30.382884 [debug] [MainThread]: On master: COMMIT
[0m08:53:30.383426 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:30.383784 [debug] [MainThread]: On master: Close
[0m08:53:30.384285 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:30.384766 [info ] [MainThread]: 
[0m08:53:30.389856 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m08:53:30.390561 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m08:53:30.391056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m08:53:30.391791 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m08:53:30.397898 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m08:53:30.399095 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m08:53:30.425065 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m08:53:30.429711 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m08:53:30.430133 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m08:53:30.430484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:30.434612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:53:30.435159 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m08:53:30.435480 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m08:53:31.277472 [debug] [Thread-1 (]: SQL status: SELECT 1159565 in 0.842 seconds
[0m08:53:31.288845 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m08:53:31.289350 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m08:53:31.297056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:53:31.307037 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m08:53:31.307517 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m08:53:31.307867 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m08:53:31.315406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m08:53:31.320257 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m08:53:31.325086 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m08:53:31.325501 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m08:53:31.325967 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:53:31.327601 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m08:53:31.328952 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1159565[0m in 0.94s]
[0m08:53:31.329576 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m08:53:31.330796 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:31.333429 [debug] [MainThread]: On master: BEGIN
[0m08:53:31.333919 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:53:31.339255 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:53:31.339924 [debug] [MainThread]: On master: COMMIT
[0m08:53:31.340376 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:31.340683 [debug] [MainThread]: On master: COMMIT
[0m08:53:31.341114 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:31.341579 [debug] [MainThread]: On master: Close
[0m08:53:31.342328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:31.343374 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:53:31.344235 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m08:53:31.344702 [info ] [MainThread]: 
[0m08:53:31.350309 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.11 seconds (11.11s).
[0m08:53:31.351124 [debug] [MainThread]: Command end result
[0m08:53:31.354268 [info ] [MainThread]: 
[0m08:53:31.355226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:31.358648 [info ] [MainThread]: 
[0m08:53:31.359379 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:53:31.360271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.556844, "process_user_time": 1.126689, "process_kernel_time": 0.069856, "process_mem_max_rss": "106704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:31.362245 [debug] [MainThread]: Command `dbt run` succeeded at 08:53:31.362155 after 11.56 seconds
[0m08:53:31.362688 [debug] [MainThread]: Flushing usage events
[0m08:53:32.991685 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:53:32.996325 | 7f9c5985-362b-4fb5-afbc-e6b248c9e4d2 ==============================
[0m08:53:32.996325 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:53:32.996984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:53:33.016137 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:53:33.020719 | 0fa62556-5509-4266-90f5-1f58dcb040bd ==============================
[0m08:53:33.020719 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:53:33.021270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:53:33.129805 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:53:33.146812 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:53:33.153782 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:53:33.164947 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:53:33.390244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:33.391282 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:33.392786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:33.393906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:33.438061 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:53:33.439347 [info ] [MainThread]: 
[0m08:53:33.441518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:53:33.442312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:53:33.449598 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:53:33.451085 [info ] [MainThread]: 
[0m08:53:33.451633 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:53:33.453123 [debug] [MainThread]: Command end result
[0m08:53:33.453878 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.47780925, "process_user_time": 0.96405, "process_kernel_time": 0.070076, "process_mem_max_rss": "97328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:33.454388 [debug] [MainThread]: Command `dbt test` succeeded at 08:53:33.454325 after 0.48 seconds
[0m08:53:33.454862 [debug] [MainThread]: Flushing usage events
[0m08:53:33.466871 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:53:33.467479 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:53:33.467902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:33.473359 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m08:53:33.474294 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:53:33.477795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:53:33.478360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:53:33.483057 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:33.484649 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:33.485027 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:53:33.485334 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:53:33.485775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:53:33.486350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:33.491726 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:53:33.492341 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:33.492817 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:53:33.494989 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.002 seconds
[0m08:53:33.496299 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:53:33.496849 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:53:38.491420 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m08:53:38.492334 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:38.492746 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:53:38.495074 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:53:38.496344 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:53:38.496901 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:53:38.500997 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:38.501577 [debug] [MainThread]: On master: BEGIN
[0m08:53:38.501985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:43.506113 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m08:53:43.509674 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:43.510128 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:53:43.515512 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m08:53:43.519406 [debug] [MainThread]: On master: ROLLBACK
[0m08:53:43.520315 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:43.520778 [debug] [MainThread]: On master: BEGIN
[0m08:53:43.522806 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:53:43.523415 [debug] [MainThread]: On master: COMMIT
[0m08:53:43.523890 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:43.524434 [debug] [MainThread]: On master: COMMIT
[0m08:53:43.525389 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:43.527037 [debug] [MainThread]: On master: Close
[0m08:53:43.530961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:43.531465 [info ] [MainThread]: 
[0m08:53:43.537175 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m08:53:43.537898 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m08:53:43.538410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.fact_sales)
[0m08:53:43.539035 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m08:53:43.545159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m08:53:43.546811 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m08:53:43.572348 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m08:53:43.575270 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m08:53:43.575954 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m08:53:43.584828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:43.589388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:53:43.589924 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m08:53:43.591281 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    transaction_id,
    product_key,
    channel_key,
    reseller_id,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    commissionpct,
    commissionpaid,
    product_price
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m08:53:44.839798 [debug] [Thread-1 (]: SQL status: SELECT 1159565 in 1.246 seconds
[0m08:53:44.853712 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m08:53:44.854376 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m08:53:44.855243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:53:44.869046 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m08:53:44.869657 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m08:53:44.870051 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m08:53:44.873533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m08:53:44.880625 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m08:53:44.883799 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m08:53:44.884922 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m08:53:44.886163 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:53:44.888908 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m08:53:44.891836 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1159565[0m in 1.35s]
[0m08:53:44.892654 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m08:53:44.893836 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:44.894221 [debug] [MainThread]: On master: BEGIN
[0m08:53:44.894529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:53:44.903300 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:53:44.903993 [debug] [MainThread]: On master: COMMIT
[0m08:53:44.904382 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:44.904656 [debug] [MainThread]: On master: COMMIT
[0m08:53:44.905294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:44.905707 [debug] [MainThread]: On master: Close
[0m08:53:44.906132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:44.906574 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:53:44.907048 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m08:53:44.907426 [info ] [MainThread]: 
[0m08:53:44.907768 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.47 seconds (11.47s).
[0m08:53:44.908323 [debug] [MainThread]: Command end result
[0m08:53:44.908591 [info ] [MainThread]: 
[0m08:53:44.908941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:44.909226 [info ] [MainThread]: 
[0m08:53:44.909516 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:53:44.910223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.952638, "process_user_time": 1.083116, "process_kernel_time": 0.081763, "process_mem_max_rss": "106552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:44.910688 [debug] [MainThread]: Command `dbt run` succeeded at 08:53:44.910613 after 11.95 seconds
[0m08:53:44.911062 [debug] [MainThread]: Flushing usage events
[0m08:53:47.182365 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:53:47.186654 | f2a97572-e692-4ced-87d9-d8a72d91a372 ==============================
[0m08:53:47.186654 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:53:47.187425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:53:47.321384 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:53:47.400384 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:53:47.564076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:47.564758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:47.619023 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:53:47.620580 [info ] [MainThread]: 
[0m08:53:47.621282 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:53:47.625165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:53:47.625864 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:53:47.662435 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:47.662839 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:47.663648 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:53:47.664083 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:53:47.664477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:47.664861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:52.669916 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m08:53:52.674416 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m08:53:52.675945 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:52.675405 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:52.676398 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:53:52.676920 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:53:52.678916 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.002 seconds
[0m08:53:52.679173 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:53:52.680449 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:53:52.681533 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:53:52.682045 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:53:52.682434 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:53:52.688490 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:52.689036 [debug] [MainThread]: On master: BEGIN
[0m08:53:52.689501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:52.693746 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:53:52.694312 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:52.694732 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:53:52.699841 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m08:53:52.701639 [debug] [MainThread]: On master: ROLLBACK
[0m08:53:52.702160 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:52.702471 [debug] [MainThread]: On master: BEGIN
[0m08:53:52.702961 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:53:52.703454 [debug] [MainThread]: On master: COMMIT
[0m08:53:52.703923 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:52.704489 [debug] [MainThread]: On master: COMMIT
[0m08:53:52.705065 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:52.705480 [debug] [MainThread]: On master: Close
[0m08:53:52.706010 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:52.706424 [info ] [MainThread]: 
[0m08:53:52.711231 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m08:53:52.711774 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m08:53:52.712315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m08:53:52.712748 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m08:53:52.718630 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m08:53:52.720205 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m08:53:52.731875 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m08:53:52.739789 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m08:53:52.740556 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m08:53:52.742582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:52.754948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m08:53:52.756677 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m08:53:52.757359 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m08:53:52.951194 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.189 seconds
[0m08:53:52.957011 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m08:53:52.957743 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m08:53:52.958470 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.25s]
[0m08:53:52.959179 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m08:53:52.960981 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:52.962689 [debug] [MainThread]: On master: BEGIN
[0m08:53:52.963154 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:53:52.968363 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:53:52.972760 [debug] [MainThread]: On master: COMMIT
[0m08:53:52.973310 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:52.973695 [debug] [MainThread]: On master: COMMIT
[0m08:53:52.974121 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:52.974418 [debug] [MainThread]: On master: Close
[0m08:53:52.974926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:52.975257 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:53:52.975542 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m08:53:52.975854 [info ] [MainThread]: 
[0m08:53:52.976177 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m08:53:52.981740 [debug] [MainThread]: Command end result
[0m08:53:52.982172 [info ] [MainThread]: 
[0m08:53:52.982610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:52.982968 [info ] [MainThread]: 
[0m08:53:52.983285 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:53:52.984083 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.830804, "process_user_time": 1.125108, "process_kernel_time": 0.078018, "process_mem_max_rss": "110584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:52.984805 [debug] [MainThread]: Command `dbt test` succeeded at 08:53:52.984674 after 5.83 seconds
[0m08:53:52.985235 [debug] [MainThread]: Flushing usage events
[0m14:50:19.511645 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:50:19.552494 | 033a5498-66cc-4a27-98a1-2f4dd397042c ==============================
[0m14:50:19.552494 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:50:19.555114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:19.879130 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m14:50:19.957097 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m14:50:20.115829 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5i1u1hsv'
[0m14:50:20.122449 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m14:50:20.139169 [debug] [MainThread]: Creating symlink to local dependency.
[0m14:50:20.158591 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m14:50:20.161373 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.79899335, "process_user_time": 2.774675, "process_kernel_time": 0.429289, "process_mem_max_rss": "108052", "process_in_blocks": "22696", "process_out_blocks": "8"}
[0m14:50:20.163858 [debug] [MainThread]: Command `dbt deps` succeeded at 14:50:20.163645 after 0.80 seconds
[0m14:50:20.165814 [debug] [MainThread]: Flushing usage events
[0m14:50:24.528673 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:50:24.540062 | 3f29b037-8736-45e8-af05-60e308e072f3 ==============================
[0m14:50:24.540062 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:50:24.542337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:50:25.058761 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:50:25.123922 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:50:25.131763 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:50:31.791433 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:50:31.796637 [info ] [MainThread]: 
[0m14:50:31.798850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:31.801749 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:50:31.870139 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:50:31.872197 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:50:31.874521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:31.888141 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m14:50:31.891549 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:50:31.894688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m14:50:31.897009 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m14:50:31.909031 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m14:50:31.911357 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m14:50:31.912929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:31.923278 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:50:31.925961 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m14:50:31.928246 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m14:50:31.931982 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m14:50:31.935510 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m14:50:31.937254 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m14:50:31.938910 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m14:50:31.942902 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m14:50:31.945134 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m14:50:31.957531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m14:50:31.959431 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:50:31.973064 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:50:31.979198 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:50:31.980912 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:50:31.982845 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:50:31.984641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:31.986432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:31.998683 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:50:31.999926 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m14:50:32.001695 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:50:32.003429 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:50:32.005476 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:50:32.007802 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:50:32.023500 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m14:50:32.024491 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m14:50:32.027882 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:50:32.031602 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:50:32.033423 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:50:32.034697 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:50:32.048733 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:32.050873 [debug] [MainThread]: On master: BEGIN
[0m14:50:32.052802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:32.064974 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m14:50:32.067630 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:32.069748 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:50:32.080748 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:50:32.084789 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:32.087016 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:32.088624 [debug] [MainThread]: On master: BEGIN
[0m14:50:32.090632 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:50:32.093315 [debug] [MainThread]: On master: COMMIT
[0m14:50:32.095991 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:32.098462 [debug] [MainThread]: On master: COMMIT
[0m14:50:32.100487 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:32.102387 [debug] [MainThread]: On master: Close
[0m14:50:32.103903 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:32.105823 [info ] [MainThread]: 
[0m14:50:32.118426 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m14:50:32.121136 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m14:50:32.123539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m14:50:32.126609 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m14:50:32.128947 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m14:50:32.203364 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m14:50:32.206096 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m14:50:32.214724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:32.248884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m14:50:32.255440 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m14:50:32.263548 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m14:50:32.302830 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.035 seconds
[0m14:50:32.604836 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m14:50:32.607292 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m14:50:32.612024 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.002 seconds
[0m14:50:32.623498 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m14:50:32.901230 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m14:50:32.904016 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m14:50:32.906435 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m14:50:32.911384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:50:32.918016 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m14:50:32.922861 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.80s]
[0m14:50:32.925956 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m14:50:32.929903 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:32.932217 [debug] [MainThread]: On master: BEGIN
[0m14:50:32.934932 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:32.947817 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m14:50:32.950881 [debug] [MainThread]: On master: COMMIT
[0m14:50:32.953101 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:32.955138 [debug] [MainThread]: On master: COMMIT
[0m14:50:32.958186 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:32.960263 [debug] [MainThread]: On master: Close
[0m14:50:32.963534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:32.966804 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m14:50:32.969298 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:50:32.971523 [info ] [MainThread]: 
[0m14:50:32.974321 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m14:50:32.977890 [debug] [MainThread]: Command end result
[0m14:50:33.109550 [info ] [MainThread]: 
[0m14:50:33.111832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:33.114066 [info ] [MainThread]: 
[0m14:50:33.116081 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:50:33.120013 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.742546, "process_user_time": 8.456439, "process_kernel_time": 0.220952, "process_mem_max_rss": "121116", "process_in_blocks": "4200", "process_out_blocks": "0"}
[0m14:50:33.123566 [debug] [MainThread]: Command `dbt seed` succeeded at 14:50:33.123160 after 8.75 seconds
[0m14:50:33.126298 [debug] [MainThread]: Flushing usage events
[0m14:50:50.468985 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:50:50.481976 | 88da6803-516e-466c-bf7b-01460e92cf36 ==============================
[0m14:50:50.481976 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:50:50.484505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:50.743709 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m14:50:50.751335 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m14:50:50.787508 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2wh_qm7n'
[0m14:50:50.790250 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m14:50:50.794979 [debug] [MainThread]: Creating symlink to local dependency.
[0m14:50:50.799963 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m14:50:50.803055 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5227314, "process_user_time": 2.741127, "process_kernel_time": 0.101148, "process_mem_max_rss": "108052", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:50:50.806105 [debug] [MainThread]: Command `dbt deps` succeeded at 14:50:50.805763 after 0.53 seconds
[0m14:50:50.807940 [debug] [MainThread]: Flushing usage events
[0m14:50:55.525102 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:50:55.534358 | 2de530f8-ef61-4781-8ce3-f1ec5c9e02f6 ==============================
[0m14:50:55.534358 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:50:55.536307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:50:55.999644 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:50:56.064591 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:50:57.756027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:57.757825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:58.221397 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:50:58.226751 [info ] [MainThread]: 
[0m14:50:58.229671 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:58.233891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:50:58.373473 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:50:58.375468 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:50:58.377032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:58.390054 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m14:50:58.393029 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:50:58.404899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:50:58.406613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:50:58.420554 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:50:58.425837 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:50:58.427582 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:50:58.429475 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:50:58.431416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:58.433188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:58.446198 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m14:50:58.448560 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m14:50:58.450938 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:50:58.453318 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:50:58.455889 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:50:58.458149 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:50:58.466369 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m14:50:58.468156 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m14:50:58.471189 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:50:58.474837 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:50:58.477042 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:50:58.478624 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:50:58.498673 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.500792 [debug] [MainThread]: On master: BEGIN
[0m14:50:58.502801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:58.516073 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m14:50:58.518783 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.521734 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:50:58.528536 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m14:50:58.533324 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:58.536277 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.538415 [debug] [MainThread]: On master: BEGIN
[0m14:50:58.540802 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:50:58.543443 [debug] [MainThread]: On master: COMMIT
[0m14:50:58.545505 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.548566 [debug] [MainThread]: On master: COMMIT
[0m14:50:58.551999 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:58.554006 [debug] [MainThread]: On master: Close
[0m14:50:58.556229 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:58.558291 [info ] [MainThread]: 
[0m14:50:58.654382 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m14:50:58.656928 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m14:50:58.659041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now seed.dbtcomp.geography)
[0m14:50:58.661051 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m14:50:58.662993 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m14:50:58.739621 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m14:50:58.741595 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m14:50:58.743857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:58.756605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m14:50:58.759429 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m14:50:58.761471 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */
truncate table "sales_dw"."dev_raw"."geography"
[0m14:50:58.766380 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m14:50:59.006793 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m14:50:59.008981 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m14:50:59.013296 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.002 seconds
[0m14:50:59.027877 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m14:50:59.080617 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m14:50:59.083364 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m14:50:59.085705 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m14:50:59.090033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:50:59.094858 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m14:50:59.099934 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.44s]
[0m14:50:59.102357 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m14:50:59.106603 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:59.108604 [debug] [MainThread]: On master: BEGIN
[0m14:50:59.110541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:59.122397 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m14:50:59.125320 [debug] [MainThread]: On master: COMMIT
[0m14:50:59.127285 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:59.129667 [debug] [MainThread]: On master: COMMIT
[0m14:50:59.132694 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:59.135072 [debug] [MainThread]: On master: Close
[0m14:50:59.137361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:59.139389 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:50:59.141105 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m14:50:59.143019 [info ] [MainThread]: 
[0m14:50:59.144705 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m14:50:59.147839 [debug] [MainThread]: Command end result
[0m14:50:59.256869 [info ] [MainThread]: 
[0m14:50:59.258984 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:59.260693 [info ] [MainThread]: 
[0m14:50:59.262698 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:50:59.266045 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.8568966, "process_user_time": 4.407815, "process_kernel_time": 0.249876, "process_mem_max_rss": "111348", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:50:59.268906 [debug] [MainThread]: Command `dbt seed` succeeded at 14:50:59.268616 after 3.86 seconds
[0m14:50:59.271128 [debug] [MainThread]: Flushing usage events
[0m14:51:41.401459 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:51:41.418283 | 1d7779b8-b4aa-4b6e-89e8-3c3a6ab79b1b ==============================
[0m14:51:41.418283 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:51:41.422064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:41.507175 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:51:41.524990 | 729933b6-32a5-4aad-820d-18bfefb9be2e ==============================
[0m14:51:41.524990 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:51:41.528691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:51:41.796522 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:51:41.816308 | a0cd5f23-c21b-4aae-b4b6-c0e2dcdb6902 ==============================
[0m14:51:41.816308 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:51:41.820242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:51:41.871056 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:51:41.890883 | 7d0da1a9-bfa4-48fb-adf1-e5125c2bbe5f ==============================
[0m14:51:41.890883 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:51:41.894366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:41.919580 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:51:41.938963 | 35872797-7e89-4a1e-8cd6-1184bcffe279 ==============================
[0m14:51:41.938963 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:51:41.942757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:42.006416 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:51:42.024450 | 4605e7fc-b647-4ddc-bf52-e6526a98792d ==============================
[0m14:51:42.024450 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:51:42.028167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:42.053691 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:51:42.075961 | 62be0fd3-05f3-4829-98ed-9e34979fefaf ==============================
[0m14:51:42.075961 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:51:42.079711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:51:42.248487 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:51:42.374665 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:51:42.382968 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:51:42.492365 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:51:42.676492 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:51:42.778200 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:51:42.831094 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:51:42.868975 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:51:42.918558 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:51:42.921495 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:51:42.924380 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:51:42.951990 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:51:42.956889 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:51:43.043359 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:51:43.068051 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:51:43.052944 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:51:43.104926 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:51:43.241344 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:51:43.409900 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:51:43.413300 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:51:43.559710 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:51:43.563720 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:51:43.582575 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:51:43.586699 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:51:43.726563 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:51:43.730988 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:51:43.855173 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:51:43.858812 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:51:52.146916 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:51:52.154969 [info ] [MainThread]: 
[0m14:51:52.161109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:52.166142 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:51:52.353730 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:51:52.358155 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:51:52.363793 [info ] [MainThread]: 
[0m14:51:52.365665 [info ] [MainThread]: 
[0m14:51:52.368694 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:52.369340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:52.377279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:51:52.376674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:51:52.387283 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:51:52.390929 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:51:52.394313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:52.419573 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.025 seconds
[0m14:51:52.429288 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:51:52.438455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m14:51:52.446397 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m14:51:52.480095 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m14:51:52.483926 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m14:51:52.486865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:52.508017 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m14:51:52.514076 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m14:51:52.517049 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m14:51:52.520535 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:51:52.521181 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m14:51:52.524650 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:51:52.525119 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:51:52.523975 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:51:52.528469 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:51:52.529407 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m14:51:52.530337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:52.532216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:52.532386 [info ] [MainThread]: 
[0m14:51:52.532651 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m14:51:52.535891 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:52.535568 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m14:51:52.542089 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m14:51:52.541115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:51:52.545433 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m14:51:52.553639 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.023 seconds
[0m14:51:52.556340 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.024 seconds
[0m14:51:52.560367 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:51:52.562330 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:51:52.569641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m14:51:52.583201 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:51:52.584798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:51:52.588437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:51:52.571744 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:51:52.591718 [info ] [MainThread]: 
[0m14:51:52.595127 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:52.586806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:51:52.606451 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:51:52.603977 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:52.591197 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:51:52.609585 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:52.623063 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:51:52.631326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:52.605549 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:52.627042 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:52.639067 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:51:52.622557 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:52.642582 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:51:52.640764 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:52.630423 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:51:52.647005 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:51:52.654635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:52.646532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:52.650397 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:51:52.648087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:52.664221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:52.660991 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m14:51:52.672229 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:52.675200 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:51:52.678414 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m14:51:52.651093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:52.687671 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m14:51:52.682862 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:52.696957 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:51:52.696830 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m14:51:52.698220 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:52.690360 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m14:51:52.700034 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:52.702196 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:52.703078 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:51:52.706183 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:51:52.701630 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:51:52.710620 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m14:51:52.696497 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.017 seconds
[0m14:51:52.711366 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m14:51:52.718961 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:51:52.719319 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:51:52.720514 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m14:51:52.722984 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m14:51:52.724684 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:51:52.716440 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m14:51:52.729066 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:51:52.725277 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:51:52.725446 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:52.724658 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:51:52.732137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:52.731257 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:51:52.731690 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:51:52.731738 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:51:52.737919 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:51:52.735007 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:51:52.739126 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:51:52.742204 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:51:52.756124 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m14:51:52.762460 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.030 seconds
[0m14:51:52.765000 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.765304 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:51:52.767900 [debug] [MainThread]: On master: BEGIN
[0m14:51:52.767960 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:51:52.768720 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:51:52.770777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:52.773619 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.777561 [debug] [MainThread]: On master: BEGIN
[0m14:51:52.782840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:52.801728 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:51:52.800913 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m14:51:52.802230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:51:52.804796 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:51:52.804707 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.807461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:52.809721 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:52.811724 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m14:51:52.815511 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.815802 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.819725 [debug] [MainThread]: On master: BEGIN
[0m14:51:52.819323 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:52.824599 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m14:51:52.826389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:52.804424 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:51:52.831751 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.024 seconds
[0m14:51:52.831436 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:52.833005 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m14:51:52.835082 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.836899 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:51:52.838369 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:52.837659 [debug] [MainThread]: On master: BEGIN
[0m14:51:52.834307 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:52.843991 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.847350 [debug] [MainThread]: On master: BEGIN
[0m14:51:52.847744 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:51:52.844363 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:52.848197 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m14:51:52.851427 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:51:52.847339 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:51:52.851900 [debug] [MainThread]: On master: COMMIT
[0m14:51:52.852918 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.854413 [debug] [MainThread]: On master: COMMIT
[0m14:51:52.851982 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:51:52.856471 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.857853 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.857529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:52.855095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:52.859642 [debug] [MainThread]: On master: COMMIT
[0m14:51:52.860989 [debug] [MainThread]: On master: COMMIT
[0m14:51:52.858566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:52.863441 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:52.865357 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:52.866252 [debug] [MainThread]: On master: Close
[0m14:51:52.869158 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m14:51:52.868364 [debug] [MainThread]: On master: Close
[0m14:51:52.869869 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:52.875581 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:52.875227 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:52.875341 [info ] [MainThread]: 
[0m14:51:52.874737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:51:52.881501 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m14:51:52.879667 [info ] [MainThread]: 
[0m14:51:52.880214 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.886033 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:52.887210 [debug] [MainThread]: On master: BEGIN
[0m14:51:52.889811 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:51:52.894203 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m14:51:52.896147 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:51:52.898777 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:52.880176 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:51:52.902383 [debug] [MainThread]: On master: COMMIT
[0m14:51:52.903462 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:51:52.907495 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.905045 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m14:51:52.911704 [debug] [MainThread]: On master: COMMIT
[0m14:51:52.913900 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m14:51:52.914981 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:52.915537 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:51:52.919042 [debug] [MainThread]: On master: Close
[0m14:51:52.917580 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m14:51:52.920672 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m14:51:52.925060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m14:51:52.924123 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:52.925640 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m14:51:52.922842 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:52.928256 [info ] [MainThread]: 
[0m14:51:52.928403 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m14:51:52.918984 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:51:52.930780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_geography)
[0m14:51:52.928430 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:52.920251 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m14:51:52.934699 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m14:51:52.937564 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:51:52.931648 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:51:52.934480 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:51:52.941219 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:51:52.941133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:52.944731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:52.952591 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m14:51:52.956184 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m14:51:52.960565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_resellers)
[0m14:51:52.965136 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m14:51:52.967596 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m14:51:52.966401 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m14:51:52.971430 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.969944 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m14:51:52.974620 [debug] [MainThread]: On master: BEGIN
[0m14:51:52.974987 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m14:51:52.973605 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:52.977597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:52.977402 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:52.981103 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:51:52.984629 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:51:52.996328 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m14:51:53.002687 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m14:51:53.010870 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m14:51:53.012732 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.017667 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:51:53.017756 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:53.003570 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:51:53.023963 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:51:53.018484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m14:51:53.035122 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m14:51:53.043964 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:53.020729 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:51:53.047663 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.045465 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m14:51:53.062877 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m14:51:53.056387 [debug] [MainThread]: On master: BEGIN
[0m14:51:53.066817 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m14:51:53.077730 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:51:53.098291 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.101623 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.104430 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.105133 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.108954 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:51:53.109696 [debug] [MainThread]: On master: BEGIN
[0m14:51:53.111800 [debug] [MainThread]: On master: Close
[0m14:51:53.112879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:53.115530 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:53.118247 [info ] [MainThread]: 
[0m14:51:53.131735 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m14:51:53.135946 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.140271 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:53.147740 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m14:51:53.152463 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m14:51:53.152535 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m14:51:53.157765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_transactions)
[0m14:51:53.159626 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:53.161374 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m14:51:53.163567 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.166339 [debug] [MainThread]: On master: BEGIN
[0m14:51:53.169562 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:51:53.188723 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.192668 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.195951 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.199343 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:53.202020 [debug] [MainThread]: On master: Close
[0m14:51:53.206249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:53.207567 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m14:51:53.210065 [info ] [MainThread]: 
[0m14:51:53.230379 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m14:51:53.234084 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m14:51:53.237375 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m14:51:53.239987 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m14:51:53.240626 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:51:53.241422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_date)
[0m14:51:53.244675 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m14:51:53.246970 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m14:51:53.248250 [info ] [MainThread]: 
[0m14:51:53.250098 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m14:51:53.252522 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:53.257032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:51:53.274218 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m14:51:53.274222 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m14:51:53.277870 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m14:51:53.277697 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m14:51:53.278761 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m14:51:53.279564 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m14:51:53.281047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:53.281058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:53.282672 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m14:51:53.286042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:53.301708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m14:51:53.301777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m14:51:53.301286 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m14:51:53.305055 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m14:51:53.305147 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m14:51:53.308623 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m14:51:53.308542 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
       -- fill code here 
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m14:51:53.309200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m14:51:53.313003 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m14:51:53.315853 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.003 seconds
[0m14:51:53.316508 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m14:51:53.318800 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:51:53.325490 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:51:53.347607 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m14:51:53.348766 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m14:51:53.350747 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m14:51:53.351752 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m14:51:53.354807 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m14:51:53.355481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:53.354182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:53.358592 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m14:51:53.364435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:53.387404 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m14:51:53.399631 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:51:53.406550 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:51:53.409555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:53.416608 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m14:51:53.420548 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m14:51:53.423911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:53.427737 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m14:51:53.432672 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m14:51:53.436549 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m14:51:53.435702 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m14:51:53.437028 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.027 seconds
[0m14:51:53.440107 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m14:51:53.442952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:51:53.443297 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:51:53.444659 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m14:51:53.444150 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m14:51:53.451578 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m14:51:53.455154 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m14:51:53.456946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m14:51:53.457480 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:51:53.463171 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:51:53.462482 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m14:51:53.475884 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m14:51:53.485168 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:51:53.486124 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m14:51:53.488530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:51:53.505501 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m14:51:53.517239 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m14:51:53.532164 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m14:51:53.523834 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m14:51:53.491927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:51:53.535685 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m14:51:53.539062 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m14:51:53.546364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:53.544936 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m14:51:53.546609 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m14:51:53.547035 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m14:51:53.550664 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m14:51:53.557181 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:51:53.554548 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m14:51:53.559383 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:51:53.570039 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:51:53.579281 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m14:51:53.580926 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:53.592373 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m14:51:53.593239 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 0.66s]
[0m14:51:53.590239 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m14:51:53.604251 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m14:51:53.587861 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:51:53.610712 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.68s]
[0m14:51:53.611117 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.617672 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m14:51:53.618594 [debug] [MainThread]: On master: BEGIN
[0m14:51:53.619497 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m14:51:53.622090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:53.620997 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m14:51:53.625536 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.65s]
[0m14:51:53.583345 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:53.617330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:53.646564 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:51:53.625759 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.640212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:53.653469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:53.654855 [debug] [MainThread]: On master: BEGIN
[0m14:51:53.659666 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m14:51:53.641699 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m14:51:53.658780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:53.662609 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.662178 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m14:51:53.675018 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.676732 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.679158 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m14:51:53.685560 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.686473 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:53.678658 [debug] [MainThread]: On master: BEGIN
[0m14:51:53.678324 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m14:51:53.692577 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:53.694345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m14:51:53.692367 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:51:53.692254 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:53.698707 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m14:51:53.705033 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m14:51:53.703979 [debug] [MainThread]: On master: Close
[0m14:51:53.712506 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m14:51:53.723285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:53.718411 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m14:51:53.727374 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m14:51:53.729632 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:51:53.730098 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m14:51:53.730887 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.732529 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m14:51:53.733101 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.734235 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.735747 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.735648 [info ] [MainThread]: 
[0m14:51:53.727492 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m14:51:53.733515 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:51:53.736865 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.740252 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:53.728701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m14:51:53.738571 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.745278 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:53.738906 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m14:51:53.743912 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:51:53.748919 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:53.749498 [debug] [MainThread]: On master: Close
[0m14:51:53.757281 [debug] [MainThread]: Command end result
[0m14:51:53.747039 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:51:53.763639 [debug] [MainThread]: On master: Close
[0m14:51:53.760350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:53.769804 [info ] [MainThread]: 
[0m14:51:53.772479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:53.772773 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:51:53.773091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:53.776185 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m14:51:53.777026 [info ] [MainThread]: 
[0m14:51:53.776084 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m14:51:53.780233 [info ] [MainThread]: 
[0m14:51:53.781712 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:51:53.783039 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m14:51:53.785082 [info ] [MainThread]: 
[0m14:51:53.780412 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:53.783688 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m14:51:53.791655 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m14:51:53.795093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.621542, "process_user_time": 14.454925, "process_kernel_time": 0.817061, "process_mem_max_rss": "121392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:51:53.795485 [debug] [MainThread]: Command end result
[0m14:51:53.796406 [debug] [MainThread]: Command end result
[0m14:51:53.798406 [info ] [MainThread]: 
[0m14:51:53.799165 [info ] [MainThread]: 
[0m14:51:53.801692 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m14:51:53.801989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:53.802390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:53.800218 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:53.798180 after 12.63 seconds
[0m14:51:53.805040 [info ] [MainThread]: 
[0m14:51:53.805253 [info ] [MainThread]: 
[0m14:51:53.808959 [debug] [MainThread]: Flushing usage events
[0m14:51:53.810499 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:53.808697 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:51:53.810008 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m14:51:53.810685 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:53.815517 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.201149, "process_user_time": 14.798456, "process_kernel_time": 0.736343, "process_mem_max_rss": "121272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:51:53.815526 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.503436, "process_user_time": 14.324699, "process_kernel_time": 0.885119, "process_mem_max_rss": "121448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:51:53.814995 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m14:51:53.815293 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:51:53.819172 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:53.818742 after 12.51 seconds
[0m14:51:53.819484 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:51:53.819171 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:53.818719 after 12.20 seconds
[0m14:51:53.822456 [debug] [MainThread]: Flushing usage events
[0m14:51:53.825920 [debug] [MainThread]: Flushing usage events
[0m14:51:53.829251 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m14:51:53.836724 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.68s]
[0m14:51:53.841214 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m14:51:53.848281 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.848858 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.851676 [debug] [MainThread]: On master: BEGIN
[0m14:51:53.856888 [debug] [MainThread]: On master: BEGIN
[0m14:51:53.858328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:53.859750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:53.879584 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m14:51:53.882881 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.885416 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m14:51:53.886759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:53.889296 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.892572 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.896142 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.906771 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m14:51:53.910724 [debug] [MainThread]: SQL status: SELECT 3 in 0.021 seconds
[0m14:51:53.911832 [debug] [MainThread]: On master: Close
[0m14:51:53.926011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:53.928524 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:53.932262 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.929595 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m14:51:53.935379 [debug] [MainThread]: On master: BEGIN
[0m14:51:53.937443 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:51:53.945331 [info ] [MainThread]: 
[0m14:51:53.948697 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m14:51:53.950911 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m14:51:53.954156 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.957427 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:53.960746 [debug] [MainThread]: On master: COMMIT
[0m14:51:53.953359 [debug] [MainThread]: Command end result
[0m14:51:53.965439 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:53.965547 [info ] [MainThread]: 
[0m14:51:53.974284 [debug] [MainThread]: On master: Close
[0m14:51:53.969096 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:53.978539 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:53.980762 [info ] [MainThread]: 
[0m14:51:53.981525 [info ] [MainThread]: 
[0m14:51:53.984159 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:53.999911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.28258, "process_user_time": 14.94341, "process_kernel_time": 0.861528, "process_mem_max_rss": "121316", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:51:54.005135 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:54.003825 after 12.29 seconds
[0m14:51:54.010899 [debug] [MainThread]: Flushing usage events
[0m14:51:54.023155 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m14:51:54.026922 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m14:51:54.036699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m14:51:54.042019 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m14:51:54.110641 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m14:51:54.125763 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:51:54.136813 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m14:51:54.141866 [info ] [MainThread]: 
[0m14:51:54.146246 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:54.151897 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:51:54.295246 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:51:54.296854 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m14:51:54.298521 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:51:54.301221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:54.319068 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m14:51:54.322795 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m14:51:54.324440 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.023 seconds
[0m14:51:54.325845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:54.329550 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:51:54.347706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m14:51:54.352620 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m14:51:54.352951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:51:54.358845 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m14:51:54.368342 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:51:54.358377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:51:54.397733 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m14:51:54.397420 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:54.400976 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m14:51:54.399008 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:54.401190 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:51:54.405208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:54.404464 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:51:54.407582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:54.411133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:54.435081 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m14:51:54.440238 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m14:51:54.445445 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:51:54.449764 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:51:54.453504 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:51:54.461188 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:51:54.473344 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m14:51:54.474858 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m14:51:54.484977 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m14:51:54.484480 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:51:54.490719 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m14:51:54.490360 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:51:54.494881 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m14:51:54.495070 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:51:54.498439 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:51:54.502073 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:51:54.538760 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m14:51:54.540715 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:54.544660 [debug] [MainThread]: On master: BEGIN
[0m14:51:54.547983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:54.561711 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m14:51:54.566724 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m14:51:54.571234 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m14:51:54.573780 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:51:54.577398 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:54.583716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:54.593943 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m14:51:54.600835 [debug] [MainThread]: SQL status: SELECT 4 in 0.011 seconds
[0m14:51:54.604036 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.57s]
[0m14:51:54.611318 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:54.610364 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m14:51:54.614665 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:54.617557 [debug] [MainThread]: On master: BEGIN
[0m14:51:54.617415 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:54.621420 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:51:54.620773 [debug] [MainThread]: On master: BEGIN
[0m14:51:54.627174 [debug] [MainThread]: On master: COMMIT
[0m14:51:54.628640 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:54.630931 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:54.634257 [debug] [MainThread]: On master: COMMIT
[0m14:51:54.640533 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:51:54.643981 [debug] [MainThread]: On master: Close
[0m14:51:54.647710 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:54.657933 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m14:51:54.652009 [info ] [MainThread]: 
[0m14:51:54.662661 [debug] [MainThread]: On master: COMMIT
[0m14:51:54.666040 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:54.671216 [debug] [MainThread]: On master: COMMIT
[0m14:51:54.675881 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:51:54.681172 [debug] [MainThread]: On master: Close
[0m14:51:54.684879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:54.689307 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m14:51:54.692453 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m14:51:54.692798 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:51:54.696629 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m14:51:54.701480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m14:51:54.696395 [info ] [MainThread]: 
[0m14:51:54.704687 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m14:51:54.704914 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m14:51:54.710590 [debug] [MainThread]: Command end result
[0m14:51:54.714891 [info ] [MainThread]: 
[0m14:51:54.727295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:54.730194 [info ] [MainThread]: 
[0m14:51:54.733425 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:54.739199 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.943772, "process_user_time": 15.174825, "process_kernel_time": 0.945215, "process_mem_max_rss": "119480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:51:54.743304 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:54.742804 after 12.95 seconds
[0m14:51:54.749091 [debug] [MainThread]: Flushing usage events
[0m14:51:54.757245 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m14:51:54.784331 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m14:51:54.964368 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m14:51:54.989007 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m14:51:54.992508 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m14:51:54.995796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:55.006551 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 1.269 seconds
[0m14:51:55.028961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m14:51:55.032997 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m14:51:55.041692 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m14:51:55.044941 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m14:51:55.048871 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:51:55.051618 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:51:55.054041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:55.083211 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m14:51:55.089115 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m14:51:55.095034 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:55.145327 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m14:51:55.148575 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m14:51:55.151453 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m14:51:55.166021 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m14:51:55.170762 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m14:51:55.173792 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m14:51:55.182686 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m14:51:55.184752 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m14:51:55.204065 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m14:51:55.204331 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m14:51:55.223020 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m14:51:55.223596 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m14:51:55.226585 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m14:51:55.226898 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m14:51:55.230986 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:51:55.231181 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:51:55.242424 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m14:51:55.242397 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m14:51:55.250910 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.55s]
[0m14:51:55.251103 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 2.01s]
[0m14:51:55.255213 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m14:51:55.255149 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m14:51:55.261213 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:55.261374 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:55.263849 [debug] [MainThread]: On master: BEGIN
[0m14:51:55.264012 [debug] [MainThread]: On master: BEGIN
[0m14:51:55.266371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:55.266432 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:55.282206 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m14:51:55.285470 [debug] [MainThread]: On master: COMMIT
[0m14:51:55.285457 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m14:51:55.289018 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:55.289314 [debug] [MainThread]: On master: COMMIT
[0m14:51:55.292069 [debug] [MainThread]: On master: COMMIT
[0m14:51:55.292717 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:55.295536 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:55.295513 [debug] [MainThread]: On master: COMMIT
[0m14:51:55.298967 [debug] [MainThread]: On master: Close
[0m14:51:55.299410 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:55.302978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:55.302547 [debug] [MainThread]: On master: Close
[0m14:51:55.305933 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:51:55.308923 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m14:51:55.309196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:55.313531 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:51:55.313506 [info ] [MainThread]: 
[0m14:51:55.316656 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m14:51:55.317035 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m14:51:55.319293 [info ] [MainThread]: 
[0m14:51:55.320731 [debug] [MainThread]: Command end result
[0m14:51:55.323113 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m14:51:55.323870 [info ] [MainThread]: 
[0m14:51:55.327953 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:55.328297 [debug] [MainThread]: Command end result
[0m14:51:55.331297 [info ] [MainThread]: 
[0m14:51:55.331253 [info ] [MainThread]: 
[0m14:51:55.334914 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:55.335331 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:55.338083 [info ] [MainThread]: 
[0m14:51:55.341067 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.4912, "process_user_time": 15.557215, "process_kernel_time": 0.862578, "process_mem_max_rss": "121396", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:51:55.341190 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:55.345613 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:55.345195 after 13.50 seconds
[0m14:51:55.348446 [debug] [MainThread]: Flushing usage events
[0m14:51:55.349797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.661712, "process_user_time": 14.954665, "process_kernel_time": 0.79305, "process_mem_max_rss": "121184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:51:55.359820 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:55.359412 after 13.68 seconds
[0m14:51:55.362975 [debug] [MainThread]: Flushing usage events
[0m14:52:04.772059 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:04.812474 | cdddfa88-6b25-4aad-8e4c-ed34e3696511 ==============================
[0m14:52:04.812474 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:04.824199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:52:04.821311 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:04.874637 | bcc5c468-5ee1-47cd-96c7-22af90420b91 ==============================
[0m14:52:04.874637 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:04.858605 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m14:52:04.883248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 14:52:04.887691 | b2deb7c5-4836-4d95-9867-b762ba5b218a ==============================
[0m14:52:04.887691 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:04.895308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:04.938080 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:04.973151 | ee55df1d-7a92-4de3-be23-759a1425c9a0 ==============================
[0m14:52:04.973151 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:04.978192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:05.095040 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:05.123073 | 699e5473-c19c-4faf-967c-7595c87f071f ==============================
[0m14:52:05.123073 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:05.143367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:52:05.247588 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:05.283808 | 27afbb5d-db6b-4b2a-a172-9101507be158 ==============================
[0m14:52:05.283808 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:05.287663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:52:05.437225 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:05.471007 | 82c10984-bcac-413f-947a-e8f5c6b36f08 ==============================
[0m14:52:05.471007 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:05.479917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:52:05.709138 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:05.732496 | 1634e34a-48a5-4aa2-8c9b-fe0d618aadb2 ==============================
[0m14:52:05.732496 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:05.738419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:06.185965 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:06.234630 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:06.318351 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:06.404850 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:06.452530 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:06.486150 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:06.528754 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:06.592885 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:06.838328 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:06.848190 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:06.838065 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:06.985457 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:07.070910 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:07.175385 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:07.480763 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:07.541801 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:07.568081 | 628a518e-1bdc-4adf-9e1f-4e85091e8356 ==============================
[0m14:52:07.568081 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:07.572134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:07.572459 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:07.595023 | 760aaebb-f481-41d3-9c56-a0ad3d10531d ==============================
[0m14:52:07.595023 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:07.602223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'send_anonymous_usage_stats': 'True'}
[0m14:52:07.613711 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:08.631964 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:08.728130 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:08.729637 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:08.824516 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:08.851291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:08.854168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:08.854816 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:08.857632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:09.090939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:09.094674 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:09.118062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:09.122170 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:09.156942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:09.160591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:09.325748 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:09.335001 [info ] [MainThread]: 
[0m14:52:09.343533 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:09.350418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:52:09.418256 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:09.432487 [info ] [MainThread]: 
[0m14:52:09.440573 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:52:09.467543 [debug] [MainThread]: Command end result
[0m14:52:09.472261 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.062008, "process_user_time": 9.00671, "process_kernel_time": 0.689791, "process_mem_max_rss": "101792", "process_in_blocks": "1432", "process_out_blocks": "0"}
[0m14:52:09.482185 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:09.481613 after 5.07 seconds
[0m14:52:09.485655 [debug] [MainThread]: Flushing usage events
[0m14:52:09.535417 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:52:09.539365 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:52:09.547774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:09.568966 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:09.574142 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.027 seconds
[0m14:52:09.582018 [info ] [MainThread]: 
[0m14:52:09.581340 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:52:09.586756 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:52:09.599794 [debug] [MainThread]: Command end result
[0m14:52:09.607210 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.1308427, "process_user_time": 8.758474, "process_kernel_time": 0.777202, "process_mem_max_rss": "101760", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:09.609269 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:09.612611 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:09.612202 after 5.14 seconds
[0m14:52:09.610775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:52:09.615979 [debug] [MainThread]: Flushing usage events
[0m14:52:09.620868 [info ] [MainThread]: 
[0m14:52:09.629314 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:52:09.613409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:52:09.642086 [debug] [MainThread]: Command end result
[0m14:52:09.643137 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:09.647319 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.301554, "process_user_time": 9.135451, "process_kernel_time": 0.694333, "process_mem_max_rss": "101800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:09.650179 [info ] [MainThread]: 
[0m14:52:09.651965 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:09.651485 after 5.31 seconds
[0m14:52:09.653304 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:52:09.655357 [debug] [MainThread]: Flushing usage events
[0m14:52:09.667243 [debug] [MainThread]: Command end result
[0m14:52:09.673684 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.033913, "process_user_time": 9.44737, "process_kernel_time": 0.630491, "process_mem_max_rss": "101848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:09.664702 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:52:09.681717 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:09.680560 after 5.04 seconds
[0m14:52:09.688153 [debug] [MainThread]: Flushing usage events
[0m14:52:09.684302 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:52:09.689549 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:52:09.694471 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:52:09.697534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:09.701366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:09.723708 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m14:52:09.733494 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:52:09.735117 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m14:52:09.737827 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:52:09.753087 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:52:09.759608 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:52:09.764511 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m14:52:09.776226 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:52:09.785056 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:52:09.777882 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m14:52:09.807352 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:52:09.811489 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:52:09.859391 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:09.865312 [debug] [MainThread]: On master: BEGIN
[0m14:52:09.876789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:09.903399 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m14:52:09.916446 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:09.926954 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:09.950465 [debug] [MainThread]: SQL status: SELECT 5 in 0.019 seconds
[0m14:52:09.956136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:09.961582 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:09.963230 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:09.966433 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:09.974556 [debug] [MainThread]: On master: BEGIN
[0m14:52:09.979126 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:52:09.990273 [debug] [MainThread]: On master: COMMIT
[0m14:52:09.996878 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:10.004912 [debug] [MainThread]: On master: COMMIT
[0m14:52:10.012877 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m14:52:10.017472 [debug] [MainThread]: On master: Close
[0m14:52:10.022808 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:10.026220 [info ] [MainThread]: 
[0m14:52:10.058097 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m14:52:10.061970 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m14:52:10.066124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_channels)
[0m14:52:10.072803 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m14:52:10.132615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:10.136263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:10.178615 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m14:52:10.272952 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m14:52:10.739061 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m14:52:10.778177 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:10.795306 [info ] [MainThread]: 
[0m14:52:10.802851 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:52:10.824089 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m14:52:10.841447 [debug] [MainThread]: Command end result
[0m14:52:10.885867 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m14:52:10.889527 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.9608655, "process_user_time": 8.842416, "process_kernel_time": 0.657947, "process_mem_max_rss": "102080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:10.889737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:10.893602 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:10.893127 after 5.96 seconds
[0m14:52:10.896477 [debug] [MainThread]: Flushing usage events
[0m14:52:10.924248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m14:52:10.928061 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m14:52:10.936097 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m14:52:10.945553 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:52:10.998367 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m14:52:11.014846 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m14:52:11.029167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:52:11.069029 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:11.089317 [info ] [MainThread]: 
[0m14:52:11.105182 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:11.112577 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:52:11.135092 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m14:52:11.142750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:11.143530 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m14:52:11.146407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:11.153542 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m14:52:11.164116 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:52:11.205872 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m14:52:11.229382 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m14:52:11.232404 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m14:52:11.236264 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:52:11.246297 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m14:52:11.256706 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 1.18s]
[0m14:52:11.261362 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m14:52:11.267353 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.270525 [debug] [MainThread]: On master: BEGIN
[0m14:52:11.273727 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:11.295701 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m14:52:11.298797 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:52:11.299148 [debug] [MainThread]: On master: COMMIT
[0m14:52:11.302108 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:52:11.302172 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.305588 [debug] [MainThread]: On master: COMMIT
[0m14:52:11.305599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:11.309488 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:52:11.312985 [debug] [MainThread]: On master: Close
[0m14:52:11.316719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:11.321498 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:52:11.324510 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m14:52:11.327681 [info ] [MainThread]: 
[0m14:52:11.330481 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m14:52:11.331040 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.025 seconds
[0m14:52:11.334244 [debug] [MainThread]: Command end result
[0m14:52:11.336592 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:52:11.336986 [info ] [MainThread]: 
[0m14:52:11.340877 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:11.343967 [info ] [MainThread]: 
[0m14:52:11.346866 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:11.350939 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.937301, "process_user_time": 10.213311, "process_kernel_time": 0.898531, "process_mem_max_rss": "114168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:11.354633 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:11.354163 after 6.94 seconds
[0m14:52:11.357396 [debug] [MainThread]: Flushing usage events
[0m14:52:11.360304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:52:11.362396 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:52:11.385143 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:52:11.393173 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:52:11.394776 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:52:11.396823 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:52:11.399099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:11.401922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:11.421778 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m14:52:11.425164 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m14:52:11.428520 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:52:11.431889 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:52:11.435769 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:52:11.440748 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:52:11.451936 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.007 seconds
[0m14:52:11.453358 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m14:52:11.466705 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:11.461714 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:52:11.468215 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:52:11.472535 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:52:11.475341 [info ] [MainThread]: 
[0m14:52:11.475927 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:52:11.483151 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:11.489111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:52:11.516251 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.519343 [debug] [MainThread]: On master: BEGIN
[0m14:52:11.522485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:11.546060 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m14:52:11.553417 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.562790 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:11.579764 [debug] [MainThread]: SQL status: SELECT 6 in 0.013 seconds
[0m14:52:11.593766 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:11.597687 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.600503 [debug] [MainThread]: On master: BEGIN
[0m14:52:11.607957 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:52:11.611933 [debug] [MainThread]: On master: COMMIT
[0m14:52:11.615026 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.618276 [debug] [MainThread]: On master: COMMIT
[0m14:52:11.622994 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:52:11.627614 [debug] [MainThread]: On master: Close
[0m14:52:11.630898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:11.633878 [info ] [MainThread]: 
[0m14:52:11.658281 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m14:52:11.662013 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m14:52:11.664123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:11.665462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m14:52:11.667365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:11.671608 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m14:52:11.674923 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:52:11.679298 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:52:11.682705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:11.713524 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m14:52:11.716697 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.034 seconds
[0m14:52:11.723366 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:52:11.747136 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m14:52:11.755145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:52:11.759214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:52:11.792003 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:52:11.795300 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:52:11.797317 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:52:11.800080 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:52:11.803114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:11.805796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:11.828565 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m14:52:11.835356 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m14:52:11.837487 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:52:11.841212 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:52:11.845339 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:52:11.848394 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:52:11.857108 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m14:52:11.860149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:11.862744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:11.859700 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m14:52:11.863945 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:52:11.869292 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:52:11.873567 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:52:11.876545 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:52:11.904761 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.906768 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m14:52:11.908825 [debug] [MainThread]: On master: BEGIN
[0m14:52:11.912883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:11.931097 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m14:52:11.930993 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m14:52:11.934404 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.934648 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m14:52:11.938421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:11.938423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:11.953637 [debug] [MainThread]: SQL status: SELECT 6 in 0.011 seconds
[0m14:52:11.959370 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m14:52:11.960770 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:11.963376 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m14:52:11.964159 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.966713 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m14:52:11.974556 [debug] [MainThread]: On master: BEGIN
[0m14:52:11.979657 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:52:11.980271 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:52:11.984757 [debug] [MainThread]: On master: COMMIT
[0m14:52:11.988555 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:11.992125 [debug] [MainThread]: On master: COMMIT
[0m14:52:11.995579 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:52:11.998161 [debug] [MainThread]: On master: Close
[0m14:52:12.000973 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:12.004616 [info ] [MainThread]: 
[0m14:52:12.008394 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m14:52:12.011480 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m14:52:12.015386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:52:12.021691 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:12.027610 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m14:52:12.029140 [info ] [MainThread]: 
[0m14:52:12.030849 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m14:52:12.031919 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:52:12.033869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_product)
[0m14:52:12.037313 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m14:52:12.041097 [debug] [MainThread]: Command end result
[0m14:52:12.045142 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.8510795, "process_user_time": 8.856224, "process_kernel_time": 0.572341, "process_mem_max_rss": "102056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:12.048605 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:12.048202 after 4.85 seconds
[0m14:52:12.051513 [debug] [MainThread]: Flushing usage events
[0m14:52:12.067484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m14:52:12.073309 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m14:52:12.076147 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m14:52:12.078867 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m14:52:12.085583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:52:12.089997 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m14:52:12.114446 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m14:52:12.134153 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m14:52:12.138240 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m14:52:12.143369 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:52:12.154006 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m14:52:12.164791 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.49s]
[0m14:52:12.165929 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:12.170567 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m14:52:12.173889 [info ] [MainThread]: 
[0m14:52:12.177213 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:52:12.177737 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:12.180960 [debug] [MainThread]: On master: BEGIN
[0m14:52:12.184274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:12.185539 [debug] [MainThread]: Command end result
[0m14:52:12.189606 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.0438094, "process_user_time": 8.659855, "process_kernel_time": 0.65771, "process_mem_max_rss": "101856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:12.194152 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:12.193770 after 5.05 seconds
[0m14:52:12.196671 [debug] [MainThread]: Flushing usage events
[0m14:52:12.208109 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m14:52:12.213910 [debug] [MainThread]: On master: COMMIT
[0m14:52:12.217803 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:12.222589 [debug] [MainThread]: On master: COMMIT
[0m14:52:12.227164 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:52:12.230969 [debug] [MainThread]: On master: Close
[0m14:52:12.240809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:12.246887 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m14:52:12.252440 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m14:52:12.254784 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:52:12.259190 [info ] [MainThread]: 
[0m14:52:12.265692 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m14:52:12.272531 [debug] [MainThread]: Command end result
[0m14:52:12.281587 [info ] [MainThread]: 
[0m14:52:12.293768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:12.297655 [info ] [MainThread]: 
[0m14:52:12.319277 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m14:52:12.330823 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:12.328861 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m14:52:12.335470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:12.336372 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.28817, "process_user_time": 10.94711, "process_kernel_time": 0.8483, "process_mem_max_rss": "112224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:12.342418 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:12.341957 after 7.29 seconds
[0m14:52:12.345780 [debug] [MainThread]: Flushing usage events
[0m14:52:12.357312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m14:52:12.361593 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m14:52:12.364717 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m14:52:12.378545 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:52:12.410753 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m14:52:12.414522 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m14:52:12.418926 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:52:12.471483 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m14:52:12.474283 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m14:52:12.476680 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m14:52:12.481886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:52:12.505253 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m14:52:12.522506 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m14:52:12.526482 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m14:52:12.529808 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:52:12.539113 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m14:52:12.548737 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.51s]
[0m14:52:12.553225 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m14:52:12.559717 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:12.562502 [debug] [MainThread]: On master: BEGIN
[0m14:52:12.565014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:12.579453 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m14:52:12.583314 [debug] [MainThread]: On master: COMMIT
[0m14:52:12.587857 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:12.591229 [debug] [MainThread]: On master: COMMIT
[0m14:52:12.594009 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:52:12.596842 [debug] [MainThread]: On master: Close
[0m14:52:12.600980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:12.604574 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m14:52:12.608027 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:52:12.611048 [info ] [MainThread]: 
[0m14:52:12.613961 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m14:52:12.619101 [debug] [MainThread]: Command end result
[0m14:52:12.622530 [info ] [MainThread]: 
[0m14:52:12.625272 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:12.628046 [info ] [MainThread]: 
[0m14:52:12.631040 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:12.636927 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.338427, "process_user_time": 9.339015, "process_kernel_time": 0.852649, "process_mem_max_rss": "110832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:12.641334 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:12.640602 after 7.34 seconds
[0m14:52:12.644594 [debug] [MainThread]: Flushing usage events
[0m14:52:18.656288 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:18.676722 | 793747fb-1ef4-4f9e-9f4c-fdfc191ec39c ==============================
[0m14:52:18.676722 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:18.682006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:18.740945 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:18.762991 | 35e8ded4-9877-41cd-b11f-d5e1fb94a32a ==============================
[0m14:52:18.762991 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:18.766891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m14:52:19.568582 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:19.656872 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:19.670114 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:19.784073 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:19.940642 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:19.955808 | 1c59f412-6d3d-486d-92fb-4e16c8f9cacc ==============================
[0m14:52:19.955808 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:19.958215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:52:19.955953 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:19.973075 | a2ec2426-054e-47db-be77-e2c5d298a6f2 ==============================
[0m14:52:19.973075 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:19.980518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:52:20.072515 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:20.097283 | e4c823e6-d9a9-46cc-9f2b-4995ad284668 ==============================
[0m14:52:20.097283 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:20.101924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:52:20.114674 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:20.131903 | 6f256bae-11ca-410b-b918-5f865a50b09f ==============================
[0m14:52:20.131903 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:20.136115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:20.708050 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:20.734927 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:20.806800 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:20.816660 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:20.826135 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:20.861113 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:20.921611 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:20.966497 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:21.597263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:21.599451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:21.626883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:21.630117 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:22.049429 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:22.051231 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:22.058385 [info ] [MainThread]: 
[0m14:52:22.062393 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:52:22.066746 [info ] [MainThread]: 
[0m14:52:22.071053 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:22.076417 [debug] [MainThread]: Command end result
[0m14:52:22.079243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:52:22.081500 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.664359, "process_user_time": 6.41058, "process_kernel_time": 0.258841, "process_mem_max_rss": "101900", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:22.087409 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:22.086197 after 3.67 seconds
[0m14:52:22.091982 [debug] [MainThread]: Flushing usage events
[0m14:52:22.312941 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:52:22.316719 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:52:22.319752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:22.356136 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.036 seconds
[0m14:52:22.364002 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:52:22.395935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:52:22.398323 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:52:22.460969 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:52:22.470465 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:52:22.474531 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:52:22.478679 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:52:22.483801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:22.487865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:22.515663 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m14:52:22.518362 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m14:52:22.522124 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:52:22.528439 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:52:22.532429 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:52:22.537265 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:52:22.554912 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m14:52:22.557417 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m14:52:22.563294 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:52:22.571679 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:52:22.580351 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:52:22.583892 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:52:22.629733 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:22.633146 [debug] [MainThread]: On master: BEGIN
[0m14:52:22.636472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:22.654215 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m14:52:22.657774 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:22.661856 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:22.676934 [debug] [MainThread]: SQL status: SELECT 9 in 0.011 seconds
[0m14:52:22.679787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:22.684105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:22.689443 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:22.690122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:22.696702 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:22.696498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:22.700056 [debug] [MainThread]: On master: BEGIN
[0m14:52:22.704155 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:52:22.709952 [debug] [MainThread]: On master: COMMIT
[0m14:52:22.713788 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:22.717708 [debug] [MainThread]: On master: COMMIT
[0m14:52:22.721652 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:52:22.726313 [debug] [MainThread]: On master: Close
[0m14:52:22.730931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:22.734475 [info ] [MainThread]: 
[0m14:52:22.764174 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m14:52:22.767576 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m14:52:22.770858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_channel)
[0m14:52:22.773602 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m14:52:22.826833 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m14:52:22.840660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:22.844293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:22.876393 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m14:52:23.000342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:23.003827 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:23.032684 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m14:52:23.037195 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:23.044891 [info ] [MainThread]: 
[0m14:52:23.048882 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:23.052857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:52:23.052756 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m14:52:23.055726 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m14:52:23.059467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:23.059792 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:23.067157 [info ] [MainThread]: 
[0m14:52:23.070639 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:52:23.079125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m14:52:23.080437 [debug] [MainThread]: Command end result
[0m14:52:23.086535 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m14:52:23.090437 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.378568, "process_user_time": 6.092067, "process_kernel_time": 0.289622, "process_mem_max_rss": "101892", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:23.090182 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m14:52:23.095511 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:23.095079 after 3.38 seconds
[0m14:52:23.098607 [debug] [MainThread]: Flushing usage events
[0m14:52:23.099927 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m14:52:23.157459 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m14:52:23.161245 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m14:52:23.165186 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:52:23.204394 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:23.211131 [info ] [MainThread]: 
[0m14:52:23.213926 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:52:23.218942 [debug] [MainThread]: Command end result
[0m14:52:23.222017 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:52:23.221848 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.3820531, "process_user_time": 6.113608, "process_kernel_time": 0.290646, "process_mem_max_rss": "101800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:23.223868 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m14:52:23.224723 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:52:23.225813 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:23.224926 after 3.39 seconds
[0m14:52:23.227365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:23.227426 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m14:52:23.228151 [debug] [MainThread]: Flushing usage events
[0m14:52:23.229853 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m14:52:23.234707 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:52:23.242569 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.015 seconds
[0m14:52:23.246656 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:52:23.257383 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m14:52:23.269639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:52:23.272557 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m14:52:23.275763 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m14:52:23.279176 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:52:23.286088 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m14:52:23.272341 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:52:23.292589 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 9[0m in 0.52s]
[0m14:52:23.295958 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m14:52:23.296846 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:23.291116 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:52:23.297736 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:52:23.300850 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:23.299593 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:52:23.302393 [info ] [MainThread]: 
[0m14:52:23.303227 [debug] [MainThread]: On master: BEGIN
[0m14:52:23.301724 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:52:23.305501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:23.305828 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:23.304173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:23.306211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:23.309602 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:52:23.320011 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:52:23.321945 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m14:52:23.322733 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m14:52:23.324908 [debug] [MainThread]: On master: COMMIT
[0m14:52:23.324830 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:52:23.327201 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:23.327162 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:52:23.329374 [debug] [MainThread]: On master: COMMIT
[0m14:52:23.329422 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:52:23.332303 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:52:23.331982 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:52:23.334963 [debug] [MainThread]: On master: Close
[0m14:52:23.338397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:23.340550 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m14:52:23.341941 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m14:52:23.344790 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:52:23.343365 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.007 seconds
[0m14:52:23.347041 [info ] [MainThread]: 
[0m14:52:23.349405 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m14:52:23.346858 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:52:23.352442 [debug] [MainThread]: Command end result
[0m14:52:23.351711 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:52:23.354530 [info ] [MainThread]: 
[0m14:52:23.354361 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:52:23.357460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:23.356701 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:52:23.360414 [info ] [MainThread]: 
[0m14:52:23.363220 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:23.367390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8560452, "process_user_time": 7.314814, "process_kernel_time": 0.386555, "process_mem_max_rss": "112296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:23.370947 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:23.370540 after 4.86 seconds
[0m14:52:23.373696 [debug] [MainThread]: Flushing usage events
[0m14:52:23.381624 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:23.383625 [debug] [MainThread]: On master: BEGIN
[0m14:52:23.385445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:23.400753 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m14:52:23.403683 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:23.407221 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:23.420421 [debug] [MainThread]: SQL status: SELECT 9 in 0.009 seconds
[0m14:52:23.425800 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:52:23.429517 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:52:23.430688 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:23.433824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:23.434965 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:23.437682 [debug] [MainThread]: On master: BEGIN
[0m14:52:23.444375 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:52:23.448130 [debug] [MainThread]: On master: COMMIT
[0m14:52:23.453081 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:23.464362 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.030 seconds
[0m14:52:23.462849 [debug] [MainThread]: On master: COMMIT
[0m14:52:23.476754 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:52:23.474521 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:52:23.485925 [debug] [MainThread]: On master: Close
[0m14:52:23.495677 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:23.500326 [info ] [MainThread]: 
[0m14:52:23.512982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:52:23.532620 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m14:52:23.536756 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m14:52:23.516375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:52:23.541300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m14:52:23.545604 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m14:52:23.568309 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:52:23.583024 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:52:23.585748 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:52:23.592863 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:52:23.596863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m14:52:23.596652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:23.599654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:23.625086 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m14:52:23.701454 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:52:23.708295 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m14:52:23.709065 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:52:23.627825 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m14:52:23.718781 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m14:52:23.722524 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:52:23.733574 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:52:23.729654 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:52:23.740618 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:52:23.743965 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.008 seconds
[0m14:52:23.751066 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:52:23.754028 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:52:23.779680 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:23.782450 [debug] [MainThread]: On master: BEGIN
[0m14:52:23.784866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:23.801260 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m14:52:23.804279 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:23.808548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:23.827712 [debug] [MainThread]: SQL status: SELECT 9 in 0.016 seconds
[0m14:52:23.839713 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:23.843454 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:23.847752 [debug] [MainThread]: On master: BEGIN
[0m14:52:23.852189 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:52:23.855811 [debug] [MainThread]: On master: COMMIT
[0m14:52:23.859484 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:23.862754 [debug] [MainThread]: On master: COMMIT
[0m14:52:23.866948 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:52:23.870478 [debug] [MainThread]: On master: Close
[0m14:52:23.874915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:23.878380 [info ] [MainThread]: 
[0m14:52:23.884594 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m14:52:23.907083 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m14:52:23.911045 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m14:52:23.914794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_product)
[0m14:52:23.917103 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m14:52:23.940259 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m14:52:23.977475 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m14:52:23.977501 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m14:52:23.980944 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m14:52:23.984113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:24.001614 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m14:52:24.005170 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m14:52:24.008785 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT
     -- fill code here 
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m14:52:24.013059 [debug] [Thread-1 (]: Postgres adapter: Postgres error: each UNION query must have the same number of columns
LINE 21:     0 AS sales_agent_key,
             ^

[0m14:52:24.016782 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: ROLLBACK
[0m14:52:24.022227 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m14:52:24.038116 [debug] [Thread-1 (]: Database Error in model dim_salesagent (models/dim/dim_salesagent.sql)
  each UNION query must have the same number of columns
  LINE 21:     0 AS sales_agent_key,
               ^
  compiled code at target/run/dbtcomp/models/dim/dim_salesagent.sql
[0m14:52:24.048845 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.dim_salesagent ....................... [[31mERROR[0m in 0.50s]
[0m14:52:24.053111 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m14:52:24.063672 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:24.066111 [debug] [MainThread]: On master: BEGIN
[0m14:52:24.068776 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:24.085789 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m14:52:24.089473 [debug] [MainThread]: On master: COMMIT
[0m14:52:24.093794 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:24.096865 [debug] [MainThread]: On master: COMMIT
[0m14:52:24.099722 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:52:24.102586 [debug] [MainThread]: On master: Close
[0m14:52:24.106187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:24.109332 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m14:52:24.112558 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:52:24.116119 [info ] [MainThread]: 
[0m14:52:24.118666 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m14:52:24.122363 [debug] [MainThread]: Command end result
[0m14:52:24.125539 [info ] [MainThread]: 
[0m14:52:24.128128 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:52:24.130309 [info ] [MainThread]: 
[0m14:52:24.132800 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m14:52:24.133094 [error] [MainThread]:   Database Error in model dim_salesagent (models/dim/dim_salesagent.sql)
  each UNION query must have the same number of columns
  LINE 21:     0 AS sales_agent_key,
               ^
  compiled code at target/run/dbtcomp/models/dim/dim_salesagent.sql
[0m14:52:24.135787 [info ] [MainThread]: 
[0m14:52:24.138936 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:52:24.143997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.424754, "process_user_time": 6.638795, "process_kernel_time": 0.439258, "process_mem_max_rss": "110924", "process_in_blocks": "472", "command_success": false, "process_out_blocks": "0"}
[0m14:52:24.147465 [debug] [MainThread]: Command `dbt run` failed at 14:52:24.147095 after 4.43 seconds
[0m14:52:24.149990 [debug] [MainThread]: Flushing usage events
[0m14:52:24.153215 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m14:52:24.156011 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m14:52:24.158897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:24.175880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m14:52:24.178839 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m14:52:24.181917 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select product_id, product_name, product_price
-- fill code here 


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m14:52:24.218232 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.034 seconds
[0m14:52:24.245491 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m14:52:24.247987 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m14:52:24.250513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:52:24.299512 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m14:52:24.301954 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m14:52:24.304156 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m14:52:24.310870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:52:24.328776 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m14:52:24.340542 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m14:52:24.343218 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m14:52:24.346559 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:52:24.352729 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m14:52:24.359058 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.44s]
[0m14:52:24.361955 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m14:52:24.366118 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:24.368143 [debug] [MainThread]: On master: BEGIN
[0m14:52:24.370382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:24.386317 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m14:52:24.390324 [debug] [MainThread]: On master: COMMIT
[0m14:52:24.393838 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:24.397144 [debug] [MainThread]: On master: COMMIT
[0m14:52:24.400815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:52:24.404218 [debug] [MainThread]: On master: Close
[0m14:52:24.408105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:24.411628 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:52:24.413967 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m14:52:24.416708 [info ] [MainThread]: 
[0m14:52:24.419405 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m14:52:24.423641 [debug] [MainThread]: Command end result
[0m14:52:24.425969 [info ] [MainThread]: 
[0m14:52:24.428156 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:24.430285 [info ] [MainThread]: 
[0m14:52:24.433088 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:24.435855 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5585737, "process_user_time": 6.817368, "process_kernel_time": 0.345308, "process_mem_max_rss": "114292", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:24.438464 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:24.438156 after 4.56 seconds
[0m14:52:24.440436 [debug] [MainThread]: Flushing usage events
[0m14:52:28.700570 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:28.710423 | 130a3ceb-bc20-4fef-8d37-e89b79803042 ==============================
[0m14:52:28.710423 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:28.712893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:52:29.137144 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:52:29.147450 | f2567d24-f754-4501-a0f4-525c0df58c23 ==============================
[0m14:52:29.147450 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:52:29.150542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:52:29.212700 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:29.303823 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:29.832237 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:29.901953 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:52:31.331981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:31.334146 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:31.514836 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:31.518581 [info ] [MainThread]: 
[0m14:52:31.520445 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:52:31.526195 [debug] [MainThread]: Command end result
[0m14:52:31.528993 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9570863, "process_user_time": 4.004689, "process_kernel_time": 0.209797, "process_mem_max_rss": "102124", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:31.531706 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:31.531436 after 2.96 seconds
[0m14:52:31.533497 [debug] [MainThread]: Flushing usage events
[0m14:52:31.794808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:31.797300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:31.996443 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:52:32.000737 [info ] [MainThread]: 
[0m14:52:32.002653 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:52:32.008372 [debug] [MainThread]: Command end result
[0m14:52:32.011190 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9952936, "process_user_time": 4.06672, "process_kernel_time": 0.249186, "process_mem_max_rss": "101780", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:32.013216 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:32.012986 after 3.00 seconds
[0m14:52:32.015002 [debug] [MainThread]: Flushing usage events
[0m15:22:03.424048 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m15:22:03.424552 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m15:22:03.430814 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m15:22:03.422516 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:03.472367 | 97e7e21a-9517-4fd5-ad17-bc48697da3d4 ==============================
[0m15:22:03.472367 [info ] [MainThread]: Running with dbt=1.8.2


============================== 15:22:03.474204 | 29e6e0d8-57ed-4533-b5c3-31b410e70baf ==============================
[0m15:22:03.474204 [info ] [MainThread]: Running with dbt=1.8.2


============================== 15:22:03.474682 | ecb6fc67-bbd9-4d22-a1c2-5228a2c8f635 ==============================
[0m15:22:03.474682 [info ] [MainThread]: Running with dbt=1.8.2


============================== 15:22:03.474547 | e5fae30e-6e67-414b-a5cb-0d93cc173bc9 ==============================
[0m15:22:03.474547 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:03.479683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:03.479963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:22:03.483544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'send_anonymous_usage_stats': 'True'}
[0m15:22:03.483066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:22:03.471351 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m15:22:03.471271 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:03.500036 | 4ebbf969-93f0-4e29-9fa0-697f52aacd37 ==============================
[0m15:22:03.500036 [info ] [MainThread]: Running with dbt=1.8.2


============================== 15:22:03.505383 | fe14e447-f908-41db-b6f0-a34f2b766ea9 ==============================
[0m15:22:03.505383 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:03.505978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:03.509843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'send_anonymous_usage_stats': 'True'}
[0m15:22:03.534995 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:03.557439 | f23e7b4d-7806-45f0-8db7-1467fd44c24a ==============================
[0m15:22:03.557439 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:03.561079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:22:04.295502 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:04.301698 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:04.304257 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:04.305404 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:04.315809 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:04.364610 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:04.403578 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:04.414785 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:04.414646 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:04.453453 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:04.461932 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:04.480858 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:04.836658 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:04.869126 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:06.416168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:22:06.421567 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_product.sql
[0m15:22:06.421863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:22:06.422367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:22:06.421757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:22:06.425636 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_geography.sql
[0m15:22:06.426309 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_product.sql
[0m15:22:06.428572 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_salesagent.sql
[0m15:22:06.429712 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_salesagent.sql
[0m15:22:06.428020 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_product.sql
[0m15:22:06.436723 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_geography.sql
[0m15:22:06.436501 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_salesagent.sql
[0m15:22:06.439676 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_salesagent.sql
[0m15:22:06.440960 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_geography.sql
[0m15:22:06.440927 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_product.sql
[0m15:22:06.449717 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_geography.sql
[0m15:22:06.457208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:22:06.469140 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_geography.sql
[0m15:22:06.478392 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_product.sql
[0m15:22:06.484235 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_salesagent.sql
[0m15:22:06.719254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:22:06.723589 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_salesagent.sql
[0m15:22:06.727296 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_geography.sql
[0m15:22:06.733109 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_product.sql
[0m15:22:07.009270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:22:07.013505 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_geography.sql
[0m15:22:07.017484 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_product.sql
[0m15:22:07.020886 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_salesagent.sql
[0m15:22:07.735877 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:07.743361 [info ] [MainThread]: 
[0m15:22:07.745704 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:07.748281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:07.753459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:07.754093 [info ] [MainThread]: 
[0m15:22:07.757435 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:07.762641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:07.767275 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:07.768311 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:07.775817 [info ] [MainThread]: 
[0m15:22:07.776981 [info ] [MainThread]: 
[0m15:22:07.780735 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:07.786290 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:07.787924 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:07.794829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:07.853916 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:07.864788 [info ] [MainThread]: 
[0m15:22:07.868282 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:07.872559 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:07.990898 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:08.000685 [info ] [MainThread]: 
[0m15:22:08.004871 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:08.009998 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:08.045355 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:08.048894 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:08.051815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.067517 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:08.068198 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:08.070630 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:08.071268 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:08.071541 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:08.073838 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:08.074865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.074671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.077907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.084710 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.033 seconds
[0m15:22:08.091021 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:08.104703 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.030 seconds
[0m15:22:08.104880 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.027 seconds
[0m15:22:08.106876 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.032 seconds
[0m15:22:08.110721 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:08.110718 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:08.117016 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:08.122535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m15:22:08.140315 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:08.146251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m15:22:08.146342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m15:22:08.147936 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:08.155386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m15:22:08.155238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.125744 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m15:22:08.179237 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:08.149091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m15:22:08.150172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m15:22:08.191053 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.037 seconds
[0m15:22:08.157279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m15:22:08.192668 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:08.189908 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:08.165113 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:08.201348 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:08.209104 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:08.217977 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:08.226104 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:08.221769 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:08.228274 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:08.231535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:08.228134 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:08.233293 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:08.217593 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:08.219137 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:08.239969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:08.234149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.246209 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:08.237441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:08.242127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:08.252743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.228296 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:08.276206 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m15:22:08.270717 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:08.199775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.275864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m15:22:08.283921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.282504 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:08.289718 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m15:22:08.302544 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:08.297372 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m15:22:08.301965 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m15:22:08.317852 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:08.318091 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m15:22:08.293975 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m15:22:08.304955 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:08.321395 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:08.321482 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:08.317868 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:08.333347 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:08.322985 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:08.335835 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:08.323500 [debug] [ThreadPool]: SQL status: BEGIN in 0.125 seconds
[0m15:22:08.336583 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:08.332757 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:08.328687 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m15:22:08.340940 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:08.281833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m15:22:08.343668 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:22:08.359570 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:08.361623 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.023 seconds
[0m15:22:08.361222 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:08.344365 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.008 seconds
[0m15:22:08.366083 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:08.362939 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:22:08.352202 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.012 seconds
[0m15:22:08.346137 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m15:22:08.359469 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:08.384436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.365304 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:08.381738 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.018 seconds
[0m15:22:08.358940 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:08.374426 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:08.389473 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:08.371899 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:08.392895 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:08.387523 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:08.403508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:08.398126 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:08.385512 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:08.388395 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:08.402862 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:08.399918 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:08.402108 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:08.400995 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:08.398086 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:08.424484 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:08.429491 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.045 seconds
[0m15:22:08.411792 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:08.446607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.449828 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:08.424268 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:08.454967 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m15:22:08.460545 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:08.448216 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:08.476211 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.018 seconds
[0m15:22:08.467573 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:08.473106 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.482149 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:08.473827 [info ] [MainThread]: 
[0m15:22:08.484886 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:08.496653 [debug] [MainThread]: On master: BEGIN
[0m15:22:08.498243 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:08.499064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:08.497132 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.012 seconds
[0m15:22:08.497811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:08.504008 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.518605 [debug] [MainThread]: On master: BEGIN
[0m15:22:08.519358 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:08.521282 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:08.523627 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.518389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m15:22:08.521558 [debug] [ThreadPool]: SQL status: BEGIN in 0.075 seconds
[0m15:22:08.527120 [debug] [MainThread]: On master: BEGIN
[0m15:22:08.524729 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:08.532119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:08.524855 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:08.530084 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m15:22:08.541117 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.531581 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:08.520621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m15:22:08.545472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:08.546669 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m15:22:08.552710 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.550595 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:08.556253 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:08.561522 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m15:22:08.566109 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.566124 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.567025 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:22:08.569328 [debug] [MainThread]: SQL status: SELECT 9 in 0.018 seconds
[0m15:22:08.569439 [debug] [MainThread]: On master: BEGIN
[0m15:22:08.570298 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:08.572492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:08.574006 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:08.578378 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:08.579192 [debug] [MainThread]: SQL status: SELECT 9 in 0.014 seconds
[0m15:22:08.583148 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:08.584034 [debug] [MainThread]: SQL status: SELECT 9 in 0.010 seconds
[0m15:22:08.586529 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.590670 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:08.591133 [debug] [MainThread]: On master: BEGIN
[0m15:22:08.587672 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:08.594749 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.595806 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:08.595035 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:08.597581 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:22:08.597816 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m15:22:08.598091 [debug] [MainThread]: On master: BEGIN
[0m15:22:08.600970 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.597292 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:08.601476 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.601220 [debug] [MainThread]: On master: COMMIT
[0m15:22:08.603182 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:22:08.604634 [debug] [MainThread]: On master: BEGIN
[0m15:22:08.601152 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:08.606702 [debug] [MainThread]: On master: COMMIT
[0m15:22:08.606078 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:08.605422 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.610528 [debug] [MainThread]: On master: COMMIT
[0m15:22:08.604991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:08.613645 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:22:08.613998 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.615779 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:08.609291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.610242 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.617429 [debug] [MainThread]: On master: COMMIT
[0m15:22:08.618293 [debug] [MainThread]: On master: BEGIN
[0m15:22:08.619242 [debug] [MainThread]: On master: Close
[0m15:22:08.619379 [debug] [MainThread]: On master: COMMIT
[0m15:22:08.620488 [debug] [MainThread]: SQL status: SELECT 9 in 0.010 seconds
[0m15:22:08.621385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:08.620533 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.623259 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:08.623486 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:08.627549 [debug] [MainThread]: On master: Close
[0m15:22:08.628033 [debug] [MainThread]: On master: COMMIT
[0m15:22:08.640009 [info ] [MainThread]: 
[0m15:22:08.638853 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:08.643403 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m15:22:08.643248 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:08.645452 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:22:08.650130 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:08.652561 [info ] [MainThread]: 
[0m15:22:08.653762 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.654509 [debug] [MainThread]: On master: Close
[0m15:22:08.654008 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m15:22:08.660465 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m15:22:08.661784 [debug] [MainThread]: On master: BEGIN
[0m15:22:08.664602 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:08.664910 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.665519 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:08.668600 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:22:08.671342 [info ] [MainThread]: 
[0m15:22:08.658526 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:08.669921 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:08.672022 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:08.676695 [debug] [MainThread]: On master: COMMIT
[0m15:22:08.677711 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m15:22:08.684767 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:22:08.683175 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m15:22:08.686291 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.688668 [debug] [MainThread]: SQL status: SELECT 9 in 0.011 seconds
[0m15:22:08.691907 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:08.691421 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m15:22:08.694193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_geography)
[0m15:22:08.694533 [debug] [MainThread]: On master: COMMIT
[0m15:22:08.693337 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.013 seconds
[0m15:22:08.698551 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m15:22:08.699238 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:08.702226 [debug] [MainThread]: On master: Close
[0m15:22:08.702328 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m15:22:08.703038 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:08.703318 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:08.696704 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:08.705495 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:08.707630 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m15:22:08.708197 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:08.710117 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.713193 [info ] [MainThread]: 
[0m15:22:08.715987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m15:22:08.716674 [debug] [MainThread]: On master: BEGIN
[0m15:22:08.707593 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m15:22:08.720550 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:22:08.719107 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m15:22:08.720423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_products)
[0m15:22:08.727813 [debug] [MainThread]: On master: COMMIT
[0m15:22:08.728825 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m15:22:08.732560 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.736090 [debug] [MainThread]: On master: COMMIT
[0m15:22:08.740057 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:08.742246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m15:22:08.743780 [debug] [MainThread]: On master: Close
[0m15:22:08.748787 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m15:22:08.747899 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:08.752522 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.752739 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m15:22:08.752707 [info ] [MainThread]: 
[0m15:22:08.756291 [debug] [MainThread]: On master: BEGIN
[0m15:22:08.759618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:08.759093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m15:22:08.763166 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m15:22:08.762821 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m15:22:08.763407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m15:22:08.766160 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m15:22:08.777309 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m15:22:08.778815 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m15:22:08.780657 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m15:22:08.781480 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m15:22:08.781847 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.785086 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m15:22:08.785323 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:08.789996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m15:22:08.794830 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m15:22:08.798469 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m15:22:08.801765 [debug] [MainThread]: SQL status: SELECT 9 in 0.010 seconds
[0m15:22:08.813809 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:08.816736 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.819258 [debug] [MainThread]: On master: BEGIN
[0m15:22:08.822627 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:22:08.822037 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m15:22:08.827447 [debug] [MainThread]: On master: COMMIT
[0m15:22:08.831274 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:08.832529 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m15:22:08.834442 [debug] [MainThread]: On master: COMMIT
[0m15:22:08.837557 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:08.842944 [debug] [MainThread]: On master: Close
[0m15:22:08.856288 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:08.860784 [info ] [MainThread]: 
[0m15:22:08.861686 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:08.864766 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:08.880352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.886532 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m15:22:08.888452 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m15:22:08.894556 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m15:22:08.898515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_date)
[0m15:22:08.901950 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m15:22:08.915943 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.036 seconds
[0m15:22:08.921589 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:08.938250 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m15:22:08.952337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m15:22:08.956973 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m15:22:08.958780 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m15:22:08.965535 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m15:22:08.966095 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m15:22:08.956123 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m15:22:08.975207 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m15:22:08.975441 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m15:22:08.977241 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m15:22:08.978495 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m15:22:08.978683 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m15:22:08.980077 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m15:22:08.981072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:08.981260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:08.982950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:08.996950 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m15:22:08.993164 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:09.004094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m15:22:09.003629 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:09.008886 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m15:22:09.011052 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m15:22:09.008961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m15:22:09.006613 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:09.012459 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m15:22:09.014563 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT id AS geographykey, id AS original_id , cityname, countryname, regionname
       -- fill code here 
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m15:22:09.014694 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m15:22:09.011701 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:09.016452 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m15:22:09.018432 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m15:22:09.014826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:09.018085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:09.025071 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:22:09.025643 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.008 seconds
[0m15:22:09.026972 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:22:09.029001 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m15:22:09.032153 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m15:22:09.035277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:09.046529 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m15:22:09.047987 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m15:22:09.050944 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:09.054920 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m15:22:09.055090 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m15:22:09.053820 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:09.058166 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions" rename to "src_transactions__dbt_backup"
[0m15:22:09.058183 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography" rename to "dim_geography__dbt_backup"
[0m15:22:09.060485 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m15:22:09.057571 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:09.062699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:09.063065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:09.063120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m15:22:09.060894 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:09.063974 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m15:22:09.065873 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products" rename to "src_products__dbt_backup"
[0m15:22:09.067797 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m15:22:09.069796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:09.070542 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m15:22:09.072329 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m15:22:09.077526 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:09.078453 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m15:22:09.078565 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m15:22:09.080382 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:09.081390 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m15:22:09.081535 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m15:22:09.083531 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m15:22:09.084542 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m15:22:09.081513 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.014 seconds
[0m15:22:09.085529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:09.085748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:09.086379 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m15:22:09.086753 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m15:22:09.089899 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m15:22:09.090395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:09.090244 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:09.093350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:09.094386 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:09.109510 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m15:22:09.113507 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels" rename to "src_channels__dbt_backup"
[0m15:22:09.112944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m15:22:09.116705 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m15:22:09.117385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:09.119972 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m15:22:09.124205 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.126412 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:22:09.127147 [debug] [MainThread]: On master: BEGIN
[0m15:22:09.129704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:09.132497 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m15:22:09.135298 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m15:22:09.139249 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:09.140196 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m15:22:09.147216 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m15:22:09.148995 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m15:22:09.150215 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.150832 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m15:22:09.152057 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m15:22:09.154127 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers" rename to "src_resellers__dbt_backup"
[0m15:22:09.153999 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m15:22:09.154828 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m15:22:09.154240 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:09.158980 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m15:22:09.159044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:09.161679 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m15:22:09.162015 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m15:22:09.162349 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:22:09.162717 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m15:22:09.164805 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m15:22:09.165452 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m15:22:09.167453 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m15:22:09.167259 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:22:09.167870 [debug] [MainThread]: SQL status: SELECT 10 in 0.007 seconds
[0m15:22:09.168281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:09.171555 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m15:22:09.173090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:22:09.175001 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m15:22:09.178078 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:09.178612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:09.180925 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.183831 [debug] [MainThread]: On master: BEGIN
[0m15:22:09.185983 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m15:22:09.186973 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:22:09.187434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m15:22:09.191019 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.191856 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m15:22:09.193120 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m15:22:09.194626 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.196718 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m15:22:09.197827 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.200396 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m15:22:09.201165 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m15:22:09.212045 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m15:22:09.213010 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m15:22:09.207491 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:09.217401 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m15:22:09.217427 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m15:22:09.221012 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m15:22:09.222784 [debug] [MainThread]: On master: Close
[0m15:22:09.227055 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m15:22:09.227158 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:22:09.231402 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m15:22:09.229505 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:09.235174 [info ] [MainThread]: 
[0m15:22:09.235576 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.012 seconds
[0m15:22:09.238977 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m15:22:09.236418 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m15:22:09.250265 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m15:22:09.250453 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:22:09.250899 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m15:22:09.262774 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m15:22:09.266140 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.54s]
[0m15:22:09.267310 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m15:22:09.265503 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.54s]
[0m15:22:09.271864 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m15:22:09.270494 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m15:22:09.271661 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m15:22:09.266745 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m15:22:09.275758 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m15:22:09.278618 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.278105 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 0.58s]
[0m15:22:09.278125 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m15:22:09.279600 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.279675 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m15:22:09.281706 [debug] [MainThread]: On master: BEGIN
[0m15:22:09.282414 [debug] [MainThread]: On master: BEGIN
[0m15:22:09.282469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m15:22:09.283308 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m15:22:09.285002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:09.285400 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:09.285692 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m15:22:09.285976 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:22:09.289687 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.293641 [debug] [MainThread]: On master: BEGIN
[0m15:22:09.293959 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m15:22:09.297408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:09.298101 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m15:22:09.308493 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m15:22:09.307981 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m15:22:09.315013 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.316942 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m15:22:09.318184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m15:22:09.320588 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.321050 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.325122 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.326168 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m15:22:09.325309 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m15:22:09.324259 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.327195 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m15:22:09.329782 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.330954 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:09.331221 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.333184 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:09.334233 [debug] [MainThread]: On master: Close
[0m15:22:09.334395 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.336318 [debug] [MainThread]: On master: Close
[0m15:22:09.337750 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.337698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:09.338762 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.57s]
[0m15:22:09.342404 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m15:22:09.342517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:09.344825 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m15:22:09.345214 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m15:22:09.345833 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m15:22:09.346967 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m15:22:09.347878 [debug] [MainThread]: On master: Close
[0m15:22:09.350248 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m15:22:09.349194 [info ] [MainThread]: 
[0m15:22:09.351669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:09.353069 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.353804 [info ] [MainThread]: 
[0m15:22:09.354866 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m15:22:09.353940 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m15:22:09.356050 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m15:22:09.356755 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m15:22:09.359213 [debug] [MainThread]: On master: BEGIN
[0m15:22:09.359650 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m15:22:09.362469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:09.362373 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m15:22:09.365625 [debug] [MainThread]: Command end result
[0m15:22:09.362126 [debug] [MainThread]: Command end result
[0m15:22:09.361530 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m15:22:09.369532 [info ] [MainThread]: 
[0m15:22:09.378290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:09.376625 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m15:22:09.373578 [info ] [MainThread]: 
[0m15:22:09.383048 [info ] [MainThread]: 
[0m15:22:09.372395 [info ] [MainThread]: 
[0m15:22:09.385945 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:09.385794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:09.386950 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m15:22:09.391030 [info ] [MainThread]: 
[0m15:22:09.391998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.2361116, "process_user_time": 8.252638, "process_kernel_time": 0.657025, "process_mem_max_rss": "114616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:09.392692 [debug] [MainThread]: Command end result
[0m15:22:09.393474 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m15:22:09.394382 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:09.395237 [info ] [MainThread]: 
[0m15:22:09.395819 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:09.395304 after 6.24 seconds
[0m15:22:09.399128 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m15:22:09.398095 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.2804585, "process_user_time": 8.201168, "process_kernel_time": 0.696701, "process_mem_max_rss": "114208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:09.398400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:09.398916 [debug] [MainThread]: Flushing usage events
[0m15:22:09.401993 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.403105 [info ] [MainThread]: 
[0m15:22:09.403237 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:09.402792 after 6.29 seconds
[0m15:22:09.403174 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.61s]
[0m15:22:09.407397 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:09.407224 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.407969 [debug] [MainThread]: Flushing usage events
[0m15:22:09.409415 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m15:22:09.410551 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.411785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.2564573, "process_user_time": 8.408417, "process_kernel_time": 0.439917, "process_mem_max_rss": "114032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:09.414679 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:09.415409 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.415599 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:09.415097 after 6.26 seconds
[0m15:22:09.417763 [debug] [MainThread]: On master: Close
[0m15:22:09.418342 [debug] [MainThread]: On master: BEGIN
[0m15:22:09.418562 [debug] [MainThread]: Flushing usage events
[0m15:22:09.421111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:09.421577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:09.424851 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m15:22:09.428590 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m15:22:09.431679 [info ] [MainThread]: 
[0m15:22:09.435325 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.67 seconds (1.67s).
[0m15:22:09.439926 [debug] [MainThread]: Command end result
[0m15:22:09.442290 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m15:22:09.445225 [info ] [MainThread]: 
[0m15:22:09.446975 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.450454 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:09.450567 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.459194 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.455094 [info ] [MainThread]: 
[0m15:22:09.464116 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:22:09.463699 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:09.467521 [debug] [MainThread]: On master: Close
[0m15:22:09.468918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.334026, "process_user_time": 8.277167, "process_kernel_time": 0.59544, "process_mem_max_rss": "114508", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:09.471504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:09.476829 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:09.475320 after 6.34 seconds
[0m15:22:09.479390 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m15:22:09.482858 [debug] [MainThread]: Flushing usage events
[0m15:22:09.483259 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m15:22:09.486400 [info ] [MainThread]: 
[0m15:22:09.490865 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m15:22:09.496365 [debug] [MainThread]: Command end result
[0m15:22:09.499050 [info ] [MainThread]: 
[0m15:22:09.502643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:09.508363 [info ] [MainThread]: 
[0m15:22:09.513241 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:09.519270 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3286767, "process_user_time": 8.376935, "process_kernel_time": 0.576349, "process_mem_max_rss": "114648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:09.527218 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:09.526426 after 6.34 seconds
[0m15:22:09.560209 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m15:22:09.563507 [debug] [MainThread]: Flushing usage events
[0m15:22:09.653144 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m15:22:09.660568 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m15:22:09.665359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:09.687929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m15:22:09.694042 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m15:22:09.698710 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m15:22:09.705913 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:22:09.736760 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m15:22:09.743202 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers" rename to "src_customers__dbt_backup"
[0m15:22:09.748058 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:09.768034 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m15:22:09.772935 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m15:22:09.781481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:09.860497 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m15:22:09.863656 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m15:22:09.866463 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m15:22:09.874601 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:22:09.899343 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m15:22:09.917546 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m15:22:09.921945 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m15:22:09.934199 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m15:22:09.950931 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m15:22:09.961369 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.67s]
[0m15:22:09.966266 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m15:22:09.974996 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.979810 [debug] [MainThread]: On master: BEGIN
[0m15:22:09.984185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:10.020899 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m15:22:10.035986 [debug] [MainThread]: On master: COMMIT
[0m15:22:10.040380 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:10.044247 [debug] [MainThread]: On master: COMMIT
[0m15:22:10.048313 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:22:10.053694 [debug] [MainThread]: On master: Close
[0m15:22:10.061195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:10.065343 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m15:22:10.070426 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m15:22:10.073730 [info ] [MainThread]: 
[0m15:22:10.078235 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m15:22:10.086396 [debug] [MainThread]: Command end result
[0m15:22:10.091378 [info ] [MainThread]: 
[0m15:22:10.096271 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:10.100448 [info ] [MainThread]: 
[0m15:22:10.110236 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:10.117966 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.885926, "process_user_time": 8.280074, "process_kernel_time": 0.520574, "process_mem_max_rss": "114728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:10.121769 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:10.121271 after 6.89 seconds
[0m15:22:10.129528 [debug] [MainThread]: Flushing usage events
[0m15:22:10.473754 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 1.273 seconds
[0m15:22:10.500351 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m15:22:10.505273 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date" rename to "dim_date__dbt_backup"
[0m15:22:10.509881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:10.525020 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m15:22:10.530652 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m15:22:10.534381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:10.612571 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m15:22:10.614922 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m15:22:10.616888 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m15:22:10.630360 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m15:22:10.649309 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m15:22:10.662282 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m15:22:10.664649 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m15:22:10.673342 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:22:10.682324 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m15:22:10.690711 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 1.79s]
[0m15:22:10.696040 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m15:22:10.700464 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:10.703162 [debug] [MainThread]: On master: BEGIN
[0m15:22:10.706383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:10.723072 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m15:22:10.726231 [debug] [MainThread]: On master: COMMIT
[0m15:22:10.728991 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:10.731733 [debug] [MainThread]: On master: COMMIT
[0m15:22:10.734178 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:10.736350 [debug] [MainThread]: On master: Close
[0m15:22:10.739588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:10.742117 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m15:22:10.744219 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m15:22:10.746515 [info ] [MainThread]: 
[0m15:22:10.748804 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m15:22:10.751956 [debug] [MainThread]: Command end result
[0m15:22:10.755044 [info ] [MainThread]: 
[0m15:22:10.758559 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:10.762745 [info ] [MainThread]: 
[0m15:22:10.765323 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:10.768812 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.5778217, "process_user_time": 8.107677, "process_kernel_time": 0.57417, "process_mem_max_rss": "117948", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:10.772312 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:10.772026 after 7.58 seconds
[0m15:22:10.774618 [debug] [MainThread]: Flushing usage events
[0m15:22:19.786788 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m15:22:19.813444 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:19.843405 | a5dde494-551c-4bbf-b095-c74e99550726 ==============================
[0m15:22:19.843405 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:19.847184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 15:22:19.850036 | ec062ca1-b7c3-491e-8421-0c94b9d0bc88 ==============================
[0m15:22:19.850036 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:19.867255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:19.874657 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:19.905351 | 61bbf3be-98d6-4a1e-b946-14442b6a90f0 ==============================
[0m15:22:19.905351 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:19.917446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:22:20.203748 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:20.264876 | a46deba0-8c42-4e3b-8875-436f71d82405 ==============================
[0m15:22:20.264876 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:20.274874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:20.318817 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:20.357404 | 2aa807a3-f31f-44fc-8c35-4516563eca2d ==============================
[0m15:22:20.357404 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:20.331901 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m15:22:20.361845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 15:22:20.364981 | c8d8184d-d2e3-4ce2-819f-5bca7d701a0f ==============================
[0m15:22:20.364981 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:20.369861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:22:20.417628 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:20.447499 | 7c9fe315-3d22-4495-a09c-24836136fdcf ==============================
[0m15:22:20.447499 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:20.452272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:20.596073 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:20.622779 | 809bddba-d0f8-40cd-b44c-6c31d7de10a1 ==============================
[0m15:22:20.622779 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:20.628045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:20.686237 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:20.718251 | 79a0d310-3479-461b-9c38-5efae9b212d9 ==============================
[0m15:22:20.718251 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:20.722482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:22:20.787993 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:20.868384 | fc0112c1-d153-41a1-b11f-3ad21a2fd37f ==============================
[0m15:22:20.868384 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:20.874037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:21.013125 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:21.053342 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:21.067617 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:21.157859 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:21.199948 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:21.244083 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:21.416170 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:21.432167 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:21.617340 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:21.656068 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:21.667309 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:21.731867 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:21.873844 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:21.997484 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:22.123012 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:22.131543 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:22.227870 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:22.278421 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:22.427628 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:22.530001 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:24.019712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:24.025044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:24.027398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:24.030788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:24.131159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:24.135789 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:24.161232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:24.164571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:24.279417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:24.283803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:24.474906 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:24.483642 [info ] [MainThread]: 
[0m15:22:24.487406 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:24.505045 [debug] [MainThread]: Command end result
[0m15:22:24.504761 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:24.510499 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.937144, "process_user_time": 7.527222, "process_kernel_time": 0.469826, "process_mem_max_rss": "101764", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:24.515181 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:24.514737 after 4.94 seconds
[0m15:22:24.518570 [debug] [MainThread]: Flushing usage events
[0m15:22:24.520489 [info ] [MainThread]: 
[0m15:22:24.523823 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:24.537109 [debug] [MainThread]: Command end result
[0m15:22:24.544027 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.038452, "process_user_time": 7.530984, "process_kernel_time": 0.605257, "process_mem_max_rss": "101860", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:24.548324 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:24.547814 after 5.04 seconds
[0m15:22:24.552058 [debug] [MainThread]: Flushing usage events
[0m15:22:24.565454 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:24.569934 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:24.578577 [info ] [MainThread]: 
[0m15:22:24.577254 [info ] [MainThread]: 
[0m15:22:24.583094 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:24.584417 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:24.588969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:24.588343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:24.784141 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:24.787361 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:24.791547 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:24.792347 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:24.792408 [info ] [MainThread]: 
[0m15:22:24.794792 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:24.795505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:24.796360 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:24.798474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:24.808003 [debug] [MainThread]: Command end result
[0m15:22:24.817457 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.8968015, "process_user_time": 7.96887, "process_kernel_time": 0.719897, "process_mem_max_rss": "101932", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:24.817680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:24.821088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:24.821565 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:24.821131 after 4.90 seconds
[0m15:22:24.831536 [debug] [MainThread]: Flushing usage events
[0m15:22:24.839703 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.040 seconds
[0m15:22:24.846765 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.051 seconds
[0m15:22:24.847471 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:24.859846 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:24.859326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:24.864218 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:24.887369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m15:22:24.903967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m15:22:24.889952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m15:22:24.901778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m15:22:24.925789 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:24.972413 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:24.945217 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:24.998096 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:24.982866 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:25.009353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:25.001610 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:24.993596 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:25.026074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:25.047587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:25.055948 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:25.066793 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m15:22:25.090213 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:25.085615 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m15:22:25.096137 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:25.098414 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m15:22:25.079017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:25.104453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:25.100464 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:25.116336 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:25.115435 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m15:22:25.115065 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:25.107052 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:25.129380 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.009 seconds
[0m15:22:25.137621 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:25.148798 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m15:22:25.135860 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:25.147625 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:25.163285 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:25.166378 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:22:25.152526 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:25.172269 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:25.183008 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:25.170267 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:25.201546 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:22:25.189575 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:25.216352 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:25.219566 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:25.253676 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:25.260101 [debug] [MainThread]: On master: BEGIN
[0m15:22:25.263845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:25.263941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:25.256050 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:25.269704 [debug] [MainThread]: On master: BEGIN
[0m15:22:25.267762 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:25.276504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:25.287401 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m15:22:25.297817 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:25.298957 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m15:22:25.304385 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:25.304360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:25.324209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:25.326555 [debug] [MainThread]: SQL status: SELECT 5 in 0.014 seconds
[0m15:22:25.335578 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:25.336291 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:25.338237 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m15:22:25.341624 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:25.346300 [debug] [MainThread]: On master: BEGIN
[0m15:22:25.349864 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:22:25.351020 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:25.353038 [debug] [MainThread]: On master: COMMIT
[0m15:22:25.354492 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:25.357494 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:25.359520 [debug] [MainThread]: On master: BEGIN
[0m15:22:25.364984 [debug] [MainThread]: On master: COMMIT
[0m15:22:25.368606 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:25.367987 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:22:25.368941 [info ] [MainThread]: 
[0m15:22:25.375379 [debug] [MainThread]: On master: Close
[0m15:22:25.376124 [debug] [MainThread]: On master: COMMIT
[0m15:22:25.380245 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:25.379394 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:25.383796 [debug] [MainThread]: On master: COMMIT
[0m15:22:25.387607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:25.386812 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:25.394441 [info ] [MainThread]: 
[0m15:22:25.394674 [debug] [MainThread]: On master: Close
[0m15:22:25.398849 [debug] [MainThread]: Command end result
[0m15:22:25.404663 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.380147, "process_user_time": 8.284652, "process_kernel_time": 0.606679, "process_mem_max_rss": "102024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:25.413545 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:25.413001 after 5.39 seconds
[0m15:22:25.403241 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:25.416856 [debug] [MainThread]: Flushing usage events
[0m15:22:25.417042 [info ] [MainThread]: 
[0m15:22:25.424631 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:25.430644 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m15:22:25.435273 [info ] [MainThread]: 
[0m15:22:25.434936 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m15:22:25.439796 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:25.443124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m15:22:25.449291 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m15:22:25.449777 [debug] [MainThread]: Command end result
[0m15:22:25.465239 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m15:22:25.468326 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.339186, "process_user_time": 8.219303, "process_kernel_time": 0.630713, "process_mem_max_rss": "101832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:25.477089 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m15:22:25.480292 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:25.479852 after 5.35 seconds
[0m15:22:25.482839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_product)
[0m15:22:25.487917 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m15:22:25.490983 [debug] [MainThread]: Flushing usage events
[0m15:22:25.499348 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m15:22:25.539625 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m15:22:25.545875 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m15:22:25.561708 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m15:22:25.571855 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:25.591711 [info ] [MainThread]: 
[0m15:22:25.597780 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:25.605373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:25.714851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:25.721210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:25.733883 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:25.736608 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m15:22:25.742974 [info ] [MainThread]: 
[0m15:22:25.747374 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:25.760129 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m15:22:25.761028 [debug] [MainThread]: Command end result
[0m15:22:25.769660 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.414296, "process_user_time": 8.322484, "process_kernel_time": 0.670676, "process_mem_max_rss": "101612", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:25.771034 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m15:22:25.777731 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:25.777135 after 5.42 seconds
[0m15:22:25.779113 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m15:22:25.777679 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:25.781122 [debug] [MainThread]: Flushing usage events
[0m15:22:25.783627 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m15:22:25.784478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:25.787543 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m15:22:25.785940 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:25.792486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:25.793239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:25.806845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m15:22:25.813865 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m15:22:25.819031 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m15:22:25.817922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m15:22:25.822630 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.030 seconds
[0m15:22:25.824545 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m15:22:25.830538 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m15:22:25.828176 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:22:25.833641 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:25.840398 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m15:22:25.860998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m15:22:25.860257 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m15:22:25.875586 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m15:22:25.874218 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m15:22:25.880233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:25.882289 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m15:22:25.891847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:25.863986 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m15:22:25.907759 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:25.895283 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:25.912767 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:25.915636 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:25.919409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:25.922473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:25.952922 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m15:22:25.948555 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m15:22:25.956095 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m15:22:25.949896 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m15:22:25.959662 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m15:22:25.956416 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:25.965027 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m15:22:25.961119 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:25.968700 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:22:25.968831 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m15:22:25.964917 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:25.971900 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m15:22:25.968940 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:25.980563 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m15:22:25.983002 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m15:22:26.001245 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.021 seconds
[0m15:22:26.007141 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m15:22:25.993986 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:26.009056 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:26.012572 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:26.015524 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:26.035974 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m15:22:26.031206 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m15:22:26.042246 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m15:22:26.046331 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:22:26.060349 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m15:22:26.062565 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m15:22:26.067471 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m15:22:26.068195 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:26.072188 [debug] [MainThread]: On master: BEGIN
[0m15:22:26.075862 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 0.63s]
[0m15:22:26.078191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:26.078934 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:22:26.080601 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m15:22:26.090211 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:26.091713 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m15:22:26.094792 [debug] [MainThread]: On master: BEGIN
[0m15:22:26.098463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:26.100270 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m15:22:26.100720 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.61s]
[0m15:22:26.103810 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:26.107283 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m15:22:26.108635 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:26.115007 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:26.118310 [debug] [MainThread]: On master: BEGIN
[0m15:22:26.120737 [debug] [MainThread]: SQL status: SELECT 8 in 0.009 seconds
[0m15:22:26.121267 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:26.123219 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m15:22:26.126975 [debug] [MainThread]: On master: COMMIT
[0m15:22:26.129534 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:26.130738 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:26.133175 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:26.134054 [debug] [MainThread]: On master: COMMIT
[0m15:22:26.137873 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:26.139101 [info ] [MainThread]: 
[0m15:22:26.142243 [debug] [MainThread]: On master: BEGIN
[0m15:22:26.142521 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:26.141747 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m15:22:26.144008 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m15:22:26.146836 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:22:26.145933 [debug] [MainThread]: On master: Close
[0m15:22:26.148098 [debug] [MainThread]: On master: COMMIT
[0m15:22:26.150579 [debug] [MainThread]: On master: COMMIT
[0m15:22:26.152112 [debug] [MainThread]: Command end result
[0m15:22:26.154236 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:26.152378 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:26.151399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:26.157865 [debug] [MainThread]: On master: COMMIT
[0m15:22:26.158498 [debug] [MainThread]: On master: COMMIT
[0m15:22:26.158419 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m15:22:26.160513 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.699746, "process_user_time": 8.187903, "process_kernel_time": 0.629838, "process_mem_max_rss": "101944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:26.162190 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:22:26.162294 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m15:22:26.162687 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:26.165127 [debug] [MainThread]: On master: Close
[0m15:22:26.164776 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:26.164213 after 5.71 seconds
[0m15:22:26.165566 [debug] [MainThread]: On master: Close
[0m15:22:26.165587 [info ] [MainThread]: 
[0m15:22:26.168533 [debug] [MainThread]: Flushing usage events
[0m15:22:26.169268 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:26.170226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:26.173482 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m15:22:26.173308 [info ] [MainThread]: 
[0m15:22:26.173278 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m15:22:26.176538 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m15:22:26.178248 [debug] [MainThread]: Command end result
[0m15:22:26.179842 [info ] [MainThread]: 
[0m15:22:26.180720 [info ] [MainThread]: 
[0m15:22:26.183052 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m15:22:26.184379 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:26.187489 [debug] [MainThread]: Command end result
[0m15:22:26.187448 [info ] [MainThread]: 
[0m15:22:26.190375 [info ] [MainThread]: 
[0m15:22:26.191135 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:26.193701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:26.195486 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m15:22:26.195152 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1916065, "process_user_time": 8.67115, "process_kernel_time": 0.749724, "process_mem_max_rss": "112480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:26.196843 [info ] [MainThread]: 
[0m15:22:26.198651 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m15:22:26.198798 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:26.198209 after 6.20 seconds
[0m15:22:26.200363 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:26.201582 [debug] [MainThread]: Flushing usage events
[0m15:22:26.201996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_resellers)
[0m15:22:26.205627 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.761473, "process_user_time": 8.848402, "process_kernel_time": 0.725609, "process_mem_max_rss": "112296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:26.205441 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m15:22:26.209276 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:26.208843 after 6.77 seconds
[0m15:22:26.212406 [debug] [MainThread]: Flushing usage events
[0m15:22:26.238319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m15:22:26.261750 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m15:22:26.432415 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m15:22:26.467645 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m15:22:26.470874 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m15:22:26.477343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:26.498370 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m15:22:26.508119 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m15:22:26.511876 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m15:22:26.519415 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:22:26.549229 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m15:22:26.556426 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m15:22:26.564331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:26.644155 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m15:22:26.647745 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m15:22:26.650846 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m15:22:26.658822 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:22:26.679734 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m15:22:26.695655 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m15:22:26.698971 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m15:22:26.702650 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:22:26.709883 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m15:22:26.716822 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.51s]
[0m15:22:26.720121 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m15:22:26.728522 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:26.731103 [debug] [MainThread]: On master: BEGIN
[0m15:22:26.733512 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:26.751037 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m15:22:26.754786 [debug] [MainThread]: On master: COMMIT
[0m15:22:26.757478 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:26.760506 [debug] [MainThread]: On master: COMMIT
[0m15:22:26.763258 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:26.765742 [debug] [MainThread]: On master: Close
[0m15:22:26.768173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:26.770582 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m15:22:26.773904 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m15:22:26.776837 [info ] [MainThread]: 
[0m15:22:26.779294 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m15:22:26.783181 [debug] [MainThread]: Command end result
[0m15:22:26.785406 [info ] [MainThread]: 
[0m15:22:26.788727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:26.791683 [info ] [MainThread]: 
[0m15:22:26.794439 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:26.798091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5270805, "process_user_time": 9.040691, "process_kernel_time": 0.752565, "process_mem_max_rss": "110652", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:26.800656 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:26.800387 after 6.53 seconds
[0m15:22:26.803207 [debug] [MainThread]: Flushing usage events
[0m15:22:33.076541 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:33.098061 | 961c36a2-90cf-41f3-830a-b2b2f380be9e ==============================
[0m15:22:33.098061 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:33.103633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m15:22:33.098145 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m15:22:33.097188 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:33.123714 | 8bb8c893-94da-46f5-bd9b-9d9879d47aad ==============================
[0m15:22:33.123714 [info ] [MainThread]: Running with dbt=1.8.2


============================== 15:22:33.123132 | f7cce7e3-7e84-4679-8f29-3742623d68aa ==============================
[0m15:22:33.123132 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:33.127883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:33.127951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:22:33.196867 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:33.215431 | 716d4b2b-ef31-4917-a1f0-fb3301d9a909 ==============================
[0m15:22:33.215431 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:33.219954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:33.345471 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:33.378759 | b5ddb935-2278-4b7c-8c40-09a75a2a305a ==============================
[0m15:22:33.378759 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:33.385815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:33.415083 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:33.436162 | 5327798b-0681-474a-bbba-718cd6773c46 ==============================
[0m15:22:33.436162 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:33.439849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:34.017388 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:34.083177 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:34.187512 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:34.242701 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:34.279785 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:34.391094 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:34.461270 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:34.538950 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:34.578365 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:34.630288 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:34.698195 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:34.732724 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:36.121167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:36.131467 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:36.157474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:36.161518 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:36.223464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:36.226516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:36.227912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:36.231097 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:36.352621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:36.354971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:36.446417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:36.451418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:36.480955 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:36.483541 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:36.487212 [info ] [MainThread]: 
[0m15:22:36.489974 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:36.489996 [info ] [MainThread]: 
[0m15:22:36.492978 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:36.493813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:36.497996 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:36.525598 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:36.532291 [info ] [MainThread]: 
[0m15:22:36.535524 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:36.541205 [debug] [MainThread]: Command end result
[0m15:22:36.545166 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.592443, "process_user_time": 6.269023, "process_kernel_time": 0.351627, "process_mem_max_rss": "101876", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:36.545572 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:36.549196 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:36.548766 after 3.60 seconds
[0m15:22:36.552271 [debug] [MainThread]: Flushing usage events
[0m15:22:36.552412 [info ] [MainThread]: 
[0m15:22:36.555018 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:36.562943 [debug] [MainThread]: Command end result
[0m15:22:36.567469 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.6767035, "process_user_time": 6.227634, "process_kernel_time": 0.292877, "process_mem_max_rss": "101848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:36.570196 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:36.569920 after 3.68 seconds
[0m15:22:36.572133 [debug] [MainThread]: Flushing usage events
[0m15:22:36.614059 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:36.616805 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:36.618189 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:36.618985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:36.621113 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:36.624319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:36.630037 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:36.638532 [info ] [MainThread]: 
[0m15:22:36.640976 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.022 seconds
[0m15:22:36.642118 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:36.644816 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.020 seconds
[0m15:22:36.645954 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:36.646701 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:36.650212 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:36.668419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m15:22:36.669369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m15:22:36.670888 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m15:22:36.671607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m15:22:36.693086 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:36.694736 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:36.700968 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:36.703176 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:36.703032 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:36.705620 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:36.705406 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:36.711730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:36.708768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:36.708727 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:36.711743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:36.717204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:36.731183 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m15:22:36.730816 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m15:22:36.734637 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:36.734169 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:36.739053 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:36.737854 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m15:22:36.736736 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m15:22:36.739217 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:36.741935 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:36.743307 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:36.745997 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:36.748085 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:36.748045 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:36.749874 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.008 seconds
[0m15:22:36.750720 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.006 seconds
[0m15:22:36.754438 [info ] [MainThread]: 
[0m15:22:36.757358 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:36.758534 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:36.757625 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:36.759054 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:22:36.760463 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m15:22:36.763048 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:36.767327 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:36.767145 [debug] [MainThread]: Command end result
[0m15:22:36.762624 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:36.769677 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:36.772549 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:36.771135 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.59499, "process_user_time": 6.30671, "process_kernel_time": 0.250848, "process_mem_max_rss": "101700", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:36.767117 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:36.775406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:36.777215 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:36.776773 after 3.60 seconds
[0m15:22:36.778092 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:36.770258 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:36.780012 [debug] [MainThread]: Flushing usage events
[0m15:22:36.796445 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.021 seconds
[0m15:22:36.801015 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:36.800716 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:36.801470 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:36.803379 [debug] [MainThread]: On master: BEGIN
[0m15:22:36.804519 [debug] [MainThread]: On master: BEGIN
[0m15:22:36.806906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:36.806432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:36.821028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m15:22:36.827531 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m15:22:36.825173 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m15:22:36.831580 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:36.834374 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:36.834945 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:36.837706 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:36.824118 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m15:22:36.845621 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m15:22:36.848649 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m15:22:36.853575 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:36.847587 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:36.855996 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:36.857002 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:36.855560 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:36.858112 [debug] [MainThread]: On master: BEGIN
[0m15:22:36.859632 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:36.857822 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:36.861812 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:22:36.862785 [debug] [MainThread]: On master: BEGIN
[0m15:22:36.864416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:36.864801 [debug] [MainThread]: On master: COMMIT
[0m15:22:36.866285 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:22:36.860484 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:36.868252 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:36.869602 [debug] [MainThread]: On master: COMMIT
[0m15:22:36.869920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:36.871213 [debug] [MainThread]: On master: COMMIT
[0m15:22:36.872203 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:36.874549 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:36.875137 [debug] [MainThread]: On master: COMMIT
[0m15:22:36.877814 [debug] [MainThread]: On master: Close
[0m15:22:36.878692 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:36.881501 [debug] [MainThread]: On master: Close
[0m15:22:36.881523 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:36.884422 [info ] [MainThread]: 
[0m15:22:36.886826 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:36.884807 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m15:22:36.890498 [info ] [MainThread]: 
[0m15:22:36.887557 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m15:22:36.890976 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:36.893618 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:36.896828 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:36.900026 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:36.905401 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m15:22:36.908921 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m15:22:36.908796 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m15:22:36.908724 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m15:22:36.912609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_product)
[0m15:22:36.912962 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m15:22:36.911402 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.006 seconds
[0m15:22:36.915501 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m15:22:36.916254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_channel)
[0m15:22:36.918734 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m15:22:36.915170 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:36.921185 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:36.924021 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:36.926478 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:36.948674 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m15:22:36.950346 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m15:22:36.961101 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m15:22:36.962559 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m15:22:36.963307 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:36.965936 [debug] [MainThread]: On master: BEGIN
[0m15:22:36.968947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:36.986745 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m15:22:36.989892 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:36.992969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:37.004309 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m15:22:37.011524 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:37.014731 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:37.017707 [debug] [MainThread]: On master: BEGIN
[0m15:22:37.020790 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:22:37.023557 [debug] [MainThread]: On master: COMMIT
[0m15:22:37.026366 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:37.029115 [debug] [MainThread]: On master: COMMIT
[0m15:22:37.032154 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:37.034861 [debug] [MainThread]: On master: Close
[0m15:22:37.037145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:37.039839 [info ] [MainThread]: 
[0m15:22:37.056858 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m15:22:37.059514 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m15:22:37.063517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_salesagent)
[0m15:22:37.066584 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m15:22:37.090682 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m15:22:37.096362 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m15:22:37.097958 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m15:22:37.107961 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m15:22:37.108774 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m15:22:37.109957 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m15:22:37.112225 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m15:22:37.113101 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m15:22:37.114761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:37.115273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:37.131788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:22:37.132874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:22:37.134874 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m15:22:37.135554 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m15:22:37.137273 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select product_id AS product_key, product_id AS original_product_id, product_name, geography_key, product_price
-- fill code here 


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m15:22:37.138171 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m15:22:37.145198 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m15:22:37.169650 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m15:22:37.172838 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel" rename to "dim_channel__dbt_backup"
[0m15:22:37.175828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:37.179251 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.039 seconds
[0m15:22:37.188299 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m15:22:37.191473 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m15:22:37.196111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:37.204171 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m15:22:37.206590 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product" rename to "dim_product__dbt_backup"
[0m15:22:37.209525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:37.220649 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m15:22:37.223118 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m15:22:37.226280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:37.244368 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m15:22:37.258726 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m15:22:37.262223 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m15:22:37.263968 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m15:22:37.265550 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m15:22:37.266747 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m15:22:37.269412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:37.272836 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:22:37.290694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m15:22:37.299458 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m15:22:37.302853 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT reseller_id AS sales_agent_key, reseller_id AS original_reseller_id, reseller_name, commission_pct
     -- fill code here 
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m15:22:37.307399 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m15:22:37.308541 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m15:22:37.318096 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m15:22:37.320319 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.014 seconds
[0m15:22:37.321618 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m15:22:37.331974 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:22:37.335871 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m15:22:37.339244 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m15:22:37.350523 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:22:37.350804 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m15:22:37.354463 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m15:22:37.358479 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m15:22:37.359618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:37.361346 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m15:22:37.368679 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 9[0m in 0.45s]
[0m15:22:37.372602 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m15:22:37.377100 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m15:22:37.378849 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:37.380050 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m15:22:37.381390 [debug] [MainThread]: On master: BEGIN
[0m15:22:37.383482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:37.387124 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:22:37.395919 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m15:22:37.400229 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m15:22:37.403583 [debug] [MainThread]: On master: COMMIT
[0m15:22:37.404608 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.49s]
[0m15:22:37.406795 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:37.407967 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m15:22:37.409273 [debug] [MainThread]: On master: COMMIT
[0m15:22:37.412342 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:37.413373 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:37.414724 [debug] [MainThread]: On master: Close
[0m15:22:37.415970 [debug] [MainThread]: On master: BEGIN
[0m15:22:37.417860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:37.418128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:37.420479 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m15:22:37.423088 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m15:22:37.422969 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m15:22:37.425314 [info ] [MainThread]: 
[0m15:22:37.425512 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m15:22:37.428088 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m15:22:37.428616 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m15:22:37.431637 [debug] [MainThread]: Command end result
[0m15:22:37.433708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:22:37.433728 [info ] [MainThread]: 
[0m15:22:37.434383 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m15:22:37.437198 [debug] [MainThread]: On master: COMMIT
[0m15:22:37.437293 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:37.439792 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:37.439756 [info ] [MainThread]: 
[0m15:22:37.442124 [debug] [MainThread]: On master: COMMIT
[0m15:22:37.442572 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:37.445306 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:37.446805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.575687, "process_user_time": 6.778562, "process_kernel_time": 0.365075, "process_mem_max_rss": "112664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:37.447589 [debug] [MainThread]: On master: Close
[0m15:22:37.449305 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:37.449065 after 4.58 seconds
[0m15:22:37.450388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:37.451870 [debug] [MainThread]: Flushing usage events
[0m15:22:37.453321 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m15:22:37.454464 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m15:22:37.455713 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m15:22:37.457589 [info ] [MainThread]: 
[0m15:22:37.459707 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m15:22:37.463568 [debug] [MainThread]: Command end result
[0m15:22:37.466268 [info ] [MainThread]: 
[0m15:22:37.467185 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m15:22:37.469081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:37.469914 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m15:22:37.471180 [info ] [MainThread]: 
[0m15:22:37.472640 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:22:37.473050 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:37.476098 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5945745, "process_user_time": 6.866244, "process_kernel_time": 0.328873, "process_mem_max_rss": "112476", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:37.479113 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:37.478800 after 4.60 seconds
[0m15:22:37.479849 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m15:22:37.481324 [debug] [MainThread]: Flushing usage events
[0m15:22:37.485390 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.42s]
[0m15:22:37.491007 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m15:22:37.496311 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:37.499041 [debug] [MainThread]: On master: BEGIN
[0m15:22:37.501574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:37.516740 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m15:22:37.519766 [debug] [MainThread]: On master: COMMIT
[0m15:22:37.521879 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:37.524147 [debug] [MainThread]: On master: COMMIT
[0m15:22:37.526682 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:37.529561 [debug] [MainThread]: On master: Close
[0m15:22:37.532501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:37.535071 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m15:22:37.537273 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m15:22:37.539424 [info ] [MainThread]: 
[0m15:22:37.541474 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m15:22:37.545062 [debug] [MainThread]: Command end result
[0m15:22:37.547419 [info ] [MainThread]: 
[0m15:22:37.549975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:37.552504 [info ] [MainThread]: 
[0m15:22:37.555057 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:37.558823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.434257, "process_user_time": 6.882897, "process_kernel_time": 0.29796, "process_mem_max_rss": "110596", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:37.562875 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:37.562403 after 4.44 seconds
[0m15:22:37.565976 [debug] [MainThread]: Flushing usage events
[0m15:22:42.786572 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:42.797588 | 9c8a2433-4fee-4081-9f69-69123f704c63 ==============================
[0m15:22:42.797588 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:42.800496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:22:42.810649 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:42.823457 | 0ec01741-29e6-435e-b53c-1e3b22337a5b ==============================
[0m15:22:42.823457 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:42.826617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:42.846318 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m15:22:42.846258 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:42.856866 | 95c2d0c8-8c17-4d25-bddd-559b1fdc84bc ==============================
[0m15:22:42.856866 [info ] [MainThread]: Running with dbt=1.8.2


============================== 15:22:42.857226 | c1c13c0a-7934-46d8-a4ca-db7a775de7de ==============================
[0m15:22:42.857226 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:42.859144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:22:42.859570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:22:43.369777 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:43.369858 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:43.375036 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:43.396721 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:43.463639 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:43.519290 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:43.540107 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:43.539771 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:44.730624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:44.731187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:44.732590 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:44.733484 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:44.774106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:44.776576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:44.856212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:44.859722 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:45.006225 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:45.010106 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:45.011380 [info ] [MainThread]: 
[0m15:22:45.014200 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:45.015195 [info ] [MainThread]: 
[0m15:22:45.017670 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:45.021067 [debug] [MainThread]: Command end result
[0m15:22:45.024425 [debug] [MainThread]: Command end result
[0m15:22:45.025009 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.301792, "process_user_time": 4.340804, "process_kernel_time": 0.231107, "process_mem_max_rss": "101792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:45.027246 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.371944, "process_user_time": 4.429559, "process_kernel_time": 0.130281, "process_mem_max_rss": "102060", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:45.027014 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:45.027686 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:45.027415 after 2.30 seconds
[0m15:22:45.029714 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:45.029456 after 2.37 seconds
[0m15:22:45.029948 [debug] [MainThread]: Flushing usage events
[0m15:22:45.031495 [debug] [MainThread]: Flushing usage events
[0m15:22:45.032570 [info ] [MainThread]: 
[0m15:22:45.036043 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:45.040015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:45.136122 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:45.138968 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:45.141445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:45.152356 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:45.158169 [info ] [MainThread]: 
[0m15:22:45.159817 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.018 seconds
[0m15:22:45.160349 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:45.163434 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:45.166114 [debug] [MainThread]: Command end result
[0m15:22:45.170497 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.4407701, "process_user_time": 4.287342, "process_kernel_time": 0.220377, "process_mem_max_rss": "101672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:45.173450 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:45.173189 after 2.44 seconds
[0m15:22:45.175568 [debug] [MainThread]: Flushing usage events
[0m15:22:45.185211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m15:22:45.187391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m15:22:45.209171 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:45.217619 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:45.219978 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:45.222644 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:45.225194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:45.227641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:45.248192 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m15:22:45.252197 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m15:22:45.254296 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:45.257633 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:45.260401 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:45.263498 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:45.273305 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:22:45.274579 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.006 seconds
[0m15:22:45.278936 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:45.284536 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:45.288713 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:45.293536 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:45.324476 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:45.326992 [debug] [MainThread]: On master: BEGIN
[0m15:22:45.329298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:45.346131 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m15:22:45.349285 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:45.353143 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:45.363641 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m15:22:45.372895 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:45.375490 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:45.378119 [debug] [MainThread]: On master: BEGIN
[0m15:22:45.381119 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:22:45.384262 [debug] [MainThread]: On master: COMMIT
[0m15:22:45.387128 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:45.389643 [debug] [MainThread]: On master: COMMIT
[0m15:22:45.392437 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:45.395043 [debug] [MainThread]: On master: Close
[0m15:22:45.397765 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:45.400911 [info ] [MainThread]: 
[0m15:22:45.419948 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m15:22:45.422583 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m15:22:45.425275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m15:22:45.427994 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m15:22:45.490901 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m15:22:45.509705 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m15:22:45.614197 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m15:22:45.661812 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m15:22:45.664176 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m15:22:45.666987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:45.685356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m15:22:45.688210 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m15:22:45.691223 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m15:22:45.702188 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m15:22:45.729759 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m15:22:45.733381 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m15:22:45.738804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:22:45.797123 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m15:22:45.800159 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m15:22:45.802897 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m15:22:45.807617 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:22:45.828320 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m15:22:45.843448 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m15:22:45.845969 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m15:22:45.849516 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:22:45.856803 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m15:22:45.861875 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.43s]
[0m15:22:45.865465 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m15:22:45.871539 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:45.874070 [debug] [MainThread]: On master: BEGIN
[0m15:22:45.876719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:45.890636 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m15:22:45.894174 [debug] [MainThread]: On master: COMMIT
[0m15:22:45.896796 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:45.899782 [debug] [MainThread]: On master: COMMIT
[0m15:22:45.902532 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:45.904751 [debug] [MainThread]: On master: Close
[0m15:22:45.906972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:45.908922 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m15:22:45.910595 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m15:22:45.912313 [info ] [MainThread]: 
[0m15:22:45.913949 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m15:22:45.916496 [debug] [MainThread]: Command end result
[0m15:22:45.918357 [info ] [MainThread]: 
[0m15:22:45.920029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:45.921715 [info ] [MainThread]: 
[0m15:22:45.923595 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:45.926288 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2381842, "process_user_time": 4.866506, "process_kernel_time": 0.297844, "process_mem_max_rss": "111164", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:45.928318 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:45.928102 after 3.24 seconds
[0m15:22:45.930134 [debug] [MainThread]: Flushing usage events
[0m15:22:50.647499 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:50.659717 | 7cc22ff3-9e07-4c97-9f69-b810a621db82 ==============================
[0m15:22:50.659717 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:50.662317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'send_anonymous_usage_stats': 'True'}
[0m15:22:50.694221 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:22:50.705462 | c24f30d6-9f6f-4e4d-84d3-1079cfd90ca8 ==============================
[0m15:22:50.705462 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:22:50.708553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:51.263549 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:51.287451 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:22:51.325543 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:51.358192 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:22:52.444509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:52.446119 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:52.480776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:52.482802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:52.592875 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:52.598509 [info ] [MainThread]: 
[0m15:22:52.601150 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:22:52.606510 [debug] [MainThread]: Command end result
[0m15:22:52.609563 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0842257, "process_user_time": 3.482736, "process_kernel_time": 0.238819, "process_mem_max_rss": "101864", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:52.612305 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:52.612001 after 2.09 seconds
[0m15:22:52.617664 [debug] [MainThread]: Flushing usage events
[0m15:22:52.649349 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:22:52.655453 [info ] [MainThread]: 
[0m15:22:52.657984 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:52.661776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:22:52.745914 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:22:52.747852 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:22:52.749405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:52.763785 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.014 seconds
[0m15:22:52.767542 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:22:52.783897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m15:22:52.785870 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m15:22:52.802361 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:52.809363 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:52.811446 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:22:52.813824 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:22:52.816182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:52.818030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:52.832061 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m15:22:52.834112 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m15:22:52.835762 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:22:52.837816 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:22:52.839870 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:22:52.841760 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:22:52.848010 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m15:22:52.851370 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:22:52.852043 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.007 seconds
[0m15:22:52.853662 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:22:52.856769 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:22:52.861152 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:22:52.881655 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:52.883347 [debug] [MainThread]: On master: BEGIN
[0m15:22:52.884820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:52.895296 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:22:52.898222 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:52.900732 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:52.908212 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m15:22:52.914727 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:52.916626 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:52.918103 [debug] [MainThread]: On master: BEGIN
[0m15:22:52.919986 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:22:52.923123 [debug] [MainThread]: On master: COMMIT
[0m15:22:52.925069 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:52.927436 [debug] [MainThread]: On master: COMMIT
[0m15:22:52.929190 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:52.930723 [debug] [MainThread]: On master: Close
[0m15:22:52.932837 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:52.935249 [info ] [MainThread]: 
[0m15:22:52.949998 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m15:22:52.952737 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m15:22:52.955311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_customer)
[0m15:22:52.957032 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m15:22:52.975107 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m15:22:52.989163 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m15:22:53.104725 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m15:22:53.132595 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m15:22:53.135807 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m15:22:53.138904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:53.173202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:22:53.175948 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m15:22:53.178753 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select customer_key, customer_first_name, customer_last_name, customer_email
-- fill code here 
from "sales_dw"."dev"."staging_customers"
  );
  
[0m15:22:56.862491 [debug] [Thread-1 (]: SQL status: SELECT 359277 in 3.681 seconds
[0m15:22:56.873955 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m15:22:56.876175 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m15:22:56.878151 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:22:56.907892 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m15:22:56.909935 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m15:22:56.911543 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m15:22:56.918749 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:22:56.929937 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m15:22:56.938254 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m15:22:56.940419 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m15:22:56.942724 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:22:56.947101 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m15:22:56.950879 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 359277[0m in 3.99s]
[0m15:22:56.953461 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m15:22:56.957252 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:56.959419 [debug] [MainThread]: On master: BEGIN
[0m15:22:56.961142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:56.971596 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:22:56.974251 [debug] [MainThread]: On master: COMMIT
[0m15:22:56.976376 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:56.978313 [debug] [MainThread]: On master: COMMIT
[0m15:22:56.980659 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:22:56.982587 [debug] [MainThread]: On master: Close
[0m15:22:56.984849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:56.986536 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m15:22:56.988609 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m15:22:56.990931 [info ] [MainThread]: 
[0m15:22:56.992815 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m15:22:56.995191 [debug] [MainThread]: Command end result
[0m15:22:56.996869 [info ] [MainThread]: 
[0m15:22:56.998605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:57.000014 [info ] [MainThread]: 
[0m15:22:57.001569 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:57.004861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.431911, "process_user_time": 4.103058, "process_kernel_time": 0.181158, "process_mem_max_rss": "110664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:57.007286 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:57.007055 after 6.43 seconds
[0m15:22:57.008837 [debug] [MainThread]: Flushing usage events
[0m15:23:01.705169 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:23:01.717257 | bf34d885-d56d-47cb-bfe3-457d025a5900 ==============================
[0m15:23:01.717257 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:23:01.720178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:23:01.736089 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:23:01.752959 | b43a77cf-ade0-4367-a302-b25ae6b828be ==============================
[0m15:23:01.752959 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:23:01.755544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'send_anonymous_usage_stats': 'True'}
[0m15:23:01.767373 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:23:01.789604 | d583dc9a-5245-43b9-b8d8-a41710ac301b ==============================
[0m15:23:01.789604 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:23:01.792874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:23:02.321312 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:23:02.348176 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:23:02.432453 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:23:02.433325 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:23:02.438517 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:23:02.537952 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:23:03.723711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:03.726089 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:03.741354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:03.743814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:03.819854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:03.822507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:03.965248 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:23:03.970404 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:23:03.970490 [info ] [MainThread]: 
[0m15:23:03.972980 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:03.974864 [info ] [MainThread]: 
[0m15:23:03.975996 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:23:03.976954 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:03.979721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:23:04.056517 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:23:04.060237 [info ] [MainThread]: 
[0m15:23:04.062211 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:23:04.067532 [debug] [MainThread]: Command end result
[0m15:23:04.068138 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:23:04.069472 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:23:04.070005 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.44062, "process_user_time": 4.078518, "process_kernel_time": 0.21992, "process_mem_max_rss": "101872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:23:04.070061 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:23:04.071229 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:23:04.071716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:04.072106 [debug] [MainThread]: Command `dbt test` succeeded at 15:23:04.071855 after 2.44 seconds
[0m15:23:04.072940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:04.074081 [debug] [MainThread]: Flushing usage events
[0m15:23:04.085914 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.014 seconds
[0m15:23:04.085995 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.013 seconds
[0m15:23:04.089606 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:23:04.089947 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:23:04.103787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m15:23:04.107741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m15:23:04.105286 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m15:23:04.109327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m15:23:04.119877 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:23:04.125761 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:23:04.127682 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:23:04.125212 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:23:04.129915 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:23:04.131342 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:23:04.132344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:04.133115 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:23:04.134677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:04.135104 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:23:04.136998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:04.139248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:04.147421 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m15:23:04.150543 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:23:04.151870 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m15:23:04.154610 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:23:04.157367 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m15:23:04.157444 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:23:04.159196 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m15:23:04.161992 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:23:04.160975 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:23:04.162917 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:23:04.166034 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.006 seconds
[0m15:23:04.165370 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:23:04.168126 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:23:04.170518 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:23:04.171678 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:23:04.175150 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.004 seconds
[0m15:23:04.173995 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:23:04.176464 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m15:23:04.177839 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:23:04.180065 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:23:04.184479 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:23:04.187546 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:23:04.187218 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:23:04.189152 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:23:04.205473 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:04.207658 [debug] [MainThread]: On master: BEGIN
[0m15:23:04.209347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:04.210052 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:04.211888 [debug] [MainThread]: On master: BEGIN
[0m15:23:04.213905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:04.221379 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:23:04.224158 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:04.227064 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:04.227808 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m15:23:04.230481 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:04.233648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:04.240906 [debug] [MainThread]: SQL status: SELECT 12 in 0.011 seconds
[0m15:23:04.245369 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m15:23:04.247860 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:04.250973 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:04.252650 [debug] [MainThread]: On master: BEGIN
[0m15:23:04.252872 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:04.254894 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:23:04.254848 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:04.257286 [debug] [MainThread]: On master: BEGIN
[0m15:23:04.257265 [debug] [MainThread]: On master: COMMIT
[0m15:23:04.259345 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:04.259844 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:23:04.261481 [debug] [MainThread]: On master: COMMIT
[0m15:23:04.262136 [debug] [MainThread]: On master: COMMIT
[0m15:23:04.263852 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:04.264038 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:04.266452 [debug] [MainThread]: On master: Close
[0m15:23:04.266474 [debug] [MainThread]: On master: COMMIT
[0m15:23:04.269027 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:04.268916 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:23:04.271340 [info ] [MainThread]: 
[0m15:23:04.271424 [debug] [MainThread]: On master: Close
[0m15:23:04.273720 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:23:04.275953 [info ] [MainThread]: 
[0m15:23:04.285206 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m15:23:04.287760 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m15:23:04.289356 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m15:23:04.290156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_resellers_xml)
[0m15:23:04.291754 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m15:23:04.292071 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m15:23:04.293740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_main)
[0m15:23:04.295827 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m15:23:04.352201 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m15:23:04.353928 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m15:23:04.384857 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m15:23:04.396438 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m15:23:04.527788 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m15:23:04.538905 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m15:23:04.563653 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m15:23:04.565899 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m15:23:04.567653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:04.578116 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:04.580273 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m15:23:04.582732 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m15:23:04.596799 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m15:23:04.599169 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m15:23:04.601139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:04.617245 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m15:23:04.619812 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m15:23:04.622324 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 



trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  

)
SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m15:23:12.812989 [debug] [Thread-1 (]: SQL status: SELECT 477831 in 8.189 seconds
[0m15:23:12.866494 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m15:23:12.868595 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m15:23:12.870242 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m15:23:12.880446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m15:23:12.884776 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m15:23:12.888984 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 477831[0m in 8.60s]
[0m15:23:12.891490 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m15:23:12.895407 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:12.897341 [debug] [MainThread]: On master: BEGIN
[0m15:23:12.899306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:12.910418 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:23:12.912811 [debug] [MainThread]: On master: COMMIT
[0m15:23:12.914896 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:12.916496 [debug] [MainThread]: On master: COMMIT
[0m15:23:12.918484 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:12.920276 [debug] [MainThread]: On master: Close
[0m15:23:12.922675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:12.924657 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m15:23:12.926489 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m15:23:12.928215 [info ] [MainThread]: 
[0m15:23:12.930076 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.95 seconds (8.95s).
[0m15:23:12.932266 [debug] [MainThread]: Command end result
[0m15:23:12.933868 [info ] [MainThread]: 
[0m15:23:12.935608 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:12.937162 [info ] [MainThread]: 
[0m15:23:12.938950 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:23:12.941278 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.371137, "process_user_time": 4.640713, "process_kernel_time": 0.190055, "process_mem_max_rss": "113116", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:23:12.943461 [debug] [MainThread]: Command `dbt run` succeeded at 15:23:12.943234 after 11.37 seconds
[0m15:23:12.945218 [debug] [MainThread]: Flushing usage events
[0m15:23:17.461426 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:23:17.473825 | 83633772-1a70-4309-af99-52ef6f91b0ab ==============================
[0m15:23:17.473825 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:23:17.475951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:18.179353 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:23:18.245488 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:23:20.706407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:20.708690 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:20.921706 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:23:20.926454 [info ] [MainThread]: 
[0m15:23:20.928565 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:23:20.934531 [debug] [MainThread]: Command end result
[0m15:23:20.937075 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.6092048, "process_user_time": 4.208499, "process_kernel_time": 0.355059, "process_mem_max_rss": "101756", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:23:20.939299 [debug] [MainThread]: Command `dbt test` succeeded at 15:23:20.939038 after 3.61 seconds
[0m15:23:20.941422 [debug] [MainThread]: Flushing usage events
[0m15:26:14.490715 [debug] [Thread-1 (]: SQL status: SELECT 18000000 in 189.913 seconds
[0m15:26:14.582620 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m15:26:14.685474 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m15:26:14.688281 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m15:26:14.694388 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:26:14.734929 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m15:26:14.761054 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 18000000[0m in 190.45s]
[0m15:26:14.815142 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m15:26:14.854377 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:14.858051 [debug] [MainThread]: On master: BEGIN
[0m15:26:14.876801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:14.927579 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m15:26:14.932815 [debug] [MainThread]: On master: COMMIT
[0m15:26:14.937824 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:14.940704 [debug] [MainThread]: On master: COMMIT
[0m15:26:14.943888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:26:14.947964 [debug] [MainThread]: On master: Close
[0m15:26:14.951074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:14.954062 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m15:26:14.956808 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m15:26:14.959337 [info ] [MainThread]: 
[0m15:26:14.966299 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 3 minutes and 10.99 seconds (190.99s).
[0m15:26:14.971446 [debug] [MainThread]: Command end result
[0m15:26:14.974156 [info ] [MainThread]: 
[0m15:26:14.978206 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:14.982714 [info ] [MainThread]: 
[0m15:26:14.986617 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:26:14.994837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 193.40312, "process_user_time": 4.85934, "process_kernel_time": 0.259964, "process_mem_max_rss": "111136", "process_in_blocks": "8", "process_out_blocks": "0"}
[0m15:26:15.001842 [debug] [MainThread]: Command `dbt run` succeeded at 15:26:15.001396 after 193.41 seconds
[0m15:26:15.004959 [debug] [MainThread]: Flushing usage events
[0m15:26:22.034889 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m15:26:22.034916 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:26:22.049373 | 834dd054-5b64-42ce-918f-f3913ff6e150 ==============================
[0m15:26:22.049373 [info ] [MainThread]: Running with dbt=1.8.2


============================== 15:26:22.049366 | 970f2960-caf7-411e-a9d2-2d98b142e9fd ==============================
[0m15:26:22.049366 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:26:22.051676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'send_anonymous_usage_stats': 'True'}
[0m15:26:22.051686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:26:22.783475 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:26:22.783582 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:26:22.870045 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:26:22.875025 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:26:24.473577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:26:24.475876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:26:24.493827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:26:24.495736 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:26:24.664330 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:26:24.669298 [info ] [MainThread]: 
[0m15:26:24.672419 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:26:24.676370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:26:24.687328 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:26:24.692665 [info ] [MainThread]: 
[0m15:26:24.695218 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:26:24.701563 [debug] [MainThread]: Command end result
[0m15:26:24.705400 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.811357, "process_user_time": 4.652001, "process_kernel_time": 0.405879, "process_mem_max_rss": "101840", "process_in_blocks": "2184", "process_out_blocks": "0"}
[0m15:26:24.708940 [debug] [MainThread]: Command `dbt test` succeeded at 15:26:24.708490 after 2.81 seconds
[0m15:26:24.711375 [debug] [MainThread]: Flushing usage events
[0m15:26:24.792386 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:26:24.794866 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:26:24.797463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:24.817607 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.020 seconds
[0m15:26:24.823858 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:26:24.841074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m15:26:24.843193 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m15:26:24.864976 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:26:24.874326 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:26:24.876887 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:26:24.879416 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:26:24.881546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:24.884005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:24.901824 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m15:26:24.904026 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m15:26:24.907843 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:26:24.910783 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:26:24.913002 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:26:24.915308 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:26:24.925098 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.006 seconds
[0m15:26:24.926318 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m15:26:24.930230 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:26:24.934657 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:26:24.939204 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:26:24.941595 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:26:24.970191 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:24.973118 [debug] [MainThread]: On master: BEGIN
[0m15:26:24.975955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:24.990577 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m15:26:24.993411 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:24.996155 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:26:25.005091 [debug] [MainThread]: SQL status: SELECT 12 in 0.006 seconds
[0m15:26:25.012807 [debug] [MainThread]: On master: ROLLBACK
[0m15:26:25.015420 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:25.017708 [debug] [MainThread]: On master: BEGIN
[0m15:26:25.020758 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:26:25.023686 [debug] [MainThread]: On master: COMMIT
[0m15:26:25.026141 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:25.028620 [debug] [MainThread]: On master: COMMIT
[0m15:26:25.031450 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:26:25.033471 [debug] [MainThread]: On master: Close
[0m15:26:25.036549 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:26:25.039163 [info ] [MainThread]: 
[0m15:26:25.054081 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m15:26:25.057471 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m15:26:25.060145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions)
[0m15:26:25.062338 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m15:26:25.084009 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m15:26:25.118952 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m15:26:25.245096 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m15:26:25.263671 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m15:26:25.265926 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m15:26:25.268259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:25.283948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m15:26:25.288156 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m15:26:25.291304 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m15:26:27.396958 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:26:27.412116 | 484c911d-5a1d-4581-8668-eb990a268657 ==============================
[0m15:26:27.412116 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:26:27.414449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'send_anonymous_usage_stats': 'True'}
[0m15:26:27.685565 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m15:26:27.692439 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m15:26:27.769887 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l9vbqqwh'
[0m15:26:27.773029 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m15:26:27.778324 [debug] [MainThread]: Creating symlink to local dependency.
[0m15:26:27.784008 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m15:26:27.787746 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53297246, "process_user_time": 3.389176, "process_kernel_time": 0.140796, "process_mem_max_rss": "108092", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m15:26:27.790557 [debug] [MainThread]: Command `dbt deps` succeeded at 15:26:27.790183 after 0.54 seconds
[0m15:26:27.793147 [debug] [MainThread]: Flushing usage events
[0m15:26:36.802816 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:26:36.812929 | 0b361c2c-6163-4004-9698-3b828882d6e2 ==============================
[0m15:26:36.812929 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:26:36.815488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:37.886176 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:26:37.970983 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m15:26:38.554075 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:26:38.556905 [debug] [MainThread]: previous checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, current checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44
[0m15:26:45.710258 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:26:45.715446 [info ] [MainThread]: 
[0m15:26:45.718734 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:26:45.722621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:26:45.911828 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:26:45.914656 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:26:45.916385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:45.935796 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.019 seconds
[0m15:26:45.939318 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:26:45.952386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m15:26:45.953927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m15:26:46.099728 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:26:46.167149 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:26:46.203424 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:26:46.206229 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:26:46.208222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:46.210115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:46.227006 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m15:26:46.228300 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m15:26:46.230552 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:26:46.233906 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:26:46.237281 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:26:46.240481 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:26:46.248937 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.005 seconds
[0m15:26:46.256331 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:26:46.287097 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:26:46.425296 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.180 seconds
[0m15:26:46.429111 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:26:46.431167 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:26:46.448329 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:46.450930 [debug] [MainThread]: On master: BEGIN
[0m15:26:46.453063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:46.676925 [debug] [MainThread]: SQL status: BEGIN in 0.224 seconds
[0m15:26:46.680492 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:46.684772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:26:46.692362 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m15:26:46.698565 [debug] [MainThread]: On master: ROLLBACK
[0m15:26:46.700962 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:46.702614 [debug] [MainThread]: On master: BEGIN
[0m15:26:46.704390 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:26:46.706306 [debug] [MainThread]: On master: COMMIT
[0m15:26:46.707892 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:46.709202 [debug] [MainThread]: On master: COMMIT
[0m15:26:46.710701 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:26:46.712391 [debug] [MainThread]: On master: Close
[0m15:26:46.714062 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:26:46.716177 [info ] [MainThread]: 
[0m15:26:46.732002 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m15:26:46.734323 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m15:26:46.736527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m15:26:46.737905 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m15:26:46.739114 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m15:26:46.925553 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m15:26:46.927916 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m15:26:46.929901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:46.944682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m15:26:46.947141 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m15:26:46.949906 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */
truncate table "sales_dw"."dev_raw"."geography"
[0m15:26:46.955114 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m15:26:47.161412 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m15:26:47.279672 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m15:26:47.288779 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.005 seconds
[0m15:26:47.303322 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m15:26:47.349960 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m15:26:47.352060 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m15:26:47.353287 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m15:26:47.471233 [debug] [Thread-1 (]: SQL status: COMMIT in 0.117 seconds
[0m15:26:47.477858 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m15:26:47.484820 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.74s]
[0m15:26:47.488549 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m15:26:47.494388 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:47.497195 [debug] [MainThread]: On master: BEGIN
[0m15:26:47.500786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:47.589231 [debug] [MainThread]: SQL status: BEGIN in 0.088 seconds
[0m15:26:47.591628 [debug] [MainThread]: On master: COMMIT
[0m15:26:47.593792 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:47.595530 [debug] [MainThread]: On master: COMMIT
[0m15:26:47.597835 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:26:47.600284 [debug] [MainThread]: On master: Close
[0m15:26:47.602743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:47.604382 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m15:26:47.606254 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m15:26:47.608701 [info ] [MainThread]: 
[0m15:26:47.611336 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m15:26:47.615849 [debug] [MainThread]: Command end result
[0m15:26:47.924961 [info ] [MainThread]: 
[0m15:26:47.927273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:47.929031 [info ] [MainThread]: 
[0m15:26:47.931625 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:26:47.935986 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.343328, "process_user_time": 12.555693, "process_kernel_time": 2.190445, "process_mem_max_rss": "119832", "process_in_blocks": "280", "process_out_blocks": "0"}
[0m15:26:47.938653 [debug] [MainThread]: Command `dbt seed` succeeded at 15:26:47.938356 after 11.35 seconds
[0m15:26:47.940645 [debug] [MainThread]: Flushing usage events
[0m15:42:41.209780 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 15:42:41.249697 | 4b1fda56-4a80-43f2-b6eb-7d4e65a2e126 ==============================
[0m15:42:41.249697 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:42:41.252709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'send_anonymous_usage_stats': 'True'}
[0m15:42:41.919780 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:42:42.075210 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m15:42:42.472211 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:42:42.474853 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m15:42:48.794364 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m15:42:48.800999 [info ] [MainThread]: 
[0m15:42:48.803713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:42:48.807532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m15:42:48.904834 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m15:42:48.908270 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m15:42:48.910997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:48.959189 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.048 seconds
[0m15:42:48.963848 [debug] [ThreadPool]: On list_sales_dw: Close
[0m15:42:48.981019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m15:42:48.982795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m15:42:48.999704 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:42:49.005605 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:42:49.007945 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m15:42:49.010341 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m15:42:49.012221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:49.014163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:49.031716 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m15:42:49.033008 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m15:42:49.035180 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m15:42:49.037841 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m15:42:49.040639 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m15:42:49.045532 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:42:49.063148 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m15:42:49.064105 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.015 seconds
[0m15:42:49.067948 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m15:42:49.073060 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m15:42:49.076331 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m15:42:49.079337 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m15:42:49.105805 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:49.108783 [debug] [MainThread]: On master: BEGIN
[0m15:42:49.110693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:49.123158 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:42:49.125794 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:49.128725 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:42:49.142236 [debug] [MainThread]: SQL status: SELECT 12 in 0.011 seconds
[0m15:42:49.149910 [debug] [MainThread]: On master: ROLLBACK
[0m15:42:49.152095 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:49.153990 [debug] [MainThread]: On master: BEGIN
[0m15:42:49.156773 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:42:49.159632 [debug] [MainThread]: On master: COMMIT
[0m15:42:49.162594 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:49.165044 [debug] [MainThread]: On master: COMMIT
[0m15:42:49.167604 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:42:49.169736 [debug] [MainThread]: On master: Close
[0m15:42:49.172178 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:42:49.176587 [info ] [MainThread]: 
[0m15:42:49.193241 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m15:42:49.195791 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m15:42:49.198036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m15:42:49.199841 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m15:42:49.230772 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m15:42:49.306327 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m15:42:49.468025 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m15:42:49.701769 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m15:42:49.704397 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m15:42:49.706886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:49.720335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:42:49.723280 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m15:42:49.726061 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m15:43:41.746696 [debug] [Thread-1 (]: Postgres adapter: Postgres error: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m15:43:41.749637 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: ROLLBACK
[0m15:43:41.752739 [debug] [Thread-1 (]: Failed to rollback 'model.dbtcomp.staging_transactions'
[0m15:43:41.755204 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m15:43:41.760942 [debug] [Thread-1 (]: Database Error in model staging_transactions (models/staging/staging_transactions.sql)
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled code at target/run/dbtcomp/models/staging/staging_transactions.sql
[0m15:43:41.768578 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.staging_transactions ................. [[31mERROR[0m in 52.57s]
[0m15:43:41.772325 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m15:43:41.779897 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:41.782193 [debug] [MainThread]: On master: BEGIN
[0m15:43:41.785785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:41.797374 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dw" (172.18.0.3), port 5432 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m15:43:41.803916 [debug] [MainThread]: Postgres adapter: Error running SQL: BEGIN
[0m15:43:41.806657 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m15:43:41.808811 [info ] [MainThread]: Database error while running on-run-end
[0m15:43:41.811229 [debug] [MainThread]: On master: No close available on handle
[0m15:43:41.813978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:41.816765 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m15:43:41.819979 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m15:43:41.829737 [info ] [MainThread]: 
[0m15:43:41.835321 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 53.03 seconds (53.03s).
[0m15:43:41.844263 [debug] [MainThread]: Command end result
[0m15:43:41.849954 [info ] [MainThread]: 
[0m15:43:41.855969 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:43:41.863100 [info ] [MainThread]: 
[0m15:43:41.872895 [error] [MainThread]:   Database Error in model staging_transactions (models/staging/staging_transactions.sql)
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled code at target/run/dbtcomp/models/staging/staging_transactions.sql
[0m15:43:41.879827 [info ] [MainThread]: 
[0m15:43:41.883063 [error] [MainThread]:   on-run-end failed, error:
 connection to server at "dw" (172.18.0.3), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m15:43:41.889691 [info ] [MainThread]: 
[0m15:43:41.894832 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:33:56.235833 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:33:56.275306 | 40c6147e-4b87-4ea6-bbbb-36e2aeaccffa ==============================
[0m16:33:56.275306 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:33:56.278617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:33:56.801975 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m16:33:56.813199 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m16:33:56.981701 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0qp8t2zo'
[0m16:33:56.985836 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m16:33:56.993728 [debug] [MainThread]: Creating symlink to local dependency.
[0m16:33:57.003964 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m16:33:57.012792 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0332844, "process_user_time": 4.105738, "process_kernel_time": 0.52903, "process_mem_max_rss": "108048", "process_in_blocks": "712", "process_out_blocks": "8"}
[0m16:33:57.023630 [debug] [MainThread]: Command `dbt deps` succeeded at 16:33:57.023121 after 1.04 seconds
[0m16:33:57.028765 [debug] [MainThread]: Flushing usage events
[0m16:34:03.396946 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:34:03.408888 | fc977685-77db-47e0-95dc-9dfd07dd9593 ==============================
[0m16:34:03.408888 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:34:03.411225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:04.033979 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:34:04.097072 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m16:34:04.597502 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:34:04.599671 [debug] [MainThread]: previous checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, current checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44
[0m16:34:15.820836 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:34:15.828673 [info ] [MainThread]: 
[0m16:34:15.831613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:34:15.835501 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:34:15.961145 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:34:15.963854 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:34:15.966112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:16.004025 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.038 seconds
[0m16:34:16.009517 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:34:16.013651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m16:34:16.017917 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m16:34:16.037233 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m16:34:16.039762 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m16:34:16.042601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:16.062410 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m16:34:16.066316 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m16:34:16.069250 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m16:34:16.073968 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m16:34:16.079257 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m16:34:16.082679 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m16:34:16.085248 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m16:34:16.090581 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m16:34:16.093539 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m16:34:16.115799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m16:34:16.117885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m16:34:16.138233 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:34:16.146557 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:34:16.148611 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:34:16.151008 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:34:16.153361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:16.155734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:16.169617 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m16:34:16.172574 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:34:16.176628 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m16:34:16.178472 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:34:16.181804 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:34:16.186605 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:34:16.194958 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m16:34:16.196425 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:34:16.200148 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:34:16.204068 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:34:16.207650 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:34:16.210757 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:34:16.236761 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:16.239865 [debug] [MainThread]: On master: BEGIN
[0m16:34:16.242830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:16.261460 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:34:16.264604 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:16.268072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:34:16.281795 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m16:34:16.286619 [debug] [MainThread]: On master: ROLLBACK
[0m16:34:16.289450 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:16.292358 [debug] [MainThread]: On master: BEGIN
[0m16:34:16.295994 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:34:16.300481 [debug] [MainThread]: On master: COMMIT
[0m16:34:16.303902 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:16.306834 [debug] [MainThread]: On master: COMMIT
[0m16:34:16.310325 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:34:16.313260 [debug] [MainThread]: On master: Close
[0m16:34:16.317058 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:34:16.319933 [info ] [MainThread]: 
[0m16:34:16.337551 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m16:34:16.340170 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m16:34:16.342330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now seed.dbtcomp.geography)
[0m16:34:16.344080 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m16:34:16.346050 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m16:34:16.437474 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m16:34:16.440117 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m16:34:16.442803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:16.458490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:34:16.462132 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m16:34:16.465420 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m16:34:16.471188 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m16:34:16.774394 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m16:34:16.777054 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m16:34:16.781035 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.002 seconds
[0m16:34:16.795584 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m16:34:16.852506 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m16:34:16.854794 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m16:34:16.857024 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m16:34:16.862254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:34:16.867053 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m16:34:16.871972 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.53s]
[0m16:34:16.874749 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m16:34:16.879461 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:16.881668 [debug] [MainThread]: On master: BEGIN
[0m16:34:16.883703 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:16.895714 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:34:16.898494 [debug] [MainThread]: On master: COMMIT
[0m16:34:16.900629 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:16.902975 [debug] [MainThread]: On master: COMMIT
[0m16:34:16.905600 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:34:16.908134 [debug] [MainThread]: On master: Close
[0m16:34:16.911075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:16.913202 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m16:34:16.914703 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m16:34:16.916391 [info ] [MainThread]: 
[0m16:34:16.918520 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m16:34:16.921066 [debug] [MainThread]: Command end result
[0m16:34:17.045062 [info ] [MainThread]: 
[0m16:34:17.047380 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:34:17.049331 [info ] [MainThread]: 
[0m16:34:17.051221 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:34:17.055053 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 13.86229, "process_user_time": 14.395715, "process_kernel_time": 0.370404, "process_mem_max_rss": "121752", "process_in_blocks": "440", "process_out_blocks": "0"}
[0m16:34:17.058100 [debug] [MainThread]: Command `dbt seed` succeeded at 16:34:17.057730 after 13.87 seconds
[0m16:34:17.061038 [debug] [MainThread]: Flushing usage events
[0m16:35:19.512334 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:35:19.532753 | dafcfa05-256e-4492-a1fe-21505ef3b9d7 ==============================
[0m16:35:19.532753 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:19.535796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:35:19.814883 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:35:19.892056 | be1a81e4-da7e-4899-a783-5f955dea8098 ==============================
[0m16:35:19.892056 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:19.896661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:35:20.202067 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:20.447236 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:35:20.706211 | 23183564-714b-4f0c-9a05-fc8233ee6486 ==============================
[0m16:35:20.706211 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:20.732404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:35:20.801908 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:20.841745 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:21.341389 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m16:35:21.351326 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:35:21.353845 | 1bad4be5-c27c-4011-8be1-abc092ea0887 ==============================
[0m16:35:21.353845 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:21.377471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'send_anonymous_usage_stats': 'True'}


============================== 16:35:21.379003 | 56992736-e81f-4567-91b8-54800f0f19d0 ==============================
[0m16:35:21.379003 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:21.381758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:35:21.422162 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:21.809821 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:35:21.826418 | ee726987-715b-41f4-baff-c4615a8128d8 ==============================
[0m16:35:21.826418 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:21.828853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:35:21.964095 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:35:21.967488 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m16:35:22.085859 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:35:22.087958 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m16:35:22.131834 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:22.146078 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:35:22.185837 | 6aaa018e-0128-4022-9834-670b7a4ef29c ==============================
[0m16:35:22.185837 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:22.190321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m16:35:22.192580 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:22.239177 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:22.289636 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:22.322188 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:22.724794 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:23.004039 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:23.096829 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:23.721746 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:35:23.820521 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m16:35:23.946432 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:35:24.021703 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:24.003622 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m16:35:24.148456 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:35:24.210169 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:35:24.350859 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m16:35:24.365903 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m16:35:24.540267 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:25.278687 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:35:25.281281 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m16:35:30.905597 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:35:30.912725 [info ] [MainThread]: 
[0m16:35:30.916507 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:35:30.920111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:35:31.215122 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:35:31.219894 [info ] [MainThread]: 
[0m16:35:31.223310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:35:31.225058 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:35:31.229930 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:35:31.230013 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:35:31.232515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:31.274098 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.042 seconds
[0m16:35:31.279050 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:35:31.282240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m16:35:31.285164 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m16:35:31.301662 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m16:35:31.304169 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m16:35:31.306952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:31.330285 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m16:35:31.333908 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m16:35:31.337305 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m16:35:31.350215 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:35:31.688520 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:35:31.688782 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m16:35:31.690503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:31.692017 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m16:35:31.694142 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m16:35:31.695986 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m16:35:31.766310 [debug] [ThreadPool]: SQL status: COMMIT in 0.068 seconds
[0m16:35:31.801750 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m16:35:31.978216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m16:35:32.255564 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:32.279562 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:35:32.293296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:32.271585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:35:32.319785 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:32.392979 [debug] [ThreadPool]: SQL status: BEGIN in 0.099 seconds
[0m16:35:32.405327 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:35:32.409836 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:32.418876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:32.421834 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:35:32.576360 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.886 seconds
[0m16:35:32.580799 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.140 seconds
[0m16:35:32.654406 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:35:32.656354 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:35:32.701050 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:35:32.714383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m16:35:32.757983 [debug] [ThreadPool]: SQL status: BEGIN in 0.339 seconds
[0m16:35:32.759874 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:32.761627 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:35:32.715836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m16:35:32.816775 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.053 seconds
[0m16:35:32.824772 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:35:32.827789 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:35:32.829449 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:35:32.828864 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:35:32.780123 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:32.835999 [info ] [MainThread]: 
[0m16:35:32.837015 [info ] [MainThread]: 
[0m16:35:32.845475 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:35:32.846698 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:35:32.832737 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:32.852727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:35:32.859156 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:35:32.862215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:32.862378 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:32.863835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:35:32.838834 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:35:32.867465 [debug] [MainThread]: On master: BEGIN
[0m16:35:32.869960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:32.875275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:33.233323 [debug] [MainThread]: SQL status: BEGIN in 0.358 seconds
[0m16:35:33.236002 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:33.240150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:35:33.009897 [debug] [ThreadPool]: SQL status: BEGIN in 0.140 seconds
[0m16:35:33.349743 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:35:33.393729 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:33.245026 [debug] [ThreadPool]: SQL status: BEGIN in 0.383 seconds
[0m16:35:33.574231 [debug] [MainThread]: SQL status: SELECT 0 in 0.331 seconds
[0m16:35:33.543454 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:35:33.396014 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:35:33.655841 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:33.670268 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:33.670421 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:35:33.671524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:33.395305 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:35:33.674788 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:33.674602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:33.680079 [debug] [MainThread]: On master: BEGIN
[0m16:35:33.672109 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:35:33.683895 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:35:33.754192 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.079 seconds
[0m16:35:33.767680 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:35:33.773325 [debug] [MainThread]: On master: COMMIT
[0m16:35:33.894217 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.159 seconds
[0m16:35:33.937426 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:35:33.894837 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:35:33.916195 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:33.942881 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:35:34.013903 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:34.015656 [debug] [MainThread]: On master: BEGIN
[0m16:35:34.017357 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:33.972208 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.301 seconds
[0m16:35:34.002385 [debug] [MainThread]: On master: COMMIT
[0m16:35:34.062220 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m16:35:34.049285 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:35:34.064112 [debug] [MainThread]: On master: Close
[0m16:35:34.075228 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:34.076821 [info ] [MainThread]: 
[0m16:35:34.073008 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.398 seconds
[0m16:35:34.168999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m16:35:34.199819 [debug] [MainThread]: SQL status: BEGIN in 0.182 seconds
[0m16:35:34.226674 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:34.226936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m16:35:34.232638 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:35:34.170850 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:35:34.231384 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:34.262122 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:35:34.275762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:34.260614 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:34.279569 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:35:34.281111 [debug] [MainThread]: SQL status: SELECT 0 in 0.034 seconds
[0m16:35:34.281990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:34.284611 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:34.286542 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m16:35:34.282539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m16:35:34.289136 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m16:35:34.291487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m16:35:34.293006 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m16:35:34.288309 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:34.313376 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m16:35:34.314780 [debug] [MainThread]: On master: BEGIN
[0m16:35:34.297585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:35:34.337084 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m16:35:34.334032 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m16:35:34.365462 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:34.366031 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:35:34.361879 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:34.377770 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:35:34.344929 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:34.372632 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:35:34.377069 [debug] [MainThread]: On master: COMMIT
[0m16:35:34.374052 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:34.382552 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:34.388196 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:35:34.423152 [debug] [MainThread]: On master: COMMIT
[0m16:35:34.383258 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:35:34.425693 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:35:34.426216 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:35:34.423290 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:35:34.429046 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:35:34.429670 [debug] [MainThread]: On master: Close
[0m16:35:34.425775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:34.429754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:34.433206 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:34.438369 [info ] [MainThread]: 
[0m16:35:34.441857 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:35:34.443722 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:35:34.451971 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m16:35:34.452823 [info ] [MainThread]: 
[0m16:35:34.454541 [info ] [MainThread]: 
[0m16:35:34.455400 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:34.458740 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:35:34.458114 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:35:34.457449 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m16:35:34.464266 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:35:34.464834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:35:34.459924 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:35:34.463524 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:34.473175 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.091 seconds
[0m16:35:34.476392 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:35:34.480847 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:35:34.486103 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m16:35:34.485904 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:35:34.497928 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m16:35:34.493259 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m16:35:34.502032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_resellers)
[0m16:35:34.503510 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:35:34.506965 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m16:35:34.508846 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:35:34.519104 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m16:35:34.521031 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:34.530141 [debug] [MainThread]: On master: BEGIN
[0m16:35:34.531967 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.059 seconds
[0m16:35:34.532969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:34.537685 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:35:34.541573 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:35:34.552232 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m16:35:34.559607 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m16:35:34.589695 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:34.587371 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:34.598228 [debug] [MainThread]: On master: BEGIN
[0m16:35:34.599683 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:35:34.603463 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:34.616784 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m16:35:34.622388 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:34.626215 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:34.629507 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m16:35:34.631086 [debug] [MainThread]: On master: BEGIN
[0m16:35:34.635043 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:34.636073 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:35:34.639191 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:35:34.640108 [debug] [MainThread]: On master: COMMIT
[0m16:35:34.644379 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:34.649725 [debug] [MainThread]: On master: COMMIT
[0m16:35:34.654320 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m16:35:34.654345 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:35:34.665091 [debug] [MainThread]: On master: Close
[0m16:35:34.666491 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:34.667982 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:34.669785 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:34.671104 [info ] [MainThread]: 
[0m16:35:34.672632 [debug] [MainThread]: On master: BEGIN
[0m16:35:34.677023 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:35:34.678433 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:35:34.681384 [debug] [MainThread]: On master: COMMIT
[0m16:35:34.682068 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:35:34.684725 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:34.685174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:34.688274 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m16:35:34.687862 [debug] [MainThread]: On master: COMMIT
[0m16:35:34.696775 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:35:34.700064 [debug] [MainThread]: On master: Close
[0m16:35:34.704005 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:34.710184 [info ] [MainThread]: 
[0m16:35:34.717744 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m16:35:34.726974 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:35:34.730303 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:35:34.733579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:34.730244 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m16:35:34.734693 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.049 seconds
[0m16:35:34.738025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m16:35:34.741058 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:35:34.743491 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m16:35:34.765614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m16:35:34.771300 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.038 seconds
[0m16:35:34.781360 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:35:34.782925 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m16:35:34.767969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m16:35:34.784310 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m16:35:34.811449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m16:35:34.811709 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:34.819341 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:35:34.822610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:34.817239 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:34.828715 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:35:34.831101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:34.813293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m16:35:34.841911 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m16:35:34.845741 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:34.856869 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:35:34.854998 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:34.859549 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m16:35:34.858598 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:34.860478 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:35:34.862425 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:35:34.864605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:34.867942 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m16:35:34.866853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:34.876901 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m16:35:34.869638 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m16:35:34.880262 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m16:35:34.878132 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:35:34.885197 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m16:35:34.885679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_date)
[0m16:35:34.887745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:34.891433 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m16:35:34.892506 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m16:35:34.895803 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m16:35:34.898901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:34.890387 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:34.908335 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:35:34.915916 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:35:34.918300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m16:35:34.917793 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:35:34.928461 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m16:35:34.924377 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:34.929915 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:34.931937 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m16:35:34.920952 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m16:35:34.932821 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:35:34.935782 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m16:35:34.944240 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:35:34.944468 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:35:34.947975 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:35:34.936155 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:35:34.968611 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m16:35:34.971199 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m16:35:34.975568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:35:34.996111 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m16:35:35.005297 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m16:35:35.013319 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m16:35:35.015281 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m16:35:35.016899 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m16:35:35.040219 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m16:35:35.042945 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m16:35:35.045043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:35.052196 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.087 seconds
[0m16:35:35.057426 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:35:35.059778 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:35:35.053983 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m16:35:35.085651 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m16:35:35.087270 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.227 seconds
[0m16:35:35.091865 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:35:35.094698 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:35:35.095589 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.155 seconds
[0m16:35:35.098443 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m16:35:35.100611 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:35:35.102116 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m16:35:35.103797 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:35:35.111755 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m16:35:35.113556 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m16:35:35.114256 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:35.117284 [debug] [MainThread]: On master: BEGIN
[0m16:35:35.120092 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:35.122562 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m16:35:35.128562 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:35.128794 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.62s]
[0m16:35:35.131119 [debug] [MainThread]: On master: BEGIN
[0m16:35:35.131951 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m16:35:35.133964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:35.136038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.248 seconds
[0m16:35:35.139791 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m16:35:35.140324 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m16:35:35.141724 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:35.143064 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:35.143741 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT id AS geographykey, id AS original_id , cityname, countryname, regionname
       -- fill code here 
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m16:35:35.144799 [debug] [MainThread]: On master: BEGIN
[0m16:35:35.146146 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:35:35.147675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:35.149612 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m16:35:35.153116 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m16:35:35.156645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:35.158516 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m16:35:35.161039 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:35.163497 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:35:35.169116 [debug] [Thread-1 (]: SQL status: BEGIN in 0.124 seconds
[0m16:35:35.172340 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m16:35:35.174750 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m16:35:35.179476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m16:35:35.182329 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m16:35:35.185431 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m16:35:35.306675 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.160 seconds
[0m16:35:35.329854 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m16:35:35.331800 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m16:35:35.333994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:35:35.337730 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.161 seconds
[0m16:35:35.351401 [debug] [MainThread]: SQL status: SELECT 1 in 0.185 seconds
[0m16:35:35.359733 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m16:35:35.363543 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m16:35:35.365047 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:35.366430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:35:35.366356 [debug] [MainThread]: SQL status: SELECT 1 in 0.217 seconds
[0m16:35:35.367713 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:35.371046 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:35.369371 [debug] [MainThread]: On master: BEGIN
[0m16:35:35.374959 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:35.377046 [debug] [MainThread]: On master: BEGIN
[0m16:35:35.377702 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:35:35.379641 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:35:35.380773 [debug] [MainThread]: On master: COMMIT
[0m16:35:35.382683 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:35.381592 [debug] [MainThread]: On master: COMMIT
[0m16:35:35.388810 [debug] [MainThread]: On master: COMMIT
[0m16:35:35.391496 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:35.391691 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:35:35.393614 [debug] [MainThread]: On master: COMMIT
[0m16:35:35.393694 [debug] [MainThread]: On master: Close
[0m16:35:35.397068 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:35:35.400640 [debug] [MainThread]: On master: Close
[0m16:35:35.400899 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:35.403932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:35.405280 [info ] [MainThread]: 
[0m16:35:35.404694 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:35:35.407869 [info ] [MainThread]: 
[0m16:35:35.409175 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m16:35:35.412135 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m16:35:35.415537 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m16:35:35.413679 [info ] [MainThread]: 
[0m16:35:35.425283 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m16:35:35.435000 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m16:35:35.435243 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m16:35:35.437476 [debug] [MainThread]: SQL status: BEGIN in 0.290 seconds
[0m16:35:35.443866 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m16:35:35.435379 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:35:35.450572 [debug] [MainThread]: On master: COMMIT
[0m16:35:35.451103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_channels)
[0m16:35:35.448577 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m16:35:35.453163 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:35.453999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:35:35.456192 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m16:35:35.457107 [debug] [MainThread]: On master: COMMIT
[0m16:35:35.457898 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m16:35:35.461312 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m16:35:35.460014 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:35:35.465503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_customers)
[0m16:35:35.465331 [debug] [MainThread]: On master: Close
[0m16:35:35.468697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:35.468490 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m16:35:35.471112 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m16:35:35.474665 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m16:35:35.478193 [info ] [MainThread]: 
[0m16:35:35.481066 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m16:35:35.484496 [debug] [MainThread]: Command end result
[0m16:35:35.485264 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m16:35:35.486795 [info ] [MainThread]: 
[0m16:35:35.493251 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:35.502183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m16:35:35.498448 [info ] [MainThread]: 
[0m16:35:35.533666 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:35:35.537551 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.386744, "process_user_time": 13.735177, "process_kernel_time": 4.2555, "process_mem_max_rss": "117628", "process_in_blocks": "48", "process_out_blocks": "0"}
[0m16:35:35.540302 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:35.540018 after 16.39 seconds
[0m16:35:35.542425 [debug] [MainThread]: Flushing usage events
[0m16:35:35.564677 [debug] [Thread-1 (]: SQL status: COMMIT in 0.130 seconds
[0m16:35:35.571607 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m16:35:35.575024 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m16:35:35.583044 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:35:35.584663 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m16:35:35.585371 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:35:35.587316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:35.597515 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m16:35:35.599592 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m16:35:35.644626 [debug] [Thread-1 (]: SQL status: COMMIT in 0.189 seconds
[0m16:35:35.662181 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m16:35:35.709244 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m16:35:35.713268 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m16:35:35.721052 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m16:35:35.723832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:35.736704 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m16:35:35.605661 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:35:35.758624 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m16:35:35.763313 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:35:35.782608 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m16:35:35.781919 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m16:35:35.795994 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m16:35:35.801968 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 1.06s]
[0m16:35:35.801971 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 1.51s]
[0m16:35:35.805610 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m16:35:35.808029 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m16:35:35.815435 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:35.817099 [debug] [MainThread]: On master: BEGIN
[0m16:35:35.818369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:35.825122 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m16:35:35.827920 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m16:35:35.829776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:35.831376 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:35.833334 [debug] [MainThread]: On master: BEGIN
[0m16:35:35.834866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:35.881296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m16:35:35.929181 [debug] [Thread-1 (]: SQL status: BEGIN in 0.205 seconds
[0m16:35:35.970254 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m16:35:35.970580 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m16:35:35.973753 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m16:35:35.975219 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m16:35:35.998314 [debug] [MainThread]: SQL status: BEGIN in 0.163 seconds
[0m16:35:36.022133 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.435 seconds
[0m16:35:36.031569 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m16:35:36.033478 [debug] [MainThread]: On master: COMMIT
[0m16:35:36.241509 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:35:36.260277 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.281 seconds
[0m16:35:36.338253 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.350908 [debug] [MainThread]: SQL status: BEGIN in 0.532 seconds
[0m16:35:36.355958 [debug] [MainThread]: On master: COMMIT
[0m16:35:36.356779 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m16:35:36.358706 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.359559 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m16:35:36.360926 [debug] [MainThread]: On master: COMMIT
[0m16:35:36.362430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:35:36.362833 [debug] [MainThread]: On master: COMMIT
[0m16:35:36.363289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:35:36.365789 [debug] [MainThread]: On master: Close
[0m16:35:36.365690 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:35:36.367184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m16:35:36.368905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:36.368693 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m16:35:36.371316 [debug] [MainThread]: On master: Close
[0m16:35:36.373720 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m16:35:36.375453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:36.377090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:35:36.378341 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m16:35:36.380509 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m16:35:36.372875 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m16:35:36.383777 [info ] [MainThread]: 
[0m16:35:36.385228 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m16:35:36.388739 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.47 seconds (5.47s).
[0m16:35:36.369289 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:35:36.393536 [debug] [MainThread]: Command end result
[0m16:35:36.392430 [info ] [MainThread]: 
[0m16:35:36.396399 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m16:35:36.395945 [info ] [MainThread]: 
[0m16:35:36.401339 [debug] [MainThread]: Command end result
[0m16:35:36.401800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:36.394792 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:36.404473 [info ] [MainThread]: 
[0m16:35:36.404518 [info ] [MainThread]: 
[0m16:35:36.403793 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:36.407807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:36.407591 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:35:36.407299 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:35:36.410622 [info ] [MainThread]: 
[0m16:35:36.411747 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.852295, "process_user_time": 14.561299, "process_kernel_time": 4.177595, "process_mem_max_rss": "121720", "process_in_blocks": "192", "process_out_blocks": "0"}
[0m16:35:36.410376 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:35:36.414785 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:35:36.415677 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:36.415300 after 16.86 seconds
[0m16:35:36.413198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:36.418005 [debug] [MainThread]: Flushing usage events
[0m16:35:36.418568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.309752, "process_user_time": 15.275414, "process_kernel_time": 5.251663, "process_mem_max_rss": "119432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:35:36.416208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:36.423033 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:36.422627 after 16.31 seconds
[0m16:35:36.425825 [debug] [MainThread]: Flushing usage events
[0m16:35:36.427693 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m16:35:36.430621 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m16:35:36.433239 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m16:35:36.435626 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m16:35:36.438408 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:35:36.442347 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m16:35:36.441923 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:35:36.445507 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m16:35:36.449433 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m16:35:36.450714 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m16:35:36.453765 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:35:36.455401 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m16:35:36.456034 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m16:35:36.457993 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:35:36.463797 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:35:36.467263 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m16:35:36.472873 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:35:36.478044 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m16:35:36.477855 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m16:35:36.487045 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:35:36.492674 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:35:36.505182 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m16:35:36.504892 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m16:35:36.509030 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m16:35:36.512806 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:35:36.518044 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.522956 [debug] [MainThread]: On master: BEGIN
[0m16:35:36.523274 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m16:35:36.525911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:36.527024 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m16:35:36.530095 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m16:35:36.530783 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 1.08s]
[0m16:35:36.533682 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:35:36.534319 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m16:35:36.541286 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.542855 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m16:35:36.544427 [debug] [MainThread]: On master: BEGIN
[0m16:35:36.544835 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:35:36.547356 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:36.547637 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.549873 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 1.08s]
[0m16:35:36.550572 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:35:36.553718 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m16:35:36.559913 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.562896 [debug] [MainThread]: On master: BEGIN
[0m16:35:36.564248 [debug] [MainThread]: SQL status: SELECT 4 in 0.009 seconds
[0m16:35:36.565629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:36.568426 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m16:35:36.571476 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:36.573999 [debug] [MainThread]: On master: COMMIT
[0m16:35:36.576677 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.577631 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.579710 [debug] [MainThread]: On master: BEGIN
[0m16:35:36.580304 [debug] [MainThread]: On master: COMMIT
[0m16:35:36.583233 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:35:36.582961 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:35:36.586692 [debug] [MainThread]: On master: COMMIT
[0m16:35:36.588195 [debug] [MainThread]: On master: Close
[0m16:35:36.589900 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.591737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:36.592587 [debug] [MainThread]: On master: COMMIT
[0m16:35:36.595157 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m16:35:36.596271 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:35:36.598198 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m16:35:36.599001 [debug] [MainThread]: On master: Close
[0m16:35:36.601158 [info ] [MainThread]: 
[0m16:35:36.602724 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:36.606422 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m16:35:36.606526 [info ] [MainThread]: 
[0m16:35:36.610644 [debug] [MainThread]: Command end result
[0m16:35:36.612877 [info ] [MainThread]: 
[0m16:35:36.616273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:36.618222 [info ] [MainThread]: 
[0m16:35:36.620982 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:35:36.623940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.86007, "process_user_time": 15.528189, "process_kernel_time": 5.608644, "process_mem_max_rss": "119692", "process_in_blocks": "16", "process_out_blocks": "0"}
[0m16:35:36.626801 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:36.626524 after 15.86 seconds
[0m16:35:36.628608 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m16:35:36.629285 [debug] [MainThread]: Flushing usage events
[0m16:35:36.631734 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m16:35:36.634772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m16:35:36.637820 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m16:35:36.662842 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m16:35:36.697036 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m16:35:36.702452 [debug] [MainThread]: SQL status: BEGIN in 0.137 seconds
[0m16:35:36.708495 [debug] [MainThread]: On master: COMMIT
[0m16:35:36.712922 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:36.715717 [debug] [MainThread]: On master: COMMIT
[0m16:35:36.718661 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:35:36.721798 [debug] [MainThread]: On master: Close
[0m16:35:36.725826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:36.728361 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m16:35:36.730739 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m16:35:36.733000 [info ] [MainThread]: 
[0m16:35:36.736313 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m16:35:36.741032 [debug] [MainThread]: Command end result
[0m16:35:36.743723 [info ] [MainThread]: 
[0m16:35:36.746607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:36.749730 [info ] [MainThread]: 
[0m16:35:36.753763 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:35:36.759367 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.99545, "process_user_time": 16.049217, "process_kernel_time": 6.409671, "process_mem_max_rss": "117440", "process_in_blocks": "136", "process_out_blocks": "0"}
[0m16:35:36.762955 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:36.762596 after 16.00 seconds
[0m16:35:36.765718 [debug] [MainThread]: Flushing usage events
[0m16:35:36.830999 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m16:35:36.852526 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m16:35:36.855869 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m16:35:36.858814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:36.877997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m16:35:36.880952 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m16:35:36.884257 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m16:35:36.890517 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:35:36.918907 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m16:35:36.924579 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m16:35:36.928754 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:35:36.958426 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 1.770 seconds
[0m16:35:36.979447 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m16:35:36.981502 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m16:35:36.982343 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m16:35:36.983935 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m16:35:36.984879 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m16:35:36.988011 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:35:37.007767 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m16:35:37.033613 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m16:35:37.054562 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m16:35:37.058466 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m16:35:37.061867 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m16:35:37.061587 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m16:35:37.064693 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m16:35:37.067180 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:35:37.068549 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:35:37.079841 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m16:35:37.088446 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.45s]
[0m16:35:37.090254 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m16:35:37.093244 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m16:35:37.098883 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:37.102202 [debug] [MainThread]: On master: BEGIN
[0m16:35:37.105481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:37.106864 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m16:35:37.110956 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m16:35:37.114281 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m16:35:37.123681 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:35:37.122184 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m16:35:37.128382 [debug] [MainThread]: On master: COMMIT
[0m16:35:37.131298 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:37.134537 [debug] [MainThread]: On master: COMMIT
[0m16:35:37.134866 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 2.24s]
[0m16:35:37.138324 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:35:37.141443 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m16:35:37.142761 [debug] [MainThread]: On master: Close
[0m16:35:37.145693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:37.147321 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:37.148077 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m16:35:37.150023 [debug] [MainThread]: On master: BEGIN
[0m16:35:37.150401 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m16:35:37.153243 [info ] [MainThread]: 
[0m16:35:37.153152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:37.156695 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m16:35:37.162230 [debug] [MainThread]: Command end result
[0m16:35:37.165018 [info ] [MainThread]: 
[0m16:35:37.167838 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:37.175418 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m16:35:37.172126 [info ] [MainThread]: 
[0m16:35:37.179945 [debug] [MainThread]: On master: COMMIT
[0m16:35:37.180320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:35:37.183103 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:37.186686 [debug] [MainThread]: On master: COMMIT
[0m16:35:37.185157 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.260519, "process_user_time": 16.112488, "process_kernel_time": 4.752804, "process_mem_max_rss": "121476", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:35:37.191802 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:37.191292 after 15.27 seconds
[0m16:35:37.191480 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:35:37.195278 [debug] [MainThread]: Flushing usage events
[0m16:35:37.195784 [debug] [MainThread]: On master: Close
[0m16:35:37.198633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:37.201420 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m16:35:37.204283 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m16:35:37.209194 [info ] [MainThread]: 
[0m16:35:37.212048 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.36 seconds (4.36s).
[0m16:35:37.216079 [debug] [MainThread]: Command end result
[0m16:35:37.218463 [info ] [MainThread]: 
[0m16:35:37.221773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:37.224915 [info ] [MainThread]: 
[0m16:35:37.227497 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:35:37.231544 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.636478, "process_user_time": 15.381171, "process_kernel_time": 5.145785, "process_mem_max_rss": "119364", "process_in_blocks": "32", "process_out_blocks": "0"}
[0m16:35:37.234887 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:37.234396 after 15.64 seconds
[0m16:35:37.238738 [debug] [MainThread]: Flushing usage events
[0m16:35:51.112597 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:35:51.782977 | bb053ee4-85ab-49b7-b054-7e9668034572 ==============================
[0m16:35:51.782977 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:51.787828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:35:52.213802 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:35:52.230511 | 9a48e359-e6ed-47e3-b6be-f700c18cfc9b ==============================
[0m16:35:52.230511 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:52.233881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:35:52.173172 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:35:52.256667 | 1e74a244-82bd-4bde-926d-5122d9597d03 ==============================
[0m16:35:52.256667 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:52.262688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:35:52.266330 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:35:52.343756 | c48ea12f-c0bd-4c6f-952d-4acc62b7b782 ==============================
[0m16:35:52.343756 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:52.383622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:35:52.332528 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:35:52.555365 | c29ab5db-f9ef-414d-9b17-a8d51b8e8232 ==============================
[0m16:35:52.555365 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:52.562257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'send_anonymous_usage_stats': 'True'}
[0m16:35:52.502722 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:35:52.841506 | 0e0643bc-f781-425d-aec3-1472d13fe5d8 ==============================
[0m16:35:52.841506 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:52.846113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:35:52.885305 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:35:53.212094 | e88ed897-ca48-49f3-a28a-677bf03b119f ==============================
[0m16:35:53.212094 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:52.877773 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m16:35:53.350244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 16:35:53.373828 | 4d54abe1-b897-48c8-a8a9-60aada0babb8 ==============================
[0m16:35:53.373828 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:53.379119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'send_anonymous_usage_stats': 'True'}
[0m16:35:53.881137 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:54.227354 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:54.758055 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:54.945840 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:55.430788 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:55.545870 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:56.068088 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:56.091710 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:56.116282 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:55.962821 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m16:35:56.181682 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m16:35:56.170034 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2


============================== 16:35:56.467336 | d176d4a3-d4af-4ced-aede-336d8a618468 ==============================
[0m16:35:56.467336 [info ] [MainThread]: Running with dbt=1.8.2


============================== 16:35:56.467131 | f234a122-03c8-4512-a95b-c29ede44261e ==============================
[0m16:35:56.467131 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:35:57.103515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:35:57.289610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:35:57.565775 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:57.721327 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:57.538021 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:57.864728 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:57.855965 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:57.872973 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:58.357163 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:58.798509 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:35:59.199036 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:35:59.244042 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:02.413413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:02.416396 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:02.435411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:02.436142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:02.438493 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:02.439432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:02.616256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:02.618868 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:02.637791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:02.641216 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:02.658673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:02.682955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:02.686490 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:02.694916 [info ] [MainThread]: 
[0m16:36:02.697406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:02.697792 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:02.733747 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:02.774193 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:36:02.773259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:02.814629 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:03.099303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:03.125864 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:03.131717 [info ] [MainThread]: 
[0m16:36:03.145605 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:03.153950 [debug] [MainThread]: Command end result
[0m16:36:03.156443 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.913591, "process_user_time": 10.98431, "process_kernel_time": 3.208899, "process_mem_max_rss": "102160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:03.158033 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:03.159671 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:03.159291 after 10.92 seconds
[0m16:36:03.102905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:03.161921 [debug] [MainThread]: Flushing usage events
[0m16:36:03.166503 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:03.173396 [info ] [MainThread]: 
[0m16:36:03.177976 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:03.185495 [debug] [MainThread]: Command end result
[0m16:36:03.188956 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.210991, "process_user_time": 8.507549, "process_kernel_time": 2.088845, "process_mem_max_rss": "102324", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:03.192910 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:03.192456 after 11.22 seconds
[0m16:36:03.195400 [debug] [MainThread]: Flushing usage events
[0m16:36:03.201816 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:03.209428 [info ] [MainThread]: 
[0m16:36:03.213719 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:03.220188 [debug] [MainThread]: Command end result
[0m16:36:03.225349 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:03.223824 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.125014, "process_user_time": 9.885802, "process_kernel_time": 3.189987, "process_mem_max_rss": "102204", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:03.235837 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:03.235430 after 11.14 seconds
[0m16:36:03.238150 [debug] [MainThread]: Flushing usage events
[0m16:36:03.276335 [info ] [MainThread]: 
[0m16:36:03.270673 [info ] [MainThread]: 
[0m16:36:03.280474 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:03.281927 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:03.333477 [debug] [MainThread]: Command end result
[0m16:36:03.315880 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:03.347484 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:36:03.347257 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:36:03.350367 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:36:03.353618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:03.336969 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.418553, "process_user_time": 9.981271, "process_kernel_time": 3.311859, "process_mem_max_rss": "102268", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:03.385382 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:03.384967 after 11.47 seconds
[0m16:36:03.387652 [debug] [MainThread]: Flushing usage events
[0m16:36:03.405244 [info ] [MainThread]: 
[0m16:36:03.443047 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:03.608316 [debug] [MainThread]: Command end result
[0m16:36:03.663314 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.685244, "process_user_time": 10.615435, "process_kernel_time": 2.606391, "process_mem_max_rss": "102152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:03.665411 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.312 seconds
[0m16:36:03.670029 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:03.672995 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:36:03.672388 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:03.668783 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:03.667911 after 11.69 seconds
[0m16:36:03.681723 [debug] [MainThread]: Flushing usage events
[0m16:36:03.684016 [info ] [MainThread]: 
[0m16:36:03.683991 [info ] [MainThread]: 
[0m16:36:03.688095 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:03.694836 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:03.700754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m16:36:03.701483 [debug] [MainThread]: Command end result
[0m16:36:03.704758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:36:03.703795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m16:36:03.708288 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 14.046071, "process_user_time": 10.827625, "process_kernel_time": 3.246503, "process_mem_max_rss": "102356", "process_in_blocks": "32", "process_out_blocks": "0"}
[0m16:36:03.716454 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:36:03.719345 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:36:03.719108 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:03.718325 after 14.06 seconds
[0m16:36:03.731047 [debug] [MainThread]: Flushing usage events
[0m16:36:03.733217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:03.768157 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:03.770889 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.038 seconds
[0m16:36:03.773214 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:03.784435 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:36:03.777261 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:36:03.784537 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:36:03.791425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:03.798490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:03.814675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m16:36:03.828065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:03.832717 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m16:36:03.841864 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:03.841452 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:03.817535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:36:03.838883 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m16:36:03.864252 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:03.866366 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:03.871650 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:36:03.854375 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:36:03.869330 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:03.870989 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:36:03.884305 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:36:03.887243 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:36:03.879509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:03.900500 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:36:03.891483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:03.898702 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m16:36:03.905431 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:36:03.904387 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:36:03.921290 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:36:03.916073 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:36:03.924389 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:36:03.930793 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:36:03.930605 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:03.935731 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:36:03.934793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:03.927643 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m16:36:03.949220 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:03.953497 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m16:36:03.961511 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:36:03.968915 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:36:03.974395 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:36:03.976996 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:03.977244 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.047 seconds
[0m16:36:03.983127 [debug] [MainThread]: On master: BEGIN
[0m16:36:03.988106 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m16:36:03.988417 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:36:03.990572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:03.994053 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:36:03.997903 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:36:04.014190 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m16:36:04.017153 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.016153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m16:36:04.023970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:04.030136 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.035068 [debug] [MainThread]: On master: BEGIN
[0m16:36:04.019878 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:36:04.040969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:04.042319 [debug] [MainThread]: SQL status: SELECT 5 in 0.013 seconds
[0m16:36:04.050794 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:04.054148 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.058272 [debug] [MainThread]: On master: BEGIN
[0m16:36:04.065451 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:36:04.070290 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m16:36:04.063170 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:04.074399 [debug] [MainThread]: On master: COMMIT
[0m16:36:04.070306 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:04.077367 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.081260 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.081728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:04.084164 [debug] [MainThread]: On master: COMMIT
[0m16:36:04.077463 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:36:04.081190 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:36:04.088087 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:04.097991 [debug] [MainThread]: On master: Close
[0m16:36:04.091102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:04.100098 [debug] [MainThread]: SQL status: SELECT 5 in 0.014 seconds
[0m16:36:04.095945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:04.102744 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:04.110759 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:04.123243 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.118886 [info ] [MainThread]: 
[0m16:36:04.122338 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m16:36:04.128093 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:04.127101 [debug] [MainThread]: On master: BEGIN
[0m16:36:04.136694 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:36:04.143021 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:36:04.150880 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:04.153329 [debug] [MainThread]: On master: COMMIT
[0m16:36:04.142143 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:36:04.161734 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m16:36:04.162412 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.154208 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:36:04.166849 [debug] [MainThread]: On master: COMMIT
[0m16:36:04.166710 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m16:36:04.172015 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:36:04.177750 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:04.181985 [debug] [MainThread]: On master: Close
[0m16:36:04.180821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m16:36:04.176463 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m16:36:04.188489 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:04.193711 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m16:36:04.182470 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:36:04.198680 [info ] [MainThread]: 
[0m16:36:04.198210 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:36:04.203136 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:36:04.206548 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:36:04.223165 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m16:36:04.229458 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m16:36:04.233476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_channels)
[0m16:36:04.236415 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m16:36:04.236918 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m16:36:04.241816 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.244732 [debug] [MainThread]: On master: BEGIN
[0m16:36:04.248536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:04.250074 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:04.261472 [info ] [MainThread]: 
[0m16:36:04.265269 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:04.277563 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m16:36:04.280956 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m16:36:04.282658 [debug] [MainThread]: Command end result
[0m16:36:04.284661 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.288643 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.629569, "process_user_time": 8.945035, "process_kernel_time": 2.374276, "process_mem_max_rss": "102028", "process_in_blocks": "16", "process_out_blocks": "0"}
[0m16:36:04.288456 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:04.294055 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:04.293022 after 10.64 seconds
[0m16:36:04.298030 [debug] [MainThread]: Flushing usage events
[0m16:36:04.301951 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m16:36:04.308047 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:04.311537 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.314741 [debug] [MainThread]: On master: BEGIN
[0m16:36:04.319759 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:36:04.324015 [debug] [MainThread]: On master: COMMIT
[0m16:36:04.327189 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.330764 [debug] [MainThread]: On master: COMMIT
[0m16:36:04.333456 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:04.336612 [debug] [MainThread]: On master: Close
[0m16:36:04.340284 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:04.343617 [info ] [MainThread]: 
[0m16:36:04.362405 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m16:36:04.366294 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m16:36:04.367069 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m16:36:04.369983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_product)
[0m16:36:04.369559 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m16:36:04.373924 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m16:36:04.404476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m16:36:04.449363 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m16:36:04.520928 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m16:36:04.524334 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m16:36:04.617312 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m16:36:04.618181 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m16:36:04.619017 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m16:36:04.620942 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m16:36:04.622880 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m16:36:04.623858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:04.626371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:04.641417 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m16:36:04.644663 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m16:36:04.645994 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m16:36:04.646327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m16:36:04.647935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:04.649176 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m16:36:04.649775 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m16:36:04.652769 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m16:36:04.653147 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m16:36:04.660281 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:36:04.661841 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:36:04.670330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m16:36:04.675290 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m16:36:04.679415 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m16:36:04.687132 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m16:36:04.690462 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m16:36:04.690909 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m16:36:04.691486 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m16:36:04.693853 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m16:36:04.695247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:36:04.698125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:36:04.717016 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m16:36:04.721882 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m16:36:04.726352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:36:04.751361 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m16:36:04.752092 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m16:36:04.754724 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m16:36:04.754487 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m16:36:04.757074 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m16:36:04.757179 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m16:36:04.762260 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:36:04.762306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:36:04.772166 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m16:36:04.774622 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m16:36:04.776563 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m16:36:04.781046 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:36:04.783443 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m16:36:04.787378 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m16:36:04.795212 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m16:36:04.797140 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m16:36:04.799540 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:36:04.800304 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m16:36:04.801720 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m16:36:04.802574 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m16:36:04.804909 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:36:04.804906 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m16:36:04.811715 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 0.57s]
[0m16:36:04.813183 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m16:36:04.813670 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m16:36:04.815432 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m16:36:04.816779 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m16:36:04.819761 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:36:04.820005 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.64s]
[0m16:36:04.820169 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.822318 [debug] [MainThread]: On master: BEGIN
[0m16:36:04.823087 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m16:36:04.824544 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:04.827898 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.827788 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m16:36:04.830047 [debug] [MainThread]: On master: BEGIN
[0m16:36:04.832555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:04.833684 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.46s]
[0m16:36:04.836387 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m16:36:04.838071 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:36:04.841278 [debug] [MainThread]: On master: COMMIT
[0m16:36:04.842012 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.843610 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.844379 [debug] [MainThread]: On master: BEGIN
[0m16:36:04.846151 [debug] [MainThread]: On master: COMMIT
[0m16:36:04.846857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:04.848912 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:04.850357 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:36:04.852456 [debug] [MainThread]: On master: Close
[0m16:36:04.853435 [debug] [MainThread]: On master: COMMIT
[0m16:36:04.855369 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.855783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:04.858043 [debug] [MainThread]: On master: COMMIT
[0m16:36:04.860053 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m16:36:04.861406 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:36:04.863455 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m16:36:04.863962 [debug] [MainThread]: On master: Close
[0m16:36:04.864888 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:36:04.866184 [info ] [MainThread]: 
[0m16:36:04.866966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:04.868405 [debug] [MainThread]: On master: COMMIT
[0m16:36:04.869019 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m16:36:04.869643 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m16:36:04.871218 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:04.871899 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m16:36:04.872741 [debug] [MainThread]: Command end result
[0m16:36:04.873802 [debug] [MainThread]: On master: COMMIT
[0m16:36:04.874530 [info ] [MainThread]: 
[0m16:36:04.875317 [info ] [MainThread]: 
[0m16:36:04.877135 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:04.877683 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m16:36:04.878443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:04.879757 [debug] [MainThread]: On master: Close
[0m16:36:04.881149 [info ] [MainThread]: 
[0m16:36:04.881068 [debug] [MainThread]: Command end result
[0m16:36:04.882493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:04.883477 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:36:04.883594 [info ] [MainThread]: 
[0m16:36:04.884914 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m16:36:04.886447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:04.886820 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.183795, "process_user_time": 11.757003, "process_kernel_time": 3.105118, "process_mem_max_rss": "112736", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:04.886976 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m16:36:04.889117 [info ] [MainThread]: 
[0m16:36:04.888912 [info ] [MainThread]: 
[0m16:36:04.889592 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:04.889201 after 11.19 seconds
[0m16:36:04.892062 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:36:04.892534 [debug] [MainThread]: Flushing usage events
[0m16:36:04.892083 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m16:36:04.895918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.4022455, "process_user_time": 10.560269, "process_kernel_time": 2.821552, "process_mem_max_rss": "113048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:04.896401 [debug] [MainThread]: Command end result
[0m16:36:04.898632 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:04.898385 after 12.41 seconds
[0m16:36:04.898356 [info ] [MainThread]: 
[0m16:36:04.900435 [debug] [MainThread]: Flushing usage events
[0m16:36:04.900511 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:04.902268 [info ] [MainThread]: 
[0m16:36:04.904343 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:36:04.908203 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.7783375, "process_user_time": 11.687175, "process_kernel_time": 3.106129, "process_mem_max_rss": "112620", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:04.911648 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:04.911345 after 12.78 seconds
[0m16:36:04.913601 [debug] [MainThread]: Flushing usage events
[0m16:36:12.376518 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m16:36:12.376775 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:36:12.394464 | 8ae2762b-11d1-45fa-9549-31a2c30dc56a ==============================
[0m16:36:12.394464 [info ] [MainThread]: Running with dbt=1.8.2


============================== 16:36:12.394901 | 771aa7f6-bfc1-4108-b23f-603c041881cf ==============================
[0m16:36:12.394901 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:12.397548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:36:12.397970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'send_anonymous_usage_stats': 'True'}
[0m16:36:12.385910 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m16:36:12.386061 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:36:12.404871 | cdedaeae-c778-4a9d-86a7-ea0f7e5f92fb ==============================
[0m16:36:12.404871 [info ] [MainThread]: Running with dbt=1.8.2


============================== 16:36:12.405037 | 8f0b4435-d363-45d3-8e3b-128b8114bbb3 ==============================
[0m16:36:12.405037 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:12.408129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:36:12.408232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:12.418183 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m16:36:12.425225 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:36:12.436978 | 6c6e29a0-8d79-47b4-9a4a-15dc6979151d ==============================
[0m16:36:12.436978 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:12.443059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 16:36:12.444866 | 13559b3d-8160-40f8-bfaa-50887d199d02 ==============================
[0m16:36:12.444866 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:12.447997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:13.158460 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:13.185814 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:13.199321 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:13.205946 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:13.242619 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:13.268412 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:13.274727 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:13.291831 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:13.304500 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:13.305141 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:13.371935 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:13.408327 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:14.753836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:14.756728 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:14.772749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:14.773064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:14.773862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:14.775453 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:14.775413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:14.776260 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:14.780734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:14.784635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:14.847166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:14.850445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:15.058839 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:15.070105 [info ] [MainThread]: 
[0m16:36:15.069291 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:15.078006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:15.083267 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:15.074480 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:15.090650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:36:15.086985 [info ] [MainThread]: 
[0m16:36:15.103418 [info ] [MainThread]: 
[0m16:36:15.103314 [info ] [MainThread]: 
[0m16:36:15.104899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:15.107243 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:15.108087 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:15.109536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:36:15.113696 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:36:15.118736 [debug] [MainThread]: Command end result
[0m16:36:15.119542 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:15.122619 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9295542, "process_user_time": 5.543382, "process_kernel_time": 0.267748, "process_mem_max_rss": "101972", "process_in_blocks": "32", "process_out_blocks": "0"}
[0m16:36:15.125857 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:15.125473 after 2.93 seconds
[0m16:36:15.125950 [info ] [MainThread]: 
[0m16:36:15.128990 [debug] [MainThread]: Flushing usage events
[0m16:36:15.128825 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:15.138805 [debug] [MainThread]: Command end result
[0m16:36:15.142372 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.943757, "process_user_time": 5.569709, "process_kernel_time": 0.279985, "process_mem_max_rss": "101976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:15.146083 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:15.145620 after 2.95 seconds
[0m16:36:15.149799 [debug] [MainThread]: Flushing usage events
[0m16:36:15.173750 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:15.179220 [info ] [MainThread]: 
[0m16:36:15.182851 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:15.192569 [debug] [MainThread]: Command end result
[0m16:36:15.196972 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9499474, "process_user_time": 5.581093, "process_kernel_time": 0.272494, "process_mem_max_rss": "102180", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:15.201393 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:15.200943 after 2.95 seconds
[0m16:36:15.204517 [debug] [MainThread]: Flushing usage events
[0m16:36:15.222762 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:36:15.225283 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:36:15.227741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:15.233556 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:36:15.236803 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:36:15.239758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:15.241333 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:36:15.244341 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:36:15.247998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:15.252432 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.025 seconds
[0m16:36:15.256864 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:36:15.262426 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.023 seconds
[0m16:36:15.268953 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:36:15.270949 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.023 seconds
[0m16:36:15.276679 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:36:15.277419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m16:36:15.289811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m16:36:15.280243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m16:36:15.305442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m16:36:15.292432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:36:15.311857 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:15.315833 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:15.318487 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:36:15.321417 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:36:15.308232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:36:15.324490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:15.327288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:15.329312 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:15.333221 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:15.336161 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:36:15.333683 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:15.339082 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:36:15.342463 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:15.345593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:15.348876 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:36:15.342400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:15.350168 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m16:36:15.345075 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:36:15.353001 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m16:36:15.352770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:15.356017 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:15.358401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:15.359782 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:15.373155 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m16:36:15.369154 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:36:15.375208 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m16:36:15.375957 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:36:15.379426 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:15.382762 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:15.390167 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m16:36:15.388263 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:36:15.392276 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m16:36:15.392649 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:36:15.400287 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:15.402259 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m16:36:15.393132 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m16:36:15.406750 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:36:15.404838 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:36:15.408586 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:15.406225 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:36:15.412405 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:36:15.414334 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:36:15.415949 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:36:15.419870 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:36:15.422239 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m16:36:15.418151 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.018 seconds
[0m16:36:15.427622 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:36:15.420421 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:36:15.428662 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:36:15.429000 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m16:36:15.433270 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:36:15.435354 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:36:15.432710 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:36:15.438588 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:36:15.444215 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:36:15.453529 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:15.456756 [debug] [MainThread]: On master: BEGIN
[0m16:36:15.459070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:15.467884 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:15.470833 [debug] [MainThread]: On master: BEGIN
[0m16:36:15.471517 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:15.474154 [debug] [MainThread]: On master: BEGIN
[0m16:36:15.473726 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:15.476310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:15.477098 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:36:15.481957 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:15.485265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:15.496137 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m16:36:15.496625 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m16:36:15.499027 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m16:36:15.500330 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:15.502530 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:15.504202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:15.505882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:15.507702 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:15.511201 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:15.515088 [debug] [MainThread]: On master: BEGIN
[0m16:36:15.518866 [debug] [MainThread]: SQL status: SELECT 9 in 0.011 seconds
[0m16:36:15.519652 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:36:15.523099 [debug] [MainThread]: On master: COMMIT
[0m16:36:15.524643 [debug] [MainThread]: SQL status: SELECT 9 in 0.015 seconds
[0m16:36:15.526001 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:15.528294 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:15.528922 [debug] [MainThread]: On master: COMMIT
[0m16:36:15.532814 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:15.532761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:15.535642 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:15.536745 [debug] [MainThread]: On master: Close
[0m16:36:15.536713 [debug] [MainThread]: On master: BEGIN
[0m16:36:15.538675 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:15.539541 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:15.539961 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:36:15.542095 [debug] [MainThread]: On master: BEGIN
[0m16:36:15.543081 [info ] [MainThread]: 
[0m16:36:15.543821 [debug] [MainThread]: On master: COMMIT
[0m16:36:15.546957 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:36:15.549268 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:15.551296 [debug] [MainThread]: On master: COMMIT
[0m16:36:15.552877 [debug] [MainThread]: On master: COMMIT
[0m16:36:15.554717 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:15.556015 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:15.557620 [debug] [MainThread]: On master: COMMIT
[0m16:36:15.558564 [debug] [MainThread]: On master: Close
[0m16:36:15.561061 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:36:15.561846 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:15.566899 [debug] [MainThread]: On master: Close
[0m16:36:15.568671 [info ] [MainThread]: 
[0m16:36:15.571023 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m16:36:15.571066 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:15.573570 [info ] [MainThread]: 
[0m16:36:15.574012 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m16:36:15.577506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m16:36:15.582036 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m16:36:15.589348 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m16:36:15.592758 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m16:36:15.593589 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m16:36:15.596360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m16:36:15.597358 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m16:36:15.600431 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m16:36:15.601828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m16:36:15.604507 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m16:36:15.614270 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m16:36:15.631065 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m16:36:15.634035 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m16:36:15.648756 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m16:36:15.649955 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m16:36:15.652191 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m16:36:15.799697 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m16:36:15.811511 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m16:36:15.810994 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m16:36:15.826029 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m16:36:15.827620 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m16:36:15.829288 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m16:36:15.830385 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m16:36:15.832318 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m16:36:15.833042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:15.834190 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m16:36:15.835620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:15.837300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:15.855226 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m16:36:15.858461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m16:36:15.863670 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m16:36:15.868377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:36:15.869290 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m16:36:15.869493 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m16:36:15.871774 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m16:36:15.873354 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select product_id AS product_key, product_id AS original_product_id, product_name, geography_key, product_price
-- fill code here 


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m16:36:15.874809 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT reseller_id AS sales_agent_key, reseller_id AS original_reseller_id, reseller_name, commission_pct
     -- fill code here 
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m16:36:15.877215 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m16:36:15.889374 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.010 seconds
[0m16:36:15.907534 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m16:36:15.909288 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.033 seconds
[0m16:36:15.910761 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m16:36:15.914600 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m16:36:15.916169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:36:15.918247 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m16:36:15.922479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:36:15.938427 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m16:36:15.942112 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m16:36:15.945977 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:36:15.987228 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m16:36:15.990158 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m16:36:15.990412 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m16:36:15.993192 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m16:36:15.993191 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m16:36:15.998263 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m16:36:16.002674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m16:36:16.005465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:36:16.019749 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m16:36:16.024100 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m16:36:16.027174 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m16:36:16.029263 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m16:36:16.035297 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:36:16.037072 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m16:36:16.053507 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m16:36:16.055591 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m16:36:16.057067 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m16:36:16.058908 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m16:36:16.063117 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:36:16.060159 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:36:16.064007 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m16:36:16.073986 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m16:36:16.075993 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m16:36:16.082424 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.48s]
[0m16:36:16.086896 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m16:36:16.087618 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.51s]
[0m16:36:16.089635 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m16:36:16.091515 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m16:36:16.093232 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:16.093375 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m16:36:16.097370 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:16.097350 [debug] [MainThread]: On master: BEGIN
[0m16:36:16.097887 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:36:16.100918 [debug] [MainThread]: On master: BEGIN
[0m16:36:16.101100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:16.103670 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:16.107427 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m16:36:16.115702 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.51s]
[0m16:36:16.118962 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m16:36:16.119391 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:36:16.121962 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:36:16.123638 [debug] [MainThread]: On master: COMMIT
[0m16:36:16.125064 [debug] [MainThread]: On master: COMMIT
[0m16:36:16.125303 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:16.126697 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:16.127681 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:16.129440 [debug] [MainThread]: On master: COMMIT
[0m16:36:16.129721 [debug] [MainThread]: On master: BEGIN
[0m16:36:16.130676 [debug] [MainThread]: On master: COMMIT
[0m16:36:16.133294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:16.133287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:16.133959 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:16.136927 [debug] [MainThread]: On master: Close
[0m16:36:16.137451 [debug] [MainThread]: On master: Close
[0m16:36:16.139916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:16.140404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:16.142727 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m16:36:16.142872 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m16:36:16.144892 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m16:36:16.144897 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m16:36:16.148366 [info ] [MainThread]: 
[0m16:36:16.148448 [info ] [MainThread]: 
[0m16:36:16.151782 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m16:36:16.151769 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m16:36:16.153375 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m16:36:16.155759 [debug] [MainThread]: Command end result
[0m16:36:16.156006 [debug] [MainThread]: Command end result
[0m16:36:16.156297 [debug] [MainThread]: On master: COMMIT
[0m16:36:16.158570 [info ] [MainThread]: 
[0m16:36:16.158690 [info ] [MainThread]: 
[0m16:36:16.159041 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:16.162494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:16.162461 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:16.164395 [debug] [MainThread]: On master: COMMIT
[0m16:36:16.166725 [info ] [MainThread]: 
[0m16:36:16.166779 [info ] [MainThread]: 
[0m16:36:16.167980 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:16.170464 [debug] [MainThread]: On master: Close
[0m16:36:16.170050 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:36:16.170036 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:36:16.173513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:16.174139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9854248, "process_user_time": 6.228659, "process_kernel_time": 0.394346, "process_mem_max_rss": "111164", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:16.174146 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9685936, "process_user_time": 6.35308, "process_kernel_time": 0.283213, "process_mem_max_rss": "112912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:16.176278 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m16:36:16.176943 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:16.176572 after 3.99 seconds
[0m16:36:16.177363 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:16.177001 after 3.97 seconds
[0m16:36:16.178952 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m16:36:16.179843 [debug] [MainThread]: Flushing usage events
[0m16:36:16.180390 [debug] [MainThread]: Flushing usage events
[0m16:36:16.182477 [info ] [MainThread]: 
[0m16:36:16.186825 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m16:36:16.190986 [debug] [MainThread]: Command end result
[0m16:36:16.193279 [info ] [MainThread]: 
[0m16:36:16.196356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:16.199117 [info ] [MainThread]: 
[0m16:36:16.202496 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:36:16.206081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9695878, "process_user_time": 6.270773, "process_kernel_time": 0.351163, "process_mem_max_rss": "112836", "process_in_blocks": "568", "process_out_blocks": "0"}
[0m16:36:16.209665 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:16.209247 after 3.97 seconds
[0m16:36:16.212951 [debug] [MainThread]: Flushing usage events
[0m16:36:21.965685 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:36:22.001152 | ba1b0b6d-f48e-4e5d-a7c8-a8fb11e9fe5e ==============================
[0m16:36:22.001152 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:22.007728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:36:21.993362 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:36:22.016759 | 276a9760-b79c-4d31-84db-b5408e733ddb ==============================
[0m16:36:22.016759 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:22.000302 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m16:36:22.019715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'send_anonymous_usage_stats': 'True'}


============================== 16:36:22.025093 | 9385cddd-597a-4572-bc77-8618308ed444 ==============================
[0m16:36:22.025093 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:22.027978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:36:22.036719 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:36:22.053208 | 3a32ea10-5b22-4dc7-bf95-31829874c527 ==============================
[0m16:36:22.053208 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:22.055617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m16:36:22.613059 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:22.616831 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:22.629691 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:22.695001 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:22.695880 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:22.720219 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:22.727454 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:22.799990 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:24.134621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:24.135305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:24.137534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:24.138175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:24.344996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:24.346259 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:24.347213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:24.352074 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:24.352207 [info ] [MainThread]: 
[0m16:36:24.355106 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:24.358078 [info ] [MainThread]: 
[0m16:36:24.359020 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:36:24.360546 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:24.367561 [debug] [MainThread]: Command end result
[0m16:36:24.371356 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.5905373, "process_user_time": 4.690186, "process_kernel_time": 0.221425, "process_mem_max_rss": "102180", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:24.374456 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:24.374168 after 2.59 seconds
[0m16:36:24.376642 [debug] [MainThread]: Flushing usage events
[0m16:36:24.479398 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:36:24.482112 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:36:24.484428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:24.501649 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.017 seconds
[0m16:36:24.505331 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:36:24.523027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m16:36:24.524787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m16:36:24.541374 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:24.549845 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:24.551977 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:36:24.554782 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:36:24.557369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:24.560247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:24.577533 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m16:36:24.579661 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m16:36:24.581843 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:24.584447 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:24.587661 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:36:24.591634 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:36:24.593949 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:24.601086 [info ] [MainThread]: 
[0m16:36:24.601150 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:36:24.604323 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:24.602578 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.006 seconds
[0m16:36:24.614192 [debug] [MainThread]: Command end result
[0m16:36:24.609259 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:36:24.617948 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.8340404, "process_user_time": 4.694099, "process_kernel_time": 0.239698, "process_mem_max_rss": "102296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:24.616961 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:36:24.621614 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:24.621118 after 2.84 seconds
[0m16:36:24.619848 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:36:24.622378 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:36:24.624563 [debug] [MainThread]: Flushing usage events
[0m16:36:24.646664 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:24.648771 [debug] [MainThread]: On master: BEGIN
[0m16:36:24.650560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:24.664335 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:36:24.667326 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:24.670553 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:24.680865 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m16:36:24.687338 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:24.690248 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:24.692734 [debug] [MainThread]: On master: BEGIN
[0m16:36:24.695212 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:36:24.697765 [debug] [MainThread]: On master: COMMIT
[0m16:36:24.701616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:24.702124 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:24.704786 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:24.705538 [debug] [MainThread]: On master: COMMIT
[0m16:36:24.708559 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:36:24.710786 [debug] [MainThread]: On master: Close
[0m16:36:24.713137 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:24.715609 [info ] [MainThread]: 
[0m16:36:24.733652 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m16:36:24.736217 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m16:36:24.738570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m16:36:24.740607 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m16:36:24.788019 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m16:36:24.803600 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m16:36:24.893718 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m16:36:24.894412 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:24.899363 [info ] [MainThread]: 
[0m16:36:24.901780 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:24.906975 [debug] [MainThread]: Command end result
[0m16:36:24.909756 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.0676107, "process_user_time": 4.712321, "process_kernel_time": 0.312997, "process_mem_max_rss": "102096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:24.911792 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:24.911573 after 3.07 seconds
[0m16:36:24.913362 [debug] [MainThread]: Flushing usage events
[0m16:36:24.924585 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m16:36:24.926652 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m16:36:24.928483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:24.943079 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:36:24.946065 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m16:36:24.949038 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m16:36:24.959625 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:36:24.979849 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m16:36:24.992346 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m16:36:24.996447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:36:25.089941 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m16:36:25.092895 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m16:36:25.094786 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m16:36:25.098917 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:36:25.114339 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m16:36:25.128964 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m16:36:25.131934 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m16:36:25.134652 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:36:25.142518 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m16:36:25.148778 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.41s]
[0m16:36:25.151945 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m16:36:25.157063 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:25.159312 [debug] [MainThread]: On master: BEGIN
[0m16:36:25.161452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:25.175639 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:36:25.177964 [debug] [MainThread]: On master: COMMIT
[0m16:36:25.179740 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:25.182124 [debug] [MainThread]: On master: COMMIT
[0m16:36:25.184832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:25.187565 [debug] [MainThread]: On master: Close
[0m16:36:25.190853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:25.192568 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m16:36:25.194031 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m16:36:25.195555 [info ] [MainThread]: 
[0m16:36:25.197170 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m16:36:25.199616 [debug] [MainThread]: Command end result
[0m16:36:25.201378 [info ] [MainThread]: 
[0m16:36:25.203573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:25.205401 [info ] [MainThread]: 
[0m16:36:25.207511 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:36:25.210015 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.421296, "process_user_time": 5.260881, "process_kernel_time": 0.286686, "process_mem_max_rss": "111232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:25.212353 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:25.212125 after 3.42 seconds
[0m16:36:25.214192 [debug] [MainThread]: Flushing usage events
[0m16:36:30.437557 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:36:30.471077 | dc7b803c-ed4c-4239-bc05-c3257f1aaacd ==============================
[0m16:36:30.471077 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:30.474401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'send_anonymous_usage_stats': 'True'}
[0m16:36:30.571129 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:36:30.589194 | 99f06532-7b7c-46d4-826e-9b04d5c7c661 ==============================
[0m16:36:30.589194 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:30.592818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:36:31.040957 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:31.113418 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:31.135430 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:31.203087 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:32.574370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:32.576396 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:32.720935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:32.722536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:32.765981 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:32.769876 [info ] [MainThread]: 
[0m16:36:32.771998 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:32.774398 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:36:32.849126 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:36:32.851596 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:36:32.853857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:32.867641 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.014 seconds
[0m16:36:32.870811 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:36:32.884527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m16:36:32.886816 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:32.890413 [info ] [MainThread]: 
[0m16:36:32.892507 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:32.897845 [debug] [MainThread]: Command end result
[0m16:36:32.885829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:36:32.900355 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.5203657, "process_user_time": 3.84262, "process_kernel_time": 0.297877, "process_mem_max_rss": "102328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:32.902548 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:32.902336 after 2.52 seconds
[0m16:36:32.904255 [debug] [MainThread]: Flushing usage events
[0m16:36:32.899513 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:32.904288 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:32.906055 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:36:32.907665 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:36:32.909117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:32.910905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:32.924208 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m16:36:32.926018 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m16:36:32.927635 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:32.930447 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:32.933213 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:36:32.935574 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:36:32.942806 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.005 seconds
[0m16:36:32.944046 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:36:32.948695 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:36:32.952961 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:36:32.955292 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:36:32.957176 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:36:32.978559 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:32.981096 [debug] [MainThread]: On master: BEGIN
[0m16:36:32.982608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:33.001665 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m16:36:33.006204 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:33.014300 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:33.028338 [debug] [MainThread]: SQL status: SELECT 12 in 0.010 seconds
[0m16:36:33.043951 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:33.049855 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:33.053608 [debug] [MainThread]: On master: BEGIN
[0m16:36:33.057189 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:36:33.064707 [debug] [MainThread]: On master: COMMIT
[0m16:36:33.068434 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:33.072759 [debug] [MainThread]: On master: COMMIT
[0m16:36:33.077169 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:33.084064 [debug] [MainThread]: On master: Close
[0m16:36:33.090683 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:33.094506 [info ] [MainThread]: 
[0m16:36:33.112874 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m16:36:33.115478 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m16:36:33.117679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m16:36:33.119539 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m16:36:33.139462 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m16:36:33.177155 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m16:36:33.275870 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m16:36:33.290927 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m16:36:33.292919 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m16:36:33.296389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:33.308236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:36:33.311505 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m16:36:33.314675 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select customer_key, customer_first_name, customer_last_name, customer_email
-- fill code here 
from "sales_dw"."dev"."staging_customers"
  );
  
[0m16:36:37.854248 [debug] [Thread-1 (]: SQL status: SELECT 259210 in 4.537 seconds
[0m16:36:37.875054 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m16:36:37.877810 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m16:36:37.881229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:36:37.938359 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m16:36:37.942146 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m16:36:37.944823 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m16:36:37.952988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:36:37.974117 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m16:36:37.986625 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m16:36:37.989206 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m16:36:37.992499 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:36:38.002533 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m16:36:38.010341 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 259210[0m in 4.89s]
[0m16:36:38.014824 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m16:36:38.020586 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:38.023610 [debug] [MainThread]: On master: BEGIN
[0m16:36:38.025871 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:38.038275 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:36:38.041386 [debug] [MainThread]: On master: COMMIT
[0m16:36:38.044664 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:38.047027 [debug] [MainThread]: On master: COMMIT
[0m16:36:38.049345 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:38.051134 [debug] [MainThread]: On master: Close
[0m16:36:38.053024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:38.055637 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m16:36:38.057844 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m16:36:38.059586 [info ] [MainThread]: 
[0m16:36:38.061315 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m16:36:38.063487 [debug] [MainThread]: Command end result
[0m16:36:38.064796 [info ] [MainThread]: 
[0m16:36:38.066286 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:38.067726 [info ] [MainThread]: 
[0m16:36:38.069277 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:36:38.071887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.778944, "process_user_time": 4.344093, "process_kernel_time": 0.264511, "process_mem_max_rss": "112820", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:38.074077 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:38.073759 after 7.78 seconds
[0m16:36:38.075892 [debug] [MainThread]: Flushing usage events
[0m16:36:43.903738 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:36:43.917422 | 35f8d050-efda-4895-936e-2bfa0a8ba3e6 ==============================
[0m16:36:43.917422 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:43.920974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'send_anonymous_usage_stats': 'True'}
[0m16:36:43.937613 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m16:36:43.938565 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:36:43.953589 | 00db8413-3d03-4a74-8e89-74989934c8cc ==============================
[0m16:36:43.953589 [info ] [MainThread]: Running with dbt=1.8.2


============================== 16:36:43.955105 | f203085c-2702-448b-b0f6-36431dfc5a79 ==============================
[0m16:36:43.955105 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:43.956064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:43.957293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}
[0m16:36:44.618241 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:44.643424 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:44.666871 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:44.689167 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:44.718853 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:44.744845 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:46.018688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:46.021271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:46.038426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:46.040714 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:46.267839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:46.270981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:46.317819 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:46.318555 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:46.324173 [info ] [MainThread]: 
[0m16:36:46.325022 [info ] [MainThread]: 
[0m16:36:46.327371 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:46.327663 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:46.333326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:36:46.337885 [debug] [MainThread]: Command end result
[0m16:36:46.341408 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.5616143, "process_user_time": 4.327256, "process_kernel_time": 0.249265, "process_mem_max_rss": "102308", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:46.344525 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:46.344139 after 2.56 seconds
[0m16:36:46.347757 [debug] [MainThread]: Flushing usage events
[0m16:36:46.449376 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:36:46.452229 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:36:46.455289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:46.475631 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.020 seconds
[0m16:36:46.479868 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:36:46.491509 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:46.497247 [info ] [MainThread]: 
[0m16:36:46.497666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m16:36:46.500883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:46.504622 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:36:46.500013 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:36:46.516835 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:46.522765 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:46.524894 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:36:46.527368 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:36:46.529880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:46.532695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:46.548872 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m16:36:46.551261 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m16:36:46.553141 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:46.556282 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:46.559290 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:36:46.562761 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:36:46.573305 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.007 seconds
[0m16:36:46.574230 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:36:46.578623 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:36:46.583565 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:36:46.586820 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:36:46.589585 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:36:46.615646 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:46.617042 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:36:46.618324 [debug] [MainThread]: On master: BEGIN
[0m16:36:46.619547 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:36:46.620949 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:46.622062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:46.635578 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:36:46.638312 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:46.639815 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.018 seconds
[0m16:36:46.641432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:46.644723 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:36:46.653928 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m16:36:46.662611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m16:36:46.664432 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:46.667811 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:46.670589 [debug] [MainThread]: On master: BEGIN
[0m16:36:46.673489 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:36:46.676390 [debug] [MainThread]: On master: COMMIT
[0m16:36:46.679105 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:46.681935 [debug] [MainThread]: On master: COMMIT
[0m16:36:46.664613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m16:36:46.685564 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:46.688655 [debug] [MainThread]: On master: Close
[0m16:36:46.691640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:46.685704 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:46.693967 [info ] [MainThread]: 
[0m16:36:46.692872 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:46.694651 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:36:46.696952 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:36:46.699317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:46.701453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:46.711798 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m16:36:46.714575 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m16:36:46.717510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_main)
[0m16:36:46.718804 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:36:46.720455 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m16:36:46.720273 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m16:36:46.722191 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:36:46.724449 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:36:46.726473 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:36:46.728913 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:36:46.736330 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.004 seconds
[0m16:36:46.738272 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:36:46.742957 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:36:46.747301 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:36:46.750458 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:36:46.752338 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:36:46.771384 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:46.773366 [debug] [MainThread]: On master: BEGIN
[0m16:36:46.775038 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:46.787127 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:36:46.786875 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m16:36:46.789536 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:46.791922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:46.799960 [debug] [MainThread]: SQL status: SELECT 12 in 0.006 seconds
[0m16:36:46.807098 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:46.809165 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:46.810525 [debug] [MainThread]: On master: BEGIN
[0m16:36:46.812238 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:36:46.814799 [debug] [MainThread]: On master: COMMIT
[0m16:36:46.817428 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:46.819876 [debug] [MainThread]: On master: COMMIT
[0m16:36:46.819711 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m16:36:46.822319 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:46.824462 [debug] [MainThread]: On master: Close
[0m16:36:46.826593 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:46.828704 [info ] [MainThread]: 
[0m16:36:46.842693 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m16:36:46.844852 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m16:36:46.846987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_resellers_xml)
[0m16:36:46.849567 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m16:36:46.906823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m16:36:46.921398 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m16:36:46.948606 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m16:36:46.965473 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m16:36:46.968008 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m16:36:46.969956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:46.983609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:36:46.986439 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m16:36:46.989178 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m16:36:47.052354 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m16:36:47.066883 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m16:36:47.069036 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m16:36:47.070599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:47.082044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:36:47.084686 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m16:36:47.087585 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 



trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  

)
SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m16:36:51.121925 [debug] [Thread-1 (]: SQL status: SELECT 159210 in 4.032 seconds
[0m16:36:51.167497 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m16:36:51.169975 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m16:36:51.172472 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m16:36:51.182805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m16:36:51.187844 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m16:36:51.193607 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 159210[0m in 4.34s]
[0m16:36:51.196933 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m16:36:51.200983 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:51.202784 [debug] [MainThread]: On master: BEGIN
[0m16:36:51.204295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:51.218328 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:36:51.220754 [debug] [MainThread]: On master: COMMIT
[0m16:36:51.222928 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:51.225404 [debug] [MainThread]: On master: COMMIT
[0m16:36:51.229014 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:51.232188 [debug] [MainThread]: On master: Close
[0m16:36:51.235020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:51.237205 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m16:36:51.239213 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m16:36:51.241316 [info ] [MainThread]: 
[0m16:36:51.243864 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m16:36:51.247934 [debug] [MainThread]: Command end result
[0m16:36:51.250028 [info ] [MainThread]: 
[0m16:36:51.252347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:51.254278 [info ] [MainThread]: 
[0m16:36:51.256226 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:36:51.259022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4794865, "process_user_time": 4.787336, "process_kernel_time": 0.353244, "process_mem_max_rss": "113512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:51.262096 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:51.261838 after 7.48 seconds
[0m16:36:51.263905 [debug] [MainThread]: Flushing usage events
[0m16:36:55.633794 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:36:55.647972 | 5e7d0937-fdcc-4a8d-b5ca-44ad000c67c6 ==============================
[0m16:36:55.647972 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:55.650526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:36:56.307366 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:36:56.373943 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:36:58.473000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:58.474880 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:58.668436 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:36:58.673031 [info ] [MainThread]: 
[0m16:36:58.675062 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:36:58.680226 [debug] [MainThread]: Command end result
[0m16:36:58.683769 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.1664927, "process_user_time": 3.88548, "process_kernel_time": 0.099883, "process_mem_max_rss": "102040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:58.689032 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:58.688729 after 3.17 seconds
[0m16:36:58.691507 [debug] [MainThread]: Flushing usage events
[0m16:37:01.770865 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 14.780 seconds
[0m16:37:01.815606 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m16:37:01.818031 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m16:37:01.819979 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m16:37:01.834143 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m16:37:01.837758 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m16:37:01.841632 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 15.12s]
[0m16:37:01.844080 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m16:37:01.849606 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:01.851895 [debug] [MainThread]: On master: BEGIN
[0m16:37:01.853986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:01.865312 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:37:01.867951 [debug] [MainThread]: On master: COMMIT
[0m16:37:01.870003 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:01.871944 [debug] [MainThread]: On master: COMMIT
[0m16:37:01.874231 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:37:01.876225 [debug] [MainThread]: On master: Close
[0m16:37:01.879343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:01.881609 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m16:37:01.883987 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m16:37:01.886080 [info ] [MainThread]: 
[0m16:37:01.887803 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 15.56 seconds (15.56s).
[0m16:37:01.890155 [debug] [MainThread]: Command end result
[0m16:37:01.891655 [info ] [MainThread]: 
[0m16:37:01.893502 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:01.895851 [info ] [MainThread]: 
[0m16:37:01.897791 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:37:01.900595 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.15148, "process_user_time": 4.866207, "process_kernel_time": 0.261407, "process_mem_max_rss": "113040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:37:01.902789 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:01.902600 after 18.15 seconds
[0m16:37:01.904397 [debug] [MainThread]: Flushing usage events
[0m16:37:06.753932 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:37:06.764544 | 7b808c17-ff63-4aa3-b1ff-c231fafeec8f ==============================
[0m16:37:06.764544 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:37:06.766733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:37:06.771826 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:37:06.784762 | 3b777dd8-97a1-4ee8-b391-578c32a8688a ==============================
[0m16:37:06.784762 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:37:06.787033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:37:07.317657 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:37:07.337591 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:37:07.383175 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:37:07.410739 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:37:09.098836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:09.100517 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:09.159339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:09.161418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:09.345811 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:37:09.349994 [info ] [MainThread]: 
[0m16:37:09.352135 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:37:09.358312 [debug] [MainThread]: Command end result
[0m16:37:09.361363 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.754238, "process_user_time": 3.824873, "process_kernel_time": 0.163558, "process_mem_max_rss": "102296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:37:09.363655 [debug] [MainThread]: Command `dbt test` succeeded at 16:37:09.363406 after 2.76 seconds
[0m16:37:09.365412 [debug] [MainThread]: Flushing usage events
[0m16:37:09.373560 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:37:09.379670 [info ] [MainThread]: 
[0m16:37:09.382230 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:37:09.385794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:37:09.469578 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:37:09.472100 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:37:09.474801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:09.488949 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.014 seconds
[0m16:37:09.494192 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:37:09.508242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m16:37:09.509835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m16:37:09.524527 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:37:09.533014 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:37:09.534583 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:37:09.536233 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:37:09.537980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:09.540397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:09.557890 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m16:37:09.559888 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m16:37:09.562077 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:37:09.564561 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:37:09.566681 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:37:09.569513 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:37:09.578725 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:37:09.579890 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.005 seconds
[0m16:37:09.582972 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:37:09.587450 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:37:09.591059 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:37:09.593844 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:37:09.617421 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:09.619625 [debug] [MainThread]: On master: BEGIN
[0m16:37:09.621958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:09.637662 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:37:09.641007 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:09.643967 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:37:09.653425 [debug] [MainThread]: SQL status: SELECT 12 in 0.006 seconds
[0m16:37:09.661224 [debug] [MainThread]: On master: ROLLBACK
[0m16:37:09.663442 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:09.665355 [debug] [MainThread]: On master: BEGIN
[0m16:37:09.667461 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:37:09.669959 [debug] [MainThread]: On master: COMMIT
[0m16:37:09.674166 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:09.677727 [debug] [MainThread]: On master: COMMIT
[0m16:37:09.680259 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:37:09.682079 [debug] [MainThread]: On master: Close
[0m16:37:09.684249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:37:09.686695 [info ] [MainThread]: 
[0m16:37:09.704309 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m16:37:09.707878 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m16:37:09.710737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m16:37:09.712604 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m16:37:09.734900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m16:37:09.782382 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m16:37:09.947837 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m16:37:10.002929 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m16:37:10.005480 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m16:37:10.008550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:10.021922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:37:10.025037 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m16:37:10.027578 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m16:37:11.915099 [debug] [Thread-1 (]: SQL status: SELECT 1159210 in 1.885 seconds
[0m16:37:11.928992 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m16:37:11.930952 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m16:37:11.934293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:37:11.974663 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m16:37:11.976726 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m16:37:11.978711 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m16:37:11.993364 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m16:37:12.007153 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m16:37:12.020959 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m16:37:12.024051 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m16:37:12.026770 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m16:37:12.032149 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m16:37:12.036080 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1159210[0m in 2.32s]
[0m16:37:12.038839 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m16:37:12.042637 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:12.045112 [debug] [MainThread]: On master: BEGIN
[0m16:37:12.047708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:12.060704 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:37:12.063383 [debug] [MainThread]: On master: COMMIT
[0m16:37:12.065262 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:12.067308 [debug] [MainThread]: On master: COMMIT
[0m16:37:12.069976 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:37:12.073809 [debug] [MainThread]: On master: Close
[0m16:37:12.076234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:12.077841 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m16:37:12.079656 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m16:37:12.081112 [info ] [MainThread]: 
[0m16:37:12.082630 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m16:37:12.084643 [debug] [MainThread]: Command end result
[0m16:37:12.086249 [info ] [MainThread]: 
[0m16:37:12.088750 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:12.090446 [info ] [MainThread]: 
[0m16:37:12.092101 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:37:12.094150 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.45694, "process_user_time": 4.426079, "process_kernel_time": 0.220802, "process_mem_max_rss": "112880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:37:12.095890 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:12.095713 after 5.46 seconds
[0m16:37:12.097329 [debug] [MainThread]: Flushing usage events
[0m16:37:17.024264 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:37:17.034301 | cf59afb1-87a9-423e-8c6a-dfd5da136c5a ==============================
[0m16:37:17.034301 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:37:17.036584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:37:17.077824 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:37:17.089042 | 04647ded-4bc4-4c01-a97a-7a739bacfe2f ==============================
[0m16:37:17.089042 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:37:17.091460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:37:17.618999 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:37:17.700906 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:37:17.701537 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:37:17.851033 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:37:19.315881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:19.318125 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:19.472766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:19.475786 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:19.557730 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:37:19.563569 [info ] [MainThread]: 
[0m16:37:19.566726 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:37:19.570273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:37:19.677797 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:37:19.680273 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:37:19.682041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:19.697380 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.015 seconds
[0m16:37:19.701801 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:37:19.709149 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:37:19.713360 [info ] [MainThread]: 
[0m16:37:19.715516 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:37:19.720870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m16:37:19.722331 [debug] [MainThread]: Command end result
[0m16:37:19.725293 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.7640414, "process_user_time": 3.975964, "process_kernel_time": 0.239155, "process_mem_max_rss": "102260", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:37:19.728034 [debug] [MainThread]: Command `dbt test` succeeded at 16:37:19.727795 after 2.77 seconds
[0m16:37:19.730234 [debug] [MainThread]: Flushing usage events
[0m16:37:19.722594 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:37:19.738976 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:37:19.744554 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:37:19.747209 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:37:19.749965 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:37:19.752122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:19.754554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:19.769255 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:37:19.772217 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:37:19.773645 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m16:37:19.775770 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:37:19.778579 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:37:19.784098 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:37:19.788701 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.007 seconds
[0m16:37:19.794150 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:37:19.795536 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m16:37:19.798668 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:37:19.802550 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:37:19.813068 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:37:19.832463 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:19.834715 [debug] [MainThread]: On master: BEGIN
[0m16:37:19.836545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:19.851600 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:37:19.854114 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:19.856887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:37:19.868238 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m16:37:19.874948 [debug] [MainThread]: On master: ROLLBACK
[0m16:37:19.877030 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:19.879396 [debug] [MainThread]: On master: BEGIN
[0m16:37:19.882764 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:37:19.885703 [debug] [MainThread]: On master: COMMIT
[0m16:37:19.888084 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:19.890473 [debug] [MainThread]: On master: COMMIT
[0m16:37:19.892968 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:37:19.896044 [debug] [MainThread]: On master: Close
[0m16:37:19.899942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:37:19.903239 [info ] [MainThread]: 
[0m16:37:19.918831 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m16:37:19.921708 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m16:37:19.924257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.fact_sales)
[0m16:37:19.926937 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m16:37:19.954819 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m16:37:19.996747 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m16:37:20.110978 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m16:37:20.145925 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m16:37:20.150156 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m16:37:20.154634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:20.169996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:37:20.173439 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m16:37:20.179228 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
		product_key,
		channel_key,
		bought_date_key,
		geography_key
     -- fill code here 
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m16:37:22.979707 [debug] [Thread-1 (]: SQL status: SELECT 1159210 in 2.797 seconds
[0m16:37:23.000699 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m16:37:23.002949 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m16:37:23.005362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:37:23.060936 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m16:37:23.064104 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m16:37:23.066669 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m16:37:23.075177 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m16:37:23.093781 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m16:37:23.103407 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m16:37:23.106478 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m16:37:23.110771 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:37:23.116994 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m16:37:23.122184 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1159210[0m in 3.20s]
[0m16:37:23.125493 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m16:37:23.129969 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:23.131980 [debug] [MainThread]: On master: BEGIN
[0m16:37:23.133591 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:23.148541 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:37:23.151318 [debug] [MainThread]: On master: COMMIT
[0m16:37:23.161022 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:23.163783 [debug] [MainThread]: On master: COMMIT
[0m16:37:23.166663 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:37:23.169239 [debug] [MainThread]: On master: Close
[0m16:37:23.171144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:23.174020 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m16:37:23.181190 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m16:37:23.185353 [info ] [MainThread]: 
[0m16:37:23.187562 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m16:37:23.190075 [debug] [MainThread]: Command end result
[0m16:37:23.192213 [info ] [MainThread]: 
[0m16:37:23.194799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:23.196533 [info ] [MainThread]: 
[0m16:37:23.198687 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:37:23.201403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.2853885, "process_user_time": 4.528458, "process_kernel_time": 0.258769, "process_mem_max_rss": "113032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:37:23.204223 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:23.203947 after 6.29 seconds
[0m16:37:23.206338 [debug] [MainThread]: Flushing usage events
[0m16:37:28.429200 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:37:28.442582 | a3fd8acc-2252-45dc-a0b4-9923a0c3c1b3 ==============================
[0m16:37:28.442582 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:37:28.444966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'send_anonymous_usage_stats': 'True'}
[0m16:37:28.940113 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:37:28.995374 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:37:30.984790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:30.986039 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:31.240190 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:37:31.243980 [info ] [MainThread]: 
[0m16:37:31.246206 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:37:31.269475 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:37:31.263409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m16:37:31.362054 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:37:31.363256 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:37:31.365306 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:37:31.367429 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:37:31.369081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:31.370639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:31.388569 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m16:37:31.391382 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m16:37:31.392713 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:37:31.395351 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:37:31.397872 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:37:31.400843 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:37:31.409147 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m16:37:31.411204 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:37:31.417251 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:37:31.423445 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:37:31.426185 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:37:31.428142 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:37:31.454589 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:31.456641 [debug] [MainThread]: On master: BEGIN
[0m16:37:31.458262 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:31.469963 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:37:31.472281 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:31.474725 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:37:31.483619 [debug] [MainThread]: SQL status: SELECT 12 in 0.006 seconds
[0m16:37:31.490224 [debug] [MainThread]: On master: ROLLBACK
[0m16:37:31.492396 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:31.494641 [debug] [MainThread]: On master: BEGIN
[0m16:37:31.498672 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:37:31.502142 [debug] [MainThread]: On master: COMMIT
[0m16:37:31.506204 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:31.508695 [debug] [MainThread]: On master: COMMIT
[0m16:37:31.511018 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:37:31.512737 [debug] [MainThread]: On master: Close
[0m16:37:31.514735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:37:31.516868 [info ] [MainThread]: 
[0m16:37:31.532327 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m16:37:31.534276 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m16:37:31.536435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now test.dbtcomp.total_amount_is_non_negative)
[0m16:37:31.538247 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m16:37:31.558002 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m16:37:31.580657 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m16:37:31.619455 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m16:37:31.637191 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m16:37:31.639816 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m16:37:31.641740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:31.654361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:37:31.657264 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m16:37:31.659963 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m16:37:31.664769 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "total_amount" does not exist
LINE 9: where total_amount <= 0.00
              ^

[0m16:37:31.669133 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m16:37:31.672933 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m16:37:31.689052 [debug] [Thread-1 (]: Database Error in test total_amount_is_non_negative (tests/total_amount_is_non_negative.sql)
  column "total_amount" does not exist
  LINE 9: where total_amount <= 0.00
                ^
  compiled code at target/run/dbtcomp/tests/total_amount_is_non_negative.sql
[0m16:37:31.691825 [error] [Thread-1 (]: 1 of 1 ERROR total_amount_is_non_negative ...................................... [[31mERROR[0m in 0.16s]
[0m16:37:31.694577 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m16:37:31.700253 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:31.702909 [debug] [MainThread]: On master: BEGIN
[0m16:37:31.706010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:31.719545 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:37:31.722493 [debug] [MainThread]: On master: COMMIT
[0m16:37:31.724574 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:31.726498 [debug] [MainThread]: On master: COMMIT
[0m16:37:31.728994 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:37:31.731590 [debug] [MainThread]: On master: Close
[0m16:37:31.734577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:31.736822 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m16:37:31.738833 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m16:37:31.740574 [info ] [MainThread]: 
[0m16:37:31.742365 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m16:37:31.745807 [debug] [MainThread]: Command end result
[0m16:37:31.748313 [info ] [MainThread]: 
[0m16:37:31.751429 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:37:31.754230 [info ] [MainThread]: 
[0m16:37:31.756766 [error] [MainThread]:   Database Error in test total_amount_is_non_negative (tests/total_amount_is_non_negative.sql)
  column "total_amount" does not exist
  LINE 9: where total_amount <= 0.00
                ^
  compiled code at target/run/dbtcomp/tests/total_amount_is_non_negative.sql
[0m16:37:31.759242 [info ] [MainThread]: 
[0m16:37:31.761827 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:37:31.764915 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.4679966, "process_user_time": 4.328331, "process_kernel_time": 0.364162, "process_mem_max_rss": "115504", "process_in_blocks": "56", "command_success": false, "process_out_blocks": "0"}
[0m16:37:31.767944 [debug] [MainThread]: Command `dbt test` failed at 16:37:31.767439 after 3.47 seconds
[0m16:37:31.770364 [debug] [MainThread]: Flushing usage events
[0m16:47:21.113273 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:47:21.178993 | 662d57e6-c16a-46d4-bd68-b71fc061b78b ==============================
[0m16:47:21.178993 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:47:21.203883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:47:21.846005 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:47:21.925184 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:47:24.570322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:47:24.573495 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/fact/fact_sales.sql
[0m16:47:25.486904 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:47:25.493891 [info ] [MainThread]: 
[0m16:47:25.496735 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:47:25.510947 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m16:47:25.514998 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:47:25.698175 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:47:25.699915 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:47:25.702181 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:47:25.706289 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:47:25.710841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:25.714027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:25.733172 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m16:47:25.735393 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m16:47:25.737532 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:47:25.741193 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:47:25.744655 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:47:25.747353 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:47:25.755694 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.004 seconds
[0m16:47:25.757057 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:47:25.761760 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:47:25.764838 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:47:25.766677 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:47:25.768147 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:47:25.788878 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:25.792199 [debug] [MainThread]: On master: BEGIN
[0m16:47:25.794515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:25.806099 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:47:25.809311 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:25.811922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:47:25.819469 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m16:47:25.828513 [debug] [MainThread]: On master: ROLLBACK
[0m16:47:25.830991 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:25.833023 [debug] [MainThread]: On master: BEGIN
[0m16:47:25.835371 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:47:25.837988 [debug] [MainThread]: On master: COMMIT
[0m16:47:25.842162 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:25.844943 [debug] [MainThread]: On master: COMMIT
[0m16:47:25.847342 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:47:25.849443 [debug] [MainThread]: On master: Close
[0m16:47:25.852048 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:47:25.854234 [info ] [MainThread]: 
[0m16:47:25.869967 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m16:47:25.873538 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m16:47:25.876895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now test.dbtcomp.total_amount_is_non_negative)
[0m16:47:25.880053 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m16:47:25.907205 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m16:47:25.922138 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m16:47:25.961679 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m16:47:25.975362 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m16:47:25.977544 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m16:47:25.979262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:25.993581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:47:25.996144 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m16:47:25.998730 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m16:47:26.002537 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "total_amount" does not exist
LINE 9: where total_amount <= 0.00
              ^

[0m16:47:26.006402 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m16:47:26.010726 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m16:47:26.018078 [debug] [Thread-1 (]: Database Error in test total_amount_is_non_negative (tests/total_amount_is_non_negative.sql)
  column "total_amount" does not exist
  LINE 9: where total_amount <= 0.00
                ^
  compiled code at target/run/dbtcomp/tests/total_amount_is_non_negative.sql
[0m16:47:26.023253 [error] [Thread-1 (]: 1 of 1 ERROR total_amount_is_non_negative ...................................... [[31mERROR[0m in 0.14s]
[0m16:47:26.028434 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m16:47:26.034802 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:26.037213 [debug] [MainThread]: On master: BEGIN
[0m16:47:26.040926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:26.061436 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m16:47:26.064526 [debug] [MainThread]: On master: COMMIT
[0m16:47:26.066886 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:26.069313 [debug] [MainThread]: On master: COMMIT
[0m16:47:26.072736 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:47:26.076105 [debug] [MainThread]: On master: Close
[0m16:47:26.078896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:26.081432 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m16:47:26.083440 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m16:47:26.085350 [info ] [MainThread]: 
[0m16:47:26.087550 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m16:47:26.094968 [debug] [MainThread]: Command end result
[0m16:47:26.098426 [info ] [MainThread]: 
[0m16:47:26.102219 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:47:26.104786 [info ] [MainThread]: 
[0m16:47:26.108764 [error] [MainThread]:   Database Error in test total_amount_is_non_negative (tests/total_amount_is_non_negative.sql)
  column "total_amount" does not exist
  LINE 9: where total_amount <= 0.00
                ^
  compiled code at target/run/dbtcomp/tests/total_amount_is_non_negative.sql
[0m16:47:26.112425 [info ] [MainThread]: 
[0m16:47:26.115163 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:47:26.119337 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.184455, "process_user_time": 5.320364, "process_kernel_time": 0.397042, "process_mem_max_rss": "118224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:47:26.123495 [debug] [MainThread]: Command `dbt test` failed at 16:47:26.123008 after 5.19 seconds
[0m16:47:26.126287 [debug] [MainThread]: Flushing usage events
[0m16:48:34.026022 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:48:34.036378 | 2ee61884-d337-44c4-9444-f678dda32fe7 ==============================
[0m16:48:34.036378 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:48:34.039254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:34.533716 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:48:34.593159 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:48:36.970698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:36.972652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:37.178927 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:48:37.185522 [info ] [MainThread]: 
[0m16:48:37.188171 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:48:37.191891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m16:48:37.293736 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m16:48:37.296000 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:48:37.298102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:37.311017 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.013 seconds
[0m16:48:37.314210 [debug] [ThreadPool]: On list_sales_dw: Close
[0m16:48:37.331513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m16:48:37.333359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:48:37.348426 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:48:37.353606 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:48:37.355894 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:48:37.357673 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:48:37.359418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:37.361387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:37.376638 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:48:37.380089 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m16:48:37.382090 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:48:37.384723 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:48:37.387191 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:48:37.389807 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:48:37.398199 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m16:48:37.399290 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:48:37.403488 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:48:37.407166 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:48:37.409270 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:48:37.411498 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:48:37.437091 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:37.438702 [debug] [MainThread]: On master: BEGIN
[0m16:48:37.440865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:48:37.453958 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:48:37.456819 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:37.459667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:48:37.467953 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m16:48:37.475084 [debug] [MainThread]: On master: ROLLBACK
[0m16:48:37.477236 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:37.479122 [debug] [MainThread]: On master: BEGIN
[0m16:48:37.482067 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:48:37.484786 [debug] [MainThread]: On master: COMMIT
[0m16:48:37.487280 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:37.489511 [debug] [MainThread]: On master: COMMIT
[0m16:48:37.491931 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:48:37.493896 [debug] [MainThread]: On master: Close
[0m16:48:37.498832 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:37.501650 [info ] [MainThread]: 
[0m16:48:37.514716 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m16:48:37.517494 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m16:48:37.519630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.fact_sales)
[0m16:48:37.521279 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m16:48:37.552562 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m16:48:37.616176 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m16:48:37.725983 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m16:48:37.786994 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m16:48:37.792541 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m16:48:37.798146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:37.830403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m16:48:37.837863 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m16:48:37.845384 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
	product_key,
	channel_key,
	bought_date_key,
	geography_key,
    total_amount
     -- fill code here 
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m16:48:40.124081 [debug] [Thread-1 (]: SQL status: SELECT 1159210 in 2.270 seconds
[0m16:48:40.141096 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m16:48:40.143137 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales" rename to "fact_sales__dbt_backup"
[0m16:48:40.145778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:48:40.153405 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m16:48:40.155484 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m16:48:40.157779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:48:40.206454 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m16:48:40.208201 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m16:48:40.210377 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m16:48:40.220824 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m16:48:40.235830 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m16:48:40.249819 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m16:48:40.251887 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m16:48:40.296797 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.043 seconds
[0m16:48:40.306884 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m16:48:40.322255 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1159210[0m in 2.80s]
[0m16:48:40.328603 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m16:48:40.353757 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:40.357632 [debug] [MainThread]: On master: BEGIN
[0m16:48:40.362109 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:48:40.376138 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:48:40.378829 [debug] [MainThread]: On master: COMMIT
[0m16:48:40.381213 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:40.383271 [debug] [MainThread]: On master: COMMIT
[0m16:48:40.385387 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:48:40.387749 [debug] [MainThread]: On master: Close
[0m16:48:40.390036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:40.392555 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m16:48:40.394918 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m16:48:40.397105 [info ] [MainThread]: 
[0m16:48:40.399168 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m16:48:40.401861 [debug] [MainThread]: Command end result
[0m16:48:40.403652 [info ] [MainThread]: 
[0m16:48:40.405545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:48:40.407325 [info ] [MainThread]: 
[0m16:48:40.409351 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:48:40.412330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4990315, "process_user_time": 4.672261, "process_kernel_time": 0.440213, "process_mem_max_rss": "113016", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:48:40.414866 [debug] [MainThread]: Command `dbt run` succeeded at 16:48:40.414618 after 6.50 seconds
[0m16:48:40.416724 [debug] [MainThread]: Flushing usage events
[0m16:48:44.805070 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 16:48:44.814339 | 57ad19e7-8c14-412e-bad2-4b71c00848c6 ==============================
[0m16:48:44.814339 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:48:44.816864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:45.343026 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:48:45.412166 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m16:48:47.207592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:47.209683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:47.407880 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m16:48:47.411810 [info ] [MainThread]: 
[0m16:48:47.414081 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:48:47.428685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m16:48:47.432180 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m16:48:47.526757 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:48:47.527746 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:48:47.529386 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m16:48:47.531225 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m16:48:47.533127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:47.535425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:47.850937 [debug] [ThreadPool]: SQL status: BEGIN in 0.315 seconds
[0m16:48:47.853522 [debug] [ThreadPool]: SQL status: BEGIN in 0.320 seconds
[0m16:48:47.856431 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m16:48:47.859270 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m16:48:47.861674 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:48:47.864043 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m16:48:47.872730 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:48:47.874171 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.008 seconds
[0m16:48:47.877336 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m16:48:47.880965 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m16:48:47.883285 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m16:48:47.885318 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m16:48:47.915171 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:47.945727 [debug] [MainThread]: On master: BEGIN
[0m16:48:47.951120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:48:47.996543 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m16:48:47.998741 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:48.012095 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:48:48.026056 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m16:48:48.034600 [debug] [MainThread]: On master: ROLLBACK
[0m16:48:48.037583 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:48.040261 [debug] [MainThread]: On master: BEGIN
[0m16:48:48.046111 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:48:48.049524 [debug] [MainThread]: On master: COMMIT
[0m16:48:48.052040 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:48.055074 [debug] [MainThread]: On master: COMMIT
[0m16:48:48.058223 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:48:48.061627 [debug] [MainThread]: On master: Close
[0m16:48:48.064718 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:48.067410 [info ] [MainThread]: 
[0m16:48:48.086555 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m16:48:48.089406 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m16:48:48.092936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m16:48:48.095469 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m16:48:48.116286 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m16:48:48.129402 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m16:48:48.205354 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m16:48:48.220517 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m16:48:48.223277 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m16:48:48.225924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:48.239496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:48:48.242772 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m16:48:48.245937 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m16:48:48.642511 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.393 seconds
[0m16:48:48.654092 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m16:48:48.656603 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m16:48:48.659643 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.57s]
[0m16:48:48.663889 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m16:48:48.668362 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:48.671113 [debug] [MainThread]: On master: BEGIN
[0m16:48:48.673376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:48:48.688082 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:48:48.690859 [debug] [MainThread]: On master: COMMIT
[0m16:48:48.692748 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:48.694278 [debug] [MainThread]: On master: COMMIT
[0m16:48:48.696263 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:48:48.698077 [debug] [MainThread]: On master: Close
[0m16:48:48.700593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:48.703697 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m16:48:48.706511 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m16:48:48.708283 [info ] [MainThread]: 
[0m16:48:48.709971 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m16:48:48.712361 [debug] [MainThread]: Command end result
[0m16:48:48.713878 [info ] [MainThread]: 
[0m16:48:48.715685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:48:48.717285 [info ] [MainThread]: 
[0m16:48:48.719732 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:48:48.722470 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.0203977, "process_user_time": 3.934926, "process_kernel_time": 0.220275, "process_mem_max_rss": "112832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:48:48.724437 [debug] [MainThread]: Command `dbt test` succeeded at 16:48:48.724236 after 4.02 seconds
[0m16:48:48.726073 [debug] [MainThread]: Flushing usage events
[0m03:25:21.127492 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 03:25:21.262832 | 37007d3e-27ee-4ef1-a4c9-3055414c796b ==============================
[0m03:25:21.262832 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:25:21.281967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:25:22.793494 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:25:22.956210 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m03:25:25.675954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:25:25.678332 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/fact/fact_sales.sql
[0m03:25:26.448625 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m03:25:26.454318 [info ] [MainThread]: 
[0m03:25:26.457088 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:25:26.460252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m03:25:26.600909 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m03:25:26.603624 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m03:25:26.606076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:26.670391 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.064 seconds
[0m03:25:26.675264 [debug] [ThreadPool]: On list_sales_dw: Close
[0m03:25:26.691898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m03:25:26.693571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m03:25:26.804849 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:25:26.813940 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:25:26.816910 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m03:25:26.819740 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m03:25:26.822506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:26.825603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:26.844046 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m03:25:26.847072 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m03:25:26.849430 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:25:26.852639 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:25:26.861489 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m03:25:26.856983 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m03:25:26.941130 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.068 seconds
[0m03:25:26.947559 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.070 seconds
[0m03:25:26.954975 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m03:25:26.964918 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m03:25:26.968501 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m03:25:26.971030 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m03:25:27.006306 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:27.008621 [debug] [MainThread]: On master: BEGIN
[0m03:25:27.010288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:25:27.024056 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m03:25:27.029598 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:27.034220 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:25:27.118289 [debug] [MainThread]: SQL status: SELECT 12 in 0.050 seconds
[0m03:25:27.156771 [debug] [MainThread]: On master: ROLLBACK
[0m03:25:27.160055 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:27.162289 [debug] [MainThread]: On master: BEGIN
[0m03:25:27.164926 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:25:27.171353 [debug] [MainThread]: On master: COMMIT
[0m03:25:27.174517 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:27.176943 [debug] [MainThread]: On master: COMMIT
[0m03:25:27.179715 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:25:27.182819 [debug] [MainThread]: On master: Close
[0m03:25:27.186892 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:25:27.190266 [info ] [MainThread]: 
[0m03:25:27.208550 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m03:25:27.211297 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m03:25:27.214451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.fact_sales)
[0m03:25:27.219546 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m03:25:27.246837 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m03:25:27.293476 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m03:25:27.394274 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m03:25:27.411153 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:25:27.413327 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m03:25:27.416254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:25:27.430285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m03:25:27.434607 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:25:27.437703 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
	product_key,
	channel_key,
	bought_date_key,
	geographykey AS geography_key,
    total_amount
     -- fill code here 
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m03:25:27.441496 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "geographykey" does not exist
LINE 19:  geographykey AS geography_key,
          ^
HINT:  Perhaps you meant to reference the column "staging_transactions.geography_key".

[0m03:25:27.446797 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: ROLLBACK
[0m03:25:27.450957 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m03:25:27.462036 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact/fact_sales.sql)
  column "geographykey" does not exist
  LINE 19:  geographykey AS geography_key,
            ^
  HINT:  Perhaps you meant to reference the column "staging_transactions.geography_key".
  compiled code at target/run/dbtcomp/models/fact/fact_sales.sql
[0m03:25:27.467326 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.fact_sales ........................... [[31mERROR[0m in 0.25s]
[0m03:25:27.470753 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m03:25:27.476105 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:27.477979 [debug] [MainThread]: On master: BEGIN
[0m03:25:27.479520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:25:27.494001 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m03:25:27.496501 [debug] [MainThread]: On master: COMMIT
[0m03:25:27.498810 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:27.502505 [debug] [MainThread]: On master: COMMIT
[0m03:25:27.505832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:25:27.508259 [debug] [MainThread]: On master: Close
[0m03:25:27.510260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:25:27.511920 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m03:25:27.513547 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m03:25:27.516251 [info ] [MainThread]: 
[0m03:25:27.519092 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m03:25:27.522731 [debug] [MainThread]: Command end result
[0m03:25:27.524791 [info ] [MainThread]: 
[0m03:25:27.526907 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:25:27.528516 [info ] [MainThread]: 
[0m03:25:27.530463 [error] [MainThread]:   Database Error in model fact_sales (models/fact/fact_sales.sql)
  column "geographykey" does not exist
  LINE 19:  geographykey AS geography_key,
            ^
  HINT:  Perhaps you meant to reference the column "staging_transactions.geography_key".
  compiled code at target/run/dbtcomp/models/fact/fact_sales.sql
[0m03:25:27.533198 [info ] [MainThread]: 
[0m03:25:27.535896 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:25:27.540863 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.7348323, "process_user_time": 8.358877, "process_kernel_time": 4.82572, "process_mem_max_rss": "116344", "process_in_blocks": "29304", "command_success": false, "process_out_blocks": "0"}
[0m03:25:27.543264 [debug] [MainThread]: Command `dbt run` failed at 03:25:27.543012 after 6.74 seconds
[0m03:25:27.544839 [debug] [MainThread]: Flushing usage events
[0m03:34:23.002996 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 03:34:23.029280 | b9738504-e5e0-450d-922e-ae22e8a0afa5 ==============================
[0m03:34:23.029280 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:34:23.032549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:34:23.752409 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:34:23.838021 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m03:34:26.398669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:34:26.402525 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_geography.sql
[0m03:34:26.405314 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/fact/fact_sales.sql
[0m03:34:27.507230 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m03:34:27.514661 [info ] [MainThread]: 
[0m03:34:27.520681 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:34:27.524960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m03:34:27.704724 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m03:34:27.707594 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m03:34:27.710481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:34:27.730452 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.020 seconds
[0m03:34:27.734909 [debug] [ThreadPool]: On list_sales_dw: Close
[0m03:34:27.748982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m03:34:27.751264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m03:34:27.851010 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:34:27.855650 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:34:27.857240 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m03:34:27.860827 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m03:34:27.863125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:34:27.865096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:34:27.878121 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m03:34:27.880805 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m03:34:27.882867 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:34:27.886229 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:34:27.888804 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m03:34:27.891203 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m03:34:27.902136 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m03:34:27.903838 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.008 seconds
[0m03:34:27.907885 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m03:34:27.913194 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m03:34:27.916699 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m03:34:27.918941 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m03:34:27.938376 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:27.940478 [debug] [MainThread]: On master: BEGIN
[0m03:34:27.942049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:34:27.954101 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m03:34:27.957108 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:27.960764 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:34:27.970695 [debug] [MainThread]: SQL status: SELECT 12 in 0.006 seconds
[0m03:34:27.976909 [debug] [MainThread]: On master: ROLLBACK
[0m03:34:27.979791 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:27.982364 [debug] [MainThread]: On master: BEGIN
[0m03:34:27.985351 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:34:27.987779 [debug] [MainThread]: On master: COMMIT
[0m03:34:27.989626 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:27.991814 [debug] [MainThread]: On master: COMMIT
[0m03:34:27.996063 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:34:27.998090 [debug] [MainThread]: On master: Close
[0m03:34:28.000661 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:34:28.003677 [info ] [MainThread]: 
[0m03:34:28.023050 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m03:34:28.026833 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m03:34:28.030364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.fact_sales)
[0m03:34:28.032764 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m03:34:28.056593 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m03:34:28.075031 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m03:34:28.244425 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m03:34:28.285535 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:34:28.287845 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m03:34:28.289913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:34:28.301905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m03:34:28.305601 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:34:28.308089 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
	product_key,
	channel_key,
	bought_date_key,
	geography_key,
    total_amount
     -- fill code here 
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m03:34:31.051101 [debug] [Thread-1 (]: SQL status: SELECT 1159210 in 2.740 seconds
[0m03:34:31.066930 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:34:31.068816 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales" rename to "fact_sales__dbt_backup"
[0m03:34:31.157630 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.087 seconds
[0m03:34:31.168216 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:34:31.170207 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m03:34:31.172772 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:34:31.229810 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m03:34:31.232615 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:34:31.234710 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m03:34:31.244448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m03:34:31.260374 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m03:34:31.272910 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:34:31.276893 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m03:34:31.549045 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.241 seconds
[0m03:34:31.556649 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m03:34:31.564162 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1159210[0m in 3.53s]
[0m03:34:31.567661 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m03:34:31.573568 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:31.576296 [debug] [MainThread]: On master: BEGIN
[0m03:34:31.579027 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:34:31.594820 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m03:34:31.597605 [debug] [MainThread]: On master: COMMIT
[0m03:34:31.599609 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:31.601789 [debug] [MainThread]: On master: COMMIT
[0m03:34:31.604237 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:34:31.606358 [debug] [MainThread]: On master: Close
[0m03:34:31.608828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:34:31.611231 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m03:34:31.613312 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m03:34:31.615495 [info ] [MainThread]: 
[0m03:34:31.619105 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m03:34:31.622836 [debug] [MainThread]: Command end result
[0m03:34:31.625460 [info ] [MainThread]: 
[0m03:34:31.627788 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:34:31.629730 [info ] [MainThread]: 
[0m03:34:31.632030 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:34:31.635939 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.830185, "process_user_time": 7.19823, "process_kernel_time": 0.740847, "process_mem_max_rss": "117768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:34:31.638850 [debug] [MainThread]: Command `dbt run` succeeded at 03:34:31.638601 after 8.83 seconds
[0m03:34:31.640884 [debug] [MainThread]: Flushing usage events
[0m03:34:38.119432 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 03:34:38.153620 | 28a9412a-add9-4564-8628-dd62c679bc1e ==============================
[0m03:34:38.153620 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:34:38.158207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:34:38.908919 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:34:38.983748 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m03:34:41.438156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:34:41.441725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:34:41.776597 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m03:34:41.785959 [info ] [MainThread]: 
[0m03:34:41.792483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:34:41.812927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m03:34:41.821027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m03:34:41.986246 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:34:41.987491 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:34:41.996013 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m03:34:42.013854 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m03:34:42.016946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:34:42.024017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:34:42.073170 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m03:34:42.076579 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m03:34:42.078721 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:34:42.083145 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:34:42.086684 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m03:34:42.089737 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m03:34:42.098587 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m03:34:42.099874 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.006 seconds
[0m03:34:42.104144 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m03:34:42.108376 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m03:34:42.111141 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m03:34:42.114041 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m03:34:42.141093 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:42.143355 [debug] [MainThread]: On master: BEGIN
[0m03:34:42.145008 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:34:42.159605 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m03:34:42.162381 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:42.165473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:34:42.173668 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m03:34:42.179098 [debug] [MainThread]: On master: ROLLBACK
[0m03:34:42.181694 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:42.183867 [debug] [MainThread]: On master: BEGIN
[0m03:34:42.186747 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:34:42.189696 [debug] [MainThread]: On master: COMMIT
[0m03:34:42.191261 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:42.192844 [debug] [MainThread]: On master: COMMIT
[0m03:34:42.194399 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:34:42.196979 [debug] [MainThread]: On master: Close
[0m03:34:42.199994 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:34:42.204136 [info ] [MainThread]: 
[0m03:34:42.223517 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m03:34:42.226807 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m03:34:42.229742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m03:34:42.233780 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m03:34:42.263880 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m03:34:42.301490 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m03:34:42.360338 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m03:34:42.380487 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m03:34:42.383938 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m03:34:42.389049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:34:42.405496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m03:34:42.408596 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m03:34:42.410697 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m03:34:42.924139 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.511 seconds
[0m03:34:42.938265 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m03:34:42.940848 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m03:34:42.943339 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.71s]
[0m03:34:42.948502 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m03:34:42.956085 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:42.958050 [debug] [MainThread]: On master: BEGIN
[0m03:34:42.959806 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:34:42.975454 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m03:34:42.978057 [debug] [MainThread]: On master: COMMIT
[0m03:34:42.982189 [debug] [MainThread]: Using postgres connection "master"
[0m03:34:42.986638 [debug] [MainThread]: On master: COMMIT
[0m03:34:42.989473 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:34:42.992219 [debug] [MainThread]: On master: Close
[0m03:34:42.994899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:34:42.998766 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m03:34:43.001676 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m03:34:43.004976 [info ] [MainThread]: 
[0m03:34:43.007425 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m03:34:43.010365 [debug] [MainThread]: Command end result
[0m03:34:43.013969 [info ] [MainThread]: 
[0m03:34:43.018634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:34:43.022886 [info ] [MainThread]: 
[0m03:34:43.025033 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:34:43.028031 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.138932, "process_user_time": 5.867346, "process_kernel_time": 0.344541, "process_mem_max_rss": "112808", "process_in_blocks": "1432", "process_out_blocks": "0"}
[0m03:34:43.032818 [debug] [MainThread]: Command `dbt test` succeeded at 03:34:43.032198 after 5.14 seconds
[0m03:34:43.037852 [debug] [MainThread]: Flushing usage events
[0m03:44:21.843511 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 03:44:21.869569 | a8c91cc6-24ac-4143-b91b-4b9080a6cf1b ==============================
[0m03:44:21.869569 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:44:21.874495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:44:22.608401 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:44:22.703568 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m03:44:25.688141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:44:25.690688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:44:25.875554 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m03:44:25.879253 [info ] [MainThread]: 
[0m03:44:25.883071 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:44:25.888496 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m03:44:25.981766 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m03:44:25.984052 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m03:44:25.986870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:44:26.007114 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.020 seconds
[0m03:44:26.011069 [debug] [ThreadPool]: On list_sales_dw: Close
[0m03:44:26.027651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m03:44:26.028916 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m03:44:26.048564 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:44:26.057833 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:44:26.059760 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m03:44:26.061593 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m03:44:26.064018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:44:26.066686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:44:26.084583 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m03:44:26.088222 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m03:44:26.090920 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:44:26.093216 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:44:26.095385 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m03:44:26.098968 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m03:44:26.108187 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m03:44:26.109111 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.004 seconds
[0m03:44:26.112228 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m03:44:26.119779 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m03:44:26.123415 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m03:44:26.125596 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m03:44:26.154436 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:26.156841 [debug] [MainThread]: On master: BEGIN
[0m03:44:26.158461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:44:26.173046 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m03:44:26.175551 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:26.177966 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:44:26.189786 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m03:44:26.199108 [debug] [MainThread]: On master: ROLLBACK
[0m03:44:26.202758 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:26.206138 [debug] [MainThread]: On master: BEGIN
[0m03:44:26.209100 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:44:26.211303 [debug] [MainThread]: On master: COMMIT
[0m03:44:26.213733 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:26.216812 [debug] [MainThread]: On master: COMMIT
[0m03:44:26.220825 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m03:44:26.223621 [debug] [MainThread]: On master: Close
[0m03:44:26.225963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:44:26.227736 [info ] [MainThread]: 
[0m03:44:26.244055 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m03:44:26.246718 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m03:44:26.250163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_geography)
[0m03:44:26.254121 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m03:44:26.281391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m03:44:26.369009 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m03:44:26.554656 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m03:44:26.588779 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:44:26.592321 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m03:44:26.595932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:44:26.626112 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m03:44:26.630043 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:44:26.634671 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT id AS geography_key, id AS original_id , city_name, country_name, region_name
       -- fill code here 
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m03:44:26.667095 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "city_name" does not exist
LINE 14: SELECT id AS geography_key, id AS original_id , city_name, c...
                                                         ^
HINT:  Perhaps you meant to reference the column "geography.cityname".

[0m03:44:26.672422 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: ROLLBACK
[0m03:44:26.677582 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m03:44:26.696014 [debug] [Thread-1 (]: Database Error in model dim_geography (models/dim/dim_geography.sql)
  column "city_name" does not exist
  LINE 14: SELECT id AS geography_key, id AS original_id , city_name, c...
                                                           ^
  HINT:  Perhaps you meant to reference the column "geography.cityname".
  compiled code at target/run/dbtcomp/models/dim/dim_geography.sql
[0m03:44:26.706968 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.dim_geography ........................ [[31mERROR[0m in 0.45s]
[0m03:44:26.710904 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m03:44:26.723035 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:26.726499 [debug] [MainThread]: On master: BEGIN
[0m03:44:26.729035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:44:26.746168 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m03:44:26.750262 [debug] [MainThread]: On master: COMMIT
[0m03:44:26.753745 [debug] [MainThread]: Using postgres connection "master"
[0m03:44:26.756846 [debug] [MainThread]: On master: COMMIT
[0m03:44:26.759435 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:44:26.761897 [debug] [MainThread]: On master: Close
[0m03:44:26.767667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:44:26.771670 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m03:44:26.774961 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m03:44:26.777293 [info ] [MainThread]: 
[0m03:44:26.781206 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m03:44:26.788300 [debug] [MainThread]: Command end result
[0m03:44:26.791613 [info ] [MainThread]: 
[0m03:44:26.795882 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:44:26.799441 [info ] [MainThread]: 
[0m03:44:26.804905 [error] [MainThread]:   Database Error in model dim_geography (models/dim/dim_geography.sql)
  column "city_name" does not exist
  LINE 14: SELECT id AS geography_key, id AS original_id , city_name, c...
                                                           ^
  HINT:  Perhaps you meant to reference the column "geography.cityname".
  compiled code at target/run/dbtcomp/models/dim/dim_geography.sql
[0m03:44:26.807427 [info ] [MainThread]: 
[0m03:44:26.809754 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:44:26.814949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.2186675, "process_user_time": 5.921058, "process_kernel_time": 0.509557, "process_mem_max_rss": "112472", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:44:26.819486 [debug] [MainThread]: Command `dbt run` failed at 03:44:26.818813 after 5.22 seconds
[0m03:44:26.822146 [debug] [MainThread]: Flushing usage events
[0m03:45:50.999120 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 03:45:51.016967 | 1b3a6cd8-e911-44ce-8e41-8b75c440e599 ==============================
[0m03:45:51.016967 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:45:51.020398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:45:51.840580 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:45:51.917172 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m03:45:54.228211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:45:54.231332 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_geography.sql
[0m03:45:55.191044 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m03:45:55.196272 [info ] [MainThread]: 
[0m03:45:55.198933 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:45:55.201995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m03:45:55.297825 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m03:45:55.299880 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m03:45:55.301637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:45:55.317574 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.016 seconds
[0m03:45:55.323857 [debug] [ThreadPool]: On list_sales_dw: Close
[0m03:45:55.345387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m03:45:55.346657 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m03:45:55.458166 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:45:55.463933 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:45:55.465865 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m03:45:55.468140 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m03:45:55.471933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:45:55.475069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:45:55.509627 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m03:45:55.513030 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:45:55.515734 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m03:45:55.519119 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m03:45:55.522945 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:45:55.524581 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m03:45:55.526959 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m03:45:55.535747 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m03:45:55.547354 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m03:45:55.550607 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m03:45:55.563576 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m03:45:55.566659 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m03:45:55.606692 [debug] [MainThread]: Using postgres connection "master"
[0m03:45:55.610235 [debug] [MainThread]: On master: BEGIN
[0m03:45:55.626476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:45:55.663629 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m03:45:55.668949 [debug] [MainThread]: Using postgres connection "master"
[0m03:45:55.681589 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:45:55.702837 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m03:45:55.710369 [debug] [MainThread]: On master: ROLLBACK
[0m03:45:55.712707 [debug] [MainThread]: Using postgres connection "master"
[0m03:45:55.714672 [debug] [MainThread]: On master: BEGIN
[0m03:45:55.716932 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:45:55.719914 [debug] [MainThread]: On master: COMMIT
[0m03:45:55.722568 [debug] [MainThread]: Using postgres connection "master"
[0m03:45:55.725664 [debug] [MainThread]: On master: COMMIT
[0m03:45:55.728453 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:45:55.730573 [debug] [MainThread]: On master: Close
[0m03:45:55.732717 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:45:55.734907 [info ] [MainThread]: 
[0m03:45:55.749127 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m03:45:55.751306 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m03:45:55.754657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m03:45:55.758133 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m03:45:55.780273 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m03:45:55.798621 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m03:45:55.914200 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m03:45:55.933878 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:45:55.936605 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m03:45:55.939299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:55.954839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m03:45:55.959331 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:45:55.963177 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT id AS geography_key, id AS original_geography_id , city_name AS city_name, countryname AS country_name, regionname AS region_name
       -- fill code here 
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m03:45:55.967319 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "city_name" does not exist
LINE 14: ...d AS geography_key, id AS original_geography_id , city_name ...
                                                              ^
HINT:  Perhaps you meant to reference the column "geography.cityname".

[0m03:45:55.972034 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: ROLLBACK
[0m03:45:55.977558 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m03:45:55.985282 [debug] [Thread-1 (]: Database Error in model dim_geography (models/dim/dim_geography.sql)
  column "city_name" does not exist
  LINE 14: ...d AS geography_key, id AS original_geography_id , city_name ...
                                                                ^
  HINT:  Perhaps you meant to reference the column "geography.cityname".
  compiled code at target/run/dbtcomp/models/dim/dim_geography.sql
[0m03:45:55.995552 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.dim_geography ........................ [[31mERROR[0m in 0.23s]
[0m03:45:55.999539 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m03:45:56.007665 [debug] [MainThread]: Using postgres connection "master"
[0m03:45:56.011260 [debug] [MainThread]: On master: BEGIN
[0m03:45:56.013672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:45:56.034547 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m03:45:56.038976 [debug] [MainThread]: On master: COMMIT
[0m03:45:56.042336 [debug] [MainThread]: Using postgres connection "master"
[0m03:45:56.045883 [debug] [MainThread]: On master: COMMIT
[0m03:45:56.048965 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:45:56.051194 [debug] [MainThread]: On master: Close
[0m03:45:56.055341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:45:56.058952 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m03:45:56.061376 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m03:45:56.063609 [info ] [MainThread]: 
[0m03:45:56.065831 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m03:45:56.069555 [debug] [MainThread]: Command end result
[0m03:45:56.073313 [info ] [MainThread]: 
[0m03:45:56.076845 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:45:56.079520 [info ] [MainThread]: 
[0m03:45:56.082293 [error] [MainThread]:   Database Error in model dim_geography (models/dim/dim_geography.sql)
  column "city_name" does not exist
  LINE 14: ...d AS geography_key, id AS original_geography_id , city_name ...
                                                                ^
  HINT:  Perhaps you meant to reference the column "geography.cityname".
  compiled code at target/run/dbtcomp/models/dim/dim_geography.sql
[0m03:45:56.084758 [info ] [MainThread]: 
[0m03:45:56.089213 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:45:56.094490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.2717204, "process_user_time": 6.241681, "process_kernel_time": 0.363593, "process_mem_max_rss": "115912", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:45:56.097322 [debug] [MainThread]: Command `dbt run` failed at 03:45:56.096978 after 5.27 seconds
[0m03:45:56.099504 [debug] [MainThread]: Flushing usage events
[0m03:46:49.014625 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 03:46:49.032869 | 41d294e3-0475-4d86-8c60-51d4ff8284b1 ==============================
[0m03:46:49.032869 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:46:49.037469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'send_anonymous_usage_stats': 'True'}
[0m03:46:49.640535 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:46:49.717568 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m03:46:52.236947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:46:52.238850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:46:52.434284 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m03:46:52.438859 [info ] [MainThread]: 
[0m03:46:52.441281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:46:52.445939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m03:46:52.550740 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m03:46:52.553595 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m03:46:52.559615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:46:52.580504 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.021 seconds
[0m03:46:52.586985 [debug] [ThreadPool]: On list_sales_dw: Close
[0m03:46:52.610132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m03:46:52.612371 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m03:46:52.634738 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:46:52.639533 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:46:52.641293 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m03:46:52.644204 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m03:46:52.646805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:46:52.650962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:46:52.668550 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m03:46:52.669994 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m03:46:52.672035 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:46:52.673937 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:46:52.677265 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m03:46:52.680391 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m03:46:52.688511 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m03:46:52.689386 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.004 seconds
[0m03:46:52.693272 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m03:46:52.701321 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m03:46:52.704107 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m03:46:52.705959 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m03:46:52.733470 [debug] [MainThread]: Using postgres connection "master"
[0m03:46:52.735718 [debug] [MainThread]: On master: BEGIN
[0m03:46:52.737302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:46:52.751095 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m03:46:52.754140 [debug] [MainThread]: Using postgres connection "master"
[0m03:46:52.756302 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:46:52.768561 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m03:46:52.775026 [debug] [MainThread]: On master: ROLLBACK
[0m03:46:52.778785 [debug] [MainThread]: Using postgres connection "master"
[0m03:46:52.782464 [debug] [MainThread]: On master: BEGIN
[0m03:46:52.785697 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:46:52.788344 [debug] [MainThread]: On master: COMMIT
[0m03:46:52.790130 [debug] [MainThread]: Using postgres connection "master"
[0m03:46:52.792445 [debug] [MainThread]: On master: COMMIT
[0m03:46:52.796060 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:46:52.800028 [debug] [MainThread]: On master: Close
[0m03:46:52.803516 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:46:52.805790 [info ] [MainThread]: 
[0m03:46:52.822354 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m03:46:52.824754 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m03:46:52.828511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_geography)
[0m03:46:52.831840 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m03:46:52.854729 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m03:46:52.872997 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m03:46:53.066548 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m03:46:53.087617 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:46:53.089282 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m03:46:53.090717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:53.105347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m03:46:53.108276 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:46:53.112615 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT id AS geography_key, id AS original_geography_id , city_name AS city_name, countryname AS country_name, regionname AS region_name
       -- fill code here 
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m03:46:53.118029 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "city_name" does not exist
LINE 14: ...d AS geography_key, id AS original_geography_id , city_name ...
                                                              ^
HINT:  Perhaps you meant to reference the column "geography.cityname".

[0m03:46:53.121470 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: ROLLBACK
[0m03:46:53.124406 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m03:46:53.134177 [debug] [Thread-1 (]: Database Error in model dim_geography (models/dim/dim_geography.sql)
  column "city_name" does not exist
  LINE 14: ...d AS geography_key, id AS original_geography_id , city_name ...
                                                                ^
  HINT:  Perhaps you meant to reference the column "geography.cityname".
  compiled code at target/run/dbtcomp/models/dim/dim_geography.sql
[0m03:46:53.139446 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.dim_geography ........................ [[31mERROR[0m in 0.31s]
[0m03:46:53.142939 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m03:46:53.150740 [debug] [MainThread]: Using postgres connection "master"
[0m03:46:53.152826 [debug] [MainThread]: On master: BEGIN
[0m03:46:53.155093 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:46:53.170866 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m03:46:53.173371 [debug] [MainThread]: On master: COMMIT
[0m03:46:53.176251 [debug] [MainThread]: Using postgres connection "master"
[0m03:46:53.178738 [debug] [MainThread]: On master: COMMIT
[0m03:46:53.182752 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:46:53.185478 [debug] [MainThread]: On master: Close
[0m03:46:53.187719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:46:53.189429 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m03:46:53.191189 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m03:46:53.194801 [info ] [MainThread]: 
[0m03:46:53.198572 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m03:46:53.202211 [debug] [MainThread]: Command end result
[0m03:46:53.204303 [info ] [MainThread]: 
[0m03:46:53.206877 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:46:53.209419 [info ] [MainThread]: 
[0m03:46:53.212303 [error] [MainThread]:   Database Error in model dim_geography (models/dim/dim_geography.sql)
  column "city_name" does not exist
  LINE 14: ...d AS geography_key, id AS original_geography_id , city_name ...
                                                                ^
  HINT:  Perhaps you meant to reference the column "geography.cityname".
  compiled code at target/run/dbtcomp/models/dim/dim_geography.sql
[0m03:46:53.216661 [info ] [MainThread]: 
[0m03:46:53.218735 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:46:53.221595 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.4242864, "process_user_time": 6.334318, "process_kernel_time": 0.4431, "process_mem_max_rss": "112464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:46:53.223740 [debug] [MainThread]: Command `dbt run` failed at 03:46:53.223519 after 4.43 seconds
[0m03:46:53.227220 [debug] [MainThread]: Flushing usage events
[0m03:47:28.341635 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 03:47:28.353386 | 45427740-60cc-4bd7-8c44-569a58406247 ==============================
[0m03:47:28.353386 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:47:28.357035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:47:29.075235 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:47:29.169306 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m03:47:31.406946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:47:31.415359 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:47:31.679653 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m03:47:31.686071 [info ] [MainThread]: 
[0m03:47:31.689928 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:47:31.693784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m03:47:31.798945 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m03:47:31.802217 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m03:47:31.804961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:31.833707 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.029 seconds
[0m03:47:31.861770 [debug] [ThreadPool]: On list_sales_dw: Close
[0m03:47:31.950306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m03:47:31.953871 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m03:47:32.020904 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:47:32.051693 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:47:32.053317 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m03:47:32.057846 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m03:47:32.062978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:47:32.067589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:32.102803 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m03:47:32.107886 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:47:32.111493 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m03:47:32.114807 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m03:47:32.118792 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:47:32.129233 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m03:47:32.136186 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m03:47:32.147912 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.014 seconds
[0m03:47:32.146966 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m03:47:32.155591 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m03:47:32.161569 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m03:47:32.165333 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m03:47:32.200384 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:32.203783 [debug] [MainThread]: On master: BEGIN
[0m03:47:32.207606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:47:32.223750 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m03:47:32.227307 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:32.229248 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:47:32.239359 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m03:47:32.246997 [debug] [MainThread]: On master: ROLLBACK
[0m03:47:32.249707 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:32.252728 [debug] [MainThread]: On master: BEGIN
[0m03:47:32.258520 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:47:32.262908 [debug] [MainThread]: On master: COMMIT
[0m03:47:32.266330 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:32.269737 [debug] [MainThread]: On master: COMMIT
[0m03:47:32.273585 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m03:47:32.276330 [debug] [MainThread]: On master: Close
[0m03:47:32.279429 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:47:32.281443 [info ] [MainThread]: 
[0m03:47:32.297704 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m03:47:32.301020 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m03:47:32.304399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_geography)
[0m03:47:32.307289 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m03:47:32.328336 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m03:47:32.344698 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m03:47:32.445291 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m03:47:32.461432 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:47:32.463141 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m03:47:32.464683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:47:32.478052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m03:47:32.480869 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:47:32.483769 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT id AS geography_key, id AS original_geography_id , city_name AS city_name, countryname AS country_name, regionname AS region_name
       -- fill code here 
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m03:47:32.487437 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "city_name" does not exist
LINE 14: ...d AS geography_key, id AS original_geography_id , city_name ...
                                                              ^
HINT:  Perhaps you meant to reference the column "geography.cityname".

[0m03:47:32.490953 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: ROLLBACK
[0m03:47:32.494114 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m03:47:32.499864 [debug] [Thread-1 (]: Database Error in model dim_geography (models/dim/dim_geography.sql)
  column "city_name" does not exist
  LINE 14: ...d AS geography_key, id AS original_geography_id , city_name ...
                                                                ^
  HINT:  Perhaps you meant to reference the column "geography.cityname".
  compiled code at target/run/dbtcomp/models/dim/dim_geography.sql
[0m03:47:32.506685 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.dim_geography ........................ [[31mERROR[0m in 0.20s]
[0m03:47:32.509765 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m03:47:32.515639 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:32.519365 [debug] [MainThread]: On master: BEGIN
[0m03:47:32.523180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:47:32.536187 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m03:47:32.540322 [debug] [MainThread]: On master: COMMIT
[0m03:47:32.542944 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:32.545218 [debug] [MainThread]: On master: COMMIT
[0m03:47:32.547447 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:47:32.550245 [debug] [MainThread]: On master: Close
[0m03:47:32.553113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:47:32.556254 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m03:47:32.558712 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m03:47:32.560809 [info ] [MainThread]: 
[0m03:47:32.562611 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m03:47:32.565242 [debug] [MainThread]: Command end result
[0m03:47:32.567435 [info ] [MainThread]: 
[0m03:47:32.569878 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:47:32.572729 [info ] [MainThread]: 
[0m03:47:32.575576 [error] [MainThread]:   Database Error in model dim_geography (models/dim/dim_geography.sql)
  column "city_name" does not exist
  LINE 14: ...d AS geography_key, id AS original_geography_id , city_name ...
                                                                ^
  HINT:  Perhaps you meant to reference the column "geography.cityname".
  compiled code at target/run/dbtcomp/models/dim/dim_geography.sql
[0m03:47:32.577527 [info ] [MainThread]: 
[0m03:47:32.579181 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:47:32.581808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.4120383, "process_user_time": 5.539615, "process_kernel_time": 0.32879, "process_mem_max_rss": "110912", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:47:32.585391 [debug] [MainThread]: Command `dbt run` failed at 03:47:32.585033 after 4.42 seconds
[0m03:47:32.588453 [debug] [MainThread]: Flushing usage events
[0m03:47:50.845518 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 03:47:50.873113 | 6b2dd81c-38f1-4958-a59c-4d11e32e79bc ==============================
[0m03:47:50.873113 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:47:50.877293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:47:51.774068 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:47:51.850270 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m03:47:54.624846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:47:54.629811 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/dim/dim_geography.sql
[0m03:47:55.686274 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m03:47:55.689903 [info ] [MainThread]: 
[0m03:47:55.692828 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:47:55.696989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m03:47:55.785534 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m03:47:55.787757 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m03:47:55.789377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:55.806990 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.017 seconds
[0m03:47:55.813129 [debug] [ThreadPool]: On list_sales_dw: Close
[0m03:47:55.834583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m03:47:55.836563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m03:47:55.986859 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:47:55.995022 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:47:55.997730 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m03:47:56.001262 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m03:47:56.003936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:47:56.006092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:56.022992 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m03:47:56.026333 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m03:47:56.029928 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:47:56.033318 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:47:56.035823 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m03:47:56.038029 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m03:47:56.047980 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m03:47:56.049429 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m03:47:56.053908 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m03:47:56.060209 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m03:47:56.063854 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m03:47:56.067276 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m03:47:56.102751 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:56.105276 [debug] [MainThread]: On master: BEGIN
[0m03:47:56.107367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:47:56.125722 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m03:47:56.129547 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:56.134159 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:47:56.145335 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m03:47:56.155548 [debug] [MainThread]: On master: ROLLBACK
[0m03:47:56.158971 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:56.162301 [debug] [MainThread]: On master: BEGIN
[0m03:47:56.166619 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:47:56.169954 [debug] [MainThread]: On master: COMMIT
[0m03:47:56.172204 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:56.174434 [debug] [MainThread]: On master: COMMIT
[0m03:47:56.178418 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:47:56.183116 [debug] [MainThread]: On master: Close
[0m03:47:56.186132 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:47:56.188782 [info ] [MainThread]: 
[0m03:47:56.210011 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m03:47:56.213666 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m03:47:56.217938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m03:47:56.220512 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m03:47:56.247483 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m03:47:56.264202 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m03:47:56.402271 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m03:47:56.427197 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:47:56.430666 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m03:47:56.433871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:47:56.471418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m03:47:56.493396 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:47:56.500938 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT id AS geography_key, id AS original_geography_id , cityname AS city_name, countryname AS country_name, regionname AS region_name
       -- fill code here 
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m03:47:56.653008 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.123 seconds
[0m03:47:56.688791 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:47:56.694256 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography" rename to "dim_geography__dbt_backup"
[0m03:47:56.701938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:47:56.720023 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:47:56.723471 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m03:47:56.728803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:47:56.840676 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m03:47:56.844234 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:47:56.849529 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m03:47:56.855251 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m03:47:56.877914 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m03:47:56.893466 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m03:47:56.898033 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m03:47:56.961255 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.059 seconds
[0m03:47:56.971497 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m03:47:56.981104 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 0.76s]
[0m03:47:56.986436 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m03:47:56.991728 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:56.995961 [debug] [MainThread]: On master: BEGIN
[0m03:47:57.001258 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:47:57.019732 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m03:47:57.022726 [debug] [MainThread]: On master: COMMIT
[0m03:47:57.027059 [debug] [MainThread]: Using postgres connection "master"
[0m03:47:57.030574 [debug] [MainThread]: On master: COMMIT
[0m03:47:57.035907 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m03:47:57.038013 [debug] [MainThread]: On master: Close
[0m03:47:57.040526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:47:57.044115 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m03:47:57.047373 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m03:47:57.051946 [info ] [MainThread]: 
[0m03:47:57.054700 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m03:47:57.059612 [debug] [MainThread]: Command end result
[0m03:47:57.063050 [info ] [MainThread]: 
[0m03:47:57.067976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:47:57.071303 [info ] [MainThread]: 
[0m03:47:57.075462 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:47:57.080671 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4576964, "process_user_time": 7.53021, "process_kernel_time": 0.485167, "process_mem_max_rss": "114708", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:47:57.086646 [debug] [MainThread]: Command `dbt run` succeeded at 03:47:57.086074 after 6.46 seconds
[0m03:47:57.089139 [debug] [MainThread]: Flushing usage events
[0m03:48:06.362635 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 03:48:06.384627 | 93711a0a-166c-4eda-9acb-72e72331dc75 ==============================
[0m03:48:06.384627 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:48:06.389196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:48:07.304498 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:48:07.416443 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m03:48:10.408644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:48:10.412790 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:48:10.693326 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m03:48:10.700695 [info ] [MainThread]: 
[0m03:48:10.703460 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:48:10.709583 [debug] [MainThread]: Command end result
[0m03:48:10.714331 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.6803856, "process_user_time": 7.071805, "process_kernel_time": 0.536202, "process_mem_max_rss": "101892", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:48:10.718141 [debug] [MainThread]: Command `dbt test` succeeded at 03:48:10.717873 after 4.68 seconds
[0m03:48:10.719857 [debug] [MainThread]: Flushing usage events
[0m03:56:29.727358 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 03:56:29.757131 | d14b4bd4-be86-43a8-9a30-76c916931144 ==============================
[0m03:56:29.757131 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:56:29.760249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:56:30.517305 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:56:30.609155 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m03:56:33.478459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:56:33.482046 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/fact/fact_sales.sql
[0m03:56:34.116272 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m03:56:34.121525 [info ] [MainThread]: 
[0m03:56:34.123951 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:56:34.128434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m03:56:34.227571 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m03:56:34.230357 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m03:56:34.234691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:34.252943 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.018 seconds
[0m03:56:34.256235 [debug] [ThreadPool]: On list_sales_dw: Close
[0m03:56:34.272498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m03:56:34.273849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m03:56:34.419797 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:56:34.425177 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:56:34.432558 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m03:56:34.436021 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m03:56:34.438609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:34.441825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:34.484490 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m03:56:34.497209 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:56:34.494430 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m03:56:34.524009 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m03:56:34.532352 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:56:34.538774 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m03:56:34.545263 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.009 seconds
[0m03:56:34.554118 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m03:56:34.555622 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m03:56:34.560846 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m03:56:34.579343 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m03:56:34.609084 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m03:56:34.636737 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:34.639842 [debug] [MainThread]: On master: BEGIN
[0m03:56:34.642188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:56:34.660835 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m03:56:34.667732 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:34.672403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:56:34.690375 [debug] [MainThread]: SQL status: SELECT 12 in 0.014 seconds
[0m03:56:34.701877 [debug] [MainThread]: On master: ROLLBACK
[0m03:56:34.704256 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:34.706049 [debug] [MainThread]: On master: BEGIN
[0m03:56:34.708183 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:56:34.712616 [debug] [MainThread]: On master: COMMIT
[0m03:56:34.716155 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:34.719780 [debug] [MainThread]: On master: COMMIT
[0m03:56:34.721800 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:56:34.723293 [debug] [MainThread]: On master: Close
[0m03:56:34.725845 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:56:34.729952 [info ] [MainThread]: 
[0m03:56:34.748887 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m03:56:34.754367 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m03:56:34.758255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.fact_sales)
[0m03:56:34.762988 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m03:56:34.793491 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m03:56:34.817990 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m03:56:34.968146 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m03:56:35.002884 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:56:35.006781 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m03:56:35.011885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:35.027204 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m03:56:35.030572 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:56:35.034243 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
	product_key,
	channel_key,
	bought_date_key,
	geography_key,
    sales_agent_key,
    total_amount
     -- fill code here 
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m03:56:35.036939 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "sales_agent_key" does not exist
LINE 20:     sales_agent_key,
             ^

[0m03:56:35.039759 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: ROLLBACK
[0m03:56:35.042739 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m03:56:35.051400 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact/fact_sales.sql)
  column "sales_agent_key" does not exist
  LINE 20:     sales_agent_key,
               ^
  compiled code at target/run/dbtcomp/models/fact/fact_sales.sql
[0m03:56:35.055558 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.fact_sales ........................... [[31mERROR[0m in 0.30s]
[0m03:56:35.057649 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m03:56:35.066790 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:35.069088 [debug] [MainThread]: On master: BEGIN
[0m03:56:35.070721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:56:35.084608 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m03:56:35.086854 [debug] [MainThread]: On master: COMMIT
[0m03:56:35.088502 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:35.090306 [debug] [MainThread]: On master: COMMIT
[0m03:56:35.093619 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m03:56:35.095963 [debug] [MainThread]: On master: Close
[0m03:56:35.100012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:56:35.101859 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m03:56:35.103466 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m03:56:35.105647 [info ] [MainThread]: 
[0m03:56:35.107332 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m03:56:35.111295 [debug] [MainThread]: Command end result
[0m03:56:35.113883 [info ] [MainThread]: 
[0m03:56:35.117765 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:56:35.119908 [info ] [MainThread]: 
[0m03:56:35.122015 [error] [MainThread]:   Database Error in model fact_sales (models/fact/fact_sales.sql)
  column "sales_agent_key" does not exist
  LINE 20:     sales_agent_key,
               ^
  compiled code at target/run/dbtcomp/models/fact/fact_sales.sql
[0m03:56:35.123582 [info ] [MainThread]: 
[0m03:56:35.126278 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:56:35.130056 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.653792, "process_user_time": 7.270269, "process_kernel_time": 0.608349, "process_mem_max_rss": "114280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:56:35.133624 [debug] [MainThread]: Command `dbt run` failed at 03:56:35.133347 after 5.66 seconds
[0m03:56:35.135171 [debug] [MainThread]: Flushing usage events
[0m03:57:46.362539 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 03:57:46.379819 | 3013738c-4500-49a6-88da-880c00cbeaa9 ==============================
[0m03:57:46.379819 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:57:46.383054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:57:47.131596 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:57:47.199599 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m03:57:49.621362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:57:49.624751 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/fact/fact_sales.sql
[0m03:57:50.460165 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m03:57:50.463766 [info ] [MainThread]: 
[0m03:57:50.467542 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:57:50.472350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m03:57:50.551556 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m03:57:50.554734 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m03:57:50.557224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:50.572197 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.015 seconds
[0m03:57:50.575984 [debug] [ThreadPool]: On list_sales_dw: Close
[0m03:57:50.590574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m03:57:50.592117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m03:57:50.746792 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:57:50.743954 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:57:50.750002 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m03:57:50.752692 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m03:57:50.756481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:50.759192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:57:50.774414 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m03:57:50.776322 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m03:57:50.777887 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:57:50.780522 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:57:50.785706 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m03:57:50.789619 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m03:57:50.798926 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m03:57:50.800588 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m03:57:50.808201 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m03:57:50.811593 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m03:57:50.813790 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m03:57:50.816679 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m03:57:50.846171 [debug] [MainThread]: Using postgres connection "master"
[0m03:57:50.849792 [debug] [MainThread]: On master: BEGIN
[0m03:57:50.852712 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:57:50.871987 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m03:57:50.875567 [debug] [MainThread]: Using postgres connection "master"
[0m03:57:50.878111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:57:50.889692 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m03:57:50.897062 [debug] [MainThread]: On master: ROLLBACK
[0m03:57:50.900273 [debug] [MainThread]: Using postgres connection "master"
[0m03:57:50.904101 [debug] [MainThread]: On master: BEGIN
[0m03:57:50.909136 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:57:50.912864 [debug] [MainThread]: On master: COMMIT
[0m03:57:50.916170 [debug] [MainThread]: Using postgres connection "master"
[0m03:57:50.919046 [debug] [MainThread]: On master: COMMIT
[0m03:57:50.924769 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m03:57:50.928375 [debug] [MainThread]: On master: Close
[0m03:57:50.931761 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:57:50.935480 [info ] [MainThread]: 
[0m03:57:50.954597 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m03:57:50.959467 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m03:57:50.962642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.fact_sales)
[0m03:57:50.966167 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m03:57:50.994020 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m03:57:51.015117 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m03:57:51.193327 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m03:57:51.222046 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:57:51.225064 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m03:57:51.227150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:51.241440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m03:57:51.244120 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:57:51.245963 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
	product_key,
	channel_key,
	bought_date_key,
	geography_key,
    reseller_id AS sales_agent_key,
    total_amount
     -- fill code here 
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m03:58:06.114776 [debug] [Thread-1 (]: SQL status: SELECT 1159210 in 14.868 seconds
[0m03:58:06.167075 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:58:06.177188 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales" rename to "fact_sales__dbt_backup"
[0m03:58:06.184646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:58:06.211868 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:58:06.228120 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m03:58:06.233538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:58:06.322068 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m03:58:06.328476 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:58:06.332453 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m03:58:06.347906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m03:58:06.394529 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m03:58:06.423782 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m03:58:06.428994 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m03:58:06.483769 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.050 seconds
[0m03:58:06.500605 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m03:58:06.509743 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1159210[0m in 15.54s]
[0m03:58:06.515592 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m03:58:06.523926 [debug] [MainThread]: Using postgres connection "master"
[0m03:58:06.527225 [debug] [MainThread]: On master: BEGIN
[0m03:58:06.529642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:58:06.549288 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m03:58:06.553117 [debug] [MainThread]: On master: COMMIT
[0m03:58:06.556832 [debug] [MainThread]: Using postgres connection "master"
[0m03:58:06.560194 [debug] [MainThread]: On master: COMMIT
[0m03:58:06.564320 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m03:58:06.569404 [debug] [MainThread]: On master: Close
[0m03:58:06.573543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:58:06.576231 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m03:58:06.578313 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m03:58:06.581728 [info ] [MainThread]: 
[0m03:58:06.585055 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.11 seconds (16.11s).
[0m03:58:06.589375 [debug] [MainThread]: Command end result
[0m03:58:06.592013 [info ] [MainThread]: 
[0m03:58:06.594871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:58:06.598358 [info ] [MainThread]: 
[0m03:58:06.601849 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:58:06.606157 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.519571, "process_user_time": 7.58528, "process_kernel_time": 0.488716, "process_mem_max_rss": "117536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:58:06.608659 [debug] [MainThread]: Command `dbt run` succeeded at 03:58:06.608300 after 20.52 seconds
[0m03:58:06.611009 [debug] [MainThread]: Flushing usage events
[0m03:58:13.691390 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 03:58:13.709157 | b0348d7b-13dc-47cb-ba44-cbe7c3c704ec ==============================
[0m03:58:13.709157 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:58:13.713367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:58:14.295836 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:58:14.383560 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m03:58:16.571520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:58:16.574435 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:58:16.857755 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m03:58:16.863326 [info ] [MainThread]: 
[0m03:58:16.865673 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:58:16.881699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m03:58:16.885357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m03:58:16.990389 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:58:16.991689 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:58:16.993610 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m03:58:16.995427 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m03:58:16.996926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:58:16.999202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:58:17.015153 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m03:58:17.018236 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m03:58:17.020462 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m03:58:17.022886 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m03:58:17.026261 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m03:58:17.030401 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m03:58:17.032888 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m03:58:17.036464 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m03:58:17.037452 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m03:58:17.039732 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m03:58:17.044613 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m03:58:17.048865 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m03:58:17.068258 [debug] [MainThread]: Using postgres connection "master"
[0m03:58:17.070854 [debug] [MainThread]: On master: BEGIN
[0m03:58:17.072960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:58:17.085100 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m03:58:17.088511 [debug] [MainThread]: Using postgres connection "master"
[0m03:58:17.093635 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:58:17.102445 [debug] [MainThread]: SQL status: SELECT 12 in 0.006 seconds
[0m03:58:17.112072 [debug] [MainThread]: On master: ROLLBACK
[0m03:58:17.114142 [debug] [MainThread]: Using postgres connection "master"
[0m03:58:17.115832 [debug] [MainThread]: On master: BEGIN
[0m03:58:17.118405 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:58:17.122357 [debug] [MainThread]: On master: COMMIT
[0m03:58:17.125415 [debug] [MainThread]: Using postgres connection "master"
[0m03:58:17.128833 [debug] [MainThread]: On master: COMMIT
[0m03:58:17.131422 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:58:17.133335 [debug] [MainThread]: On master: Close
[0m03:58:17.135481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:58:17.139796 [info ] [MainThread]: 
[0m03:58:17.156175 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m03:58:17.159435 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m03:58:17.163064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now test.dbtcomp.total_amount_is_non_negative)
[0m03:58:17.165207 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m03:58:17.188096 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m03:58:17.204022 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m03:58:17.255566 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m03:58:17.290311 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m03:58:17.293436 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m03:58:17.295512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:58:17.311516 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m03:58:17.314823 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m03:58:17.317559 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m03:58:17.599586 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.279 seconds
[0m03:58:17.610236 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m03:58:17.612649 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m03:58:17.615308 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.45s]
[0m03:58:17.617760 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m03:58:17.623402 [debug] [MainThread]: Using postgres connection "master"
[0m03:58:17.626330 [debug] [MainThread]: On master: BEGIN
[0m03:58:17.628101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:58:17.641146 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m03:58:17.643609 [debug] [MainThread]: On master: COMMIT
[0m03:58:17.645374 [debug] [MainThread]: Using postgres connection "master"
[0m03:58:17.646960 [debug] [MainThread]: On master: COMMIT
[0m03:58:17.648793 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:58:17.650352 [debug] [MainThread]: On master: Close
[0m03:58:17.653734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:58:17.656273 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m03:58:17.658917 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m03:58:17.660922 [info ] [MainThread]: 
[0m03:58:17.662660 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m03:58:17.665401 [debug] [MainThread]: Command end result
[0m03:58:17.667149 [info ] [MainThread]: 
[0m03:58:17.669946 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:58:17.672619 [info ] [MainThread]: 
[0m03:58:17.676055 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:58:17.679559 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.1239014, "process_user_time": 5.396691, "process_kernel_time": 0.379767, "process_mem_max_rss": "113316", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:58:17.681920 [debug] [MainThread]: Command `dbt test` succeeded at 03:58:17.681699 after 4.13 seconds
[0m03:58:17.683929 [debug] [MainThread]: Flushing usage events
[0m04:34:50.112634 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:34:50.146540 | 4b073a6e-5130-4344-ac0d-c1c38e80fc17 ==============================
[0m04:34:50.146540 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:34:50.149370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:34:50.944821 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:34:51.030299 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:34:53.645569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:34:53.648678 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/fact/fact_sales.sql
[0m04:34:54.548276 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:34:54.554618 [info ] [MainThread]: 
[0m04:34:54.558915 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:34:54.562210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m04:34:54.678760 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m04:34:54.681605 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m04:34:54.683454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:34:54.703653 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.020 seconds
[0m04:34:54.709561 [debug] [ThreadPool]: On list_sales_dw: Close
[0m04:34:54.723696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m04:34:54.725083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m04:34:54.834474 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:34:54.841938 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:34:54.843632 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m04:34:54.845564 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m04:34:54.847635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:54.849306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:34:54.874600 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m04:34:54.878739 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m04:34:54.880474 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:34:54.884125 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:34:54.887835 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m04:34:54.891775 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m04:34:54.902010 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m04:34:54.902979 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m04:34:54.908638 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m04:34:54.913129 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m04:34:54.915575 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m04:34:54.918222 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m04:34:54.946129 [debug] [MainThread]: Using postgres connection "master"
[0m04:34:54.948142 [debug] [MainThread]: On master: BEGIN
[0m04:34:54.950040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:34:54.965292 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m04:34:54.968907 [debug] [MainThread]: Using postgres connection "master"
[0m04:34:54.972025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:34:54.986032 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m04:34:54.999002 [debug] [MainThread]: On master: ROLLBACK
[0m04:34:55.002459 [debug] [MainThread]: Using postgres connection "master"
[0m04:34:55.004875 [debug] [MainThread]: On master: BEGIN
[0m04:34:55.009831 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:34:55.012474 [debug] [MainThread]: On master: COMMIT
[0m04:34:55.014365 [debug] [MainThread]: Using postgres connection "master"
[0m04:34:55.016011 [debug] [MainThread]: On master: COMMIT
[0m04:34:55.019289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:34:55.021879 [debug] [MainThread]: On master: Close
[0m04:34:55.025874 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:34:55.028122 [info ] [MainThread]: 
[0m04:34:55.043666 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m04:34:55.046034 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m04:34:55.047792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.fact_sales)
[0m04:34:55.083441 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m04:34:55.108297 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m04:34:55.126336 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m04:34:55.230671 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m04:34:55.251886 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m04:34:55.254348 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m04:34:55.257028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:55.272591 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m04:34:55.276336 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m04:34:55.278864 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
	product_key,
	channel_key,
	bought_date_key,
	geography_key,
    reseller_name,
    commission_pct AS commissionpaid,
    total_amount
     -- fill code here 
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m04:34:55.282477 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "reseller_name" does not exist
LINE 20:     reseller_name,
             ^

[0m04:34:55.286638 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: ROLLBACK
[0m04:34:55.289818 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m04:34:55.314970 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact/fact_sales.sql)
  column "reseller_name" does not exist
  LINE 20:     reseller_name,
               ^
  compiled code at target/run/dbtcomp/models/fact/fact_sales.sql
[0m04:34:55.328571 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.fact_sales ........................... [[31mERROR[0m in 0.27s]
[0m04:34:55.332821 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m04:34:55.342133 [debug] [MainThread]: Using postgres connection "master"
[0m04:34:55.345319 [debug] [MainThread]: On master: BEGIN
[0m04:34:55.347375 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:34:55.361002 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m04:34:55.364075 [debug] [MainThread]: On master: COMMIT
[0m04:34:55.365529 [debug] [MainThread]: Using postgres connection "master"
[0m04:34:55.368055 [debug] [MainThread]: On master: COMMIT
[0m04:34:55.370657 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:34:55.374413 [debug] [MainThread]: On master: Close
[0m04:34:55.376810 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:34:55.378463 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m04:34:55.380047 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m04:34:55.381627 [info ] [MainThread]: 
[0m04:34:55.383276 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m04:34:55.387047 [debug] [MainThread]: Command end result
[0m04:34:55.390879 [info ] [MainThread]: 
[0m04:34:55.393097 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:34:55.394649 [info ] [MainThread]: 
[0m04:34:55.396116 [error] [MainThread]:   Database Error in model fact_sales (models/fact/fact_sales.sql)
  column "reseller_name" does not exist
  LINE 20:     reseller_name,
               ^
  compiled code at target/run/dbtcomp/models/fact/fact_sales.sql
[0m04:34:55.397429 [info ] [MainThread]: 
[0m04:34:55.398763 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:34:55.402623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.468684, "process_user_time": 6.108689, "process_kernel_time": 1.025017, "process_mem_max_rss": "115380", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:34:55.406937 [debug] [MainThread]: Command `dbt run` failed at 04:34:55.406537 after 5.47 seconds
[0m04:34:55.409458 [debug] [MainThread]: Flushing usage events
[0m04:36:45.751402 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:36:45.767202 | 00343316-4fd7-47ba-8f25-b4cccee625bd ==============================
[0m04:36:45.767202 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:36:45.770697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:36:46.400576 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:36:46.482158 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:36:48.870635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:36:48.875369 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/fact/fact_sales.sql
[0m04:36:50.408703 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:36:50.416888 [info ] [MainThread]: 
[0m04:36:50.420971 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:36:50.425105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m04:36:50.556650 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m04:36:50.559576 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m04:36:50.562374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:50.593360 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.031 seconds
[0m04:36:50.600216 [debug] [ThreadPool]: On list_sales_dw: Close
[0m04:36:50.649071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m04:36:50.652456 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m04:36:50.938365 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:36:50.956070 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m04:36:50.944035 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:36:50.969437 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m04:36:50.974748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:50.959680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:51.009423 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m04:36:51.021292 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:36:51.024859 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m04:36:51.028198 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m04:36:51.031522 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:36:51.035716 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m04:36:51.038269 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.011 seconds
[0m04:36:51.046797 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m04:36:51.047966 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m04:36:51.051084 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m04:36:51.056172 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m04:36:51.068950 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m04:36:51.091346 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:51.093863 [debug] [MainThread]: On master: BEGIN
[0m04:36:51.097480 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:36:51.156153 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m04:36:51.160133 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:51.166427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:36:51.179956 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m04:36:51.196278 [debug] [MainThread]: On master: ROLLBACK
[0m04:36:51.203043 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:51.207397 [debug] [MainThread]: On master: BEGIN
[0m04:36:51.211965 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:36:51.217811 [debug] [MainThread]: On master: COMMIT
[0m04:36:51.225672 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:51.229522 [debug] [MainThread]: On master: COMMIT
[0m04:36:51.235713 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:36:51.240911 [debug] [MainThread]: On master: Close
[0m04:36:51.244986 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:36:51.249857 [info ] [MainThread]: 
[0m04:36:51.276040 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m04:36:51.283009 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m04:36:51.290957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.fact_sales)
[0m04:36:51.294649 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m04:36:51.324264 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m04:36:51.343091 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m04:36:51.542029 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m04:36:51.607859 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m04:36:51.611588 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m04:36:51.616332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:51.637052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m04:36:51.640936 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m04:36:51.643167 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
	product_key,
	channel_key,
	bought_date_key,
	geography_key,
    reseller_id,
    commission_pct AS commissionpaid,
    total_amount
     -- fill code here 
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m04:36:51.647711 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "commission_pct" does not exist
LINE 21:     commission_pct AS commissionpaid,
             ^
HINT:  Perhaps you meant to reference the column "staging_transactions.commissionpct".

[0m04:36:51.651652 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: ROLLBACK
[0m04:36:51.657623 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m04:36:51.667661 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact/fact_sales.sql)
  column "commission_pct" does not exist
  LINE 21:     commission_pct AS commissionpaid,
               ^
  HINT:  Perhaps you meant to reference the column "staging_transactions.commissionpct".
  compiled code at target/run/dbtcomp/models/fact/fact_sales.sql
[0m04:36:51.674742 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.fact_sales ........................... [[31mERROR[0m in 0.38s]
[0m04:36:51.680396 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m04:36:51.689123 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:51.691681 [debug] [MainThread]: On master: BEGIN
[0m04:36:51.694845 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:36:51.716598 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m04:36:51.720189 [debug] [MainThread]: On master: COMMIT
[0m04:36:51.723315 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:51.725628 [debug] [MainThread]: On master: COMMIT
[0m04:36:51.728904 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:36:51.733478 [debug] [MainThread]: On master: Close
[0m04:36:51.737669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:51.739859 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m04:36:51.742386 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m04:36:51.746722 [info ] [MainThread]: 
[0m04:36:51.750876 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m04:36:51.755389 [debug] [MainThread]: Command end result
[0m04:36:51.757678 [info ] [MainThread]: 
[0m04:36:51.760514 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:36:51.764645 [info ] [MainThread]: 
[0m04:36:51.768640 [error] [MainThread]:   Database Error in model fact_sales (models/fact/fact_sales.sql)
  column "commission_pct" does not exist
  LINE 21:     commission_pct AS commissionpaid,
               ^
  HINT:  Perhaps you meant to reference the column "staging_transactions.commissionpct".
  compiled code at target/run/dbtcomp/models/fact/fact_sales.sql
[0m04:36:51.772316 [info ] [MainThread]: 
[0m04:36:51.775855 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:36:51.781493 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.212737, "process_user_time": 7.858754, "process_kernel_time": 0.496996, "process_mem_max_rss": "115660", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:36:51.785927 [debug] [MainThread]: Command `dbt run` failed at 04:36:51.785382 after 6.22 seconds
[0m04:36:51.789272 [debug] [MainThread]: Flushing usage events
[0m04:45:41.413975 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:45:41.466949 | c400eece-708a-4a25-861d-29c3500723f5 ==============================
[0m04:45:41.466949 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:45:41.472062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:45:42.571782 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:45:42.674702 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:45:45.721208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:45:45.724452 [debug] [MainThread]: Partial parsing: updated file: dbtcomp://models/fact/fact_sales.sql
[0m04:45:47.070053 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:45:47.076255 [info ] [MainThread]: 
[0m04:45:47.079964 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:45:47.084855 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m04:45:47.193094 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m04:45:47.198470 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m04:45:47.203193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:45:47.231566 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.028 seconds
[0m04:45:47.241068 [debug] [ThreadPool]: On list_sales_dw: Close
[0m04:45:47.275029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m04:45:47.278261 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m04:45:47.429115 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:45:47.435660 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:45:47.445346 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m04:45:47.448266 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m04:45:47.451186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:45:47.453245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:45:47.465798 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m04:45:47.468309 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m04:45:47.471715 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:45:47.474168 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:45:47.476261 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m04:45:47.478184 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m04:45:47.486795 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.006 seconds
[0m04:45:47.487556 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m04:45:47.490902 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m04:45:47.494396 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m04:45:47.497810 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m04:45:47.500715 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m04:45:47.522303 [debug] [MainThread]: Using postgres connection "master"
[0m04:45:47.525871 [debug] [MainThread]: On master: BEGIN
[0m04:45:47.527611 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:45:47.542410 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m04:45:47.546197 [debug] [MainThread]: Using postgres connection "master"
[0m04:45:47.549740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:45:47.561232 [debug] [MainThread]: SQL status: SELECT 12 in 0.007 seconds
[0m04:45:47.572330 [debug] [MainThread]: On master: ROLLBACK
[0m04:45:47.575599 [debug] [MainThread]: Using postgres connection "master"
[0m04:45:47.578599 [debug] [MainThread]: On master: BEGIN
[0m04:45:47.583210 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:45:47.586805 [debug] [MainThread]: On master: COMMIT
[0m04:45:47.589604 [debug] [MainThread]: Using postgres connection "master"
[0m04:45:47.592216 [debug] [MainThread]: On master: COMMIT
[0m04:45:47.594531 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:45:47.598123 [debug] [MainThread]: On master: Close
[0m04:45:47.601714 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:45:47.605688 [info ] [MainThread]: 
[0m04:45:47.624730 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m04:45:47.627010 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m04:45:47.629957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_salesagent)
[0m04:45:47.632763 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m04:45:47.654966 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m04:45:47.768797 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m04:45:47.870726 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m04:45:47.889966 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m04:45:47.892065 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m04:45:47.893720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:47.910028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m04:45:47.914995 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m04:45:47.918711 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT reseller_id AS sales_agent_key, reseller_id AS original_reseller_id, reseller_name, commission_pct
     -- fill code here 
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m04:45:48.220995 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.298 seconds
[0m04:45:48.250101 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m04:45:48.254878 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent" rename to "dim_salesagent__dbt_backup"
[0m04:45:48.258611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:45:48.271845 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m04:45:48.274233 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m04:45:48.276994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:45:48.340183 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m04:45:48.342154 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m04:45:48.344211 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m04:45:48.350524 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m04:45:48.368162 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m04:45:48.378258 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m04:45:48.380667 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m04:45:48.545033 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.161 seconds
[0m04:45:48.553031 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m04:45:48.559562 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.93s]
[0m04:45:48.565967 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m04:45:48.571581 [debug] [MainThread]: Using postgres connection "master"
[0m04:45:48.573896 [debug] [MainThread]: On master: BEGIN
[0m04:45:48.576014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:45:48.592318 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m04:45:48.596747 [debug] [MainThread]: On master: COMMIT
[0m04:45:48.599937 [debug] [MainThread]: Using postgres connection "master"
[0m04:45:48.603851 [debug] [MainThread]: On master: COMMIT
[0m04:45:48.608102 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:45:48.611811 [debug] [MainThread]: On master: Close
[0m04:45:48.616221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:45:48.619893 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m04:45:48.622622 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m04:45:48.625132 [info ] [MainThread]: 
[0m04:45:48.627991 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m04:45:48.632500 [debug] [MainThread]: Command end result
[0m04:45:48.636544 [info ] [MainThread]: 
[0m04:45:48.639309 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:45:48.641916 [info ] [MainThread]: 
[0m04:45:48.645435 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:45:48.649962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.418984, "process_user_time": 8.014274, "process_kernel_time": 0.591727, "process_mem_max_rss": "117872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:45:48.654032 [debug] [MainThread]: Command `dbt run` succeeded at 04:45:48.653650 after 7.42 seconds
[0m04:45:48.657118 [debug] [MainThread]: Flushing usage events
[0m04:45:57.072424 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:45:57.089693 | 699fb738-3cbe-48ff-8cf4-caadbda082ba ==============================
[0m04:45:57.089693 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:45:57.093413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:45:57.145276 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:45:57.164956 | 5cabc0d2-93a1-409f-8c91-1cd71d6f2f8b ==============================
[0m04:45:57.164956 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:45:57.168314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:45:58.148608 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:45:58.251445 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:45:58.253575 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:45:58.421022 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:46:00.215049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:46:00.216824 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:46:00.386683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:46:00.388895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:46:00.411261 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:46:00.418712 [info ] [MainThread]: 
[0m04:46:00.431636 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:46:00.436823 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m04:46:00.592723 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m04:46:00.595347 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m04:46:00.598092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:46:00.619008 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.020 seconds
[0m04:46:00.624791 [debug] [ThreadPool]: On list_sales_dw: Close
[0m04:46:00.645900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m04:46:00.648590 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m04:46:00.669921 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:46:00.676236 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:46:00.678288 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m04:46:00.682498 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m04:46:00.687000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:46:00.689746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:46:00.708778 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m04:46:00.709786 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m04:46:00.711992 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:46:00.715938 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:46:00.719080 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m04:46:00.722554 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m04:46:00.727714 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:46:00.729632 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m04:46:00.731337 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.005 seconds
[0m04:46:00.736012 [info ] [MainThread]: 
[0m04:46:00.738633 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:46:00.735278 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m04:46:00.740192 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m04:46:00.742702 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m04:46:00.745605 [debug] [MainThread]: Command end result
[0m04:46:00.745068 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m04:46:00.749795 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.9361467, "process_user_time": 5.966863, "process_kernel_time": 0.396435, "process_mem_max_rss": "101780", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:46:00.753795 [debug] [MainThread]: Command `dbt test` succeeded at 04:46:00.753336 after 3.94 seconds
[0m04:46:00.755986 [debug] [MainThread]: Flushing usage events
[0m04:46:00.777575 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:00.780580 [debug] [MainThread]: On master: BEGIN
[0m04:46:00.783987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:46:00.800816 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m04:46:00.807396 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:00.811219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:46:00.825516 [debug] [MainThread]: SQL status: SELECT 9 in 0.010 seconds
[0m04:46:00.835368 [debug] [MainThread]: On master: ROLLBACK
[0m04:46:00.839643 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:00.841537 [debug] [MainThread]: On master: BEGIN
[0m04:46:00.843729 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:46:00.846748 [debug] [MainThread]: On master: COMMIT
[0m04:46:00.849108 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:00.851616 [debug] [MainThread]: On master: COMMIT
[0m04:46:00.856526 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:46:00.859400 [debug] [MainThread]: On master: Close
[0m04:46:00.862254 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:46:00.865294 [info ] [MainThread]: 
[0m04:46:00.888872 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m04:46:00.891893 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m04:46:00.894047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m04:46:00.897067 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m04:46:00.954859 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m04:46:01.005022 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m04:46:01.133856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m04:46:01.223866 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m04:46:01.226259 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m04:46:01.229262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:01.245077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m04:46:01.248568 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m04:46:01.252100 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m04:46:01.628244 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.372 seconds
[0m04:46:01.656518 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m04:46:01.659133 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m04:46:01.663772 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:46:01.707120 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m04:46:01.708962 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m04:46:01.710979 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m04:46:01.717491 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m04:46:01.739373 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m04:46:01.754045 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m04:46:01.757833 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m04:46:01.760590 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m04:46:01.772278 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m04:46:01.777926 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.88s]
[0m04:46:01.783367 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m04:46:01.790556 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:01.793045 [debug] [MainThread]: On master: BEGIN
[0m04:46:01.795810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:46:01.810700 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m04:46:01.815108 [debug] [MainThread]: On master: COMMIT
[0m04:46:01.818403 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:01.822888 [debug] [MainThread]: On master: COMMIT
[0m04:46:01.826150 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:46:01.829977 [debug] [MainThread]: On master: Close
[0m04:46:01.834264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:46:01.837807 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m04:46:01.839858 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m04:46:01.842112 [info ] [MainThread]: 
[0m04:46:01.844837 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m04:46:01.849186 [debug] [MainThread]: Command end result
[0m04:46:01.852062 [info ] [MainThread]: 
[0m04:46:01.855410 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:46:01.858715 [info ] [MainThread]: 
[0m04:46:01.861156 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:46:01.865678 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.949942, "process_user_time": 6.412759, "process_kernel_time": 0.52267, "process_mem_max_rss": "112740", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:46:01.870395 [debug] [MainThread]: Command `dbt run` succeeded at 04:46:01.869941 after 4.95 seconds
[0m04:46:01.872805 [debug] [MainThread]: Flushing usage events
[0m04:46:11.456111 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:46:11.577954 | 1ddd6d0e-3cbe-4922-81f4-29ebe06060fe ==============================
[0m04:46:11.577954 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:46:11.582427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:46:11.706397 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:46:11.775488 | 52396723-9d7e-4df1-8bf6-dfb6bd7d5051 ==============================
[0m04:46:11.775488 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:46:11.780377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:46:13.018659 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:46:13.157566 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:46:13.215556 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:46:13.449310 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:46:16.210894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:46:16.214408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:46:16.355809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:46:16.373283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:46:16.621670 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:46:16.627658 [info ] [MainThread]: 
[0m04:46:16.631969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:46:16.637708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m04:46:16.728843 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:46:16.736090 [info ] [MainThread]: 
[0m04:46:16.739951 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:46:16.745787 [debug] [MainThread]: Command end result
[0m04:46:16.750719 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.3196936, "process_user_time": 6.578753, "process_kernel_time": 0.56418, "process_mem_max_rss": "101788", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:46:16.754969 [debug] [MainThread]: Command `dbt test` succeeded at 04:46:16.754605 after 5.32 seconds
[0m04:46:16.757347 [debug] [MainThread]: Flushing usage events
[0m04:46:16.764878 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m04:46:16.768324 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m04:46:16.773106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:46:16.799051 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.026 seconds
[0m04:46:16.806182 [debug] [ThreadPool]: On list_sales_dw: Close
[0m04:46:16.826733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m04:46:16.828699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m04:46:16.854074 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:46:16.860677 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:46:16.866421 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m04:46:16.870403 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m04:46:16.874391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:46:16.877693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:46:16.898132 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m04:46:16.903502 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:46:16.906718 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m04:46:16.910962 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m04:46:16.914215 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:46:16.921103 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m04:46:16.925520 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m04:46:16.930002 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m04:46:16.931552 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m04:46:16.934985 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m04:46:16.940907 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m04:46:16.947314 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m04:46:16.981341 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:16.985909 [debug] [MainThread]: On master: BEGIN
[0m04:46:16.988892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:46:17.008805 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m04:46:17.011972 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:17.016959 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:46:17.029381 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m04:46:17.040322 [debug] [MainThread]: On master: ROLLBACK
[0m04:46:17.093431 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:17.096157 [debug] [MainThread]: On master: BEGIN
[0m04:46:17.099641 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:46:17.104105 [debug] [MainThread]: On master: COMMIT
[0m04:46:17.106830 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:17.109670 [debug] [MainThread]: On master: COMMIT
[0m04:46:17.112828 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:46:17.116367 [debug] [MainThread]: On master: Close
[0m04:46:17.120556 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:46:17.123769 [info ] [MainThread]: 
[0m04:46:17.141726 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m04:46:17.144155 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m04:46:17.147354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_customer)
[0m04:46:17.149778 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m04:46:17.173863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m04:46:17.202558 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m04:46:17.357957 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m04:46:17.377435 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m04:46:17.381754 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m04:46:17.385645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:17.402001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m04:46:17.405625 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m04:46:17.408968 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select customer_key, customer_first_name, customer_last_name, customer_email
-- fill code here 
from "sales_dw"."dev"."staging_customers"
  );
  
[0m04:48:51.165005 [debug] [Thread-1 (]: SQL status: SELECT 259210 in 153.759 seconds
[0m04:48:51.197746 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m04:48:51.199753 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer" rename to "dim_customer__dbt_backup"
[0m04:48:51.203065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:48:51.216023 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m04:48:51.219335 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m04:48:51.225004 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:48:51.322326 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m04:48:51.327310 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m04:48:51.330684 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m04:48:51.347830 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m04:48:51.378261 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m04:48:51.394377 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m04:48:51.396971 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m04:48:51.687387 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.271 seconds
[0m04:48:51.697912 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m04:48:51.709412 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 259210[0m in 154.55s]
[0m04:48:51.715662 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m04:48:51.726578 [debug] [MainThread]: Using postgres connection "master"
[0m04:48:51.728888 [debug] [MainThread]: On master: BEGIN
[0m04:48:51.730542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:48:51.748608 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m04:48:51.752419 [debug] [MainThread]: On master: COMMIT
[0m04:48:51.756065 [debug] [MainThread]: Using postgres connection "master"
[0m04:48:51.760272 [debug] [MainThread]: On master: COMMIT
[0m04:48:51.764777 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:48:51.769923 [debug] [MainThread]: On master: Close
[0m04:48:51.773706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:48:51.777202 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m04:48:51.781892 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m04:48:51.786289 [info ] [MainThread]: 
[0m04:48:51.790399 [info ] [MainThread]: Finished running 1 table model in 0 hours 2 minutes and 35.15 seconds (155.15s).
[0m04:48:51.795877 [debug] [MainThread]: Command end result
[0m04:48:51.799582 [info ] [MainThread]: 
[0m04:48:51.812939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:48:51.819445 [info ] [MainThread]: 
[0m04:48:51.825180 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:48:51.842057 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 160.64128, "process_user_time": 7.82223, "process_kernel_time": 0.538413, "process_mem_max_rss": "111012", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:48:51.870316 [debug] [MainThread]: Command `dbt run` succeeded at 04:48:51.869845 after 160.67 seconds
[0m04:48:51.874185 [debug] [MainThread]: Flushing usage events
[0m04:49:01.198290 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m04:49:01.198288 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:49:01.213123 | 3ad5a4e5-d6dd-4a4c-9e11-26f024ba7f0e ==============================
[0m04:49:01.213123 [info ] [MainThread]: Running with dbt=1.8.2


============================== 04:49:01.213903 | e6911887-2e35-4fb4-9edd-2050304e2dbb ==============================
[0m04:49:01.213903 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:49:01.217602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:49:01.218085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:49:01.214089 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:49:01.233910 | 45177a93-ac29-4e99-8434-47df9ecd4a6b ==============================
[0m04:49:01.233910 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:49:01.237027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:49:01.907894 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:49:01.936064 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:49:01.953088 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:49:02.011315 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:49:02.037596 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:49:02.051707 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:49:04.016345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:49:04.028973 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:49:04.100109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:49:04.105593 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:49:04.328544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:49:04.330952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:49:04.341454 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:49:04.347831 [info ] [MainThread]: 
[0m04:49:04.351387 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:49:04.355835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m04:49:04.385452 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:49:04.393553 [info ] [MainThread]: 
[0m04:49:04.398243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:49:04.401515 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m04:49:04.480422 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m04:49:04.483938 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m04:49:04.486638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:04.509529 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.023 seconds
[0m04:49:04.516239 [debug] [ThreadPool]: On list_sales_dw: Close
[0m04:49:04.541864 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m04:49:04.545032 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m04:49:04.548431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:04.558716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m04:49:04.570705 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.022 seconds
[0m04:49:04.577099 [debug] [ThreadPool]: On list_sales_dw: Close
[0m04:49:04.561643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m04:49:04.585606 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:49:04.595730 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:49:04.599029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m04:49:04.598434 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m04:49:04.600801 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m04:49:04.604057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:49:04.606977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:04.600494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m04:49:04.625238 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m04:49:04.628690 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m04:49:04.631483 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:49:04.634335 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:49:04.636724 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:49:04.637317 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m04:49:04.645522 [info ] [MainThread]: 
[0m04:49:04.641400 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m04:49:04.633494 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:49:04.649251 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:49:04.648058 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:49:04.650140 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m04:49:04.655265 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m04:49:04.652538 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m04:49:04.657831 [debug] [MainThread]: Command end result
[0m04:49:04.656388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:49:04.656492 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m04:49:04.659653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:04.663210 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.6173313, "process_user_time": 5.952456, "process_kernel_time": 0.601291, "process_mem_max_rss": "101636", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:49:04.666106 [debug] [MainThread]: Command `dbt test` succeeded at 04:49:04.665795 after 3.62 seconds
[0m04:49:04.668392 [debug] [MainThread]: Flushing usage events
[0m04:49:04.662148 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m04:49:04.668470 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m04:49:04.673076 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m04:49:04.676196 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m04:49:04.680439 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m04:49:04.684079 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m04:49:04.686227 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:49:04.690383 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:49:04.694444 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m04:49:04.697984 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m04:49:04.708044 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m04:49:04.709351 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m04:49:04.718408 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:04.717134 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m04:49:04.724361 [debug] [MainThread]: On master: BEGIN
[0m04:49:04.723159 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m04:49:04.728830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:49:04.726550 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m04:49:04.729968 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m04:49:04.745451 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m04:49:04.750114 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:04.752932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:49:04.767389 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:04.768226 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m04:49:04.770583 [debug] [MainThread]: On master: BEGIN
[0m04:49:04.773510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:49:04.778443 [debug] [MainThread]: On master: ROLLBACK
[0m04:49:04.781548 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:04.784471 [debug] [MainThread]: On master: BEGIN
[0m04:49:04.788029 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:49:04.791591 [debug] [MainThread]: On master: COMMIT
[0m04:49:04.791066 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m04:49:04.795982 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:04.796085 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:04.798570 [debug] [MainThread]: On master: COMMIT
[0m04:49:04.799448 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:49:04.800969 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:49:04.804154 [debug] [MainThread]: On master: Close
[0m04:49:04.808215 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:49:04.812008 [info ] [MainThread]: 
[0m04:49:04.811190 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m04:49:04.821426 [debug] [MainThread]: On master: ROLLBACK
[0m04:49:04.824420 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:04.828310 [debug] [MainThread]: On master: BEGIN
[0m04:49:04.831793 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:49:04.834785 [debug] [MainThread]: On master: COMMIT
[0m04:49:04.836298 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m04:49:04.838194 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:04.840070 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m04:49:04.840643 [debug] [MainThread]: On master: COMMIT
[0m04:49:04.843866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_main)
[0m04:49:04.844018 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:49:04.848243 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m04:49:04.848231 [debug] [MainThread]: On master: Close
[0m04:49:04.851193 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:49:04.855020 [info ] [MainThread]: 
[0m04:49:04.877209 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m04:49:04.882913 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m04:49:04.885461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_resellers_xml)
[0m04:49:04.890191 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m04:49:04.947258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m04:49:04.981737 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m04:49:05.001097 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m04:49:05.016171 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m04:49:05.246762 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m04:49:05.249698 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m04:49:05.249786 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

    
  
    

  create temporary table "staging_transactions_resellers_xml__dbt_tmp044905161571"
  
  
    as
  
  (
    

WITH 



latest_transaction as (
    
select max(loaded_timestamp) as max_transaction  from "sales_dw"."dev"."staging_transactions_resellers_xml"

),




trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  

  -- this filter will only be applied on an incremental run
  where loaded_timestamp > (SELECT max_transaction from latest_transaction LIMIT 1)

  

)
SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m04:49:05.252542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:05.252518 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

    
  
    

  create temporary table "staging_transactions_main__dbt_tmp044905164154"
  
  
    as
  
  (
    


WITH 

  

latest_transaction as (

select max(loaded_timestamp) as max_transaction  from "sales_dw"."dev"."staging_transactions_main"

),



trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

  -- this filter will only be applied on an incremental run
  where loaded_timestamp > (SELECT max_transaction from latest_transaction LIMIT 1)

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m04:49:05.256450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:14.124813 [debug] [Thread-1 (]: SQL status: SELECT 318420 in 8.873 seconds
[0m04:49:14.163390 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m04:49:14.166727 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m04:49:14.171434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m04:49:14.174627 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m04:49:14.177455 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'staging_transactions_resellers_xml__dbt_tmp044905161571'
        
      order by ordinal_position

  
[0m04:49:14.864755 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.684 seconds
[0m04:49:14.962571 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m04:49:14.967304 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sales_dw".INFORMATION_SCHEMA.columns
      where table_name = 'staging_transactions_resellers_xml'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
[0m04:49:14.976403 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m04:49:15.011027 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m04:49:15.095340 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sales_dw".INFORMATION_SCHEMA.columns
      where table_name = 'staging_transactions_resellers_xml'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
[0m04:49:15.104292 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.006 seconds
[0m04:49:15.149063 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m04:49:15.204964 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m04:49:15.206921 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      insert into "sales_dw"."dev"."staging_transactions_resellers_xml" ("customer_key", "transaction_id", "product_key", "channel_key", "reseller_id", "bought_date_key", "total_amount", "no_purchased_postcards", "product_price", "geography_key", "commisionpaid", "commission_pct", "loaded_timestamp")
    (
        select "customer_key", "transaction_id", "product_key", "channel_key", "reseller_id", "bought_date_key", "total_amount", "no_purchased_postcards", "product_price", "geography_key", "commisionpaid", "commission_pct", "loaded_timestamp"
        from "staging_transactions_resellers_xml__dbt_tmp044905161571"
    )


  
[0m04:49:31.287641 [debug] [Thread-1 (]: SQL status: INSERT 0 318420 in 16.099 seconds
[0m04:49:31.334956 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m04:49:31.337677 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m04:49:31.342210 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m04:49:31.399951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.054 seconds
[0m04:49:31.405324 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m04:49:31.414689 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mINSERT 0 318420[0m in 26.52s]
[0m04:49:31.418104 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m04:49:31.425282 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:31.427881 [debug] [MainThread]: On master: BEGIN
[0m04:49:31.431333 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:49:31.447164 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m04:49:31.449810 [debug] [MainThread]: On master: COMMIT
[0m04:49:31.451639 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:31.453277 [debug] [MainThread]: On master: COMMIT
[0m04:49:31.455035 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:49:31.457696 [debug] [MainThread]: On master: Close
[0m04:49:31.460604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:49:31.463432 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m04:49:31.466089 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m04:49:31.468246 [info ] [MainThread]: 
[0m04:49:31.469827 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 27.07 seconds (27.07s).
[0m04:49:31.471987 [debug] [MainThread]: Command end result
[0m04:49:31.474624 [info ] [MainThread]: 
[0m04:49:31.477263 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:49:31.480656 [info ] [MainThread]: 
[0m04:49:31.482747 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:49:31.485274 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.495367, "process_user_time": 7.152255, "process_kernel_time": 0.398454, "process_mem_max_rss": "113400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:49:31.487518 [debug] [MainThread]: Command `dbt run` succeeded at 04:49:31.487314 after 30.50 seconds
[0m04:49:31.489266 [debug] [MainThread]: Flushing usage events
[0m04:49:37.511946 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:49:37.527342 | db4b8a73-ab10-410f-83db-35f6ab4fd18e ==============================
[0m04:49:37.527342 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:49:37.529537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:49:38.227971 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:49:38.324869 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:49:40.750771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:49:40.753683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:49:41.069417 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:49:41.074759 [info ] [MainThread]: 
[0m04:49:41.076903 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:49:41.082583 [debug] [MainThread]: Command end result
[0m04:49:41.087195 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.7791753, "process_user_time": 5.002335, "process_kernel_time": 0.319736, "process_mem_max_rss": "101708", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:49:41.091911 [debug] [MainThread]: Command `dbt test` succeeded at 04:49:41.091475 after 3.78 seconds
[0m04:49:41.094263 [debug] [MainThread]: Flushing usage events
[0m04:50:59.688345 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 114.438 seconds
[0m04:50:59.740929 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m04:50:59.743382 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m04:50:59.745691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m04:50:59.749623 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m04:50:59.752634 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'staging_transactions_main__dbt_tmp044905164154'
        
      order by ordinal_position

  
[0m04:50:59.763636 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.008 seconds
[0m04:50:59.778256 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m04:50:59.780059 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sales_dw".INFORMATION_SCHEMA.columns
      where table_name = 'staging_transactions_main'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
[0m04:50:59.788244 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.005 seconds
[0m04:50:59.809069 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m04:50:59.810874 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sales_dw".INFORMATION_SCHEMA.columns
      where table_name = 'staging_transactions_main'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
[0m04:50:59.816696 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.004 seconds
[0m04:50:59.845432 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m04:50:59.890974 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m04:50:59.892958 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      insert into "sales_dw"."dev"."staging_transactions_main" ("customer_key", "transaction_id", "product_key", "channel_key", "reseller_id", "bought_date_key", "total_amount", "qty", "product_price", "geography_key", "commissionpaid", "commissionpct", "loaded_timestamp")
    (
        select "customer_key", "transaction_id", "product_key", "channel_key", "reseller_id", "bought_date_key", "total_amount", "qty", "product_price", "geography_key", "commissionpaid", "commissionpct", "loaded_timestamp"
        from "staging_transactions_main__dbt_tmp044905164154"
    )


  
[0m04:51:10.320682 [debug] [Thread-1 (]: SQL status: INSERT 0 1000000 in 10.425 seconds
[0m04:51:10.378052 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m04:51:10.381852 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m04:51:10.385116 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m04:51:10.543267 [debug] [Thread-1 (]: SQL status: COMMIT in 0.155 seconds
[0m04:51:10.549515 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m04:51:10.558388 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mINSERT 0 1000000[0m in 125.71s]
[0m04:51:10.562089 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m04:51:10.568044 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:10.570603 [debug] [MainThread]: On master: BEGIN
[0m04:51:10.573461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:51:10.904819 [debug] [MainThread]: SQL status: BEGIN in 0.331 seconds
[0m04:51:10.908801 [debug] [MainThread]: On master: COMMIT
[0m04:51:10.912252 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:10.915563 [debug] [MainThread]: On master: COMMIT
[0m04:51:10.918318 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:51:10.921478 [debug] [MainThread]: On master: Close
[0m04:51:10.925845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:51:10.929410 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m04:51:10.931682 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m04:51:10.933770 [info ] [MainThread]: 
[0m04:51:10.937137 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 2 minutes and 6.58 seconds (126.58s).
[0m04:51:10.941274 [debug] [MainThread]: Command end result
[0m04:51:10.944264 [info ] [MainThread]: 
[0m04:51:10.947149 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:51:10.949178 [info ] [MainThread]: 
[0m04:51:10.951843 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:51:10.957608 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 129.946, "process_user_time": 7.017436, "process_kernel_time": 0.524291, "process_mem_max_rss": "113176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:51:10.961684 [debug] [MainThread]: Command `dbt run` succeeded at 04:51:10.961347 after 129.95 seconds
[0m04:51:10.963861 [debug] [MainThread]: Flushing usage events
[0m04:51:19.341376 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:51:19.358272 | a0a54119-43fd-41bf-86d0-bf9738d644ac ==============================
[0m04:51:19.358272 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:51:19.361544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'send_anonymous_usage_stats': 'True'}
[0m04:51:19.555315 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:51:19.725013 | 6b8d4cf3-04ad-4a55-b091-5d8708be9caa ==============================
[0m04:51:19.725013 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:51:19.727821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:51:20.057004 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:51:20.148070 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:51:20.408119 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:51:20.490986 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:51:22.177871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:51:22.180273 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:51:22.429983 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:51:22.435739 [info ] [MainThread]: 
[0m04:51:22.438292 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:51:22.442824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m04:51:22.472112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:51:22.474444 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:51:22.558200 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m04:51:22.561569 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m04:51:22.564722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:51:22.622881 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.058 seconds
[0m04:51:22.636619 [debug] [ThreadPool]: On list_sales_dw: Close
[0m04:51:22.700301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m04:51:22.704953 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m04:51:22.729674 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:51:22.737393 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:51:22.739389 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m04:51:22.742109 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m04:51:22.744673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:51:22.748183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:51:22.766746 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m04:51:22.771927 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:51:22.773650 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m04:51:22.777518 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m04:51:22.781245 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:51:22.787173 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m04:51:22.839159 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:51:22.846075 [info ] [MainThread]: 
[0m04:51:22.849643 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:51:22.855853 [debug] [MainThread]: Command end result
[0m04:51:22.862478 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.538236, "process_user_time": 5.138045, "process_kernel_time": 0.363398, "process_mem_max_rss": "101780", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:51:22.866704 [debug] [MainThread]: Command `dbt test` succeeded at 04:51:22.866297 after 3.54 seconds
[0m04:51:22.869531 [debug] [MainThread]: Flushing usage events
[0m04:51:22.872510 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.087 seconds
[0m04:51:22.873784 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.084 seconds
[0m04:51:22.879752 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m04:51:22.886256 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m04:51:22.888986 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m04:51:22.892400 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m04:51:22.928774 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:22.932161 [debug] [MainThread]: On master: BEGIN
[0m04:51:22.934957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:51:22.951844 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m04:51:22.955842 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:22.959451 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:51:23.083081 [debug] [MainThread]: SQL status: SELECT 12 in 0.120 seconds
[0m04:51:23.089828 [debug] [MainThread]: On master: ROLLBACK
[0m04:51:23.094355 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:23.097810 [debug] [MainThread]: On master: BEGIN
[0m04:51:23.103688 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:51:23.106924 [debug] [MainThread]: On master: COMMIT
[0m04:51:23.110695 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:23.113691 [debug] [MainThread]: On master: COMMIT
[0m04:51:23.117509 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:51:23.120372 [debug] [MainThread]: On master: Close
[0m04:51:23.123186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:51:23.127219 [info ] [MainThread]: 
[0m04:51:23.148070 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m04:51:23.151690 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m04:51:23.154650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m04:51:23.159207 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m04:51:23.186987 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m04:51:23.227798 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m04:51:23.382792 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m04:51:23.403347 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m04:51:23.406146 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m04:51:23.410282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:23.429549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m04:51:23.434913 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m04:51:23.438366 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m04:51:29.648223 [debug] [Thread-1 (]: SQL status: SELECT 2477630 in 6.210 seconds
[0m04:51:29.665225 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m04:51:29.668502 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions" rename to "staging_transactions__dbt_backup"
[0m04:51:29.688169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m04:51:29.697922 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m04:51:29.700636 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m04:51:29.713475 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:51:29.771804 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m04:51:29.773914 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m04:51:29.775829 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m04:51:29.788618 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m04:51:29.812086 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m04:51:29.825780 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m04:51:29.828046 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m04:51:29.957897 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.127 seconds
[0m04:51:29.965205 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m04:51:29.970721 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 2477630[0m in 6.81s]
[0m04:51:29.973392 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m04:51:29.977113 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:29.978835 [debug] [MainThread]: On master: BEGIN
[0m04:51:29.980799 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:51:30.070860 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m04:51:30.073065 [debug] [MainThread]: On master: COMMIT
[0m04:51:30.074805 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:30.076298 [debug] [MainThread]: On master: COMMIT
[0m04:51:30.078114 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:51:30.080420 [debug] [MainThread]: On master: Close
[0m04:51:30.083557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:51:30.086745 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m04:51:30.089202 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m04:51:30.091596 [info ] [MainThread]: 
[0m04:51:30.094016 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.65 seconds (7.65s).
[0m04:51:30.098858 [debug] [MainThread]: Command end result
[0m04:51:30.101678 [info ] [MainThread]: 
[0m04:51:30.105503 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:51:30.108252 [info ] [MainThread]: 
[0m04:51:30.110747 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:51:30.114466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.972382, "process_user_time": 5.642704, "process_kernel_time": 0.344542, "process_mem_max_rss": "110944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:51:30.117759 [debug] [MainThread]: Command `dbt run` succeeded at 04:51:30.117381 after 10.98 seconds
[0m04:51:30.120450 [debug] [MainThread]: Flushing usage events
[0m04:51:42.114684 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:51:42.129666 | a1f07583-b640-46ab-a105-ba2a26c909f0 ==============================
[0m04:51:42.129666 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:51:42.131913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:51:42.195372 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:51:42.212703 | cbe70e16-3d8f-40c1-ae47-23b9feff7fd7 ==============================
[0m04:51:42.212703 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:51:42.214832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:51:42.921051 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:51:43.029574 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:51:43.079886 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:51:43.171422 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:51:44.748069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:51:44.751244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:51:44.751134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:51:44.754230 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:51:44.942996 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:51:44.947068 [info ] [MainThread]: 
[0m04:51:44.950381 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:51:44.954587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m04:51:44.974997 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:51:44.978586 [info ] [MainThread]: 
[0m04:51:44.980457 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:51:44.987438 [debug] [MainThread]: Command end result
[0m04:51:44.990409 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.0274496, "process_user_time": 4.798041, "process_kernel_time": 0.49288, "process_mem_max_rss": "101856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:51:44.992644 [debug] [MainThread]: Command `dbt test` succeeded at 04:51:44.992416 after 3.03 seconds
[0m04:51:44.994253 [debug] [MainThread]: Flushing usage events
[0m04:51:45.039999 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m04:51:45.042152 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m04:51:45.043953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:51:45.061491 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.017 seconds
[0m04:51:45.066347 [debug] [ThreadPool]: On list_sales_dw: Close
[0m04:51:45.081348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m04:51:45.083249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m04:51:45.105427 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:51:45.111976 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:51:45.113618 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m04:51:45.116352 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m04:51:45.118655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:51:45.121621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:51:45.135595 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m04:51:45.137149 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m04:51:45.140174 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:51:45.143151 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:51:45.145449 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m04:51:45.147607 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m04:51:45.156904 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.006 seconds
[0m04:51:45.158169 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m04:51:45.162122 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m04:51:45.167000 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m04:51:45.171002 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m04:51:45.173933 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m04:51:45.209090 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:45.212132 [debug] [MainThread]: On master: BEGIN
[0m04:51:45.214786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:51:45.233939 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m04:51:45.240026 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:45.242844 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:51:45.254253 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m04:51:45.262316 [debug] [MainThread]: On master: ROLLBACK
[0m04:51:45.265959 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:45.269383 [debug] [MainThread]: On master: BEGIN
[0m04:51:45.272618 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:51:45.275722 [debug] [MainThread]: On master: COMMIT
[0m04:51:45.278079 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:45.281004 [debug] [MainThread]: On master: COMMIT
[0m04:51:45.284404 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:51:45.287767 [debug] [MainThread]: On master: Close
[0m04:51:45.290387 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:51:45.293031 [info ] [MainThread]: 
[0m04:51:45.311255 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m04:51:45.313678 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m04:51:45.316663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.fact_sales)
[0m04:51:45.319777 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m04:51:45.343445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m04:51:45.361278 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m04:51:45.506098 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m04:51:45.525296 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m04:51:45.528142 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m04:51:45.531710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:51:45.550862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m04:51:45.554537 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m04:51:45.557812 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
	product_key,
	channel_key,
	bought_date_key,
	geography_key,
    reseller_id,
    total_amount
     -- fill code here 
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m04:51:50.880645 [debug] [Thread-1 (]: SQL status: SELECT 2477630 in 5.320 seconds
[0m04:51:50.902256 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m04:51:50.904854 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales" rename to "fact_sales__dbt_backup"
[0m04:51:50.908387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:51:50.921788 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m04:51:50.924913 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m04:51:50.929719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:51:50.992671 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m04:51:50.995588 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m04:51:50.998525 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m04:51:51.052993 [debug] [Thread-1 (]: SQL status: COMMIT in 0.052 seconds
[0m04:51:51.071261 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m04:51:51.085772 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m04:51:51.088111 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m04:51:51.220741 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.131 seconds
[0m04:51:51.227347 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m04:51:51.235646 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 2477630[0m in 5.91s]
[0m04:51:51.239358 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m04:51:51.245776 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:51.249166 [debug] [MainThread]: On master: BEGIN
[0m04:51:51.251729 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:51:51.274399 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m04:51:51.278231 [debug] [MainThread]: On master: COMMIT
[0m04:51:51.281898 [debug] [MainThread]: Using postgres connection "master"
[0m04:51:51.285128 [debug] [MainThread]: On master: COMMIT
[0m04:51:51.288041 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:51:51.290310 [debug] [MainThread]: On master: Close
[0m04:51:51.293959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:51:51.296791 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m04:51:51.300074 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m04:51:51.302628 [info ] [MainThread]: 
[0m04:51:51.304621 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.35 seconds (6.35s).
[0m04:51:51.306971 [debug] [MainThread]: Command end result
[0m04:51:51.309190 [info ] [MainThread]: 
[0m04:51:51.311732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:51:51.315236 [info ] [MainThread]: 
[0m04:51:51.317654 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:51:51.320772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.282028, "process_user_time": 5.423002, "process_kernel_time": 0.542898, "process_mem_max_rss": "112744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:51:51.323099 [debug] [MainThread]: Command `dbt run` succeeded at 04:51:51.322855 after 9.28 seconds
[0m04:51:51.325546 [debug] [MainThread]: Flushing usage events
[0m04:51:58.359691 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 04:51:58.371062 | 1ba18b8c-dbeb-4194-a82f-8ce1aeccf251 ==============================
[0m04:51:58.371062 [info ] [MainThread]: Running with dbt=1.8.2
[0m04:51:58.374057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'send_anonymous_usage_stats': 'True'}
[0m04:51:59.088831 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:51:59.220521 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m04:52:01.597923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:52:01.600340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:52:01.833737 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m04:52:01.841240 [info ] [MainThread]: 
[0m04:52:01.844938 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:52:01.871024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m04:52:01.865387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m04:52:01.984287 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:52:01.985310 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:52:01.987489 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m04:52:01.990615 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m04:52:01.992667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:52:01.994382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:52:02.009355 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m04:52:02.010496 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m04:52:02.012915 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m04:52:02.014849 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m04:52:02.017464 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m04:52:02.019994 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m04:52:02.026388 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.004 seconds
[0m04:52:02.027446 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m04:52:02.030914 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m04:52:02.035248 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m04:52:02.038143 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m04:52:02.040175 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m04:52:02.064592 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:02.067236 [debug] [MainThread]: On master: BEGIN
[0m04:52:02.069846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:52:02.082015 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m04:52:02.085649 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:02.088584 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:52:02.098037 [debug] [MainThread]: SQL status: SELECT 12 in 0.006 seconds
[0m04:52:02.106540 [debug] [MainThread]: On master: ROLLBACK
[0m04:52:02.108895 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:02.110510 [debug] [MainThread]: On master: BEGIN
[0m04:52:02.112506 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:52:02.114462 [debug] [MainThread]: On master: COMMIT
[0m04:52:02.116748 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:02.119001 [debug] [MainThread]: On master: COMMIT
[0m04:52:02.122329 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:52:02.124621 [debug] [MainThread]: On master: Close
[0m04:52:02.126445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:52:02.128204 [info ] [MainThread]: 
[0m04:52:02.147734 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m04:52:02.158111 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m04:52:02.165001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now test.dbtcomp.total_amount_is_non_negative)
[0m04:52:02.176860 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m04:52:02.258724 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m04:52:02.276450 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m04:52:02.329562 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m04:52:02.344076 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m04:52:02.345750 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m04:52:02.347222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:52:02.361094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m04:52:02.363968 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m04:52:02.367320 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m04:52:03.022988 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.653 seconds
[0m04:52:03.031793 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m04:52:03.038242 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m04:52:03.042239 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.88s]
[0m04:52:03.045344 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m04:52:03.051586 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:03.054466 [debug] [MainThread]: On master: BEGIN
[0m04:52:03.057007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:52:03.074659 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m04:52:03.077590 [debug] [MainThread]: On master: COMMIT
[0m04:52:03.080379 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:03.083651 [debug] [MainThread]: On master: COMMIT
[0m04:52:03.087586 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:52:03.091687 [debug] [MainThread]: On master: Close
[0m04:52:03.095813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:52:03.098594 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m04:52:03.101664 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m04:52:03.105782 [info ] [MainThread]: 
[0m04:52:03.108795 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m04:52:03.112123 [debug] [MainThread]: Command end result
[0m04:52:03.114950 [info ] [MainThread]: 
[0m04:52:03.119126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:52:03.123024 [info ] [MainThread]: 
[0m04:52:03.125941 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:52:03.129117 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.9112396, "process_user_time": 4.886365, "process_kernel_time": 0.362336, "process_mem_max_rss": "114940", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:52:03.131943 [debug] [MainThread]: Command `dbt test` succeeded at 04:52:03.131570 after 4.91 seconds
[0m04:52:03.150164 [debug] [MainThread]: Flushing usage events
